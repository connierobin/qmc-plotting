Rank =    0  Free Memory = 68594 MB
Rank =    1  Free Memory = 68594 MB
Rank =    2  Free Memory = 68594 MB
Rank =    3  Free Memory = 68594 MB
Rank =    4  Free Memory = 68593 MB
Rank =    5  Free Memory = 68593 MB
Rank =    6  Free Memory = 68593 MB
Rank =    7  Free Memory = 68593 MB
Rank =    8  Free Memory = 68593 MB
Rank =    9  Free Memory = 68593 MB
Rank =   10  Free Memory = 68593 MB
Rank =   11  Free Memory = 68593 MB
Rank =   12  Free Memory = 68593 MB
Rank =   13  Free Memory = 68593 MB
Rank =   14  Free Memory = 68592 MB
Rank =   15  Free Memory = 68578 MB
Rank =   16  Free Memory = 68578 MB
Rank =   17  Free Memory = 68578 MB
Rank =   18  Free Memory = 68578 MB
Rank =   19  Free Memory = 68578 MB
Rank =   20  Free Memory = 68578 MB
Rank =   21  Free Memory = 68578 MB
Rank =   22  Free Memory = 68578 MB
Rank =   23  Free Memory = 68578 MB
Rank =   24  Free Memory = 68578 MB
Rank =   25  Free Memory = 68578 MB
Rank =   26  Free Memory = 68578 MB
Rank =   27  Free Memory = 68577 MB
Rank =   28  Free Memory = 68577 MB
Rank =   29  Free Memory = 68577 MB
Rank =   30  Free Memory = 68577 MB
Rank =   31  Free Memory = 68577 MB
Rank =   32  Free Memory = 89538 MB
Rank =   33  Free Memory = 89538 MB
Rank =   34  Free Memory = 89537 MB
Rank =   35  Free Memory = 89537 MB
Rank =   36  Free Memory = 89537 MB
Rank =   37  Free Memory = 89537 MB
Rank =   38  Free Memory = 89537 MB
Rank =   39  Free Memory = 89537 MB
Rank =   40  Free Memory = 89537 MB
Rank =   41  Free Memory = 89537 MB
Rank =   42  Free Memory = 89537 MB
Rank =   43  Free Memory = 89537 MB
Rank =   44  Free Memory = 89537 MB
Rank =   45  Free Memory = 89537 MB
Rank =   46  Free Memory = 89537 MB
Rank =   47  Free Memory = 89537 MB
Rank =   48  Free Memory = 89537 MB
Rank =   49  Free Memory = 89537 MB
Rank =   50  Free Memory = 89537 MB
Rank =   51  Free Memory = 89537 MB
Rank =   52  Free Memory = 89537 MB
Rank =   53  Free Memory = 89537 MB
Rank =   54  Free Memory = 89537 MB
Rank =   55  Free Memory = 89537 MB
Rank =   56  Free Memory = 89537 MB
Rank =   57  Free Memory = 89537 MB
Rank =   58  Free Memory = 89537 MB
Rank =   59  Free Memory = 89537 MB
Rank =   60  Free Memory = 89537 MB
Rank =   61  Free Memory = 89537 MB
Rank =   62  Free Memory = 89537 MB
Rank =   63  Free Memory = 89537 MB
Rank =   64  Free Memory = 88855 MB
Rank =   65  Free Memory = 88855 MB
Rank =   66  Free Memory = 88855 MB
Rank =   67  Free Memory = 88855 MB
Rank =   68  Free Memory = 88855 MB
Rank =   69  Free Memory = 88855 MB
Rank =   70  Free Memory = 88855 MB
Rank =   71  Free Memory = 88855 MB
Rank =   72  Free Memory = 88855 MB
Rank =   73  Free Memory = 88855 MB
Rank =   74  Free Memory = 88855 MB
Rank =   75  Free Memory = 88855 MB
Rank =   76  Free Memory = 88855 MB
Rank =   77  Free Memory = 88855 MB
Rank =   78  Free Memory = 88855 MB
Rank =   79  Free Memory = 88855 MB
Rank =   80  Free Memory = 88855 MB
Rank =   81  Free Memory = 88855 MB
Rank =   82  Free Memory = 88855 MB
Rank =   83  Free Memory = 88855 MB
Rank =   84  Free Memory = 88855 MB
Rank =   85  Free Memory = 88855 MB
Rank =   86  Free Memory = 88855 MB
Rank =   87  Free Memory = 88855 MB
Rank =   88  Free Memory = 88855 MB
Rank =   89  Free Memory = 88855 MB
Rank =   90  Free Memory = 88855 MB
Rank =   91  Free Memory = 88855 MB
Rank =   92  Free Memory = 88855 MB
Rank =   93  Free Memory = 88855 MB
Rank =   94  Free Memory = 88855 MB
Rank =   95  Free Memory = 88855 MB
Rank =   96  Free Memory = 89775 MB
Rank =   97  Free Memory = 89775 MB
Rank =   98  Free Memory = 89775 MB
Rank =   99  Free Memory = 89775 MB
Rank =  100  Free Memory = 89775 MB
Rank =  101  Free Memory = 89775 MB
Rank =  102  Free Memory = 89775 MB
Rank =  103  Free Memory = 89775 MB
Rank =  104  Free Memory = 89775 MB
Rank =  105  Free Memory = 89775 MB
Rank =  106  Free Memory = 89775 MB
Rank =  107  Free Memory = 89775 MB
Rank =  108  Free Memory = 89775 MB
Rank =  109  Free Memory = 89775 MB
Rank =  110  Free Memory = 89775 MB
Rank =  111  Free Memory = 89775 MB
Rank =  112  Free Memory = 89775 MB
Rank =  113  Free Memory = 89775 MB
Rank =  114  Free Memory = 89775 MB
Rank =  115  Free Memory = 89775 MB
Rank =  116  Free Memory = 89775 MB
Rank =  117  Free Memory = 89775 MB
Rank =  118  Free Memory = 89775 MB
Rank =  119  Free Memory = 89775 MB
Rank =  120  Free Memory = 89775 MB
Rank =  121  Free Memory = 89775 MB
Rank =  122  Free Memory = 89775 MB
Rank =  123  Free Memory = 89775 MB
Rank =  124  Free Memory = 89775 MB
Rank =  125  Free Memory = 89775 MB
Rank =  126  Free Memory = 89775 MB
Rank =  127  Free Memory = 89774 MB
  Input file(s): opt_h2o_1b1_edesc_run001l.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001l.xml

  Project = H2O
  date    = 2023-03-10 23:30:42 PST
  host    = n0050.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 546

  Range of prime numbers to use as seeds over processors and threads = 3947-5051


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.098615e-01    1         1  ON     0
     uu_1                 1.438304e-01    1         1  ON     1
     uu_2                 4.315376e-02    1         1  ON     2
     uu_3                -1.911006e-02    1         1  ON     3
     uu_4                -6.427487e-02    1         1  ON     4
     uu_5                -9.778324e-02    1         1  ON     5
     uu_6                -1.245345e-01    1         1  ON     6
     uu_7                -1.382479e-01    1         1  ON     7
     uu_8                -1.321494e-01    1         1  ON     8
     uu_9                -1.022610e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.381078e-01    1         1  ON     0
     ud_1                 1.722253e-01    1         1  ON     1
     ud_2                 5.295228e-02    1         1  ON     2
     ud_3                -1.597799e-02    1         1  ON     3
     ud_4                -6.969666e-02    1         1  ON     4
     ud_5                -1.062712e-01    1         1  ON     5
     ud_6                -1.288496e-01    1         1  ON     6
     ud_7                -1.417069e-01    1         1  ON     7
     ud_8                -1.400989e-01    1         1  ON     8
     ud_9                -1.324301e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.693832e-01    1         1  ON     0
     eO_1                -4.483044e-01    1         1  ON     1
     eO_2                -2.570842e-02    1         1  ON     2
     eO_3                 2.984774e-01    1         1  ON     3
     eO_4                 5.314438e-01    1         1  ON     4
     eO_5                 4.913985e-01    1         1  ON     5
     eO_6                 2.576740e-01    1         1  ON     6
     eO_7                -4.677101e-02    1         1  ON     7
     eO_8                -2.136946e-01    1         1  ON     8
     eO_9                -7.486503e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.363095e-01    1         1  ON     0
     eH1_1                -1.382296e-01    1         1  ON     1
     eH1_2                -9.370082e-02    1         1  ON     2
     eH1_3                -3.894466e-02    1         1  ON     3
     eH1_4                 5.524690e-03    1         1  ON     4
     eH1_5                 3.931805e-02    1         1  ON     5
     eH1_6                 9.469824e-02    1         1  ON     6
     eH1_7                 1.480147e-01    1         1  ON     7
     eH1_8                 1.673113e-01    1         1  ON     8
     eH1_9                 5.521463e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.329019e-01    1         1  ON     0
     eH2_1                -1.350703e-01    1         1  ON     1
     eH2_2                -9.051396e-02    1         1  ON     2
     eH2_3                -3.559834e-02    1         1  ON     3
     eH2_4                 8.546484e-03    1         1  ON     4
     eH2_5                 4.204399e-02    1         1  ON     5
     eH2_6                 9.791210e-02    1         1  ON     6
     eH2_7                 1.512231e-01    1         1  ON     7
     eH2_8                 1.724325e-01    1         1  ON     8
     eH2_9                 3.954105e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.052494e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 5.4895e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9161
    reference variance = 0.34074
====================================================
  Execution time = 2.1429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5266e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352676555874
                                         uncertainty =       0.009723124449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352676555874
                                         uncertainty =       0.009723124449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419915531
  error estimate for blocks of size 2^( 2) =       0.000432420923
  error estimate for blocks of size 2^( 3) =       0.000444960534
  error estimate for blocks of size 2^( 4) =       0.000456813799
  error estimate for blocks of size 2^( 5) =       0.000467083537
  error estimate for blocks of size 2^( 6) =       0.000474189206
  error estimate for blocks of size 2^( 7) =       0.000479240044

      target function =                  N/A
              le_mean =     -16.924192032835
             les_mean =     286.780933894114
             stat err =       0.000469331647
             autocorr =       1.249211009810
              std dev =       0.593850238838
             le_variance =       0.352658106168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.692419203284e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924192032835       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924195824997       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924195981131       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924195890755       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924196679386       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924198625850       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924198938758       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924198880704       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924198510955       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924198529905       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924198657297       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.447441e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924192032835       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924193186276       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924193135456       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924193022045       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924193191999       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924193910135       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924193938867       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924193900708       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924193841775       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.073846e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924192032835       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924192337708       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924192312841       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924192275047       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924192314443       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924192511867       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924192519242       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924192511513       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924192499760       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.198665e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7076e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.099569e-01                 1 1 ON  0
uu_1  1.439870e-01                 1 1 ON  1
uu_2  4.322026e-02                 1 1 ON  2
uu_3  -1.907840e-02                1 1 ON  3
uu_4  -6.439982e-02                1 1 ON  4
uu_5  -9.787107e-02                1 1 ON  5
uu_6  -1.247072e-01                1 1 ON  6
uu_7  -1.383536e-01                1 1 ON  7
uu_8  -1.321552e-01                1 1 ON  8
uu_9  -1.023197e-01                1 1 ON  9
ud_0  4.377004e-01                 1 1 ON  10
ud_1  1.720793e-01                 1 1 ON  11
ud_2  5.288322e-02                 1 1 ON  12
ud_3  -1.600926e-02                1 1 ON  13
ud_4  -6.971118e-02                1 1 ON  14
ud_5  -1.062083e-01                1 1 ON  15
ud_6  -1.286810e-01                1 1 ON  16
ud_7  -1.415499e-01                1 1 ON  17
ud_8  -1.399923e-01                1 1 ON  18
ud_9  -1.322791e-01                1 1 ON  19
eO_0  -7.695919e-01                1 1 ON  20
eO_1  -4.484933e-01                1 1 ON  21
eO_2  -2.596584e-02                1 1 ON  22
eO_3  2.983896e-01                 1 1 ON  23
eO_4  5.316450e-01                 1 1 ON  24
eO_5  4.917544e-01                 1 1 ON  25
eO_6  2.580320e-01                 1 1 ON  26
eO_7  -4.667077e-02                1 1 ON  27
eO_8  -2.138346e-01                1 1 ON  28
eO_9  -7.498274e-02                1 1 ON  29
eH1_0 -2.360824e-01                1 1 ON  30
eH1_1 -1.382358e-01                1 1 ON  31
eH1_2 -9.377357e-02                1 1 ON  32
eH1_3 -3.903316e-02                1 1 ON  33
eH1_4 5.432939e-03                 1 1 ON  34
eH1_5 3.913768e-02                 1 1 ON  35
eH1_6 9.464382e-02                 1 1 ON  36
eH1_7 1.480328e-01                 1 1 ON  37
eH1_8 1.674018e-01                 1 1 ON  38
eH1_9 5.537552e-02                 1 1 ON  39
eH2_0 -2.328043e-01                1 1 ON  40
eH2_1 -1.351018e-01                1 1 ON  41
eH2_2 -9.055826e-02                1 1 ON  42
eH2_3 -3.560615e-02                1 1 ON  43
eH2_4 8.498332e-03                 1 1 ON  44
eH2_5 4.191532e-02                 1 1 ON  45
eH2_6 9.779446e-02                 1 1 ON  46
eH2_7 1.511165e-01                 1 1 ON  47
eH2_8 1.725394e-01                 1 1 ON  48
eH2_9 3.977802e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9183
    reference variance = 0.174781
====================================================
  Execution time = 2.1141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4114e-01
  Total weights = 2.0000e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341442792079
                                         uncertainty =       0.003400335906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341442792079
                                         uncertainty =       0.003400335906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413131727
  error estimate for blocks of size 2^( 2) =       0.000425392323
  error estimate for blocks of size 2^( 3) =       0.000438486989
  error estimate for blocks of size 2^( 4) =       0.000450450418
  error estimate for blocks of size 2^( 5) =       0.000460452563
  error estimate for blocks of size 2^( 6) =       0.000469912899
  error estimate for blocks of size 2^( 7) =       0.000472674074

      target function =                  N/A
              le_mean =     -16.924258430899
             les_mean =     286.771878912202
             stat err =       0.000463372488
             autocorr =       1.258007973400
              std dev =       0.584256490793
             le_variance =       0.341355647034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007743678
                                         uncertainty =       0.003397220566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007743678
                                         uncertainty =       0.003397220566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412868434
  error estimate for blocks of size 2^( 2) =       0.000425138947
  error estimate for blocks of size 2^( 3) =       0.000438241008
  error estimate for blocks of size 2^( 4) =       0.000450211544
  error estimate for blocks of size 2^( 5) =       0.000460203992
  error estimate for blocks of size 2^( 6) =       0.000469651275
  error estimate for blocks of size 2^( 7) =       0.000472409836

      target function =                  N/A
              le_mean =     -16.924257624316
             les_mean =     286.771416651129
             stat err =       0.000463119161
             autocorr =       1.258236097873
              std dev =       0.583884138661
             le_variance =       0.340920687380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341006334818
                                         uncertainty =       0.003396957506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341006334818
                                         uncertainty =       0.003396957506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412867615
  error estimate for blocks of size 2^( 2) =       0.000425138708
  error estimate for blocks of size 2^( 3) =       0.000438242844
  error estimate for blocks of size 2^( 4) =       0.000450215535
  error estimate for blocks of size 2^( 5) =       0.000460213558
  error estimate for blocks of size 2^( 6) =       0.000469668827
  error estimate for blocks of size 2^( 7) =       0.000472429448

      target function =                  N/A
              le_mean =     -16.924257302405
             les_mean =     286.771404402551
             stat err =       0.000463131842
             autocorr =       1.258309993638
              std dev =       0.583882980574
             le_variance =       0.340919335004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341370825125
                                         uncertainty =       0.003399761745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341370825125
                                         uncertainty =       0.003399761745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413088191
  error estimate for blocks of size 2^( 2) =       0.000425350506
  error estimate for blocks of size 2^( 3) =       0.000438446775
  error estimate for blocks of size 2^( 4) =       0.000450411809
  error estimate for blocks of size 2^( 5) =       0.000460413442
  error estimate for blocks of size 2^( 6) =       0.000469873289
  error estimate for blocks of size 2^( 7) =       0.000472634445

      target function =                  N/A
              le_mean =     -16.924258183571
             les_mean =     286.771798599927
             stat err =       0.000463333246
             autocorr =       1.258060042989
              std dev =       0.584194921591
             le_variance =       0.341283706413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924258430899        initial  <--
     2.5000e-01     2.5000e+00             1.4474e-03       -16.924257624316
     1.0000e+00     1.0000e+01             4.0738e-04       -16.924257302405
     4.0000e+00     4.0000e+01             1.1987e-04       -16.924258183571

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6541
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.098615e-01 1 1  ON 0
 uu_1                 1.438304e-01 1 1  ON 1
 uu_2                 4.315376e-02 1 1  ON 2
 uu_3                -1.911006e-02 1 1  ON 3
 uu_4                -6.427487e-02 1 1  ON 4
 uu_5                -9.778324e-02 1 1  ON 5
 uu_6                -1.245345e-01 1 1  ON 6
 uu_7                -1.382479e-01 1 1  ON 7
 uu_8                -1.321494e-01 1 1  ON 8
 uu_9                -1.022610e-01 1 1  ON 9
 ud_0                 4.381078e-01 1 1  ON 10
 ud_1                 1.722253e-01 1 1  ON 11
 ud_2                 5.295228e-02 1 1  ON 12
 ud_3                -1.597799e-02 1 1  ON 13
 ud_4                -6.969666e-02 1 1  ON 14
 ud_5                -1.062712e-01 1 1  ON 15
 ud_6                -1.288496e-01 1 1  ON 16
 ud_7                -1.417069e-01 1 1  ON 17
 ud_8                -1.400989e-01 1 1  ON 18
 ud_9                -1.324301e-01 1 1  ON 19
 eO_0                -7.693832e-01 1 1  ON 20
 eO_1                -4.483044e-01 1 1  ON 21
 eO_2                -2.570842e-02 1 1  ON 22
 eO_3                 2.984774e-01 1 1  ON 23
 eO_4                 5.314438e-01 1 1  ON 24
 eO_5                 4.913985e-01 1 1  ON 25
 eO_6                 2.576740e-01 1 1  ON 26
 eO_7                -4.677101e-02 1 1  ON 27
 eO_8                -2.136946e-01 1 1  ON 28
 eO_9                -7.486503e-02 1 1  ON 29
eH1_0                -2.363095e-01 1 1  ON 30
eH1_1                -1.382296e-01 1 1  ON 31
eH1_2                -9.370082e-02 1 1  ON 32
eH1_3                -3.894466e-02 1 1  ON 33
eH1_4                 5.524690e-03 1 1  ON 34
eH1_5                 3.931805e-02 1 1  ON 35
eH1_6                 9.469824e-02 1 1  ON 36
eH1_7                 1.480147e-01 1 1  ON 37
eH1_8                 1.673113e-01 1 1  ON 38
eH1_9                 5.521463e-02 1 1  ON 39
eH2_0                -2.329019e-01 1 1  ON 40
eH2_1                -1.350703e-01 1 1  ON 41
eH2_2                -9.051396e-02 1 1  ON 42
eH2_3                -3.559834e-02 1 1  ON 43
eH2_4                 8.546484e-03 1 1  ON 44
eH2_5                 4.204399e-02 1 1  ON 45
eH2_6                 9.791210e-02 1 1  ON 46
eH2_7                 1.512231e-01 1 1  ON 47
eH2_8                 1.724325e-01 1 1  ON 48
eH2_9                 3.954105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.0178
    reference variance = 0.469511
====================================================
  Execution time = 2.1045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338470990464
                                         uncertainty =       0.004847678008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338470990464
                                         uncertainty =       0.004847678008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411373547
  error estimate for blocks of size 2^( 2) =       0.000423640354
  error estimate for blocks of size 2^( 3) =       0.000436061295
  error estimate for blocks of size 2^( 4) =       0.000447308059
  error estimate for blocks of size 2^( 5) =       0.000456058673
  error estimate for blocks of size 2^( 6) =       0.000461094716
  error estimate for blocks of size 2^( 7) =       0.000465273305

      target function =                  N/A
              le_mean =     -16.924730512735
             les_mean =     286.784959150093
             stat err =       0.000457433688
             autocorr =       1.236469955872
              std dev =       0.581770049614
             le_variance =       0.338456390628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692473051273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924730512735       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924731181889       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924731367605       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924731385787       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924732108384       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924731927496       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924731936067       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924731936870       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924731944851       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.437369e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924730512735       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924730685467       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924730732533       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924730738866       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924730922237       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924730876001       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924730879844       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924730879552       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924730882846       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.731126e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924730512735       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924730556272       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924730568084       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924730569785       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924730615729       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924730604115       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924730605242       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924730605139       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 9.625664e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6689e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.098757e-01 1 1  ON 0
 uu_1                 1.438543e-01 1 1  ON 1
 uu_2                 4.316816e-02 1 1  ON 2
 uu_3                -1.911591e-02 1 1  ON 3
 uu_4                -6.429198e-02 1 1  ON 4
 uu_5                -9.779093e-02 1 1  ON 5
 uu_6                -1.245355e-01 1 1  ON 6
 uu_7                -1.382486e-01 1 1  ON 7
 uu_8                -1.321640e-01 1 1  ON 8
 uu_9                -1.022809e-01 1 1  ON 9
 ud_0                 4.380705e-01 1 1  ON 10
 ud_1                 1.721979e-01 1 1  ON 11
 ud_2                 5.294435e-02 1 1  ON 12
 ud_3                -1.597060e-02 1 1  ON 13
 ud_4                -6.969354e-02 1 1  ON 14
 ud_5                -1.062558e-01 1 1  ON 15
 ud_6                -1.288347e-01 1 1  ON 16
 ud_7                -1.416785e-01 1 1  ON 17
 ud_8                -1.400941e-01 1 1  ON 18
 ud_9                -1.324324e-01 1 1  ON 19
 eO_0                -7.694073e-01 1 1  ON 20
 eO_1                -4.483206e-01 1 1  ON 21
 eO_2                -2.572688e-02 1 1  ON 22
 eO_3                 2.984707e-01 1 1  ON 23
 eO_4                 5.314669e-01 1 1  ON 24
 eO_5                 4.914334e-01 1 1  ON 25
 eO_6                 2.577072e-01 1 1  ON 26
 eO_7                -4.676105e-02 1 1  ON 27
 eO_8                -2.137146e-01 1 1  ON 28
 eO_9                -7.487879e-02 1 1  ON 29
eH1_0                -2.362888e-01 1 1  ON 30
eH1_1                -1.382349e-01 1 1  ON 31
eH1_2                -9.371162e-02 1 1  ON 32
eH1_3                -3.894779e-02 1 1  ON 33
eH1_4                 5.514186e-03 1 1  ON 34
eH1_5                 3.930632e-02 1 1  ON 35
eH1_6                 9.468533e-02 1 1  ON 36
eH1_7                 1.480185e-01 1 1  ON 37
eH1_8                 1.673231e-01 1 1  ON 38
eH1_9                 5.522947e-02 1 1  ON 39
eH2_0                -2.328988e-01 1 1  ON 40
eH2_1                -1.350656e-01 1 1  ON 41
eH2_2                -9.052071e-02 1 1  ON 42
eH2_3                -3.559862e-02 1 1  ON 43
eH2_4                 8.535882e-03 1 1  ON 44
eH2_5                 4.203767e-02 1 1  ON 45
eH2_6                 9.789705e-02 1 1  ON 46
eH2_7                 1.512225e-01 1 1  ON 47
eH2_8                 1.724480e-01 1 1  ON 48
eH2_9                 3.955838e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9484
    reference variance = 0.331738
====================================================
  Execution time = 2.2646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3514e-01
  Total weights = 2.0000e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335196266169
                                         uncertainty =       0.002868359613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335196266169
                                         uncertainty =       0.002868359613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409362007
  error estimate for blocks of size 2^( 2) =       0.000422065912
  error estimate for blocks of size 2^( 3) =       0.000435159324
  error estimate for blocks of size 2^( 4) =       0.000446777457
  error estimate for blocks of size 2^( 5) =       0.000457347652
  error estimate for blocks of size 2^( 6) =       0.000465867288
  error estimate for blocks of size 2^( 7) =       0.000469206717

      target function =                  N/A
              le_mean =     -16.924535817835
             les_mean =     286.775066986823
             stat err =       0.000459799779
             autocorr =       1.261602234425
              std dev =       0.578925301949
             le_variance =       0.335154505237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335144522708
                                         uncertainty =       0.002868000215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335144522708
                                         uncertainty =       0.002868000215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409330423
  error estimate for blocks of size 2^( 2) =       0.000422034350
  error estimate for blocks of size 2^( 3) =       0.000435127941
  error estimate for blocks of size 2^( 4) =       0.000446746025
  error estimate for blocks of size 2^( 5) =       0.000457315236
  error estimate for blocks of size 2^( 6) =       0.000465833116
  error estimate for blocks of size 2^( 7) =       0.000469173170

      target function =                  N/A
              le_mean =     -16.924536086340
             les_mean =     286.775024361373
             stat err =       0.000459766887
             autocorr =       1.261616409833
              std dev =       0.578880636312
             le_variance =       0.335102791097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335168480425
                                         uncertainty =       0.002868174574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335168480425
                                         uncertainty =       0.002868174574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409345047
  error estimate for blocks of size 2^( 2) =       0.000422048969
  error estimate for blocks of size 2^( 3) =       0.000435142505
  error estimate for blocks of size 2^( 4) =       0.000446760632
  error estimate for blocks of size 2^( 5) =       0.000457330328
  error estimate for blocks of size 2^( 6) =       0.000465849083
  error estimate for blocks of size 2^( 7) =       0.000469188960

      target function =                  N/A
              le_mean =     -16.924535938279
             les_mean =     286.775043293080
             stat err =       0.000459782251
             autocorr =       1.261610587388
              std dev =       0.578901316748
             le_variance =       0.335126734533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335192670965
                                         uncertainty =       0.002868334989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335192670965
                                         uncertainty =       0.002868334989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409359812
  error estimate for blocks of size 2^( 2) =       0.000422063715
  error estimate for blocks of size 2^( 3) =       0.000435157142
  error estimate for blocks of size 2^( 4) =       0.000446775270
  error estimate for blocks of size 2^( 5) =       0.000457345404
  error estimate for blocks of size 2^( 6) =       0.000465864926
  error estimate for blocks of size 2^( 7) =       0.000469204419

      target function =                  N/A
              le_mean =     -16.924535833783
             les_mean =     286.775063933290
             stat err =       0.000459797505
             autocorr =       1.261603282082
              std dev =       0.578922198463
             le_variance =       0.335150911873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924535817835        initial
     2.5000e+00     2.5000e+01             1.4374e-04       -16.924536086340  <--
     1.0000e+01     1.0000e+02             3.7311e-05       -16.924535938279
     4.0000e+01     4.0000e+02             9.6257e-06       -16.924535833783

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.2143e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.099212e-01 1 1  ON 0
 uu_1                 1.439217e-01 1 1  ON 1
 uu_2                 4.320811e-02 1 1  ON 2
 uu_3                -1.913052e-02 1 1  ON 3
 uu_4                -6.434055e-02 1 1  ON 4
 uu_5                -9.781417e-02 1 1  ON 5
 uu_6                -1.245400e-01 1 1  ON 6
 uu_7                -1.382512e-01 1 1  ON 7
 uu_8                -1.322068e-01 1 1  ON 8
 uu_9                -1.023402e-01 1 1  ON 9
 ud_0                 4.379640e-01 1 1  ON 10
 ud_1                 1.721210e-01 1 1  ON 11
 ud_2                 5.291911e-02 1 1  ON 12
 ud_3                -1.595293e-02 1 1  ON 13
 ud_4                -6.968339e-02 1 1  ON 14
 ud_5                -1.062132e-01 1 1  ON 15
 ud_6                -1.287910e-01 1 1  ON 16
 ud_7                -1.415949e-01 1 1  ON 17
 ud_8                -1.400793e-01 1 1  ON 18
 ud_9                -1.324390e-01 1 1  ON 19
 eO_0                -7.694764e-01 1 1  ON 20
 eO_1                -4.483720e-01 1 1  ON 21
 eO_2                -2.578037e-02 1 1  ON 22
 eO_3                 2.984507e-01 1 1  ON 23
 eO_4                 5.315343e-01 1 1  ON 24
 eO_5                 4.915375e-01 1 1  ON 25
 eO_6                 2.578063e-01 1 1  ON 26
 eO_7                -4.673134e-02 1 1  ON 27
 eO_8                -2.137744e-01 1 1  ON 28
 eO_9                -7.491979e-02 1 1  ON 29
eH1_0                -2.362286e-01 1 1  ON 30
eH1_1                -1.382502e-01 1 1  ON 31
eH1_2                -9.374149e-02 1 1  ON 32
eH1_3                -3.895842e-02 1 1  ON 33
eH1_4                 5.483695e-03 1 1  ON 34
eH1_5                 3.927052e-02 1 1  ON 35
eH1_6                 9.464665e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673584e-01 1 1  ON 38
eH1_9                 5.527371e-02 1 1  ON 39
eH2_0                -2.328891e-01 1 1  ON 40
eH2_1                -1.350526e-01 1 1  ON 41
eH2_2                -9.053876e-02 1 1  ON 42
eH2_3                -3.560098e-02 1 1  ON 43
eH2_4                 8.505244e-03 1 1  ON 44
eH2_5                 4.201784e-02 1 1  ON 45
eH2_6                 9.785202e-02 1 1  ON 46
eH2_7                 1.512208e-01 1 1  ON 47
eH2_8                 1.724943e-01 1 1  ON 48
eH2_9                 3.961004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6950e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9241
    reference variance = 0.25214
====================================================
  Execution time = 2.0889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.7574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375675001853
                                         uncertainty =       0.038073078480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375675001853
                                         uncertainty =       0.038073078480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433439477
  error estimate for blocks of size 2^( 2) =       0.000444864511
  error estimate for blocks of size 2^( 3) =       0.000457098084
  error estimate for blocks of size 2^( 4) =       0.000467040423
  error estimate for blocks of size 2^( 5) =       0.000475597862
  error estimate for blocks of size 2^( 6) =       0.000479834435
  error estimate for blocks of size 2^( 7) =       0.000481017768

      target function =                  N/A
              le_mean =     -16.924903991837
             les_mean =     286.828114505568
             stat err =       0.000475872622
             autocorr =       1.205381473150
              std dev =       0.612975986919
             le_variance =       0.375739560539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692490399184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924903991837       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924904725848       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924906121649       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924907000415       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924908879283       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924909304548       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924909165104       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924909504086       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924909343052       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.048519e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924903991837       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924904195017       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924904624177       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924904892131       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924905341712       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924905500232       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924905490791       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924905569688       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924905520007       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.415780e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924903991837       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924904044031       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924904158201       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924904229246       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924904339469       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924904381842       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924904384859       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924904404062       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.936189e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6406e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.100213e-01 1 1  ON 0
 uu_1                 1.439830e-01 1 1  ON 1
 uu_2                 4.325323e-02 1 1  ON 2
 uu_3                -1.913590e-02 1 1  ON 3
 uu_4                -6.434455e-02 1 1  ON 4
 uu_5                -9.784421e-02 1 1  ON 5
 uu_6                -1.245918e-01 1 1  ON 6
 uu_7                -1.382675e-01 1 1  ON 7
 uu_8                -1.322425e-01 1 1  ON 8
 uu_9                -1.024148e-01 1 1  ON 9
 ud_0                 4.378225e-01 1 1  ON 10
 ud_1                 1.720904e-01 1 1  ON 11
 ud_2                 5.289392e-02 1 1  ON 12
 ud_3                -1.595851e-02 1 1  ON 13
 ud_4                -6.964484e-02 1 1  ON 14
 ud_5                -1.061904e-01 1 1  ON 15
 ud_6                -1.286885e-01 1 1  ON 16
 ud_7                -1.415283e-01 1 1  ON 17
 ud_8                -1.401097e-01 1 1  ON 18
 ud_9                -1.324482e-01 1 1  ON 19
 eO_0                -7.695736e-01 1 1  ON 20
 eO_1                -4.484232e-01 1 1  ON 21
 eO_2                -2.583928e-02 1 1  ON 22
 eO_3                 2.984123e-01 1 1  ON 23
 eO_4                 5.316412e-01 1 1  ON 24
 eO_5                 4.916657e-01 1 1  ON 25
 eO_6                 2.579242e-01 1 1  ON 26
 eO_7                -4.669395e-02 1 1  ON 27
 eO_8                -2.138544e-01 1 1  ON 28
 eO_9                -7.497873e-02 1 1  ON 29
eH1_0                -2.361857e-01 1 1  ON 30
eH1_1                -1.382652e-01 1 1  ON 31
eH1_2                -9.375961e-02 1 1  ON 32
eH1_3                -3.894153e-02 1 1  ON 33
eH1_4                 5.474579e-03 1 1  ON 34
eH1_5                 3.921347e-02 1 1  ON 35
eH1_6                 9.457641e-02 1 1  ON 36
eH1_7                 1.480000e-01 1 1  ON 37
eH1_8                 1.674168e-01 1 1  ON 38
eH1_9                 5.534600e-02 1 1  ON 39
eH2_0                -2.328595e-01 1 1  ON 40
eH2_1                -1.350205e-01 1 1  ON 41
eH2_2                -9.054109e-02 1 1  ON 42
eH2_3                -3.562081e-02 1 1  ON 43
eH2_4                 8.492234e-03 1 1  ON 44
eH2_5                 4.195531e-02 1 1  ON 45
eH2_6                 9.779830e-02 1 1  ON 46
eH2_7                 1.512274e-01 1 1  ON 47
eH2_8                 1.725261e-01 1 1  ON 48
eH2_9                 3.966912e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9441
    reference variance = 0.253405
====================================================
  Execution time = 2.0720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4158e-01
  Total weights = 2.0000e+06
  Execution time = 1.8801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341751846957
                                         uncertainty =       0.003821160595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341751846957
                                         uncertainty =       0.003821160595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413308905
  error estimate for blocks of size 2^( 2) =       0.000425431268
  error estimate for blocks of size 2^( 3) =       0.000436964439
  error estimate for blocks of size 2^( 4) =       0.000448310437
  error estimate for blocks of size 2^( 5) =       0.000457070935
  error estimate for blocks of size 2^( 6) =       0.000461716130
  error estimate for blocks of size 2^( 7) =       0.000463046492

      target function =                  N/A
              le_mean =     -16.924961819487
             les_mean =     286.795980921835
             stat err =       0.000457535998
             autocorr =       1.225465287856
              std dev =       0.584507058625
             le_variance =       0.341648501583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341583864018
                                         uncertainty =       0.003819423042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341583864018
                                         uncertainty =       0.003819423042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413207298
  error estimate for blocks of size 2^( 2) =       0.000425332365
  error estimate for blocks of size 2^( 3) =       0.000436865330
  error estimate for blocks of size 2^( 4) =       0.000448208661
  error estimate for blocks of size 2^( 5) =       0.000456967824
  error estimate for blocks of size 2^( 6) =       0.000461616104
  error estimate for blocks of size 2^( 7) =       0.000462944263

      target function =                  N/A
              le_mean =     -16.924960398663
             les_mean =     286.795764867386
             stat err =       0.000457434213
             autocorr =       1.225522590899
              std dev =       0.584363364538
             le_variance =       0.341480541814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341612487012
                                         uncertainty =       0.003819739028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341612487012
                                         uncertainty =       0.003819739028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413224619
  error estimate for blocks of size 2^( 2) =       0.000425349614
  error estimate for blocks of size 2^( 3) =       0.000436883505
  error estimate for blocks of size 2^( 4) =       0.000448228746
  error estimate for blocks of size 2^( 5) =       0.000456988592
  error estimate for blocks of size 2^( 6) =       0.000461636077
  error estimate for blocks of size 2^( 7) =       0.000462964825

      target function =                  N/A
              le_mean =     -16.924960984949
             les_mean =     286.795813342786
             stat err =       0.000457454560
             autocorr =       1.225528870645
              std dev =       0.584387860486
             le_variance =       0.341509171483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341730535462
                                         uncertainty =       0.003820942631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341730535462
                                         uncertainty =       0.003820942631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413296017
  error estimate for blocks of size 2^( 2) =       0.000425418782
  error estimate for blocks of size 2^( 3) =       0.000436952087
  error estimate for blocks of size 2^( 4) =       0.000448298021
  error estimate for blocks of size 2^( 5) =       0.000457058438
  error estimate for blocks of size 2^( 6) =       0.000461703973
  error estimate for blocks of size 2^( 7) =       0.000463034138

      target function =                  N/A
              le_mean =     -16.924961705210
             les_mean =     286.795955747060
             stat err =       0.000457523643
             autocorr =       1.225475527282
              std dev =       0.584488832271
             le_variance =       0.341627195049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924961819487        initial  <--
     6.2500e-01     6.2500e+00             5.0485e-04       -16.924960398663
     2.5000e+00     2.5000e+01             1.4158e-04       -16.924960984949
     1.0000e+01     1.0000e+02             3.9362e-05       -16.924961705210

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2241
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.099212e-01 1 1  ON 0
 uu_1                 1.439217e-01 1 1  ON 1
 uu_2                 4.320811e-02 1 1  ON 2
 uu_3                -1.913052e-02 1 1  ON 3
 uu_4                -6.434055e-02 1 1  ON 4
 uu_5                -9.781417e-02 1 1  ON 5
 uu_6                -1.245400e-01 1 1  ON 6
 uu_7                -1.382512e-01 1 1  ON 7
 uu_8                -1.322068e-01 1 1  ON 8
 uu_9                -1.023402e-01 1 1  ON 9
 ud_0                 4.379640e-01 1 1  ON 10
 ud_1                 1.721210e-01 1 1  ON 11
 ud_2                 5.291911e-02 1 1  ON 12
 ud_3                -1.595293e-02 1 1  ON 13
 ud_4                -6.968339e-02 1 1  ON 14
 ud_5                -1.062132e-01 1 1  ON 15
 ud_6                -1.287910e-01 1 1  ON 16
 ud_7                -1.415949e-01 1 1  ON 17
 ud_8                -1.400793e-01 1 1  ON 18
 ud_9                -1.324390e-01 1 1  ON 19
 eO_0                -7.694764e-01 1 1  ON 20
 eO_1                -4.483720e-01 1 1  ON 21
 eO_2                -2.578037e-02 1 1  ON 22
 eO_3                 2.984507e-01 1 1  ON 23
 eO_4                 5.315343e-01 1 1  ON 24
 eO_5                 4.915375e-01 1 1  ON 25
 eO_6                 2.578063e-01 1 1  ON 26
 eO_7                -4.673134e-02 1 1  ON 27
 eO_8                -2.137744e-01 1 1  ON 28
 eO_9                -7.491979e-02 1 1  ON 29
eH1_0                -2.362286e-01 1 1  ON 30
eH1_1                -1.382502e-01 1 1  ON 31
eH1_2                -9.374149e-02 1 1  ON 32
eH1_3                -3.895842e-02 1 1  ON 33
eH1_4                 5.483695e-03 1 1  ON 34
eH1_5                 3.927052e-02 1 1  ON 35
eH1_6                 9.464665e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673584e-01 1 1  ON 38
eH1_9                 5.527371e-02 1 1  ON 39
eH2_0                -2.328891e-01 1 1  ON 40
eH2_1                -1.350526e-01 1 1  ON 41
eH2_2                -9.053876e-02 1 1  ON 42
eH2_3                -3.560098e-02 1 1  ON 43
eH2_4                 8.505244e-03 1 1  ON 44
eH2_5                 4.201784e-02 1 1  ON 45
eH2_6                 9.785202e-02 1 1  ON 46
eH2_7                 1.512208e-01 1 1  ON 47
eH2_8                 1.724943e-01 1 1  ON 48
eH2_9                 3.961004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6945e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8181
    reference variance = 0.301219
====================================================
  Execution time = 2.0777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338120200043
                                         uncertainty =       0.003029720531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338120200043
                                         uncertainty =       0.003029720531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411149106
  error estimate for blocks of size 2^( 2) =       0.000423800420
  error estimate for blocks of size 2^( 3) =       0.000436427995
  error estimate for blocks of size 2^( 4) =       0.000447967824
  error estimate for blocks of size 2^( 5) =       0.000458741532
  error estimate for blocks of size 2^( 6) =       0.000467773324
  error estimate for blocks of size 2^( 7) =       0.000474659300

      target function =                  N/A
              le_mean =     -16.924708043895
             les_mean =     286.783829376057
             stat err =       0.000462285495
             autocorr =       1.264217606821
              std dev =       0.581452641253
             le_variance =       0.338087174020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692470804389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924708043895       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924708137753       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924708250759       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924708333767       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924708371767       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924708373893       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924708363384       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924708377779       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924708385742       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.126960e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924708043895       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924708067601       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924708096437       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924708117960       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924708127349       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924708127679       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924708124251       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924708128315       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.522424e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924708043895       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924708049837       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924708057084       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924708062515       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924708064856       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924708064927       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924708064016       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924708065060       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 3.808006e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6374e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.099287e-01 1 1  ON 0
 uu_1                 1.439244e-01 1 1  ON 1
 uu_2                 4.320738e-02 1 1  ON 2
 uu_3                -1.913064e-02 1 1  ON 3
 uu_4                -6.434220e-02 1 1  ON 4
 uu_5                -9.781793e-02 1 1  ON 5
 uu_6                -1.245363e-01 1 1  ON 6
 uu_7                -1.382505e-01 1 1  ON 7
 uu_8                -1.322096e-01 1 1  ON 8
 uu_9                -1.023479e-01 1 1  ON 9
 ud_0                 4.379584e-01 1 1  ON 10
 ud_1                 1.721103e-01 1 1  ON 11
 ud_2                 5.291677e-02 1 1  ON 12
 ud_3                -1.595357e-02 1 1  ON 13
 ud_4                -6.968499e-02 1 1  ON 14
 ud_5                -1.062127e-01 1 1  ON 15
 ud_6                -1.287906e-01 1 1  ON 16
 ud_7                -1.415888e-01 1 1  ON 17
 ud_8                -1.400739e-01 1 1  ON 18
 ud_9                -1.324334e-01 1 1  ON 19
 eO_0                -7.694845e-01 1 1  ON 20
 eO_1                -4.483763e-01 1 1  ON 21
 eO_2                -2.579195e-02 1 1  ON 22
 eO_3                 2.984460e-01 1 1  ON 23
 eO_4                 5.315413e-01 1 1  ON 24
 eO_5                 4.915527e-01 1 1  ON 25
 eO_6                 2.578208e-01 1 1  ON 26
 eO_7                -4.672624e-02 1 1  ON 27
 eO_8                -2.137803e-01 1 1  ON 28
 eO_9                -7.492590e-02 1 1  ON 29
eH1_0                -2.362221e-01 1 1  ON 30
eH1_1                -1.382469e-01 1 1  ON 31
eH1_2                -9.374450e-02 1 1  ON 32
eH1_3                -3.895648e-02 1 1  ON 33
eH1_4                 5.474189e-03 1 1  ON 34
eH1_5                 3.926065e-02 1 1  ON 35
eH1_6                 9.464339e-02 1 1  ON 36
eH1_7                 1.480327e-01 1 1  ON 37
eH1_8                 1.673649e-01 1 1  ON 38
eH1_9                 5.527925e-02 1 1  ON 39
eH2_0                -2.328863e-01 1 1  ON 40
eH2_1                -1.350535e-01 1 1  ON 41
eH2_2                -9.054196e-02 1 1  ON 42
eH2_3                -3.560650e-02 1 1  ON 43
eH2_4                 8.497410e-03 1 1  ON 44
eH2_5                 4.201895e-02 1 1  ON 45
eH2_6                 9.784959e-02 1 1  ON 46
eH2_7                 1.512189e-01 1 1  ON 47
eH2_8                 1.725002e-01 1 1  ON 48
eH2_9                 3.962014e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.35263
====================================================
  Execution time = 2.1102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4382e-01
  Total weights = 2.0000e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343888948699
                                         uncertainty =       0.004088885460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343888948699
                                         uncertainty =       0.004088885460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414617102
  error estimate for blocks of size 2^( 2) =       0.000426840042
  error estimate for blocks of size 2^( 3) =       0.000439363270
  error estimate for blocks of size 2^( 4) =       0.000451530153
  error estimate for blocks of size 2^( 5) =       0.000461473533
  error estimate for blocks of size 2^( 6) =       0.000468164559
  error estimate for blocks of size 2^( 7) =       0.000472647753

      target function =                  N/A
              le_mean =     -16.925433193209
             les_mean =     286.814103289198
             stat err =       0.000463453999
             autocorr =       1.249449892557
              std dev =       0.586357129515
             le_variance =       0.343814683333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343899239098
                                         uncertainty =       0.004088777551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343899239098
                                         uncertainty =       0.004088777551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414623306
  error estimate for blocks of size 2^( 2) =       0.000426846151
  error estimate for blocks of size 2^( 3) =       0.000439369531
  error estimate for blocks of size 2^( 4) =       0.000451536065
  error estimate for blocks of size 2^( 5) =       0.000461479005
  error estimate for blocks of size 2^( 6) =       0.000468169025
  error estimate for blocks of size 2^( 7) =       0.000472651086

      target function =                  N/A
              le_mean =     -16.925432997200
             les_mean =     286.814106942326
             stat err =       0.000463458795
             autocorr =       1.249438362216
              std dev =       0.586365902427
             le_variance =       0.343824971530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343895260525
                                         uncertainty =       0.004088846709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343895260525
                                         uncertainty =       0.004088846709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414620907
  error estimate for blocks of size 2^( 2) =       0.000426843760
  error estimate for blocks of size 2^( 3) =       0.000439367034
  error estimate for blocks of size 2^( 4) =       0.000451533716
  error estimate for blocks of size 2^( 5) =       0.000461476864
  error estimate for blocks of size 2^( 6) =       0.000468167374
  error estimate for blocks of size 2^( 7) =       0.000472650001

      target function =                  N/A
              le_mean =     -16.925433088615
             les_mean =     286.814106058948
             stat err =       0.000463456989
             autocorr =       1.249443078969
              std dev =       0.586362510452
             le_variance =       0.343820993663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343889757481
                                         uncertainty =       0.004088880734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343889757481
                                         uncertainty =       0.004088880734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414617590
  error estimate for blocks of size 2^( 2) =       0.000426840518
  error estimate for blocks of size 2^( 3) =       0.000439363752
  error estimate for blocks of size 2^( 4) =       0.000451530609
  error estimate for blocks of size 2^( 5) =       0.000461473960
  error estimate for blocks of size 2^( 6) =       0.000468164922
  error estimate for blocks of size 2^( 7) =       0.000472648044

      target function =                  N/A
              le_mean =     -16.925433179847
             les_mean =     286.814103645474
             stat err =       0.000463454384
             autocorr =       1.249449027401
              std dev =       0.586357819011
             le_variance =       0.343815491916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925433193209        initial  <--
     6.2500e+00     6.2500e+01             6.1270e-05       -16.925432997200
     2.5000e+01     2.5000e+02             1.5224e-05       -16.925433088615
     1.0000e+02     1.0000e+03             3.8080e-06       -16.925433179847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6242
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.099212e-01 1 1  ON 0
 uu_1                 1.439217e-01 1 1  ON 1
 uu_2                 4.320811e-02 1 1  ON 2
 uu_3                -1.913052e-02 1 1  ON 3
 uu_4                -6.434055e-02 1 1  ON 4
 uu_5                -9.781417e-02 1 1  ON 5
 uu_6                -1.245400e-01 1 1  ON 6
 uu_7                -1.382512e-01 1 1  ON 7
 uu_8                -1.322068e-01 1 1  ON 8
 uu_9                -1.023402e-01 1 1  ON 9
 ud_0                 4.379640e-01 1 1  ON 10
 ud_1                 1.721210e-01 1 1  ON 11
 ud_2                 5.291911e-02 1 1  ON 12
 ud_3                -1.595293e-02 1 1  ON 13
 ud_4                -6.968339e-02 1 1  ON 14
 ud_5                -1.062132e-01 1 1  ON 15
 ud_6                -1.287910e-01 1 1  ON 16
 ud_7                -1.415949e-01 1 1  ON 17
 ud_8                -1.400793e-01 1 1  ON 18
 ud_9                -1.324390e-01 1 1  ON 19
 eO_0                -7.694764e-01 1 1  ON 20
 eO_1                -4.483720e-01 1 1  ON 21
 eO_2                -2.578037e-02 1 1  ON 22
 eO_3                 2.984507e-01 1 1  ON 23
 eO_4                 5.315343e-01 1 1  ON 24
 eO_5                 4.915375e-01 1 1  ON 25
 eO_6                 2.578063e-01 1 1  ON 26
 eO_7                -4.673134e-02 1 1  ON 27
 eO_8                -2.137744e-01 1 1  ON 28
 eO_9                -7.491979e-02 1 1  ON 29
eH1_0                -2.362286e-01 1 1  ON 30
eH1_1                -1.382502e-01 1 1  ON 31
eH1_2                -9.374149e-02 1 1  ON 32
eH1_3                -3.895842e-02 1 1  ON 33
eH1_4                 5.483695e-03 1 1  ON 34
eH1_5                 3.927052e-02 1 1  ON 35
eH1_6                 9.464665e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673584e-01 1 1  ON 38
eH1_9                 5.527371e-02 1 1  ON 39
eH2_0                -2.328891e-01 1 1  ON 40
eH2_1                -1.350526e-01 1 1  ON 41
eH2_2                -9.053876e-02 1 1  ON 42
eH2_3                -3.560098e-02 1 1  ON 43
eH2_4                 8.505244e-03 1 1  ON 44
eH2_5                 4.201784e-02 1 1  ON 45
eH2_6                 9.785202e-02 1 1  ON 46
eH2_7                 1.512208e-01 1 1  ON 47
eH2_8                 1.724943e-01 1 1  ON 48
eH2_9                 3.961004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7005e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8515
    reference variance = 0.215972
====================================================
  Execution time = 2.2842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4222e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342162612330
                                         uncertainty =       0.004379631016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342162612330
                                         uncertainty =       0.004379631016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413653642
  error estimate for blocks of size 2^( 2) =       0.000426248604
  error estimate for blocks of size 2^( 3) =       0.000439001503
  error estimate for blocks of size 2^( 4) =       0.000450177501
  error estimate for blocks of size 2^( 5) =       0.000459247523
  error estimate for blocks of size 2^( 6) =       0.000467445319
  error estimate for blocks of size 2^( 7) =       0.000473680458

      target function =                  N/A
              le_mean =     -16.924603781096
             les_mean =     286.784431646457
             stat err =       0.000462637700
             autocorr =       1.250858940893
              std dev =       0.584994590139
             le_variance =       0.342218670492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692460378110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924603781096       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924603807788       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924603825748       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924603828182       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924603828745       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924603834888       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924603834095       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924603835262       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924603835116       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.750076e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924603781096       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924603787777       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924603792272       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924603792877       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924603793024       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924603794557       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924603794355       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924603794646       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924603794609       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.437849e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924603781096       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924603782766       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924603783890       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924603784041       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924603784079       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924603784462       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924603784411       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924603784483       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924603784475       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.594830e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8391e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.099215e-01 1 1  ON 0
 uu_1                 1.439224e-01 1 1  ON 1
 uu_2                 4.320836e-02 1 1  ON 2
 uu_3                -1.913036e-02 1 1  ON 3
 uu_4                -6.434081e-02 1 1  ON 4
 uu_5                -9.781433e-02 1 1  ON 5
 uu_6                -1.245403e-01 1 1  ON 6
 uu_7                -1.382513e-01 1 1  ON 7
 uu_8                -1.322070e-01 1 1  ON 8
 uu_9                -1.023407e-01 1 1  ON 9
 ud_0                 4.379626e-01 1 1  ON 10
 ud_1                 1.721201e-01 1 1  ON 11
 ud_2                 5.291853e-02 1 1  ON 12
 ud_3                -1.595301e-02 1 1  ON 13
 ud_4                -6.968332e-02 1 1  ON 14
 ud_5                -1.062130e-01 1 1  ON 15
 ud_6                -1.287908e-01 1 1  ON 16
 ud_7                -1.415943e-01 1 1  ON 17
 ud_8                -1.400787e-01 1 1  ON 18
 ud_9                -1.324381e-01 1 1  ON 19
 eO_0                -7.694773e-01 1 1  ON 20
 eO_1                -4.483725e-01 1 1  ON 21
 eO_2                -2.578107e-02 1 1  ON 22
 eO_3                 2.984498e-01 1 1  ON 23
 eO_4                 5.315356e-01 1 1  ON 24
 eO_5                 4.915385e-01 1 1  ON 25
 eO_6                 2.578077e-01 1 1  ON 26
 eO_7                -4.673089e-02 1 1  ON 27
 eO_8                -2.137750e-01 1 1  ON 28
 eO_9                -7.492023e-02 1 1  ON 29
eH1_0                -2.362283e-01 1 1  ON 30
eH1_1                -1.382504e-01 1 1  ON 31
eH1_2                -9.374138e-02 1 1  ON 32
eH1_3                -3.895837e-02 1 1  ON 33
eH1_4                 5.483121e-03 1 1  ON 34
eH1_5                 3.926998e-02 1 1  ON 35
eH1_6                 9.464622e-02 1 1  ON 36
eH1_7                 1.480301e-01 1 1  ON 37
eH1_8                 1.673589e-01 1 1  ON 38
eH1_9                 5.527433e-02 1 1  ON 39
eH2_0                -2.328888e-01 1 1  ON 40
eH2_1                -1.350524e-01 1 1  ON 41
eH2_2                -9.053926e-02 1 1  ON 42
eH2_3                -3.560154e-02 1 1  ON 43
eH2_4                 8.504554e-03 1 1  ON 44
eH2_5                 4.201775e-02 1 1  ON 45
eH2_6                 9.785182e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724949e-01 1 1  ON 48
eH2_9                 3.961086e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0306
    reference variance = 0.291278
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3859e-01
  Total weights = 2.0000e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338650432799
                                         uncertainty =       0.005997179467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338650432799
                                         uncertainty =       0.005997179467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411456009
  error estimate for blocks of size 2^( 2) =       0.000423573287
  error estimate for blocks of size 2^( 3) =       0.000436386606
  error estimate for blocks of size 2^( 4) =       0.000447178085
  error estimate for blocks of size 2^( 5) =       0.000457090092
  error estimate for blocks of size 2^( 6) =       0.000464634960
  error estimate for blocks of size 2^( 7) =       0.000468981771

      target function =                  N/A
              le_mean =     -16.924865230999
             les_mean =     286.789655013112
             stat err =       0.000459471227
             autocorr =       1.247009670438
              std dev =       0.581886668456
             le_variance =       0.338592094927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338648802653
                                         uncertainty =       0.005997217606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338648802653
                                         uncertainty =       0.005997217606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411455019
  error estimate for blocks of size 2^( 2) =       0.000423572329
  error estimate for blocks of size 2^( 3) =       0.000436385670
  error estimate for blocks of size 2^( 4) =       0.000447177167
  error estimate for blocks of size 2^( 5) =       0.000457089136
  error estimate for blocks of size 2^( 6) =       0.000464633996
  error estimate for blocks of size 2^( 7) =       0.000468980776

      target function =                  N/A
              le_mean =     -16.924865236038
             les_mean =     286.789653553399
             stat err =       0.000459470269
             autocorr =       1.247010474123
              std dev =       0.581885267602
             le_variance =       0.338590464652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338649615836
                                         uncertainty =       0.005997198633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338649615836
                                         uncertainty =       0.005997198633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411455513
  error estimate for blocks of size 2^( 2) =       0.000423572807
  error estimate for blocks of size 2^( 3) =       0.000436386137
  error estimate for blocks of size 2^( 4) =       0.000447177625
  error estimate for blocks of size 2^( 5) =       0.000457089613
  error estimate for blocks of size 2^( 6) =       0.000464634477
  error estimate for blocks of size 2^( 7) =       0.000468981273

      target function =                  N/A
              le_mean =     -16.924865233508
             les_mean =     286.789654281020
             stat err =       0.000459470747
             autocorr =       1.247010073250
              std dev =       0.581885966406
             le_variance =       0.338591277900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338650330615
                                         uncertainty =       0.005997181866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338650330615
                                         uncertainty =       0.005997181866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411455947
  error estimate for blocks of size 2^( 2) =       0.000423573227
  error estimate for blocks of size 2^( 3) =       0.000436386548
  error estimate for blocks of size 2^( 4) =       0.000447178027
  error estimate for blocks of size 2^( 5) =       0.000457090032
  error estimate for blocks of size 2^( 6) =       0.000464634899
  error estimate for blocks of size 2^( 7) =       0.000468981709

      target function =                  N/A
              le_mean =     -16.924865231311
             les_mean =     286.789654921487
             stat err =       0.000459471167
             autocorr =       1.247009720815
              std dev =       0.581886580645
             le_variance =       0.338591992735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924865230999        initial
     6.2500e+01     6.2500e+02             5.7501e-06       -16.924865236038  <--
     2.5000e+02     2.5000e+03             1.4378e-06       -16.924865233508
     1.0000e+03     1.0000e+04             3.5948e-07       -16.924865231311

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 3.0050e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.099225e-01 1 1  ON 0
 uu_1                 1.439244e-01 1 1  ON 1
 uu_2                 4.320910e-02 1 1  ON 2
 uu_3                -1.912987e-02 1 1  ON 3
 uu_4                -6.434159e-02 1 1  ON 4
 uu_5                -9.781479e-02 1 1  ON 5
 uu_6                -1.245414e-01 1 1  ON 6
 uu_7                -1.382516e-01 1 1  ON 7
 uu_8                -1.322077e-01 1 1  ON 8
 uu_9                -1.023424e-01 1 1  ON 9
 ud_0                 4.379583e-01 1 1  ON 10
 ud_1                 1.721173e-01 1 1  ON 11
 ud_2                 5.291681e-02 1 1  ON 12
 ud_3                -1.595324e-02 1 1  ON 13
 ud_4                -6.968310e-02 1 1  ON 14
 ud_5                -1.062124e-01 1 1  ON 15
 ud_6                -1.287903e-01 1 1  ON 16
 ud_7                -1.415924e-01 1 1  ON 17
 ud_8                -1.400769e-01 1 1  ON 18
 ud_9                -1.324354e-01 1 1  ON 19
 eO_0                -7.694802e-01 1 1  ON 20
 eO_1                -4.483739e-01 1 1  ON 21
 eO_2                -2.578316e-02 1 1  ON 22
 eO_3                 2.984472e-01 1 1  ON 23
 eO_4                 5.315394e-01 1 1  ON 24
 eO_5                 4.915414e-01 1 1  ON 25
 eO_6                 2.578120e-01 1 1  ON 26
 eO_7                -4.672955e-02 1 1  ON 27
 eO_8                -2.137768e-01 1 1  ON 28
 eO_9                -7.492158e-02 1 1  ON 29
eH1_0                -2.362274e-01 1 1  ON 30
eH1_1                -1.382510e-01 1 1  ON 31
eH1_2                -9.374103e-02 1 1  ON 32
eH1_3                -3.895819e-02 1 1  ON 33
eH1_4                 5.481402e-03 1 1  ON 34
eH1_5                 3.926834e-02 1 1  ON 35
eH1_6                 9.464494e-02 1 1  ON 36
eH1_7                 1.480303e-01 1 1  ON 37
eH1_8                 1.673604e-01 1 1  ON 38
eH1_9                 5.527620e-02 1 1  ON 39
eH2_0                -2.328879e-01 1 1  ON 40
eH2_1                -1.350518e-01 1 1  ON 41
eH2_2                -9.054078e-02 1 1  ON 42
eH2_3                -3.560323e-02 1 1  ON 43
eH2_4                 8.502486e-03 1 1  ON 44
eH2_5                 4.201749e-02 1 1  ON 45
eH2_6                 9.785123e-02 1 1  ON 46
eH2_7                 1.512212e-01 1 1  ON 47
eH2_8                 1.724969e-01 1 1  ON 48
eH2_9                 3.961329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9447
    reference variance = 0.363449
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351454918143
                                         uncertainty =       0.009228598858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351454918143
                                         uncertainty =       0.009228598858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419235425
  error estimate for blocks of size 2^( 2) =       0.000431485679
  error estimate for blocks of size 2^( 3) =       0.000443835237
  error estimate for blocks of size 2^( 4) =       0.000455318629
  error estimate for blocks of size 2^( 5) =       0.000464643021
  error estimate for blocks of size 2^( 6) =       0.000471916924
  error estimate for blocks of size 2^( 7) =       0.000472880010

      target function =                  N/A
              le_mean =     -16.924379523531
             les_mean =     286.786138764108
             stat err =       0.000466189646
             autocorr =       1.236543221119
              std dev =       0.592888424042
             le_variance =       0.351516683363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692437952353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924379523531       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924379589784       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924379599560       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924379653913       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924379588267       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924379595070       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924379618050       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924379618859       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.059583e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924379523531       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924379540174       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924379542585       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924379556234       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924379539683       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924379541422       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924379547046       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924379547270       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.182062e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924379523531       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924379527696       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924379528297       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924379531713       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924379527567       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924379528004       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924379529402       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924379529459       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.297620e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6309e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.099242e-01 1 1  ON 0
 uu_1                 1.439269e-01 1 1  ON 1
 uu_2                 4.321158e-02 1 1  ON 2
 uu_3                -1.913084e-02 1 1  ON 3
 uu_4                -6.434246e-02 1 1  ON 4
 uu_5                -9.781590e-02 1 1  ON 5
 uu_6                -1.245422e-01 1 1  ON 6
 uu_7                -1.382512e-01 1 1  ON 7
 uu_8                -1.322090e-01 1 1  ON 8
 uu_9                -1.023454e-01 1 1  ON 9
 ud_0                 4.379552e-01 1 1  ON 10
 ud_1                 1.721145e-01 1 1  ON 11
 ud_2                 5.291594e-02 1 1  ON 12
 ud_3                -1.595511e-02 1 1  ON 13
 ud_4                -6.968146e-02 1 1  ON 14
 ud_5                -1.062114e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415901e-01 1 1  ON 17
 ud_8                -1.400754e-01 1 1  ON 18
 ud_9                -1.324333e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483791e-01 1 1  ON 21
 eO_2                -2.578672e-02 1 1  ON 22
 eO_3                 2.984468e-01 1 1  ON 23
 eO_4                 5.315442e-01 1 1  ON 24
 eO_5                 4.915459e-01 1 1  ON 25
 eO_6                 2.578171e-01 1 1  ON 26
 eO_7                -4.672749e-02 1 1  ON 27
 eO_8                -2.137793e-01 1 1  ON 28
 eO_9                -7.492381e-02 1 1  ON 29
eH1_0                -2.362273e-01 1 1  ON 30
eH1_1                -1.382502e-01 1 1  ON 31
eH1_2                -9.374258e-02 1 1  ON 32
eH1_3                -3.895892e-02 1 1  ON 33
eH1_4                 5.482287e-03 1 1  ON 34
eH1_5                 3.926706e-02 1 1  ON 35
eH1_6                 9.464287e-02 1 1  ON 36
eH1_7                 1.480295e-01 1 1  ON 37
eH1_8                 1.673622e-01 1 1  ON 38
eH1_9                 5.527868e-02 1 1  ON 39
eH2_0                -2.328861e-01 1 1  ON 40
eH2_1                -1.350522e-01 1 1  ON 41
eH2_2                -9.054175e-02 1 1  ON 42
eH2_3                -3.560356e-02 1 1  ON 43
eH2_4                 8.501643e-03 1 1  ON 44
eH2_5                 4.201673e-02 1 1  ON 45
eH2_6                 9.784957e-02 1 1  ON 46
eH2_7                 1.512210e-01 1 1  ON 47
eH2_8                 1.724984e-01 1 1  ON 48
eH2_9                 3.961540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.253133
====================================================
  Execution time = 2.0588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3384e-01
  Total weights = 2.0000e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333952992152
                                         uncertainty =       0.002848660783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333952992152
                                         uncertainty =       0.002848660783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408561761
  error estimate for blocks of size 2^( 2) =       0.000421172683
  error estimate for blocks of size 2^( 3) =       0.000433641128
  error estimate for blocks of size 2^( 4) =       0.000445466226
  error estimate for blocks of size 2^( 5) =       0.000454961521
  error estimate for blocks of size 2^( 6) =       0.000462327181
  error estimate for blocks of size 2^( 7) =       0.000467106185

      target function =                  N/A
              le_mean =     -16.924694493201
             les_mean =     286.779128946419
             stat err =       0.000457465278
             autocorr =       1.253720824407
              std dev =       0.577793583509
             le_variance =       0.333845425145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333948945865
                                         uncertainty =       0.002848671444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333948945865
                                         uncertainty =       0.002848671444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408559288
  error estimate for blocks of size 2^( 2) =       0.000421170269
  error estimate for blocks of size 2^( 3) =       0.000433638638
  error estimate for blocks of size 2^( 4) =       0.000445463544
  error estimate for blocks of size 2^( 5) =       0.000454958681
  error estimate for blocks of size 2^( 6) =       0.000462323969
  error estimate for blocks of size 2^( 7) =       0.000467102798

      target function =                  N/A
              le_mean =     -16.924694408061
             les_mean =     286.779122022736
             stat err =       0.000457462248
             autocorr =       1.253719393026
              std dev =       0.577790085943
             le_variance =       0.333841383414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333950948446
                                         uncertainty =       0.002848666036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333950948446
                                         uncertainty =       0.002848666036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408560512
  error estimate for blocks of size 2^( 2) =       0.000421171464
  error estimate for blocks of size 2^( 3) =       0.000433639871
  error estimate for blocks of size 2^( 4) =       0.000445464872
  error estimate for blocks of size 2^( 5) =       0.000454960088
  error estimate for blocks of size 2^( 6) =       0.000462325560
  error estimate for blocks of size 2^( 7) =       0.000467104474

      target function =                  N/A
              le_mean =     -16.924694450057
             les_mean =     286.779125444604
             stat err =       0.000457463749
             autocorr =       1.253720106734
              std dev =       0.577791816962
             le_variance =       0.333843383748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333952735919
                                         uncertainty =       0.002848661437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333952735919
                                         uncertainty =       0.002848661437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408561604
  error estimate for blocks of size 2^( 2) =       0.000421172530
  error estimate for blocks of size 2^( 3) =       0.000433640970
  error estimate for blocks of size 2^( 4) =       0.000445466056
  error estimate for blocks of size 2^( 5) =       0.000454961342
  error estimate for blocks of size 2^( 6) =       0.000462326977
  error estimate for blocks of size 2^( 7) =       0.000467105971

      target function =                  N/A
              le_mean =     -16.924694487772
             les_mean =     286.779128506711
             stat err =       0.000457465087
             autocorr =       1.253720734583
              std dev =       0.577793362026
             le_variance =       0.333845169202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924694493201        initial  <--
     1.5625e+01     1.5625e+02             2.0596e-05       -16.924694408061
     6.2500e+01     6.2500e+02             5.1821e-06       -16.924694450057
     2.5000e+02     2.5000e+03             1.2976e-06       -16.924694487772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1450
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.099225e-01 1 1  ON 0
 uu_1                 1.439244e-01 1 1  ON 1
 uu_2                 4.320910e-02 1 1  ON 2
 uu_3                -1.912987e-02 1 1  ON 3
 uu_4                -6.434159e-02 1 1  ON 4
 uu_5                -9.781479e-02 1 1  ON 5
 uu_6                -1.245414e-01 1 1  ON 6
 uu_7                -1.382516e-01 1 1  ON 7
 uu_8                -1.322077e-01 1 1  ON 8
 uu_9                -1.023424e-01 1 1  ON 9
 ud_0                 4.379583e-01 1 1  ON 10
 ud_1                 1.721173e-01 1 1  ON 11
 ud_2                 5.291681e-02 1 1  ON 12
 ud_3                -1.595324e-02 1 1  ON 13
 ud_4                -6.968310e-02 1 1  ON 14
 ud_5                -1.062124e-01 1 1  ON 15
 ud_6                -1.287903e-01 1 1  ON 16
 ud_7                -1.415924e-01 1 1  ON 17
 ud_8                -1.400769e-01 1 1  ON 18
 ud_9                -1.324354e-01 1 1  ON 19
 eO_0                -7.694802e-01 1 1  ON 20
 eO_1                -4.483739e-01 1 1  ON 21
 eO_2                -2.578316e-02 1 1  ON 22
 eO_3                 2.984472e-01 1 1  ON 23
 eO_4                 5.315394e-01 1 1  ON 24
 eO_5                 4.915414e-01 1 1  ON 25
 eO_6                 2.578120e-01 1 1  ON 26
 eO_7                -4.672955e-02 1 1  ON 27
 eO_8                -2.137768e-01 1 1  ON 28
 eO_9                -7.492158e-02 1 1  ON 29
eH1_0                -2.362274e-01 1 1  ON 30
eH1_1                -1.382510e-01 1 1  ON 31
eH1_2                -9.374103e-02 1 1  ON 32
eH1_3                -3.895819e-02 1 1  ON 33
eH1_4                 5.481402e-03 1 1  ON 34
eH1_5                 3.926834e-02 1 1  ON 35
eH1_6                 9.464494e-02 1 1  ON 36
eH1_7                 1.480303e-01 1 1  ON 37
eH1_8                 1.673604e-01 1 1  ON 38
eH1_9                 5.527620e-02 1 1  ON 39
eH2_0                -2.328879e-01 1 1  ON 40
eH2_1                -1.350518e-01 1 1  ON 41
eH2_2                -9.054078e-02 1 1  ON 42
eH2_3                -3.560323e-02 1 1  ON 43
eH2_4                 8.502486e-03 1 1  ON 44
eH2_5                 4.201749e-02 1 1  ON 45
eH2_6                 9.785123e-02 1 1  ON 46
eH2_7                 1.512212e-01 1 1  ON 47
eH2_8                 1.724969e-01 1 1  ON 48
eH2_9                 3.961329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9322
    reference variance = 0.558039
====================================================
  Execution time = 2.1154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3553e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335594712523
                                         uncertainty =       0.003013259273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335594712523
                                         uncertainty =       0.003013259273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409591882
  error estimate for blocks of size 2^( 2) =       0.000421864186
  error estimate for blocks of size 2^( 3) =       0.000434446305
  error estimate for blocks of size 2^( 4) =       0.000445792928
  error estimate for blocks of size 2^( 5) =       0.000455823040
  error estimate for blocks of size 2^( 6) =       0.000461795865
  error estimate for blocks of size 2^( 7) =       0.000465685246

      target function =                  N/A
              le_mean =     -16.924895610148
             les_mean =     286.787622266589
             stat err =       0.000457274270
             autocorr =       1.246381082055
              std dev =       0.579250394867
             le_variance =       0.335531019953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692489561015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924895610148       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924895621503       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924895623148       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924895628792       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924895633351       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924895633126       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924895633376       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924895633471       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.301581e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924895610148       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924895612988       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924895613400       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924895614813       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924895615952       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924895615896       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924895615958       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924895615981       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.754057e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924895610148       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924895610858       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924895610961       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924895611315       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924895611601       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924895611588       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924895611605       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924895611604       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.438521e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6737e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.099228e-01 1 1  ON 0
 uu_1                 1.439248e-01 1 1  ON 1
 uu_2                 4.320932e-02 1 1  ON 2
 uu_3                -1.912984e-02 1 1  ON 3
 uu_4                -6.434164e-02 1 1  ON 4
 uu_5                -9.781483e-02 1 1  ON 5
 uu_6                -1.245414e-01 1 1  ON 6
 uu_7                -1.382518e-01 1 1  ON 7
 uu_8                -1.322081e-01 1 1  ON 8
 uu_9                -1.023428e-01 1 1  ON 9
 ud_0                 4.379579e-01 1 1  ON 10
 ud_1                 1.721171e-01 1 1  ON 11
 ud_2                 5.291666e-02 1 1  ON 12
 ud_3                -1.595335e-02 1 1  ON 13
 ud_4                -6.968310e-02 1 1  ON 14
 ud_5                -1.062122e-01 1 1  ON 15
 ud_6                -1.287901e-01 1 1  ON 16
 ud_7                -1.415921e-01 1 1  ON 17
 ud_8                -1.400767e-01 1 1  ON 18
 ud_9                -1.324354e-01 1 1  ON 19
 eO_0                -7.694806e-01 1 1  ON 20
 eO_1                -4.483742e-01 1 1  ON 21
 eO_2                -2.578355e-02 1 1  ON 22
 eO_3                 2.984472e-01 1 1  ON 23
 eO_4                 5.315399e-01 1 1  ON 24
 eO_5                 4.915419e-01 1 1  ON 25
 eO_6                 2.578124e-01 1 1  ON 26
 eO_7                -4.672938e-02 1 1  ON 27
 eO_8                -2.137770e-01 1 1  ON 28
 eO_9                -7.492184e-02 1 1  ON 29
eH1_0                -2.362273e-01 1 1  ON 30
eH1_1                -1.382511e-01 1 1  ON 31
eH1_2                -9.374104e-02 1 1  ON 32
eH1_3                -3.895814e-02 1 1  ON 33
eH1_4                 5.481350e-03 1 1  ON 34
eH1_5                 3.926821e-02 1 1  ON 35
eH1_6                 9.464476e-02 1 1  ON 36
eH1_7                 1.480302e-01 1 1  ON 37
eH1_8                 1.673606e-01 1 1  ON 38
eH1_9                 5.527647e-02 1 1  ON 39
eH2_0                -2.328879e-01 1 1  ON 40
eH2_1                -1.350516e-01 1 1  ON 41
eH2_2                -9.054091e-02 1 1  ON 42
eH2_3                -3.560338e-02 1 1  ON 43
eH2_4                 8.502560e-03 1 1  ON 44
eH2_5                 4.201746e-02 1 1  ON 45
eH2_6                 9.785100e-02 1 1  ON 46
eH2_7                 1.512212e-01 1 1  ON 47
eH2_8                 1.724970e-01 1 1  ON 48
eH2_9                 3.961350e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.958
    reference variance = 0.318371
====================================================
  Execution time = 2.2800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.0000e+06
  Execution time = 1.8930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334713241466
                                         uncertainty =       0.003549930329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334713241466
                                         uncertainty =       0.003549930329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056624
  error estimate for blocks of size 2^( 2) =       0.000421212350
  error estimate for blocks of size 2^( 3) =       0.000433728948
  error estimate for blocks of size 2^( 4) =       0.000445309759
  error estimate for blocks of size 2^( 5) =       0.000455068958
  error estimate for blocks of size 2^( 6) =       0.000463947025
  error estimate for blocks of size 2^( 7) =       0.000467728681

      target function =                  N/A
              le_mean =     -16.924487766333
             les_mean =     286.772940629043
             stat err =       0.000458013606
             autocorr =       1.253689242613
              std dev =       0.578493425739
             le_variance =       0.334654643623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712561851
                                         uncertainty =       0.003549923648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712561851
                                         uncertainty =       0.003549923648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056209
  error estimate for blocks of size 2^( 2) =       0.000421211956
  error estimate for blocks of size 2^( 3) =       0.000433728568
  error estimate for blocks of size 2^( 4) =       0.000445309374
  error estimate for blocks of size 2^( 5) =       0.000455068551
  error estimate for blocks of size 2^( 6) =       0.000463946586
  error estimate for blocks of size 2^( 7) =       0.000467728215

      target function =                  N/A
              le_mean =     -16.924487774362
             les_mean =     286.772940221157
             stat err =       0.000458013181
             autocorr =       1.253689464009
              std dev =       0.578492838292
             le_variance =       0.334653963955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712901133
                                         uncertainty =       0.003549926985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334712901133
                                         uncertainty =       0.003549926985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056416
  error estimate for blocks of size 2^( 2) =       0.000421212153
  error estimate for blocks of size 2^( 3) =       0.000433728758
  error estimate for blocks of size 2^( 4) =       0.000445309566
  error estimate for blocks of size 2^( 5) =       0.000455068754
  error estimate for blocks of size 2^( 6) =       0.000463946805
  error estimate for blocks of size 2^( 7) =       0.000467728448

      target function =                  N/A
              le_mean =     -16.924487770348
             les_mean =     286.772940424594
             stat err =       0.000458013393
             autocorr =       1.253689353756
              std dev =       0.578493131561
             le_variance =       0.334654303263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334713198907
                                         uncertainty =       0.003549929911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334713198907
                                         uncertainty =       0.003549929911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056598
  error estimate for blocks of size 2^( 2) =       0.000421212325
  error estimate for blocks of size 2^( 3) =       0.000433728925
  error estimate for blocks of size 2^( 4) =       0.000445309735
  error estimate for blocks of size 2^( 5) =       0.000455068933
  error estimate for blocks of size 2^( 6) =       0.000463946998
  error estimate for blocks of size 2^( 7) =       0.000467728652

      target function =                  N/A
              le_mean =     -16.924487766835
             les_mean =     286.772940603465
             stat err =       0.000458013579
             autocorr =       1.253689256510
              std dev =       0.578493388952
             le_variance =       0.334654601061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924487766333        initial
     1.5625e+02     1.5625e+03             2.3016e-06       -16.924487774362  <--
     6.2500e+02     6.2500e+03             5.7541e-07       -16.924487770348
     2.5000e+03     2.5000e+04             1.4385e-07       -16.924487766835

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 3.2336e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.099238e-01 1 1  ON 0
 uu_1                 1.439257e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912976e-02 1 1  ON 3
 uu_4                -6.434179e-02 1 1  ON 4
 uu_5                -9.781498e-02 1 1  ON 5
 uu_6                -1.245413e-01 1 1  ON 6
 uu_7                -1.382521e-01 1 1  ON 7
 uu_8                -1.322093e-01 1 1  ON 8
 uu_9                -1.023440e-01 1 1  ON 9
 ud_0                 4.379565e-01 1 1  ON 10
 ud_1                 1.721164e-01 1 1  ON 11
 ud_2                 5.291620e-02 1 1  ON 12
 ud_3                -1.595370e-02 1 1  ON 13
 ud_4                -6.968310e-02 1 1  ON 14
 ud_5                -1.062117e-01 1 1  ON 15
 ud_6                -1.287897e-01 1 1  ON 16
 ud_7                -1.415911e-01 1 1  ON 17
 ud_8                -1.400759e-01 1 1  ON 18
 ud_9                -1.324351e-01 1 1  ON 19
 eO_0                -7.694815e-01 1 1  ON 20
 eO_1                -4.483752e-01 1 1  ON 21
 eO_2                -2.578473e-02 1 1  ON 22
 eO_3                 2.984470e-01 1 1  ON 23
 eO_4                 5.315414e-01 1 1  ON 24
 eO_5                 4.915437e-01 1 1  ON 25
 eO_6                 2.578137e-01 1 1  ON 26
 eO_7                -4.672885e-02 1 1  ON 27
 eO_8                -2.137779e-01 1 1  ON 28
 eO_9                -7.492263e-02 1 1  ON 29
eH1_0                -2.362271e-01 1 1  ON 30
eH1_1                -1.382516e-01 1 1  ON 31
eH1_2                -9.374106e-02 1 1  ON 32
eH1_3                -3.895800e-02 1 1  ON 33
eH1_4                 5.481194e-03 1 1  ON 34
eH1_5                 3.926782e-02 1 1  ON 35
eH1_6                 9.464421e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673611e-01 1 1  ON 38
eH1_9                 5.527729e-02 1 1  ON 39
eH2_0                -2.328878e-01 1 1  ON 40
eH2_1                -1.350512e-01 1 1  ON 41
eH2_2                -9.054131e-02 1 1  ON 42
eH2_3                -3.560381e-02 1 1  ON 43
eH2_4                 8.502782e-03 1 1  ON 44
eH2_5                 4.201739e-02 1 1  ON 45
eH2_6                 9.785030e-02 1 1  ON 46
eH2_7                 1.512212e-01 1 1  ON 47
eH2_8                 1.724974e-01 1 1  ON 48
eH2_9                 3.961411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8596
    reference variance = 0.162621
====================================================
  Execution time = 2.1142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3371e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333730107544
                                         uncertainty =       0.002930990213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333730107544
                                         uncertainty =       0.002930990213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408481918
  error estimate for blocks of size 2^( 2) =       0.000421229281
  error estimate for blocks of size 2^( 3) =       0.000433847920
  error estimate for blocks of size 2^( 4) =       0.000445529040
  error estimate for blocks of size 2^( 5) =       0.000455439018
  error estimate for blocks of size 2^( 6) =       0.000463186249
  error estimate for blocks of size 2^( 7) =       0.000466559275

      target function =                  N/A
              le_mean =     -16.925671460111
             les_mean =     286.812069164015
             stat err =       0.000457678395
             autocorr =       1.255379840620
              std dev =       0.577680668937
             le_variance =       0.333714955263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692567146011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925671460111       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925671489038       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925671486281       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925671483151       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925671500726       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925671493661       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925671490425       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925671493345       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.514010e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925671460111       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925671467357       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925671466658       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925671465883       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925671470313       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925671468542       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925671467731       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925671468451       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.130722e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925671460111       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925671461923       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925671461748       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925671461555       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925671462664       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925671462221       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925671462018       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925671462198       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.328170e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6684e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.099245e-01 1 1  ON 0
 uu_1                 1.439268e-01 1 1  ON 1
 uu_2                 4.321079e-02 1 1  ON 2
 uu_3                -1.912997e-02 1 1  ON 3
 uu_4                -6.434190e-02 1 1  ON 4
 uu_5                -9.781605e-02 1 1  ON 5
 uu_6                -1.245416e-01 1 1  ON 6
 uu_7                -1.382525e-01 1 1  ON 7
 uu_8                -1.322101e-01 1 1  ON 8
 uu_9                -1.023448e-01 1 1  ON 9
 ud_0                 4.379544e-01 1 1  ON 10
 ud_1                 1.721147e-01 1 1  ON 11
 ud_2                 5.291558e-02 1 1  ON 12
 ud_3                -1.595411e-02 1 1  ON 13
 ud_4                -6.968305e-02 1 1  ON 14
 ud_5                -1.062115e-01 1 1  ON 15
 ud_6                -1.287892e-01 1 1  ON 16
 ud_7                -1.415900e-01 1 1  ON 17
 ud_8                -1.400746e-01 1 1  ON 18
 ud_9                -1.324340e-01 1 1  ON 19
 eO_0                -7.694829e-01 1 1  ON 20
 eO_1                -4.483759e-01 1 1  ON 21
 eO_2                -2.578607e-02 1 1  ON 22
 eO_3                 2.984464e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915458e-01 1 1  ON 25
 eO_6                 2.578155e-01 1 1  ON 26
 eO_7                -4.672822e-02 1 1  ON 27
 eO_8                -2.137788e-01 1 1  ON 28
 eO_9                -7.492333e-02 1 1  ON 29
eH1_0                -2.362262e-01 1 1  ON 30
eH1_1                -1.382515e-01 1 1  ON 31
eH1_2                -9.374211e-02 1 1  ON 32
eH1_3                -3.895835e-02 1 1  ON 33
eH1_4                 5.480678e-03 1 1  ON 34
eH1_5                 3.926672e-02 1 1  ON 35
eH1_6                 9.464409e-02 1 1  ON 36
eH1_7                 1.480301e-01 1 1  ON 37
eH1_8                 1.673621e-01 1 1  ON 38
eH1_9                 5.527832e-02 1 1  ON 39
eH2_0                -2.328878e-01 1 1  ON 40
eH2_1                -1.350507e-01 1 1  ON 41
eH2_2                -9.054168e-02 1 1  ON 42
eH2_3                -3.560443e-02 1 1  ON 43
eH2_4                 8.503050e-03 1 1  ON 44
eH2_5                 4.201658e-02 1 1  ON 45
eH2_6                 9.784897e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724983e-01 1 1  ON 48
eH2_9                 3.961575e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9862
    reference variance = 0.356193
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3928e-01
  Total weights = 2.0000e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339158639654
                                         uncertainty =       0.004288574761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339158639654
                                         uncertainty =       0.004288574761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411873292
  error estimate for blocks of size 2^( 2) =       0.000423843729
  error estimate for blocks of size 2^( 3) =       0.000436415571
  error estimate for blocks of size 2^( 4) =       0.000448718868
  error estimate for blocks of size 2^( 5) =       0.000459063208
  error estimate for blocks of size 2^( 6) =       0.000465292685
  error estimate for blocks of size 2^( 7) =       0.000472404665

      target function =                  N/A
              le_mean =     -16.925224667021
             les_mean =     286.802509076553
             stat err =       0.000461369857
             autocorr =       1.254790354809
              std dev =       0.582476795303
             le_variance =       0.339279217067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339156157813
                                         uncertainty =       0.004288547827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339156157813
                                         uncertainty =       0.004288547827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871787
  error estimate for blocks of size 2^( 2) =       0.000423842283
  error estimate for blocks of size 2^( 3) =       0.000436414151
  error estimate for blocks of size 2^( 4) =       0.000448717435
  error estimate for blocks of size 2^( 5) =       0.000459061719
  error estimate for blocks of size 2^( 6) =       0.000465291069
  error estimate for blocks of size 2^( 7) =       0.000472402714

      target function =                  N/A
              le_mean =     -16.925224625599
             les_mean =     286.802505195238
             stat err =       0.000461368234
             autocorr =       1.254790699909
              std dev =       0.582474667169
             le_variance =       0.339276737894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157393867
                                         uncertainty =       0.004288561214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157393867
                                         uncertainty =       0.004288561214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411872536
  error estimate for blocks of size 2^( 2) =       0.000423843004
  error estimate for blocks of size 2^( 3) =       0.000436414858
  error estimate for blocks of size 2^( 4) =       0.000448718149
  error estimate for blocks of size 2^( 5) =       0.000459062461
  error estimate for blocks of size 2^( 6) =       0.000465291874
  error estimate for blocks of size 2^( 7) =       0.000472403686

      target function =                  N/A
              le_mean =     -16.925224646131
             les_mean =     286.802507124992
             stat err =       0.000461369042
             autocorr =       1.254790528460
              std dev =       0.582475727067
             le_variance =       0.339277972622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339158483762
                                         uncertainty =       0.004288573065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339158483762
                                         uncertainty =       0.004288573065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411873197
  error estimate for blocks of size 2^( 2) =       0.000423843638
  error estimate for blocks of size 2^( 3) =       0.000436415482
  error estimate for blocks of size 2^( 4) =       0.000448718778
  error estimate for blocks of size 2^( 5) =       0.000459063115
  error estimate for blocks of size 2^( 6) =       0.000465292584
  error estimate for blocks of size 2^( 7) =       0.000472404543

      target function =                  N/A
              le_mean =     -16.925224664401
             les_mean =     286.802508832145
             stat err =       0.000461369755
             autocorr =       1.254790376537
              std dev =       0.582476661630
             le_variance =       0.339279061343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925224667021        initial  <--
     3.9062e+01     3.9062e+02             8.5140e-06       -16.925224625599
     1.5625e+02     1.5625e+03             2.1307e-06       -16.925224646131
     6.2500e+02     6.2500e+03             5.3282e-07       -16.925224664401

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9668
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.099238e-01 1 1  ON 0
 uu_1                 1.439257e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912976e-02 1 1  ON 3
 uu_4                -6.434179e-02 1 1  ON 4
 uu_5                -9.781498e-02 1 1  ON 5
 uu_6                -1.245413e-01 1 1  ON 6
 uu_7                -1.382521e-01 1 1  ON 7
 uu_8                -1.322093e-01 1 1  ON 8
 uu_9                -1.023440e-01 1 1  ON 9
 ud_0                 4.379565e-01 1 1  ON 10
 ud_1                 1.721164e-01 1 1  ON 11
 ud_2                 5.291620e-02 1 1  ON 12
 ud_3                -1.595370e-02 1 1  ON 13
 ud_4                -6.968310e-02 1 1  ON 14
 ud_5                -1.062117e-01 1 1  ON 15
 ud_6                -1.287897e-01 1 1  ON 16
 ud_7                -1.415911e-01 1 1  ON 17
 ud_8                -1.400759e-01 1 1  ON 18
 ud_9                -1.324351e-01 1 1  ON 19
 eO_0                -7.694815e-01 1 1  ON 20
 eO_1                -4.483752e-01 1 1  ON 21
 eO_2                -2.578473e-02 1 1  ON 22
 eO_3                 2.984470e-01 1 1  ON 23
 eO_4                 5.315414e-01 1 1  ON 24
 eO_5                 4.915437e-01 1 1  ON 25
 eO_6                 2.578137e-01 1 1  ON 26
 eO_7                -4.672885e-02 1 1  ON 27
 eO_8                -2.137779e-01 1 1  ON 28
 eO_9                -7.492263e-02 1 1  ON 29
eH1_0                -2.362271e-01 1 1  ON 30
eH1_1                -1.382516e-01 1 1  ON 31
eH1_2                -9.374106e-02 1 1  ON 32
eH1_3                -3.895800e-02 1 1  ON 33
eH1_4                 5.481194e-03 1 1  ON 34
eH1_5                 3.926782e-02 1 1  ON 35
eH1_6                 9.464421e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673611e-01 1 1  ON 38
eH1_9                 5.527729e-02 1 1  ON 39
eH2_0                -2.328878e-01 1 1  ON 40
eH2_1                -1.350512e-01 1 1  ON 41
eH2_2                -9.054131e-02 1 1  ON 42
eH2_3                -3.560381e-02 1 1  ON 43
eH2_4                 8.502782e-03 1 1  ON 44
eH2_5                 4.201739e-02 1 1  ON 45
eH2_6                 9.785030e-02 1 1  ON 46
eH2_7                 1.512212e-01 1 1  ON 47
eH2_8                 1.724974e-01 1 1  ON 48
eH2_9                 3.961411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.807
    reference variance = 0.872507
====================================================
  Execution time = 2.1088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3251e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332541703704
                                         uncertainty =       0.002411538775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332541703704
                                         uncertainty =       0.002411538775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742721
  error estimate for blocks of size 2^( 2) =       0.000420265671
  error estimate for blocks of size 2^( 3) =       0.000433552458
  error estimate for blocks of size 2^( 4) =       0.000445784859
  error estimate for blocks of size 2^( 5) =       0.000456333881
  error estimate for blocks of size 2^( 6) =       0.000462871582
  error estimate for blocks of size 2^( 7) =       0.000468299179

      target function =                  N/A
              le_mean =     -16.924350347279
             les_mean =     286.766142763844
             stat err =       0.000458322375
             autocorr =       1.263483826137
              std dev =       0.576635285648
             le_variance =       0.332508252654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692435034728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924350347279       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924350352538       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924350353991       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924350356089       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924350359514       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924350359474       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924350358920       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924350358702       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 9.028249e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924350347279       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924350348594       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924350348957       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924350349483       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924350350340       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924350350329       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924350350190       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924350350136       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.257852e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924350347279       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924350347608       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924350347699       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924350347830       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924350348044       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924350348045       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924350348010       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924350347991       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 5.645123e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6634e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.099239e-01 1 1  ON 0
 uu_1                 1.439259e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912978e-02 1 1  ON 3
 uu_4                -6.434178e-02 1 1  ON 4
 uu_5                -9.781503e-02 1 1  ON 5
 uu_6                -1.245413e-01 1 1  ON 6
 uu_7                -1.382521e-01 1 1  ON 7
 uu_8                -1.322094e-01 1 1  ON 8
 uu_9                -1.023441e-01 1 1  ON 9
 ud_0                 4.379563e-01 1 1  ON 10
 ud_1                 1.721163e-01 1 1  ON 11
 ud_2                 5.291613e-02 1 1  ON 12
 ud_3                -1.595380e-02 1 1  ON 13
 ud_4                -6.968302e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287897e-01 1 1  ON 16
 ud_7                -1.415910e-01 1 1  ON 17
 ud_8                -1.400758e-01 1 1  ON 18
 ud_9                -1.324350e-01 1 1  ON 19
 eO_0                -7.694816e-01 1 1  ON 20
 eO_1                -4.483754e-01 1 1  ON 21
 eO_2                -2.578480e-02 1 1  ON 22
 eO_3                 2.984469e-01 1 1  ON 23
 eO_4                 5.315416e-01 1 1  ON 24
 eO_5                 4.915438e-01 1 1  ON 25
 eO_6                 2.578139e-01 1 1  ON 26
 eO_7                -4.672878e-02 1 1  ON 27
 eO_8                -2.137780e-01 1 1  ON 28
 eO_9                -7.492271e-02 1 1  ON 29
eH1_0                -2.362270e-01 1 1  ON 30
eH1_1                -1.382517e-01 1 1  ON 31
eH1_2                -9.374115e-02 1 1  ON 32
eH1_3                -3.895800e-02 1 1  ON 33
eH1_4                 5.481129e-03 1 1  ON 34
eH1_5                 3.926773e-02 1 1  ON 35
eH1_6                 9.464411e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673613e-01 1 1  ON 38
eH1_9                 5.527742e-02 1 1  ON 39
eH2_0                -2.328877e-01 1 1  ON 40
eH2_1                -1.350511e-01 1 1  ON 41
eH2_2                -9.054140e-02 1 1  ON 42
eH2_3                -3.560384e-02 1 1  ON 43
eH2_4                 8.502690e-03 1 1  ON 44
eH2_5                 4.201735e-02 1 1  ON 45
eH2_6                 9.785029e-02 1 1  ON 46
eH2_7                 1.512211e-01 1 1  ON 47
eH2_8                 1.724975e-01 1 1  ON 48
eH2_9                 3.961424e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.7896
    reference variance = 0.422055
====================================================
  Execution time = 2.0724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4070e-01
  Total weights = 2.0000e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582945610
                                         uncertainty =       0.003249362576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582945610
                                         uncertainty =       0.003249362576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412733313
  error estimate for blocks of size 2^( 2) =       0.000425594095
  error estimate for blocks of size 2^( 3) =       0.000438338630
  error estimate for blocks of size 2^( 4) =       0.000449210000
  error estimate for blocks of size 2^( 5) =       0.000458261708
  error estimate for blocks of size 2^( 6) =       0.000466032768
  error estimate for blocks of size 2^( 7) =       0.000470171323

      target function =                  N/A
              le_mean =     -16.924436206752
             les_mean =     286.777238322168
             stat err =       0.000460918950
             autocorr =       1.247125269422
              std dev =       0.583693049564
             le_variance =       0.340697576110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582793386
                                         uncertainty =       0.003249365884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582793386
                                         uncertainty =       0.003249365884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412733221
  error estimate for blocks of size 2^( 2) =       0.000425594001
  error estimate for blocks of size 2^( 3) =       0.000438338530
  error estimate for blocks of size 2^( 4) =       0.000449209885
  error estimate for blocks of size 2^( 5) =       0.000458261581
  error estimate for blocks of size 2^( 6) =       0.000466032623
  error estimate for blocks of size 2^( 7) =       0.000470171173

      target function =                  N/A
              le_mean =     -16.924436207728
             les_mean =     286.777238203357
             stat err =       0.000460918815
             autocorr =       1.247125098534
              std dev =       0.583692919478
             le_variance =       0.340697424248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582869413
                                         uncertainty =       0.003249364230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582869413
                                         uncertainty =       0.003249364230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412733267
  error estimate for blocks of size 2^( 2) =       0.000425594048
  error estimate for blocks of size 2^( 3) =       0.000438338580
  error estimate for blocks of size 2^( 4) =       0.000449209942
  error estimate for blocks of size 2^( 5) =       0.000458261644
  error estimate for blocks of size 2^( 6) =       0.000466032696
  error estimate for blocks of size 2^( 7) =       0.000470171248

      target function =                  N/A
              le_mean =     -16.924436207239
             les_mean =     286.777238262642
             stat err =       0.000460918883
             autocorr =       1.247125183996
              std dev =       0.583692984449
             le_variance =       0.340697500095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582936082
                                         uncertainty =       0.003249362783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340582936082
                                         uncertainty =       0.003249362783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412733308
  error estimate for blocks of size 2^( 2) =       0.000425594089
  error estimate for blocks of size 2^( 3) =       0.000438338624
  error estimate for blocks of size 2^( 4) =       0.000449209992
  error estimate for blocks of size 2^( 5) =       0.000458261700
  error estimate for blocks of size 2^( 6) =       0.000466032759
  error estimate for blocks of size 2^( 7) =       0.000470171314

      target function =                  N/A
              le_mean =     -16.924436206812
             les_mean =     286.777238314721
             stat err =       0.000460918941
             autocorr =       1.247125258740
              std dev =       0.583693041422
             le_variance =       0.340697566605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924436206752        initial
     3.9062e+02     3.9062e+03             9.0282e-07       -16.924436207728  <--
     1.5625e+03     1.5625e+04             2.2579e-07       -16.924436207239
     6.2500e+03     6.2500e+04             5.6451e-08       -16.924436206812

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 3.0207e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.099242e-01 1 1  ON 0
 uu_1                 1.439264e-01 1 1  ON 1
 uu_2                 4.320998e-02 1 1  ON 2
 uu_3                -1.912984e-02 1 1  ON 3
 uu_4                -6.434175e-02 1 1  ON 4
 uu_5                -9.781519e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382521e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023445e-01 1 1  ON 9
 ud_0                 4.379556e-01 1 1  ON 10
 ud_1                 1.721161e-01 1 1  ON 11
 ud_2                 5.291591e-02 1 1  ON 12
 ud_3                -1.595410e-02 1 1  ON 13
 ud_4                -6.968277e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415906e-01 1 1  ON 17
 ud_8                -1.400756e-01 1 1  ON 18
 ud_9                -1.324347e-01 1 1  ON 19
 eO_0                -7.694821e-01 1 1  ON 20
 eO_1                -4.483758e-01 1 1  ON 21
 eO_2                -2.578504e-02 1 1  ON 22
 eO_3                 2.984466e-01 1 1  ON 23
 eO_4                 5.315422e-01 1 1  ON 24
 eO_5                 4.915443e-01 1 1  ON 25
 eO_6                 2.578145e-01 1 1  ON 26
 eO_7                -4.672855e-02 1 1  ON 27
 eO_8                -2.137782e-01 1 1  ON 28
 eO_9                -7.492296e-02 1 1  ON 29
eH1_0                -2.362266e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374141e-02 1 1  ON 32
eH1_3                -3.895798e-02 1 1  ON 33
eH1_4                 5.480933e-03 1 1  ON 34
eH1_5                 3.926747e-02 1 1  ON 35
eH1_6                 9.464382e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673616e-01 1 1  ON 38
eH1_9                 5.527780e-02 1 1  ON 39
eH2_0                -2.328875e-01 1 1  ON 40
eH2_1                -1.350510e-01 1 1  ON 41
eH2_2                -9.054166e-02 1 1  ON 42
eH2_3                -3.560391e-02 1 1  ON 43
eH2_4                 8.502414e-03 1 1  ON 44
eH2_5                 4.201720e-02 1 1  ON 45
eH2_6                 9.785026e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724976e-01 1 1  ON 48
eH2_9                 3.961460e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8551
    reference variance = 0.171356
====================================================
  Execution time = 2.3023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4034e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340288954227
                                         uncertainty =       0.004249098274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340288954227
                                         uncertainty =       0.004249098274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412518676
  error estimate for blocks of size 2^( 2) =       0.000424864619
  error estimate for blocks of size 2^( 3) =       0.000437356660
  error estimate for blocks of size 2^( 4) =       0.000448343493
  error estimate for blocks of size 2^( 5) =       0.000457076205
  error estimate for blocks of size 2^( 6) =       0.000465020375
  error estimate for blocks of size 2^( 7) =       0.000468504183

      target function =                  N/A
              le_mean =     -16.925181131572
             les_mean =     286.802099483060
             stat err =       0.000459736064
             autocorr =       1.242023791792
              std dev =       0.583389506865
             le_variance =       0.340343316720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692518113157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925181131572       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925181137054       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925181139653       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925181140906       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925181149152       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925181151714       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925181152786       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925181152000       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.344471e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925181131572       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925181132943       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925181133593       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925181133906       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925181135963       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925181136603       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925181136874       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925181136677       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 8.362338e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925181131572       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925181131915       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925181132077       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925181132155       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925181132670       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925181132827       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925181132898       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925181132847       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.090657e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8489e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.099246e-01 1 1  ON 0
 uu_1                 1.439268e-01 1 1  ON 1
 uu_2                 4.321029e-02 1 1  ON 2
 uu_3                -1.912979e-02 1 1  ON 3
 uu_4                -6.434203e-02 1 1  ON 4
 uu_5                -9.781529e-02 1 1  ON 5
 uu_6                -1.245414e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322101e-01 1 1  ON 8
 uu_9                -1.023449e-01 1 1  ON 9
 ud_0                 4.379549e-01 1 1  ON 10
 ud_1                 1.721155e-01 1 1  ON 11
 ud_2                 5.291565e-02 1 1  ON 12
 ud_3                -1.595415e-02 1 1  ON 13
 ud_4                -6.968273e-02 1 1  ON 14
 ud_5                -1.062114e-01 1 1  ON 15
 ud_6                -1.287891e-01 1 1  ON 16
 ud_7                -1.415901e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694825e-01 1 1  ON 20
 eO_1                -4.483764e-01 1 1  ON 21
 eO_2                -2.578569e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315429e-01 1 1  ON 24
 eO_5                 4.915452e-01 1 1  ON 25
 eO_6                 2.578152e-01 1 1  ON 26
 eO_7                -4.672821e-02 1 1  ON 27
 eO_8                -2.137786e-01 1 1  ON 28
 eO_9                -7.492334e-02 1 1  ON 29
eH1_0                -2.362262e-01 1 1  ON 30
eH1_1                -1.382521e-01 1 1  ON 31
eH1_2                -9.374154e-02 1 1  ON 32
eH1_3                -3.895797e-02 1 1  ON 33
eH1_4                 5.480642e-03 1 1  ON 34
eH1_5                 3.926714e-02 1 1  ON 35
eH1_6                 9.464352e-02 1 1  ON 36
eH1_7                 1.480303e-01 1 1  ON 37
eH1_8                 1.673620e-01 1 1  ON 38
eH1_9                 5.527808e-02 1 1  ON 39
eH2_0                -2.328872e-01 1 1  ON 40
eH2_1                -1.350508e-01 1 1  ON 41
eH2_2                -9.054186e-02 1 1  ON 42
eH2_3                -3.560384e-02 1 1  ON 43
eH2_4                 8.502042e-03 1 1  ON 44
eH2_5                 4.201698e-02 1 1  ON 45
eH2_6                 9.784988e-02 1 1  ON 46
eH2_7                 1.512208e-01 1 1  ON 47
eH2_8                 1.724979e-01 1 1  ON 48
eH2_9                 3.961508e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.352483
====================================================
  Execution time = 2.0678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690921462
                                         uncertainty =       0.005070535916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690921462
                                         uncertainty =       0.005070535916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414508284
  error estimate for blocks of size 2^( 2) =       0.000427582177
  error estimate for blocks of size 2^( 3) =       0.000440217600
  error estimate for blocks of size 2^( 4) =       0.000451970800
  error estimate for blocks of size 2^( 5) =       0.000461822156
  error estimate for blocks of size 2^( 6) =       0.000469936543
  error estimate for blocks of size 2^( 7) =       0.000472185850

      target function =                  N/A
              le_mean =     -16.925115546754
             les_mean =     286.803170334075
             stat err =       0.000463978837
             autocorr =       1.252938965441
              std dev =       0.586203236859
             le_variance =       0.343634234904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690269721
                                         uncertainty =       0.005070527233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690269721
                                         uncertainty =       0.005070527233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414507892
  error estimate for blocks of size 2^( 2) =       0.000427581787
  error estimate for blocks of size 2^( 3) =       0.000440217218
  error estimate for blocks of size 2^( 4) =       0.000451970405
  error estimate for blocks of size 2^( 5) =       0.000461821757
  error estimate for blocks of size 2^( 6) =       0.000469936094
  error estimate for blocks of size 2^( 7) =       0.000472185380

      target function =                  N/A
              le_mean =     -16.925115545557
             les_mean =     286.803169642978
             stat err =       0.000463978409
             autocorr =       1.252939024036
              std dev =       0.586202681967
             le_variance =       0.343633584345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690595957
                                         uncertainty =       0.005070531578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690595957
                                         uncertainty =       0.005070531578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414508088
  error estimate for blocks of size 2^( 2) =       0.000427581982
  error estimate for blocks of size 2^( 3) =       0.000440217409
  error estimate for blocks of size 2^( 4) =       0.000451970603
  error estimate for blocks of size 2^( 5) =       0.000461821956
  error estimate for blocks of size 2^( 6) =       0.000469936319
  error estimate for blocks of size 2^( 7) =       0.000472185615

      target function =                  N/A
              le_mean =     -16.925115546141
             les_mean =     286.803169988410
             stat err =       0.000463978623
             autocorr =       1.252938994261
              std dev =       0.586202959725
             le_variance =       0.343633909991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690880784
                                         uncertainty =       0.005070535374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343690880784
                                         uncertainty =       0.005070535374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414508259
  error estimate for blocks of size 2^( 2) =       0.000427582152
  error estimate for blocks of size 2^( 3) =       0.000440217576
  error estimate for blocks of size 2^( 4) =       0.000451970775
  error estimate for blocks of size 2^( 5) =       0.000461822131
  error estimate for blocks of size 2^( 6) =       0.000469936515
  error estimate for blocks of size 2^( 7) =       0.000472185821

      target function =                  N/A
              le_mean =     -16.925115546677
             les_mean =     286.803170290848
             stat err =       0.000463978810
             autocorr =       1.252938969030
              std dev =       0.586203202226
             le_variance =       0.343634194300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925115546754        initial  <--
     9.7656e+01     9.7656e+02             3.3445e-06       -16.925115545557
     3.9062e+02     3.9062e+03             8.3623e-07       -16.925115546141
     1.5625e+03     1.5625e+04             2.0907e-07       -16.925115546677

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2069
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.099242e-01 1 1  ON 0
 uu_1                 1.439264e-01 1 1  ON 1
 uu_2                 4.320998e-02 1 1  ON 2
 uu_3                -1.912984e-02 1 1  ON 3
 uu_4                -6.434175e-02 1 1  ON 4
 uu_5                -9.781519e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382521e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023445e-01 1 1  ON 9
 ud_0                 4.379556e-01 1 1  ON 10
 ud_1                 1.721161e-01 1 1  ON 11
 ud_2                 5.291591e-02 1 1  ON 12
 ud_3                -1.595410e-02 1 1  ON 13
 ud_4                -6.968277e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415906e-01 1 1  ON 17
 ud_8                -1.400756e-01 1 1  ON 18
 ud_9                -1.324347e-01 1 1  ON 19
 eO_0                -7.694821e-01 1 1  ON 20
 eO_1                -4.483758e-01 1 1  ON 21
 eO_2                -2.578504e-02 1 1  ON 22
 eO_3                 2.984466e-01 1 1  ON 23
 eO_4                 5.315422e-01 1 1  ON 24
 eO_5                 4.915443e-01 1 1  ON 25
 eO_6                 2.578145e-01 1 1  ON 26
 eO_7                -4.672855e-02 1 1  ON 27
 eO_8                -2.137782e-01 1 1  ON 28
 eO_9                -7.492296e-02 1 1  ON 29
eH1_0                -2.362266e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374141e-02 1 1  ON 32
eH1_3                -3.895798e-02 1 1  ON 33
eH1_4                 5.480933e-03 1 1  ON 34
eH1_5                 3.926747e-02 1 1  ON 35
eH1_6                 9.464382e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673616e-01 1 1  ON 38
eH1_9                 5.527780e-02 1 1  ON 39
eH2_0                -2.328875e-01 1 1  ON 40
eH2_1                -1.350510e-01 1 1  ON 41
eH2_2                -9.054166e-02 1 1  ON 42
eH2_3                -3.560391e-02 1 1  ON 43
eH2_4                 8.502414e-03 1 1  ON 44
eH2_5                 4.201720e-02 1 1  ON 45
eH2_6                 9.785026e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724976e-01 1 1  ON 48
eH2_9                 3.961460e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8812
    reference variance = 0.521941
====================================================
  Execution time = 2.1004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338736998378
                                         uncertainty =       0.004929588035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338736998378
                                         uncertainty =       0.004929588035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411600296
  error estimate for blocks of size 2^( 2) =       0.000424110671
  error estimate for blocks of size 2^( 3) =       0.000436596464
  error estimate for blocks of size 2^( 4) =       0.000448791547
  error estimate for blocks of size 2^( 5) =       0.000459424672
  error estimate for blocks of size 2^( 6) =       0.000467413559
  error estimate for blocks of size 2^( 7) =       0.000473106907

      target function =                  N/A
              le_mean =     -16.924745172436
             les_mean =     286.785828589879
             stat err =       0.000462184172
             autocorr =       1.260894584166
              std dev =       0.582090720932
             le_variance =       0.338829607395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692474517244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924745172436       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924745173774       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924745173984       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924745175257       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924745175757       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924745175960       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924745175808       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924745176037       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924745176085       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.528778e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924745172436       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924745172771       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924745172823       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924745173141       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924745173266       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924745173311       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924745173279       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924745173329       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924745173341       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 8.821997e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924745172436       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924745172520       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924745172533       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924745172605       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924745172655       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924745172662       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924745172634       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924745172662       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924745172639       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.205502e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6523e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.099243e-01 1 1  ON 0
 uu_1                 1.439264e-01 1 1  ON 1
 uu_2                 4.320998e-02 1 1  ON 2
 uu_3                -1.912984e-02 1 1  ON 3
 uu_4                -6.434177e-02 1 1  ON 4
 uu_5                -9.781521e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023445e-01 1 1  ON 9
 ud_0                 4.379555e-01 1 1  ON 10
 ud_1                 1.721160e-01 1 1  ON 11
 ud_2                 5.291587e-02 1 1  ON 12
 ud_3                -1.595413e-02 1 1  ON 13
 ud_4                -6.968278e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415906e-01 1 1  ON 17
 ud_8                -1.400755e-01 1 1  ON 18
 ud_9                -1.324347e-01 1 1  ON 19
 eO_0                -7.694821e-01 1 1  ON 20
 eO_1                -4.483759e-01 1 1  ON 21
 eO_2                -2.578509e-02 1 1  ON 22
 eO_3                 2.984466e-01 1 1  ON 23
 eO_4                 5.315423e-01 1 1  ON 24
 eO_5                 4.915444e-01 1 1  ON 25
 eO_6                 2.578146e-01 1 1  ON 26
 eO_7                -4.672851e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492299e-02 1 1  ON 29
eH1_0                -2.362266e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374142e-02 1 1  ON 32
eH1_3                -3.895801e-02 1 1  ON 33
eH1_4                 5.480899e-03 1 1  ON 34
eH1_5                 3.926746e-02 1 1  ON 35
eH1_6                 9.464379e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673617e-01 1 1  ON 38
eH1_9                 5.527784e-02 1 1  ON 39
eH2_0                -2.328875e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054166e-02 1 1  ON 42
eH2_3                -3.560393e-02 1 1  ON 43
eH2_4                 8.502378e-03 1 1  ON 44
eH2_5                 4.201716e-02 1 1  ON 45
eH2_6                 9.785019e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724976e-01 1 1  ON 48
eH2_9                 3.961466e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8919
    reference variance = 0.18071
====================================================
  Execution time = 2.0740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.5438e-01
  Total weights = 2.0000e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413692139
                                         uncertainty =       0.015988600142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413692139
                                         uncertainty =       0.015988600142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420937549
  error estimate for blocks of size 2^( 2) =       0.000432936829
  error estimate for blocks of size 2^( 3) =       0.000445751073
  error estimate for blocks of size 2^( 4) =       0.000457138641
  error estimate for blocks of size 2^( 5) =       0.000467069634
  error estimate for blocks of size 2^( 6) =       0.000472042831
  error estimate for blocks of size 2^( 7) =       0.000476030298

      target function =                  N/A
              le_mean =     -16.924851071746
             les_mean =     286.804960463214
             stat err =       0.000468070351
             autocorr =       1.236479525606
              std dev =       0.595295590111
             le_variance =       0.354376839606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413666335
                                         uncertainty =       0.015988599851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413666335
                                         uncertainty =       0.015988599851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420937533
  error estimate for blocks of size 2^( 2) =       0.000432936816
  error estimate for blocks of size 2^( 3) =       0.000445751060
  error estimate for blocks of size 2^( 4) =       0.000457138628
  error estimate for blocks of size 2^( 5) =       0.000467069618
  error estimate for blocks of size 2^( 6) =       0.000472042814
  error estimate for blocks of size 2^( 7) =       0.000476030276

      target function =                  N/A
              le_mean =     -16.924851072984
             les_mean =     286.804960479195
             stat err =       0.000468070334
             autocorr =       1.236479526977
              std dev =       0.595295568353
             le_variance =       0.354376813701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413679242
                                         uncertainty =       0.015988599997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413679242
                                         uncertainty =       0.015988599997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420937541
  error estimate for blocks of size 2^( 2) =       0.000432936822
  error estimate for blocks of size 2^( 3) =       0.000445751067
  error estimate for blocks of size 2^( 4) =       0.000457138634
  error estimate for blocks of size 2^( 5) =       0.000467069626
  error estimate for blocks of size 2^( 6) =       0.000472042823
  error estimate for blocks of size 2^( 7) =       0.000476030287

      target function =                  N/A
              le_mean =     -16.924851072365
             les_mean =     286.804960471212
             stat err =       0.000468070342
             autocorr =       1.236479526279
              std dev =       0.595295579236
             le_variance =       0.354376826658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413690527
                                         uncertainty =       0.015988600124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354413690527
                                         uncertainty =       0.015988600124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420937548
  error estimate for blocks of size 2^( 2) =       0.000432936828
  error estimate for blocks of size 2^( 3) =       0.000445751072
  error estimate for blocks of size 2^( 4) =       0.000457138640
  error estimate for blocks of size 2^( 5) =       0.000467069633
  error estimate for blocks of size 2^( 6) =       0.000472042830
  error estimate for blocks of size 2^( 7) =       0.000476030296

      target function =                  N/A
              le_mean =     -16.924851071824
             les_mean =     286.804960464213
             stat err =       0.000468070350
             autocorr =       1.236479525693
              std dev =       0.595295588752
             le_variance =       0.354376837988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924851071746        initial
     9.7656e+02     9.7656e+03             3.5288e-07       -16.924851072984  <--
     3.9062e+03     3.9062e+04             8.8220e-08       -16.924851072365
     1.5625e+04     1.5625e+05             2.2055e-08       -16.924851071824

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 3.0289e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672841e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492308e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9695
    reference variance = 0.267798
====================================================
  Execution time = 2.0778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676972622
                                         uncertainty =       0.002792889319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336676972622
                                         uncertainty =       0.002792889319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410344558
  error estimate for blocks of size 2^( 2) =       0.000422905714
  error estimate for blocks of size 2^( 3) =       0.000435817460
  error estimate for blocks of size 2^( 4) =       0.000446908033
  error estimate for blocks of size 2^( 5) =       0.000456508969
  error estimate for blocks of size 2^( 6) =       0.000463857411
  error estimate for blocks of size 2^( 7) =       0.000466212540

      target function =                  N/A
              le_mean =     -16.924304353116
             les_mean =     286.768842980896
             stat err =       0.000458371738
             autocorr =       1.247780830577
              std dev =       0.580314839023
             le_variance =       0.336765312390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692430435312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924304353116       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924304360544       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924304360712       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924304360382       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924304362961       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924304361285       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924304363346       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924304362609       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.544501e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924304353116       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924304354973       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924304355015       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924304354933       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924304355576       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924304355156       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924304355673       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924304355487       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.864612e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924304353116       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924304353580       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924304353591       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924304353570       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924304353733       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924304353627       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924304353757       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924304353707       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 9.663633e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6295e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.099245e-01 1 1  ON 0
 uu_1                 1.439267e-01 1 1  ON 1
 uu_2                 4.321010e-02 1 1  ON 2
 uu_3                -1.912983e-02 1 1  ON 3
 uu_4                -6.434196e-02 1 1  ON 4
 uu_5                -9.781520e-02 1 1  ON 5
 uu_6                -1.245417e-01 1 1  ON 6
 uu_7                -1.382524e-01 1 1  ON 7
 uu_8                -1.322098e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379550e-01 1 1  ON 10
 ud_1                 1.721154e-01 1 1  ON 11
 ud_2                 5.291565e-02 1 1  ON 12
 ud_3                -1.595427e-02 1 1  ON 13
 ud_4                -6.968290e-02 1 1  ON 14
 ud_5                -1.062115e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415901e-01 1 1  ON 17
 ud_8                -1.400750e-01 1 1  ON 18
 ud_9                -1.324343e-01 1 1  ON 19
 eO_0                -7.694825e-01 1 1  ON 20
 eO_1                -4.483761e-01 1 1  ON 21
 eO_2                -2.578560e-02 1 1  ON 22
 eO_3                 2.984464e-01 1 1  ON 23
 eO_4                 5.315427e-01 1 1  ON 24
 eO_5                 4.915450e-01 1 1  ON 25
 eO_6                 2.578150e-01 1 1  ON 26
 eO_7                -4.672827e-02 1 1  ON 27
 eO_8                -2.137784e-01 1 1  ON 28
 eO_9                -7.492319e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382519e-01 1 1  ON 31
eH1_2                -9.374168e-02 1 1  ON 32
eH1_3                -3.895810e-02 1 1  ON 33
eH1_4                 5.480748e-03 1 1  ON 34
eH1_5                 3.926740e-02 1 1  ON 35
eH1_6                 9.464365e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673620e-01 1 1  ON 38
eH1_9                 5.527817e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054175e-02 1 1  ON 42
eH2_3                -3.560403e-02 1 1  ON 43
eH2_4                 8.502207e-03 1 1  ON 44
eH2_5                 4.201697e-02 1 1  ON 45
eH2_6                 9.785001e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961502e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.214206
====================================================
  Execution time = 2.0776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4367e-01
  Total weights = 2.0000e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693318832
                                         uncertainty =       0.003564189037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693318832
                                         uncertainty =       0.003564189037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414527951
  error estimate for blocks of size 2^( 2) =       0.000426656182
  error estimate for blocks of size 2^( 3) =       0.000439153773
  error estimate for blocks of size 2^( 4) =       0.000450510662
  error estimate for blocks of size 2^( 5) =       0.000459528335
  error estimate for blocks of size 2^( 6) =       0.000466589000
  error estimate for blocks of size 2^( 7) =       0.000470792602

      target function =                  N/A
              le_mean =     -16.924784161309
             les_mean =     286.791985579536
             stat err =       0.000461855150
             autocorr =       1.241377705475
              std dev =       0.586231050416
             le_variance =       0.343666844472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693240752
                                         uncertainty =       0.003564184577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693240752
                                         uncertainty =       0.003564184577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414527904
  error estimate for blocks of size 2^( 2) =       0.000426656138
  error estimate for blocks of size 2^( 3) =       0.000439153724
  error estimate for blocks of size 2^( 4) =       0.000450510592
  error estimate for blocks of size 2^( 5) =       0.000459528255
  error estimate for blocks of size 2^( 6) =       0.000466588912
  error estimate for blocks of size 2^( 7) =       0.000470792534

      target function =                  N/A
              le_mean =     -16.924784158686
             les_mean =     286.791985413034
             stat err =       0.000461855073
             autocorr =       1.241377575829
              std dev =       0.586230984135
             le_variance =       0.343666766759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693280051
                                         uncertainty =       0.003564186808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693280051
                                         uncertainty =       0.003564186808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414527928
  error estimate for blocks of size 2^( 2) =       0.000426656161
  error estimate for blocks of size 2^( 3) =       0.000439153749
  error estimate for blocks of size 2^( 4) =       0.000450510627
  error estimate for blocks of size 2^( 5) =       0.000459528295
  error estimate for blocks of size 2^( 6) =       0.000466588956
  error estimate for blocks of size 2^( 7) =       0.000470792568

      target function =                  N/A
              le_mean =     -16.924784159999
             les_mean =     286.791985496604
             stat err =       0.000461855112
             autocorr =       1.241377640430
              std dev =       0.586231017496
             le_variance =       0.343666805874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693313992
                                         uncertainty =       0.003564188758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343693313992
                                         uncertainty =       0.003564188758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414527948
  error estimate for blocks of size 2^( 2) =       0.000426656180
  error estimate for blocks of size 2^( 3) =       0.000439153770
  error estimate for blocks of size 2^( 4) =       0.000450510658
  error estimate for blocks of size 2^( 5) =       0.000459528330
  error estimate for blocks of size 2^( 6) =       0.000466588995
  error estimate for blocks of size 2^( 7) =       0.000470792598

      target function =                  N/A
              le_mean =     -16.924784161145
             les_mean =     286.791985569174
             stat err =       0.000461855145
             autocorr =       1.241377697332
              std dev =       0.586231046307
             le_variance =       0.343666839654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924784161309        initial  <--
     2.4414e+02     2.4414e+03             1.5445e-06       -16.924784158686
     9.7656e+02     9.7656e+03             3.8646e-07       -16.924784159999
     3.9062e+03     3.9062e+04             9.6636e-08       -16.924784161145

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.3175
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672841e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492308e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.819
    reference variance = 0.307672
====================================================
  Execution time = 2.1140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4093e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340967085426
                                         uncertainty =       0.004492779114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340967085426
                                         uncertainty =       0.004492779114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412872208
  error estimate for blocks of size 2^( 2) =       0.000425380403
  error estimate for blocks of size 2^( 3) =       0.000438011611
  error estimate for blocks of size 2^( 4) =       0.000448514913
  error estimate for blocks of size 2^( 5) =       0.000458018040
  error estimate for blocks of size 2^( 6) =       0.000465070558
  error estimate for blocks of size 2^( 7) =       0.000469910016

      target function =                  N/A
              le_mean =     -16.925774459716
             les_mean =     286.822767811687
             stat err =       0.000460378382
             autocorr =       1.243364727872
              std dev =       0.583889476681
             le_variance =       0.340926920979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692577445972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925774459716       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925774460266       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925774460343       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925774460577       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925774460829       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925774460808       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925774460796       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925774460757       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.367116e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925774459716       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925774459853       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925774459873       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925774459931       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925774459999       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925774459992       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925774459986       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925774459978       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 3.417794e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925774459716       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925774459750       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925774459755       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925774459769       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925774459773       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925774459779       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925774459767       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925774459771       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 8.544486e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6685e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291574e-02 1 1  ON 12
 ud_3                -1.595422e-02 1 1  ON 13
 ud_4                -6.968281e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578528e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492310e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374145e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480788e-03 1 1  ON 34
eH1_5                 3.926743e-02 1 1  ON 35
eH1_6                 9.464371e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527799e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054164e-02 1 1  ON 42
eH2_3                -3.560399e-02 1 1  ON 43
eH2_4                 8.502253e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784997e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961485e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.244605
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3823e-01
  Total weights = 2.0000e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277064530
                                         uncertainty =       0.003425058503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277064530
                                         uncertainty =       0.003425058503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411233642
  error estimate for blocks of size 2^( 2) =       0.000423501550
  error estimate for blocks of size 2^( 3) =       0.000435512159
  error estimate for blocks of size 2^( 4) =       0.000446493135
  error estimate for blocks of size 2^( 5) =       0.000453613417
  error estimate for blocks of size 2^( 6) =       0.000458532284
  error estimate for blocks of size 2^( 7) =       0.000463940399

      target function =                  N/A
              le_mean =     -16.924868971228
             les_mean =     286.789415740325
             stat err =       0.000455644809
             autocorr =       1.227652865867
              std dev =       0.581572193458
             le_variance =       0.338226216203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277068614
                                         uncertainty =       0.003425057950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277068614
                                         uncertainty =       0.003425057950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411233644
  error estimate for blocks of size 2^( 2) =       0.000423501552
  error estimate for blocks of size 2^( 3) =       0.000435512159
  error estimate for blocks of size 2^( 4) =       0.000446493135
  error estimate for blocks of size 2^( 5) =       0.000453613416
  error estimate for blocks of size 2^( 6) =       0.000458532280
  error estimate for blocks of size 2^( 7) =       0.000463940396

      target function =                  N/A
              le_mean =     -16.924868971045
             les_mean =     286.789415738234
             stat err =       0.000455644807
             autocorr =       1.227652839706
              std dev =       0.581572196981
             le_variance =       0.338226220301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277066574
                                         uncertainty =       0.003425058227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277066574
                                         uncertainty =       0.003425058227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411233643
  error estimate for blocks of size 2^( 2) =       0.000423501551
  error estimate for blocks of size 2^( 3) =       0.000435512159
  error estimate for blocks of size 2^( 4) =       0.000446493135
  error estimate for blocks of size 2^( 5) =       0.000453613417
  error estimate for blocks of size 2^( 6) =       0.000458532282
  error estimate for blocks of size 2^( 7) =       0.000463940398

      target function =                  N/A
              le_mean =     -16.924868971137
             les_mean =     286.789415739281
             stat err =       0.000455644808
             autocorr =       1.227652852790
              std dev =       0.581572195221
             le_variance =       0.338226218254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277064786
                                         uncertainty =       0.003425058468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338277064786
                                         uncertainty =       0.003425058468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411233642
  error estimate for blocks of size 2^( 2) =       0.000423501551
  error estimate for blocks of size 2^( 3) =       0.000435512159
  error estimate for blocks of size 2^( 4) =       0.000446493135
  error estimate for blocks of size 2^( 5) =       0.000453613417
  error estimate for blocks of size 2^( 6) =       0.000458532283
  error estimate for blocks of size 2^( 7) =       0.000463940399

      target function =                  N/A
              le_mean =     -16.924868971217
             les_mean =     286.789415740195
             stat err =       0.000455644809
             autocorr =       1.227652864236
              std dev =       0.581572193678
             le_variance =       0.338226216460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924868971228        initial  <--
     2.4414e+03     2.4414e+04             1.3671e-07       -16.924868971045
     9.7656e+03     9.7656e+04             3.4178e-08       -16.924868971137
     3.9062e+04     3.9062e+05             8.5445e-09       -16.924868971217

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0926
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672841e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492308e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.54979
====================================================
  Execution time = 2.0959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3862e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338533963446
                                         uncertainty =       0.004502453676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338533963446
                                         uncertainty =       0.004502453676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411470316
  error estimate for blocks of size 2^( 2) =       0.000424094237
  error estimate for blocks of size 2^( 3) =       0.000436435188
  error estimate for blocks of size 2^( 4) =       0.000447599026
  error estimate for blocks of size 2^( 5) =       0.000457147401
  error estimate for blocks of size 2^( 6) =       0.000464042653
  error estimate for blocks of size 2^( 7) =       0.000466924284

      target function =                  N/A
              le_mean =     -16.924090453257
             les_mean =     286.763453141987
             stat err =       0.000458928341
             autocorr =       1.243978107047
              std dev =       0.581906900854
             le_variance =       0.338615641262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692409045326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924090453257       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924090453332       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924090453341       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924090453382       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924090453408       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924090453398       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924090453403       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924090453410       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.432355e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924090453257       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924090453276       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924090453278       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924090453288       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924090453276       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924090453297       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924090453347       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924090453223       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.580889e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924090453257       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924090453262       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924090453262       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924090453265       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924090453266       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924090453266       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924090453259       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924090453172       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 8.952223e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6467e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.323253
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.0000e+06
  Execution time = 1.8838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504508447
                                         uncertainty =       0.003608294461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504508447
                                         uncertainty =       0.003608294461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558965
  error estimate for blocks of size 2^( 2) =       0.000421958698
  error estimate for blocks of size 2^( 3) =       0.000434728711
  error estimate for blocks of size 2^( 4) =       0.000446812256
  error estimate for blocks of size 2^( 5) =       0.000456917787
  error estimate for blocks of size 2^( 6) =       0.000465109442
  error estimate for blocks of size 2^( 7) =       0.000468224375

      target function =                  N/A
              le_mean =     -16.924554933128
             les_mean =     286.776036607860
             stat err =       0.000459265965
             autocorr =       1.257464261801
              std dev =       0.579203842471
             le_variance =       0.335477091133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504513156
                                         uncertainty =       0.003608294544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504513156
                                         uncertainty =       0.003608294544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558968
  error estimate for blocks of size 2^( 2) =       0.000421958701
  error estimate for blocks of size 2^( 3) =       0.000434728713
  error estimate for blocks of size 2^( 4) =       0.000446812258
  error estimate for blocks of size 2^( 5) =       0.000456917789
  error estimate for blocks of size 2^( 6) =       0.000465109444
  error estimate for blocks of size 2^( 7) =       0.000468224376

      target function =                  N/A
              le_mean =     -16.924554933105
             les_mean =     286.776036611803
             stat err =       0.000459265967
             autocorr =       1.257464255399
              std dev =       0.579203846536
             le_variance =       0.335477095843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504510802
                                         uncertainty =       0.003608294503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504510802
                                         uncertainty =       0.003608294503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558966
  error estimate for blocks of size 2^( 2) =       0.000421958699
  error estimate for blocks of size 2^( 3) =       0.000434728712
  error estimate for blocks of size 2^( 4) =       0.000446812257
  error estimate for blocks of size 2^( 5) =       0.000456917788
  error estimate for blocks of size 2^( 6) =       0.000465109443
  error estimate for blocks of size 2^( 7) =       0.000468224375

      target function =                  N/A
              le_mean =     -16.924554933117
             les_mean =     286.776036609831
             stat err =       0.000459265966
             autocorr =       1.257464258595
              std dev =       0.579203844504
             le_variance =       0.335477093488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504508742
                                         uncertainty =       0.003608294466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504508742
                                         uncertainty =       0.003608294466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409558965
  error estimate for blocks of size 2^( 2) =       0.000421958698
  error estimate for blocks of size 2^( 3) =       0.000434728711
  error estimate for blocks of size 2^( 4) =       0.000446812256
  error estimate for blocks of size 2^( 5) =       0.000456917787
  error estimate for blocks of size 2^( 6) =       0.000465109442
  error estimate for blocks of size 2^( 7) =       0.000468224375

      target function =                  N/A
              le_mean =     -16.924554933127
             les_mean =     286.776036608106
             stat err =       0.000459265965
             autocorr =       1.257464261398
              std dev =       0.579203842725
             le_variance =       0.335477091427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924554933128        initial  <--
     2.4414e+04     2.4414e+05             1.4324e-08       -16.924554933105
     9.7656e+04     9.7656e+05             3.5809e-09       -16.924554933117
     3.9062e+05     3.9062e+06             8.9522e-10       -16.924554933127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0592
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672841e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492308e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8284
    reference variance = 0.545787
====================================================
  Execution time = 2.1215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4049e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340577706256
                                         uncertainty =       0.004006316659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340577706256
                                         uncertainty =       0.004006316659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412607655
  error estimate for blocks of size 2^( 2) =       0.000425286272
  error estimate for blocks of size 2^( 3) =       0.000438121105
  error estimate for blocks of size 2^( 4) =       0.000450258925
  error estimate for blocks of size 2^( 5) =       0.000460386266
  error estimate for blocks of size 2^( 6) =       0.000467586878
  error estimate for blocks of size 2^( 7) =       0.000470370550

      target function =                  N/A
              le_mean =     -16.923975873215
             les_mean =     286.761449341156
             stat err =       0.000462150655
             autocorr =       1.254563311750
              std dev =       0.583515341897
             le_variance =       0.340490154229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692397587322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923975873215       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923975873222       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923975873224       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923975873225       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923975873291       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923975873181       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923975873284       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923975873219       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.446890e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923975873215       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923975873217       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923975873217       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923975873218       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923975873624       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923975871671       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923975873541       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923975873751       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.617221e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.923975873215       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.923975873216       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.923975873216       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.923975873216       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.923975873841       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.923975873882       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.923975872626       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.923975872741       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 9.043075e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8782e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672841e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492308e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9778
    reference variance = 0.390508
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5387e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169631
                                         uncertainty =       0.011370694723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169631
                                         uncertainty =       0.011370694723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420637892
  error estimate for blocks of size 2^( 2) =       0.000433333258
  error estimate for blocks of size 2^( 3) =       0.000446483990
  error estimate for blocks of size 2^( 4) =       0.000458423254
  error estimate for blocks of size 2^( 5) =       0.000468349801
  error estimate for blocks of size 2^( 6) =       0.000477368994
  error estimate for blocks of size 2^( 7) =       0.000482410462

      target function =                  N/A
              le_mean =     -16.924427436389
             les_mean =     286.790116345555
             stat err =       0.000471638128
             autocorr =       1.257190318860
              std dev =       0.594871812148
             le_variance =       0.353872472888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169750
                                         uncertainty =       0.011370694742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169750
                                         uncertainty =       0.011370694742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420637892
  error estimate for blocks of size 2^( 2) =       0.000433333258
  error estimate for blocks of size 2^( 3) =       0.000446483990
  error estimate for blocks of size 2^( 4) =       0.000458423254
  error estimate for blocks of size 2^( 5) =       0.000468349801
  error estimate for blocks of size 2^( 6) =       0.000477368994
  error estimate for blocks of size 2^( 7) =       0.000482410462

      target function =                  N/A
              le_mean =     -16.924427436390
             les_mean =     286.790116345702
             stat err =       0.000471638128
             autocorr =       1.257190318659
              std dev =       0.594871812248
             le_variance =       0.353872473007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169691
                                         uncertainty =       0.011370694732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169691
                                         uncertainty =       0.011370694732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420637892
  error estimate for blocks of size 2^( 2) =       0.000433333258
  error estimate for blocks of size 2^( 3) =       0.000446483990
  error estimate for blocks of size 2^( 4) =       0.000458423254
  error estimate for blocks of size 2^( 5) =       0.000468349801
  error estimate for blocks of size 2^( 6) =       0.000477368994
  error estimate for blocks of size 2^( 7) =       0.000482410462

      target function =                  N/A
              le_mean =     -16.924427436390
             les_mean =     286.790116345629
             stat err =       0.000471638128
             autocorr =       1.257190318762
              std dev =       0.594871812198
             le_variance =       0.353872472948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169639
                                         uncertainty =       0.011370694724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353962169639
                                         uncertainty =       0.011370694724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420637892
  error estimate for blocks of size 2^( 2) =       0.000433333258
  error estimate for blocks of size 2^( 3) =       0.000446483990
  error estimate for blocks of size 2^( 4) =       0.000458423254
  error estimate for blocks of size 2^( 5) =       0.000468349801
  error estimate for blocks of size 2^( 6) =       0.000477368994
  error estimate for blocks of size 2^( 7) =       0.000482410462

      target function =                  N/A
              le_mean =     -16.924427436389
             les_mean =     286.790116345564
             stat err =       0.000471638128
             autocorr =       1.257190318842
              std dev =       0.594871812154
             le_variance =       0.353872472896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924427436389        initial
     2.4414e+05     2.4414e+06             1.4469e-09       -16.924427436390  <--
     9.7656e+05     9.7656e+06             3.6172e-10       -16.924427436390
     3.9062e+06     3.9062e+07             9.0431e-11       -16.924427436389

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 3.0115e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8365
    reference variance = 0.221951
====================================================
  Execution time = 2.1548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334649176275
                                         uncertainty =       0.002864589098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334649176275
                                         uncertainty =       0.002864589098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409095365
  error estimate for blocks of size 2^( 2) =       0.000421162891
  error estimate for blocks of size 2^( 3) =       0.000433132093
  error estimate for blocks of size 2^( 4) =       0.000444013743
  error estimate for blocks of size 2^( 5) =       0.000454314988
  error estimate for blocks of size 2^( 6) =       0.000461174807
  error estimate for blocks of size 2^( 7) =       0.000466393165

      target function =                  N/A
              le_mean =     -16.924202390118
             les_mean =     286.763344410065
             stat err =       0.000456474176
             autocorr =       1.245040009319
              std dev =       0.578548213849
             le_variance =       0.334718035748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692420239012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924202390118       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924202390128       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924202390127       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924202390115       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924202390127       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924202390174       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924202390436       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924202390185       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.282547e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924202390118       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924202390121       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924202390120       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924202390118       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924202390125       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924202390059       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924202390035       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924202390255       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.320644e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924202390118       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924202390119       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924202390119       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924202390075       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924202390141       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924202390029       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924202390046       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924202390305       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.301612e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7025e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781526e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480796e-03 1 1  ON 34
eH1_5                 3.926745e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201704e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9778
    reference variance = 0.308392
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4058e-01
  Total weights = 2.0000e+06
  Execution time = 1.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545531714
                                         uncertainty =       0.004285620954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545531714
                                         uncertainty =       0.004285620954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412659609
  error estimate for blocks of size 2^( 2) =       0.000425186293
  error estimate for blocks of size 2^( 3) =       0.000437122684
  error estimate for blocks of size 2^( 4) =       0.000448749361
  error estimate for blocks of size 2^( 5) =       0.000456845226
  error estimate for blocks of size 2^( 6) =       0.000462384234
  error estimate for blocks of size 2^( 7) =       0.000467235579

      target function =                  N/A
              le_mean =     -16.925611076055
             les_mean =     286.816886033424
             stat err =       0.000458803600
             autocorr =       1.236145833635
              std dev =       0.583588815716
             le_variance =       0.340575905829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545532814
                                         uncertainty =       0.004285621024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545532814
                                         uncertainty =       0.004285621024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412659610
  error estimate for blocks of size 2^( 2) =       0.000425186293
  error estimate for blocks of size 2^( 3) =       0.000437122685
  error estimate for blocks of size 2^( 4) =       0.000448749362
  error estimate for blocks of size 2^( 5) =       0.000456845227
  error estimate for blocks of size 2^( 6) =       0.000462384235
  error estimate for blocks of size 2^( 7) =       0.000467235579

      target function =                  N/A
              le_mean =     -16.925611076057
             les_mean =     286.816886034571
             stat err =       0.000458803601
             autocorr =       1.236145832474
              std dev =       0.583588816658
             le_variance =       0.340575906928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545532264
                                         uncertainty =       0.004285620989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545532264
                                         uncertainty =       0.004285620989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412659609
  error estimate for blocks of size 2^( 2) =       0.000425186293
  error estimate for blocks of size 2^( 3) =       0.000437122684
  error estimate for blocks of size 2^( 4) =       0.000448749362
  error estimate for blocks of size 2^( 5) =       0.000456845226
  error estimate for blocks of size 2^( 6) =       0.000462384235
  error estimate for blocks of size 2^( 7) =       0.000467235579

      target function =                  N/A
              le_mean =     -16.925611076056
             les_mean =     286.816886033997
             stat err =       0.000458803600
             autocorr =       1.236145833055
              std dev =       0.583588816187
             le_variance =       0.340575906378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545531782
                                         uncertainty =       0.004285620959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340545531782
                                         uncertainty =       0.004285620959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412659609
  error estimate for blocks of size 2^( 2) =       0.000425186293
  error estimate for blocks of size 2^( 3) =       0.000437122684
  error estimate for blocks of size 2^( 4) =       0.000448749362
  error estimate for blocks of size 2^( 5) =       0.000456845226
  error estimate for blocks of size 2^( 6) =       0.000462384234
  error estimate for blocks of size 2^( 7) =       0.000467235579

      target function =                  N/A
              le_mean =     -16.925611076055
             les_mean =     286.816886033496
             stat err =       0.000458803600
             autocorr =       1.236145833569
              std dev =       0.583588815775
             le_variance =       0.340575905898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925611076055        initial
     6.1035e+04     6.1035e+05             5.2825e-09       -16.925611076057  <--
     2.4414e+05     2.4414e+06             1.3206e-09       -16.925611076056
     9.7656e+05     9.7656e+06             3.3016e-10       -16.925611076055

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 3.0254e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7289e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.7856
    reference variance = 1.29703
====================================================
  Execution time = 2.0763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4256e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342302625186
                                         uncertainty =       0.003942427795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342302625186
                                         uncertainty =       0.003942427795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413861164
  error estimate for blocks of size 2^( 2) =       0.000426528258
  error estimate for blocks of size 2^( 3) =       0.000439890787
  error estimate for blocks of size 2^( 4) =       0.000452957759
  error estimate for blocks of size 2^( 5) =       0.000464359114
  error estimate for blocks of size 2^( 6) =       0.000473343696
  error estimate for blocks of size 2^( 7) =       0.000478895748

      target function =                  N/A
              le_mean =     -16.925243606177
             les_mean =     286.806433083026
             stat err =       0.000467389079
             autocorr =       1.275403989877
              std dev =       0.585288070847
             le_variance =       0.342562125875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692524360618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925243606177       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925243606264       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925243606313       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925243606322       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925243606329       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925243606381       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925243606369       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925243606370       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.826208e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925243606177       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925243606199       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925243606211       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925243606234       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925243606179       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925243606217       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925243606231       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925243606238       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 7.065547e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925243606177       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925243606182       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925243606185       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925243606187       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925243606186       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925243606139       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925243606182       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925243605981       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.766388e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6280e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480793e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9579
    reference variance = 0.20211
====================================================
  Execution time = 2.0598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4102e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007157481
                                         uncertainty =       0.004539091610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007157481
                                         uncertainty =       0.004539091610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412927221
  error estimate for blocks of size 2^( 2) =       0.000425593028
  error estimate for blocks of size 2^( 3) =       0.000437993677
  error estimate for blocks of size 2^( 4) =       0.000449965194
  error estimate for blocks of size 2^( 5) =       0.000458540117
  error estimate for blocks of size 2^( 6) =       0.000466219462
  error estimate for blocks of size 2^( 7) =       0.000471925393

      target function =                  N/A
              le_mean =     -16.924939525388
             les_mean =     286.794595546588
             stat err =       0.000461662541
             autocorr =       1.249977656088
              std dev =       0.583967275672
             le_variance =       0.341017779056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007147934
                                         uncertainty =       0.004539091324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007147934
                                         uncertainty =       0.004539091324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412927215
  error estimate for blocks of size 2^( 2) =       0.000425593023
  error estimate for blocks of size 2^( 3) =       0.000437993672
  error estimate for blocks of size 2^( 4) =       0.000449965189
  error estimate for blocks of size 2^( 5) =       0.000458540111
  error estimate for blocks of size 2^( 6) =       0.000466219456
  error estimate for blocks of size 2^( 7) =       0.000471925387

      target function =                  N/A
              le_mean =     -16.924939525368
             les_mean =     286.794595536373
             stat err =       0.000461662536
             autocorr =       1.249977660832
              std dev =       0.583967267503
             le_variance =       0.341017769515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007152707
                                         uncertainty =       0.004539091467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007152707
                                         uncertainty =       0.004539091467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412927218
  error estimate for blocks of size 2^( 2) =       0.000425593026
  error estimate for blocks of size 2^( 3) =       0.000437993675
  error estimate for blocks of size 2^( 4) =       0.000449965191
  error estimate for blocks of size 2^( 5) =       0.000458540114
  error estimate for blocks of size 2^( 6) =       0.000466219459
  error estimate for blocks of size 2^( 7) =       0.000471925390

      target function =                  N/A
              le_mean =     -16.924939525378
             les_mean =     286.794595541481
             stat err =       0.000461662539
             autocorr =       1.249977658464
              std dev =       0.583967271588
             le_variance =       0.341017774285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007156884
                                         uncertainty =       0.004539091592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341007156884
                                         uncertainty =       0.004539091592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412927220
  error estimate for blocks of size 2^( 2) =       0.000425593028
  error estimate for blocks of size 2^( 3) =       0.000437993677
  error estimate for blocks of size 2^( 4) =       0.000449965194
  error estimate for blocks of size 2^( 5) =       0.000458540116
  error estimate for blocks of size 2^( 6) =       0.000466219461
  error estimate for blocks of size 2^( 7) =       0.000471925393

      target function =                  N/A
              le_mean =     -16.924939525387
             les_mean =     286.794595545950
             stat err =       0.000461662541
             autocorr =       1.249977656382
              std dev =       0.583967275162
             le_variance =       0.341017778460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924939525388        initial  <--
     1.5259e+04     1.5259e+05             2.8262e-08       -16.924939525368
     6.1035e+04     6.1035e+05             7.0655e-09       -16.924939525378
     2.4414e+05     2.4414e+06             1.7664e-09       -16.924939525387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1024
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9621
    reference variance = 0.201969
====================================================
  Execution time = 2.3505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3265e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332110014614
                                         uncertainty =       0.003169575273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332110014614
                                         uncertainty =       0.003169575273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407830373
  error estimate for blocks of size 2^( 2) =       0.000419936954
  error estimate for blocks of size 2^( 3) =       0.000432599121
  error estimate for blocks of size 2^( 4) =       0.000443966530
  error estimate for blocks of size 2^( 5) =       0.000452807254
  error estimate for blocks of size 2^( 6) =       0.000459459588
  error estimate for blocks of size 2^( 7) =       0.000463365099

      target function =                  N/A
              le_mean =     -16.925177343955
             les_mean =     286.794279184662
             stat err =       0.000454899618
             autocorr =       1.244147898901
              std dev =       0.576759244958
             le_variance =       0.332651226645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692517734396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925177343955       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925177343966       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925177343966       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925177343982       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925177343959       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925177343820       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925177344044       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925177343914       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.099756e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925177343955       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925177343958       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925177343958       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925177344018       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925177343960       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925177343871       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925177343813       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925177343760       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 5.249392e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925177343955       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925177343956       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925177343956       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925177342928       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925177343429       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925177343555       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925177343559       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925177342086       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.312346e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8965e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8231
    reference variance = 0.2627
====================================================
  Execution time = 2.1010e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4191e-01
  Total weights = 2.0000e+06
  Execution time = 1.8940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872834748
                                         uncertainty =       0.004328070793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872834748
                                         uncertainty =       0.004328070793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413468002
  error estimate for blocks of size 2^( 2) =       0.000426248548
  error estimate for blocks of size 2^( 3) =       0.000438741646
  error estimate for blocks of size 2^( 4) =       0.000450420889
  error estimate for blocks of size 2^( 5) =       0.000461300614
  error estimate for blocks of size 2^( 6) =       0.000469191426
  error estimate for blocks of size 2^( 7) =       0.000472945122

      target function =                  N/A
              le_mean =     -16.924489763255
             les_mean =     286.780265153563
             stat err =       0.000463464513
             autocorr =       1.256461427415
              std dev =       0.584732056587
             le_variance =       0.341911578001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872835136
                                         uncertainty =       0.004328070797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872835136
                                         uncertainty =       0.004328070797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413468003
  error estimate for blocks of size 2^( 2) =       0.000426248549
  error estimate for blocks of size 2^( 3) =       0.000438741646
  error estimate for blocks of size 2^( 4) =       0.000450420889
  error estimate for blocks of size 2^( 5) =       0.000461300614
  error estimate for blocks of size 2^( 6) =       0.000469191427
  error estimate for blocks of size 2^( 7) =       0.000472945122

      target function =                  N/A
              le_mean =     -16.924489763253
             les_mean =     286.780265153880
             stat err =       0.000463464513
             autocorr =       1.256461426682
              std dev =       0.584732056919
             le_variance =       0.341911578389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872834942
                                         uncertainty =       0.004328070795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872834942
                                         uncertainty =       0.004328070795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413468003
  error estimate for blocks of size 2^( 2) =       0.000426248548
  error estimate for blocks of size 2^( 3) =       0.000438741646
  error estimate for blocks of size 2^( 4) =       0.000450420889
  error estimate for blocks of size 2^( 5) =       0.000461300614
  error estimate for blocks of size 2^( 6) =       0.000469191427
  error estimate for blocks of size 2^( 7) =       0.000472945122

      target function =                  N/A
              le_mean =     -16.924489763254
             les_mean =     286.780265153721
             stat err =       0.000463464513
             autocorr =       1.256461427049
              std dev =       0.584732056753
             le_variance =       0.341911578195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872834772
                                         uncertainty =       0.004328070794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341872834772
                                         uncertainty =       0.004328070794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413468002
  error estimate for blocks of size 2^( 2) =       0.000426248548
  error estimate for blocks of size 2^( 3) =       0.000438741646
  error estimate for blocks of size 2^( 4) =       0.000450420889
  error estimate for blocks of size 2^( 5) =       0.000461300614
  error estimate for blocks of size 2^( 6) =       0.000469191426
  error estimate for blocks of size 2^( 7) =       0.000472945122

      target function =                  N/A
              le_mean =     -16.924489763255
             les_mean =     286.780265153583
             stat err =       0.000463464513
             autocorr =       1.256461427369
              std dev =       0.584732056608
             le_variance =       0.341911578025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924489763255        initial  <--
     1.5259e+05     1.5259e+06             2.0998e-09       -16.924489763253
     6.1035e+05     6.1035e+06             5.2494e-10       -16.924489763254
     2.4414e+06     2.4414e+07             1.3123e-10       -16.924489763255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5387
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9509e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.290581
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335257564541
                                         uncertainty =       0.003461302618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335257564541
                                         uncertainty =       0.003461302618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409403976
  error estimate for blocks of size 2^( 2) =       0.000422504348
  error estimate for blocks of size 2^( 3) =       0.000436041620
  error estimate for blocks of size 2^( 4) =       0.000447154338
  error estimate for blocks of size 2^( 5) =       0.000457789612
  error estimate for blocks of size 2^( 6) =       0.000465697227
  error estimate for blocks of size 2^( 7) =       0.000470608736

      target function =                  N/A
              le_mean =     -16.924522181438
             les_mean =     286.774674134006
             stat err =       0.000460312478
             autocorr =       1.264158075018
              std dev =       0.578984655788
             le_variance =       0.335223231638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692452218144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924522181438       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924522181439       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924522181439       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924522181320       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924522181606       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924522181191       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924522182598       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924522181387       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924522181140       residual = 9.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.725347e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924522181438       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924522181438       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924522181438       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924522181438       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924522178160       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924522181433       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924522180553       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924522184825       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924522181128       residual = 9.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 6.813374e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924522181438       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924522181438       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924522181438       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924522181438       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924522181438       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924522189632       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924522181438       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924522182066       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924522196988       residual = 9.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.703346e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6297e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.88209
====================================================
  Execution time = 2.0678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3718e-01
  Total weights = 2.0000e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672866
                                         uncertainty =       0.004040061789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672866
                                         uncertainty =       0.004040061789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410599800
  error estimate for blocks of size 2^( 2) =       0.000423181708
  error estimate for blocks of size 2^( 3) =       0.000435987678
  error estimate for blocks of size 2^( 4) =       0.000448636610
  error estimate for blocks of size 2^( 5) =       0.000459218929
  error estimate for blocks of size 2^( 6) =       0.000468682964
  error estimate for blocks of size 2^( 7) =       0.000476810826

      target function =                  N/A
              le_mean =     -16.924637536100
             les_mean =     286.780539951164
             stat err =       0.000463337332
             autocorr =       1.273377349727
              std dev =       0.580675805763
             le_variance =       0.337184391398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672820
                                         uncertainty =       0.004040061788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672820
                                         uncertainty =       0.004040061788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410599800
  error estimate for blocks of size 2^( 2) =       0.000423181708
  error estimate for blocks of size 2^( 3) =       0.000435987678
  error estimate for blocks of size 2^( 4) =       0.000448636610
  error estimate for blocks of size 2^( 5) =       0.000459218929
  error estimate for blocks of size 2^( 6) =       0.000468682964
  error estimate for blocks of size 2^( 7) =       0.000476810826

      target function =                  N/A
              le_mean =     -16.924637536101
             les_mean =     286.780539951159
             stat err =       0.000463337332
             autocorr =       1.273377349757
              std dev =       0.580675805723
             le_variance =       0.337184391353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672843
                                         uncertainty =       0.004040061788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672843
                                         uncertainty =       0.004040061788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410599800
  error estimate for blocks of size 2^( 2) =       0.000423181708
  error estimate for blocks of size 2^( 3) =       0.000435987678
  error estimate for blocks of size 2^( 4) =       0.000448636610
  error estimate for blocks of size 2^( 5) =       0.000459218929
  error estimate for blocks of size 2^( 6) =       0.000468682964
  error estimate for blocks of size 2^( 7) =       0.000476810826

      target function =                  N/A
              le_mean =     -16.924637536100
             les_mean =     286.780539951161
             stat err =       0.000463337332
             autocorr =       1.273377349743
              std dev =       0.580675805743
             le_variance =       0.337184391375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672863
                                         uncertainty =       0.004040061789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337211672863
                                         uncertainty =       0.004040061789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410599800
  error estimate for blocks of size 2^( 2) =       0.000423181708
  error estimate for blocks of size 2^( 3) =       0.000435987678
  error estimate for blocks of size 2^( 4) =       0.000448636610
  error estimate for blocks of size 2^( 5) =       0.000459218929
  error estimate for blocks of size 2^( 6) =       0.000468682964
  error estimate for blocks of size 2^( 7) =       0.000476810826

      target function =                  N/A
              le_mean =     -16.924637536100
             les_mean =     286.780539951163
             stat err =       0.000463337332
             autocorr =       1.273377349726
              std dev =       0.580675805760
             le_variance =       0.337184391395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924637536100        initial
     1.5259e+06     1.5259e+07             2.7253e-10       -16.924637536101  <--
     6.1035e+06     6.1035e+07             6.8134e-11       -16.924637536100
     2.4414e+07     2.4414e+08             1.7033e-11       -16.924637536100

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 3.0180e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8072
    reference variance = 0.233547
====================================================
  Execution time = 2.0948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4023e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340287974338
                                         uncertainty =       0.006325500661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340287974338
                                         uncertainty =       0.006325500661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412447523
  error estimate for blocks of size 2^( 2) =       0.000425067073
  error estimate for blocks of size 2^( 3) =       0.000437262712
  error estimate for blocks of size 2^( 4) =       0.000448564458
  error estimate for blocks of size 2^( 5) =       0.000458817065
  error estimate for blocks of size 2^( 6) =       0.000464789686
  error estimate for blocks of size 2^( 7) =       0.000469956286

      target function =                  N/A
              le_mean =     -16.924099089105
             les_mean =     286.765355726511
             stat err =       0.000460531874
             autocorr =       1.246757491741
              std dev =       0.583288881079
             le_variance =       0.340225918790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692409908910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924099089105       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924099089110       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924099089111       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924099088821       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924099089063       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924099089396       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924099089026       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924099089212       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.087577e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924099089105       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924099089106       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924099089106       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924099089276       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924099089940       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924099088337       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924099089107       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924099089065       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.718943e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924099089105       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924099089105       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924099089105       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924099089105       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924099087860       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924099088380       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924099086031       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924099098159       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 6.797338e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6439e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578526e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.299014
====================================================
  Execution time = 2.2890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3944e-01
  Total weights = 2.0000e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196242
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196242
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970719
  error estimate for blocks of size 2^( 2) =       0.000424370190
  error estimate for blocks of size 2^( 3) =       0.000436589682
  error estimate for blocks of size 2^( 4) =       0.000447941517
  error estimate for blocks of size 2^( 5) =       0.000457542197
  error estimate for blocks of size 2^( 6) =       0.000464649606
  error estimate for blocks of size 2^( 7) =       0.000470504398

      target function =                  N/A
              le_mean =     -16.925263694577
             les_mean =     286.803990707725
             stat err =       0.000460159429
             autocorr =       1.247624667769
              std dev =       0.582614577997
             le_variance =       0.339439746495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196171
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196171
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970719
  error estimate for blocks of size 2^( 2) =       0.000424370190
  error estimate for blocks of size 2^( 3) =       0.000436589682
  error estimate for blocks of size 2^( 4) =       0.000447941517
  error estimate for blocks of size 2^( 5) =       0.000457542197
  error estimate for blocks of size 2^( 6) =       0.000464649606
  error estimate for blocks of size 2^( 7) =       0.000470504398

      target function =                  N/A
              le_mean =     -16.925263694584
             les_mean =     286.803990707905
             stat err =       0.000460159429
             autocorr =       1.247624667803
              std dev =       0.582614577936
             le_variance =       0.339439746424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196206
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196206
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970719
  error estimate for blocks of size 2^( 2) =       0.000424370190
  error estimate for blocks of size 2^( 3) =       0.000436589682
  error estimate for blocks of size 2^( 4) =       0.000447941517
  error estimate for blocks of size 2^( 5) =       0.000457542197
  error estimate for blocks of size 2^( 6) =       0.000464649606
  error estimate for blocks of size 2^( 7) =       0.000470504398

      target function =                  N/A
              le_mean =     -16.925263694580
             les_mean =     286.803990707815
             stat err =       0.000460159429
             autocorr =       1.247624667794
              std dev =       0.582614577967
             le_variance =       0.339439746459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196237
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544196237
                                         uncertainty =       0.004453725908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970719
  error estimate for blocks of size 2^( 2) =       0.000424370190
  error estimate for blocks of size 2^( 3) =       0.000436589682
  error estimate for blocks of size 2^( 4) =       0.000447941517
  error estimate for blocks of size 2^( 5) =       0.000457542197
  error estimate for blocks of size 2^( 6) =       0.000464649606
  error estimate for blocks of size 2^( 7) =       0.000470504398

      target function =                  N/A
              le_mean =     -16.925263694577
             les_mean =     286.803990707736
             stat err =       0.000460159429
             autocorr =       1.247624667769
              std dev =       0.582614577993
             le_variance =       0.339439746490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925263694577        initial
     3.8147e+05     3.8147e+06             1.0876e-09       -16.925263694584  <--
     1.5259e+06     1.5259e+07             2.7189e-10       -16.925263694580
     6.1035e+06     6.1035e+07             6.7973e-11       -16.925263694577

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 3.2403e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9753
    reference variance = 0.222278
====================================================
  Execution time = 2.0898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345495180483
                                         uncertainty =       0.004914633119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345495180483
                                         uncertainty =       0.004914633119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415604144
  error estimate for blocks of size 2^( 2) =       0.000428095994
  error estimate for blocks of size 2^( 3) =       0.000440391928
  error estimate for blocks of size 2^( 4) =       0.000451474058
  error estimate for blocks of size 2^( 5) =       0.000461229119
  error estimate for blocks of size 2^( 6) =       0.000468074061
  error estimate for blocks of size 2^( 7) =       0.000473675342

      target function =                  N/A
              le_mean =     -16.924850240909
             les_mean =     286.796009113937
             stat err =       0.000463613145
             autocorr =       1.244376334910
              std dev =       0.587753017408
             le_variance =       0.345453609473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692485024091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924850240909       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924850240928       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924850240938       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924850240951       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924850240959       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924850240945       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924850240963       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924850240922       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 3.510013e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924850240909       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924850240914       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924850240916       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924850240960       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924850240765       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924850241269       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924850241154       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924850241297       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 8.775035e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924850240909       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924850240910       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924850240911       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924850240984       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924850241051       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924850241544       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924850240814       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924850241559       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.193759e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6434e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.0073
    reference variance = 0.366809
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188834300
                                         uncertainty =       0.002884041696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188834300
                                         uncertainty =       0.002884041696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410561040
  error estimate for blocks of size 2^( 2) =       0.000423614987
  error estimate for blocks of size 2^( 3) =       0.000436311343
  error estimate for blocks of size 2^( 4) =       0.000448076908
  error estimate for blocks of size 2^( 5) =       0.000458031133
  error estimate for blocks of size 2^( 6) =       0.000465707401
  error estimate for blocks of size 2^( 7) =       0.000467446387

      target function =                  N/A
              le_mean =     -16.925010894506
             les_mean =     286.793114346148
             stat err =       0.000459815457
             autocorr =       1.254329577711
              std dev =       0.580620991332
             le_variance =       0.337120735575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188833476
                                         uncertainty =       0.002884041686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188833476
                                         uncertainty =       0.002884041686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410561040
  error estimate for blocks of size 2^( 2) =       0.000423614987
  error estimate for blocks of size 2^( 3) =       0.000436311342
  error estimate for blocks of size 2^( 4) =       0.000448076908
  error estimate for blocks of size 2^( 5) =       0.000458031133
  error estimate for blocks of size 2^( 6) =       0.000465707401
  error estimate for blocks of size 2^( 7) =       0.000467446387

      target function =                  N/A
              le_mean =     -16.925010894488
             les_mean =     286.793114344731
             stat err =       0.000459815457
             autocorr =       1.254329577910
              std dev =       0.580620990622
             le_variance =       0.337120734751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188833888
                                         uncertainty =       0.002884041691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188833888
                                         uncertainty =       0.002884041691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410561040
  error estimate for blocks of size 2^( 2) =       0.000423614987
  error estimate for blocks of size 2^( 3) =       0.000436311343
  error estimate for blocks of size 2^( 4) =       0.000448076908
  error estimate for blocks of size 2^( 5) =       0.000458031133
  error estimate for blocks of size 2^( 6) =       0.000465707401
  error estimate for blocks of size 2^( 7) =       0.000467446387

      target function =                  N/A
              le_mean =     -16.925010894497
             les_mean =     286.793114345440
             stat err =       0.000459815457
             autocorr =       1.254329577811
              std dev =       0.580620990977
             le_variance =       0.337120735163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188834249
                                         uncertainty =       0.002884041696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188834249
                                         uncertainty =       0.002884041696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410561040
  error estimate for blocks of size 2^( 2) =       0.000423614987
  error estimate for blocks of size 2^( 3) =       0.000436311343
  error estimate for blocks of size 2^( 4) =       0.000448076908
  error estimate for blocks of size 2^( 5) =       0.000458031133
  error estimate for blocks of size 2^( 6) =       0.000465707401
  error estimate for blocks of size 2^( 7) =       0.000467446387

      target function =                  N/A
              le_mean =     -16.925010894505
             les_mean =     286.793114346060
             stat err =       0.000459815457
             autocorr =       1.254329577709
              std dev =       0.580620991288
             le_variance =       0.337120735524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925010894506        initial  <--
     9.5367e+04     9.5367e+05             3.5100e-09       -16.925010894488
     3.8147e+05     3.8147e+06             8.7750e-10       -16.925010894497
     1.5259e+06     1.5259e+07             2.1938e-10       -16.925010894505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0027
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.185083
====================================================
  Execution time = 2.0771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4119e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341193850847
                                         uncertainty =       0.005122574253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341193850847
                                         uncertainty =       0.005122574253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413031052
  error estimate for blocks of size 2^( 2) =       0.000425249089
  error estimate for blocks of size 2^( 3) =       0.000438239936
  error estimate for blocks of size 2^( 4) =       0.000449991599
  error estimate for blocks of size 2^( 5) =       0.000460117032
  error estimate for blocks of size 2^( 6) =       0.000467343296
  error estimate for blocks of size 2^( 7) =       0.000471537638

      target function =                  N/A
              le_mean =     -16.924732299523
             les_mean =     286.787752539270
             stat err =       0.000462247391
             autocorr =       1.252516717329
              std dev =       0.584114115011
             le_variance =       0.341189299355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692473229952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924732299523       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924732299524       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924732299524       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924732299002       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924732299048       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924732298473       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924732299168       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924732299256       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.857509e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924732299523       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924732299523       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924732299523       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924732299523       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924732299310       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924732301971       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924732303178       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924732301412       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 9.643839e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924732299523       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924732299523       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924732299523       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924732299556       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924732299523       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924732307590       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924732296755       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924732300742       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 2.410952e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6339e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.152599
====================================================
  Execution time = 2.0775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3630e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159401
                                         uncertainty =       0.004248193028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159401
                                         uncertainty =       0.004248193028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410060343
  error estimate for blocks of size 2^( 2) =       0.000422662755
  error estimate for blocks of size 2^( 3) =       0.000435737173
  error estimate for blocks of size 2^( 4) =       0.000447807751
  error estimate for blocks of size 2^( 5) =       0.000459023906
  error estimate for blocks of size 2^( 6) =       0.000466398285
  error estimate for blocks of size 2^( 7) =       0.000470135438

      target function =                  N/A
              le_mean =     -16.923627494382
             les_mean =     286.745466370446
             stat err =       0.000460841345
             autocorr =       1.263011571110
              std dev =       0.579912898629
             le_variance =       0.336298969996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159508
                                         uncertainty =       0.004248193031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159508
                                         uncertainty =       0.004248193031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410060343
  error estimate for blocks of size 2^( 2) =       0.000422662755
  error estimate for blocks of size 2^( 3) =       0.000435737174
  error estimate for blocks of size 2^( 4) =       0.000447807751
  error estimate for blocks of size 2^( 5) =       0.000459023906
  error estimate for blocks of size 2^( 6) =       0.000466398285
  error estimate for blocks of size 2^( 7) =       0.000470135438

      target function =                  N/A
              le_mean =     -16.923627494383
             les_mean =     286.745466370598
             stat err =       0.000460841345
             autocorr =       1.263011570956
              std dev =       0.579912898721
             le_variance =       0.336298970103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159454
                                         uncertainty =       0.004248193029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159454
                                         uncertainty =       0.004248193029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410060343
  error estimate for blocks of size 2^( 2) =       0.000422662755
  error estimate for blocks of size 2^( 3) =       0.000435737174
  error estimate for blocks of size 2^( 4) =       0.000447807751
  error estimate for blocks of size 2^( 5) =       0.000459023906
  error estimate for blocks of size 2^( 6) =       0.000466398285
  error estimate for blocks of size 2^( 7) =       0.000470135438

      target function =                  N/A
              le_mean =     -16.923627494383
             les_mean =     286.745466370522
             stat err =       0.000460841345
             autocorr =       1.263011571030
              std dev =       0.579912898675
             le_variance =       0.336298970049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159408
                                         uncertainty =       0.004248193028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379159408
                                         uncertainty =       0.004248193028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410060343
  error estimate for blocks of size 2^( 2) =       0.000422662755
  error estimate for blocks of size 2^( 3) =       0.000435737173
  error estimate for blocks of size 2^( 4) =       0.000447807751
  error estimate for blocks of size 2^( 5) =       0.000459023906
  error estimate for blocks of size 2^( 6) =       0.000466398285
  error estimate for blocks of size 2^( 7) =       0.000470135438

      target function =                  N/A
              le_mean =     -16.923627494382
             les_mean =     286.745466370455
             stat err =       0.000460841345
             autocorr =       1.263011571094
              std dev =       0.579912898634
             le_variance =       0.336298970002


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923627494382        initial
     9.5367e+05     9.5367e+06             3.8575e-10       -16.923627494383  <--
     3.8147e+06     3.8147e+07             9.6438e-11       -16.923627494383
     1.5259e+07     1.5259e+08             2.4110e-11       -16.923627494382

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 3.0286e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328874e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502269e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6631e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8596
    reference variance = 0.394677
====================================================
  Execution time = 2.1394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3449e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334586697153
                                         uncertainty =       0.002508200182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334586697153
                                         uncertainty =       0.002508200182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408956906
  error estimate for blocks of size 2^( 2) =       0.000421904627
  error estimate for blocks of size 2^( 3) =       0.000435023541
  error estimate for blocks of size 2^( 4) =       0.000446180493
  error estimate for blocks of size 2^( 5) =       0.000457020480
  error estimate for blocks of size 2^( 6) =       0.000463347062
  error estimate for blocks of size 2^( 7) =       0.000469474217

      target function =                  N/A
              le_mean =     -16.925287453358
             les_mean =     286.799846713339
             stat err =       0.000459005563
             autocorr =       1.259739669455
              std dev =       0.578352402765
             le_variance =       0.334491501785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692528745336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925287453358       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925287453358       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925287453365       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925287453386       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925287453366       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925287453381       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925287453411       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925287453461       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.507151e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925287453358       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925287453358       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925287453360       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925287453091       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925287453300       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925287453737       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925287453806       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925287453268       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.767879e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925287453358       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925287453358       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925287453358       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925287453488       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925287452083       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925287453354       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925287453935       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925287453389       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 9.419701e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7546e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480795e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9087
    reference variance = 0.266052
====================================================
  Execution time = 2.0636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3690e-01
  Total weights = 2.0000e+06
  Execution time = 1.8780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344826
                                         uncertainty =       0.003356759665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344826
                                         uncertainty =       0.003356759665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410426721
  error estimate for blocks of size 2^( 2) =       0.000422529547
  error estimate for blocks of size 2^( 3) =       0.000435256805
  error estimate for blocks of size 2^( 4) =       0.000446563705
  error estimate for blocks of size 2^( 5) =       0.000456595908
  error estimate for blocks of size 2^( 6) =       0.000463061239
  error estimate for blocks of size 2^( 7) =       0.000468904321

      target function =                  N/A
              le_mean =     -16.924964665332
             les_mean =     286.791328941629
             stat err =       0.000458781293
             autocorr =       1.249511178037
              std dev =       0.580431035823
             le_variance =       0.336900187347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344300
                                         uncertainty =       0.003356759663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344300
                                         uncertainty =       0.003356759663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410426721
  error estimate for blocks of size 2^( 2) =       0.000422529546
  error estimate for blocks of size 2^( 3) =       0.000435256805
  error estimate for blocks of size 2^( 4) =       0.000446563705
  error estimate for blocks of size 2^( 5) =       0.000456595907
  error estimate for blocks of size 2^( 6) =       0.000463061238
  error estimate for blocks of size 2^( 7) =       0.000468904321

      target function =                  N/A
              le_mean =     -16.924964665335
             les_mean =     286.791328941200
             stat err =       0.000458781293
             autocorr =       1.249511178225
              std dev =       0.580431035371
             le_variance =       0.336900186821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344563
                                         uncertainty =       0.003356759664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344563
                                         uncertainty =       0.003356759664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410426721
  error estimate for blocks of size 2^( 2) =       0.000422529547
  error estimate for blocks of size 2^( 3) =       0.000435256805
  error estimate for blocks of size 2^( 4) =       0.000446563705
  error estimate for blocks of size 2^( 5) =       0.000456595908
  error estimate for blocks of size 2^( 6) =       0.000463061239
  error estimate for blocks of size 2^( 7) =       0.000468904321

      target function =                  N/A
              le_mean =     -16.924964665333
             les_mean =     286.791328941415
             stat err =       0.000458781293
             autocorr =       1.249511178121
              std dev =       0.580431035597
             le_variance =       0.336900187084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344793
                                         uncertainty =       0.003356759665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012344793
                                         uncertainty =       0.003356759665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410426721
  error estimate for blocks of size 2^( 2) =       0.000422529547
  error estimate for blocks of size 2^( 3) =       0.000435256805
  error estimate for blocks of size 2^( 4) =       0.000446563705
  error estimate for blocks of size 2^( 5) =       0.000456595908
  error estimate for blocks of size 2^( 6) =       0.000463061239
  error estimate for blocks of size 2^( 7) =       0.000468904321

      target function =                  N/A
              le_mean =     -16.924964665332
             les_mean =     286.791328941602
             stat err =       0.000458781293
             autocorr =       1.249511178048
              std dev =       0.580431035795
             le_variance =       0.336900187314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924964665332        initial
     2.3842e+05     2.3842e+06             1.5072e-09       -16.924964665335  <--
     9.5367e+05     9.5367e+06             3.7679e-10       -16.924964665333
     3.8147e+06     3.8147e+07             9.4197e-11       -16.924964665332

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 3.0115e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9645
    reference variance = 0.541806
====================================================
  Execution time = 2.1293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.6293e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363046118121
                                         uncertainty =       0.024345672423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363046118121
                                         uncertainty =       0.024345672423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425987430
  error estimate for blocks of size 2^( 2) =       0.000437933214
  error estimate for blocks of size 2^( 3) =       0.000450090811
  error estimate for blocks of size 2^( 4) =       0.000461020132
  error estimate for blocks of size 2^( 5) =       0.000470573213
  error estimate for blocks of size 2^( 6) =       0.000479025580
  error estimate for blocks of size 2^( 7) =       0.000482911914

      target function =                  N/A
              le_mean =     -16.925259148236
             les_mean =     286.827327635185
             stat err =       0.000473382710
             autocorr =       1.234898360136
              std dev =       0.602437201470
             le_variance =       0.362930581715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692525914824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925259148236       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925259148251       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925259148252       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925259148261       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925259148313       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925259148269       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925259148264       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925259148252       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 6.184993e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925259148236       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925259148240       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925259148240       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925259148192       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925259148285       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925259148149       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925259148421       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925259148293       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.546249e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925259148236       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925259148237       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925259148237       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925259148617       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925259146996       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925259148444       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925259147883       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925259148464       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.865621e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6834e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8278
    reference variance = 0.318461
====================================================
  Execution time = 2.0732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3570e-01
  Total weights = 2.0000e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781540170
                                         uncertainty =       0.003191029724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781540170
                                         uncertainty =       0.003191029724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409692169
  error estimate for blocks of size 2^( 2) =       0.000422742933
  error estimate for blocks of size 2^( 3) =       0.000435994737
  error estimate for blocks of size 2^( 4) =       0.000447523192
  error estimate for blocks of size 2^( 5) =       0.000458623142
  error estimate for blocks of size 2^( 6) =       0.000465646515
  error estimate for blocks of size 2^( 7) =       0.000469964714

      target function =                  N/A
              le_mean =     -16.924737908973
             les_mean =     286.782448465519
             stat err =       0.000460439391
             autocorr =       1.263076388231
              std dev =       0.579392221157
             le_variance =       0.335695345937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781537331
                                         uncertainty =       0.003191029679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781537331
                                         uncertainty =       0.003191029679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409692167
  error estimate for blocks of size 2^( 2) =       0.000422742931
  error estimate for blocks of size 2^( 3) =       0.000435994735
  error estimate for blocks of size 2^( 4) =       0.000447523190
  error estimate for blocks of size 2^( 5) =       0.000458623140
  error estimate for blocks of size 2^( 6) =       0.000465646514
  error estimate for blocks of size 2^( 7) =       0.000469964712

      target function =                  N/A
              le_mean =     -16.924737908963
             les_mean =     286.782448462335
             stat err =       0.000460439389
             autocorr =       1.263076390030
              std dev =       0.579392218709
             le_variance =       0.335695343101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781538750
                                         uncertainty =       0.003191029702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781538750
                                         uncertainty =       0.003191029702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409692168
  error estimate for blocks of size 2^( 2) =       0.000422742932
  error estimate for blocks of size 2^( 3) =       0.000435994736
  error estimate for blocks of size 2^( 4) =       0.000447523191
  error estimate for blocks of size 2^( 5) =       0.000458623141
  error estimate for blocks of size 2^( 6) =       0.000465646515
  error estimate for blocks of size 2^( 7) =       0.000469964713

      target function =                  N/A
              le_mean =     -16.924737908968
             les_mean =     286.782448463927
             stat err =       0.000460439390
             autocorr =       1.263076389128
              std dev =       0.579392219933
             le_variance =       0.335695344519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781539992
                                         uncertainty =       0.003191029721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335781539992
                                         uncertainty =       0.003191029721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409692168
  error estimate for blocks of size 2^( 2) =       0.000422742932
  error estimate for blocks of size 2^( 3) =       0.000435994737
  error estimate for blocks of size 2^( 4) =       0.000447523192
  error estimate for blocks of size 2^( 5) =       0.000458623142
  error estimate for blocks of size 2^( 6) =       0.000465646515
  error estimate for blocks of size 2^( 7) =       0.000469964714

      target function =                  N/A
              le_mean =     -16.924737908972
             les_mean =     286.782448465320
             stat err =       0.000460439391
             autocorr =       1.263076388345
              std dev =       0.579392221004
             le_variance =       0.335695345760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924737908973        initial  <--
     5.9605e+04     5.9605e+05             6.1850e-09       -16.924737908963
     2.3842e+05     2.3842e+06             1.5462e-09       -16.924737908968
     9.5367e+05     9.5367e+06             3.8656e-10       -16.924737908972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2210
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1043
    reference variance = 0.97692
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346970317406
                                         uncertainty =       0.010308651862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346970317406
                                         uncertainty =       0.010308651862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416567467
  error estimate for blocks of size 2^( 2) =       0.000428173043
  error estimate for blocks of size 2^( 3) =       0.000440285022
  error estimate for blocks of size 2^( 4) =       0.000451440946
  error estimate for blocks of size 2^( 5) =       0.000459598432
  error estimate for blocks of size 2^( 6) =       0.000464805104
  error estimate for blocks of size 2^( 7) =       0.000470046933

      target function =                  N/A
              le_mean =     -16.925712792191
             les_mean =     286.826810259506
             stat err =       0.000461472854
             autocorr =       1.227217722351
              std dev =       0.589115361623
             le_variance =       0.347056909300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692571279219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925712792191       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925712792195       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925712792197       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925712792198       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925712792200       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925712792311       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925712792355       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925712792631       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 5.512170e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925712792191       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925712792192       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925712792192       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925712792193       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925712792796       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925712791318       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925712792048       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925712793178       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.378042e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925712792191       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925712792191       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925712792191       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925712799831       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925712792880       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925712780519       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925712793988       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925712795283       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 3.445082e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6733e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9432
    reference variance = 0.466268
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4090e-01
  Total weights = 2.0000e+06
  Execution time = 1.8909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885477109
                                         uncertainty =       0.003423721940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885477109
                                         uncertainty =       0.003423721940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412854829
  error estimate for blocks of size 2^( 2) =       0.000425243265
  error estimate for blocks of size 2^( 3) =       0.000437847829
  error estimate for blocks of size 2^( 4) =       0.000449110592
  error estimate for blocks of size 2^( 5) =       0.000459427058
  error estimate for blocks of size 2^( 6) =       0.000466617204
  error estimate for blocks of size 2^( 7) =       0.000471534540

      target function =                  N/A
              le_mean =     -16.924363884206
             les_mean =     286.774990934941
             stat err =       0.000461672348
             autocorr =       1.250469170136
              std dev =       0.583864899064
             le_variance =       0.340898220359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885476794
                                         uncertainty =       0.003423721936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885476794
                                         uncertainty =       0.003423721936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412854829
  error estimate for blocks of size 2^( 2) =       0.000425243265
  error estimate for blocks of size 2^( 3) =       0.000437847829
  error estimate for blocks of size 2^( 4) =       0.000449110592
  error estimate for blocks of size 2^( 5) =       0.000459427058
  error estimate for blocks of size 2^( 6) =       0.000466617203
  error estimate for blocks of size 2^( 7) =       0.000471534540

      target function =                  N/A
              le_mean =     -16.924363884204
             les_mean =     286.774990934553
             stat err =       0.000461672348
             autocorr =       1.250469170342
              std dev =       0.583864898794
             le_variance =       0.340898220043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885476952
                                         uncertainty =       0.003423721938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885476952
                                         uncertainty =       0.003423721938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412854829
  error estimate for blocks of size 2^( 2) =       0.000425243265
  error estimate for blocks of size 2^( 3) =       0.000437847829
  error estimate for blocks of size 2^( 4) =       0.000449110592
  error estimate for blocks of size 2^( 5) =       0.000459427058
  error estimate for blocks of size 2^( 6) =       0.000466617204
  error estimate for blocks of size 2^( 7) =       0.000471534540

      target function =                  N/A
              le_mean =     -16.924363884205
             les_mean =     286.774990934746
             stat err =       0.000461672348
             autocorr =       1.250469170227
              std dev =       0.583864898929
             le_variance =       0.340898220201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885477090
                                         uncertainty =       0.003423721940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885477090
                                         uncertainty =       0.003423721940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412854829
  error estimate for blocks of size 2^( 2) =       0.000425243265
  error estimate for blocks of size 2^( 3) =       0.000437847829
  error estimate for blocks of size 2^( 4) =       0.000449110592
  error estimate for blocks of size 2^( 5) =       0.000459427058
  error estimate for blocks of size 2^( 6) =       0.000466617204
  error estimate for blocks of size 2^( 7) =       0.000471534540

      target function =                  N/A
              le_mean =     -16.924363884206
             les_mean =     286.774990934916
             stat err =       0.000461672348
             autocorr =       1.250469170150
              std dev =       0.583864899047
             le_variance =       0.340898220340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924363884206        initial  <--
     5.9605e+05     5.9605e+06             5.5122e-10       -16.924363884204
     2.3842e+06     2.3842e+07             1.3780e-10       -16.924363884205
     9.5367e+06     9.5367e+07             3.4451e-11       -16.924363884206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2870
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9027e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.131652
====================================================
  Execution time = 2.1061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3781e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337925349869
                                         uncertainty =       0.005960258378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337925349869
                                         uncertainty =       0.005960258378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982656
  error estimate for blocks of size 2^( 2) =       0.000423330872
  error estimate for blocks of size 2^( 3) =       0.000435118804
  error estimate for blocks of size 2^( 4) =       0.000444605251
  error estimate for blocks of size 2^( 5) =       0.000453460832
  error estimate for blocks of size 2^( 6) =       0.000460888113
  error estimate for blocks of size 2^( 7) =       0.000464052164

      target function =                  N/A
              le_mean =     -16.925264278425
             les_mean =     286.802384213314
             stat err =       0.000455751590
             autocorr =       1.229728945645
              std dev =       0.581217246565
             le_variance =       0.337813487704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692526427842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925264278425       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925264278425       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925264278425       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925264280091       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925264271660       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925264276706       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925264278542       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925264275880       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.328904e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925264278425       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925264278425       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925264278425       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925264294085       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925264267480       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925264278425       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925264277984       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925264294668       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.332239e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925264278425       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925264278425       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925264278425       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925264331172       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925264277371       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925264147862       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925264279342       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925264260638       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.330325e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6597e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9652
    reference variance = 0.443028
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3908e-01
  Total weights = 2.0000e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749392
                                         uncertainty =       0.004576561309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749392
                                         uncertainty =       0.004576561309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752859
  error estimate for blocks of size 2^( 2) =       0.000424102380
  error estimate for blocks of size 2^( 3) =       0.000436205831
  error estimate for blocks of size 2^( 4) =       0.000446607643
  error estimate for blocks of size 2^( 5) =       0.000455951374
  error estimate for blocks of size 2^( 6) =       0.000462885132
  error estimate for blocks of size 2^( 7) =       0.000468529244

      target function =                  N/A
              le_mean =     -16.925769887654
             les_mean =     286.820766954249
             stat err =       0.000458493348
             autocorr =       1.239917618839
              std dev =       0.582306477694
             le_variance =       0.339080833964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749371
                                         uncertainty =       0.004576561308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749371
                                         uncertainty =       0.004576561308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752859
  error estimate for blocks of size 2^( 2) =       0.000424102380
  error estimate for blocks of size 2^( 3) =       0.000436205831
  error estimate for blocks of size 2^( 4) =       0.000446607643
  error estimate for blocks of size 2^( 5) =       0.000455951374
  error estimate for blocks of size 2^( 6) =       0.000462885132
  error estimate for blocks of size 2^( 7) =       0.000468529244

      target function =                  N/A
              le_mean =     -16.925769887654
             les_mean =     286.820766954234
             stat err =       0.000458493348
             autocorr =       1.239917618855
              std dev =       0.582306477676
             le_variance =       0.339080833944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749381
                                         uncertainty =       0.004576561308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749381
                                         uncertainty =       0.004576561308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752859
  error estimate for blocks of size 2^( 2) =       0.000424102380
  error estimate for blocks of size 2^( 3) =       0.000436205831
  error estimate for blocks of size 2^( 4) =       0.000446607643
  error estimate for blocks of size 2^( 5) =       0.000455951374
  error estimate for blocks of size 2^( 6) =       0.000462885132
  error estimate for blocks of size 2^( 7) =       0.000468529244

      target function =                  N/A
              le_mean =     -16.925769887654
             les_mean =     286.820766954242
             stat err =       0.000458493348
             autocorr =       1.239917618855
              std dev =       0.582306477685
             le_variance =       0.339080833954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749390
                                         uncertainty =       0.004576561309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339039749390
                                         uncertainty =       0.004576561309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411752859
  error estimate for blocks of size 2^( 2) =       0.000424102380
  error estimate for blocks of size 2^( 3) =       0.000436205831
  error estimate for blocks of size 2^( 4) =       0.000446607643
  error estimate for blocks of size 2^( 5) =       0.000455951374
  error estimate for blocks of size 2^( 6) =       0.000462885132
  error estimate for blocks of size 2^( 7) =       0.000468529244

      target function =                  N/A
              le_mean =     -16.925769887654
             les_mean =     286.820766954248
             stat err =       0.000458493348
             autocorr =       1.239917618841
              std dev =       0.582306477693
             le_variance =       0.339080833963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925769887654        initial
     5.9605e+06     5.9605e+07             5.3289e-11       -16.925769887654  <--
     2.3842e+07     2.3842e+08             1.3322e-11       -16.925769887654
     9.5367e+07     9.5367e+08             3.3303e-12       -16.925769887654

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 3.0079e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6681e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8899
    reference variance = 0.240313
====================================================
  Execution time = 2.1013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334856937932
                                         uncertainty =       0.003154103363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334856937932
                                         uncertainty =       0.003154103363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409165092
  error estimate for blocks of size 2^( 2) =       0.000421629666
  error estimate for blocks of size 2^( 3) =       0.000433540469
  error estimate for blocks of size 2^( 4) =       0.000444907574
  error estimate for blocks of size 2^( 5) =       0.000455898782
  error estimate for blocks of size 2^( 6) =       0.000462029764
  error estimate for blocks of size 2^( 7) =       0.000464631275

      target function =                  N/A
              le_mean =     -16.925086354887
             les_mean =     286.793380097666
             stat err =       0.000456866849
             autocorr =       1.246757940966
              std dev =       0.578646822080
             le_variance =       0.334832144703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692508635489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925086354887       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925086354888       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925086354888       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925086355321       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925086356210       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925086354180       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925086354612       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925086356116       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.903951e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925086354887       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925086354887       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925086354887       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925086354887       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925086354887       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925086353400       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925086352984       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925086361460       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 7.259871e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925086354887       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925086354887       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925086354887       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925086363380       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925086353394       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925086344561       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925086337494       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925086364149       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.814959e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6556e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9313
    reference variance = 0.212597
====================================================
  Execution time = 2.0714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059297
                                         uncertainty =       0.003032211132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059297
                                         uncertainty =       0.003032211132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562989
  error estimate for blocks of size 2^( 2) =       0.000423358113
  error estimate for blocks of size 2^( 3) =       0.000435936977
  error estimate for blocks of size 2^( 4) =       0.000448044875
  error estimate for blocks of size 2^( 5) =       0.000459216374
  error estimate for blocks of size 2^( 6) =       0.000467370224
  error estimate for blocks of size 2^( 7) =       0.000472273712

      target function =                  N/A
              le_mean =     -16.925408425420
             les_mean =     286.806574133941
             stat err =       0.000461726296
             autocorr =       1.264764380812
              std dev =       0.580623746690
             le_variance =       0.337123935220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059202
                                         uncertainty =       0.003032211131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059202
                                         uncertainty =       0.003032211131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562989
  error estimate for blocks of size 2^( 2) =       0.000423358112
  error estimate for blocks of size 2^( 3) =       0.000435936977
  error estimate for blocks of size 2^( 4) =       0.000448044875
  error estimate for blocks of size 2^( 5) =       0.000459216374
  error estimate for blocks of size 2^( 6) =       0.000467370224
  error estimate for blocks of size 2^( 7) =       0.000472273712

      target function =                  N/A
              le_mean =     -16.925408425420
             les_mean =     286.806574133833
             stat err =       0.000461726296
             autocorr =       1.264764380886
              std dev =       0.580623746608
             le_variance =       0.337123935125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059249
                                         uncertainty =       0.003032211131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059249
                                         uncertainty =       0.003032211131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562989
  error estimate for blocks of size 2^( 2) =       0.000423358113
  error estimate for blocks of size 2^( 3) =       0.000435936977
  error estimate for blocks of size 2^( 4) =       0.000448044875
  error estimate for blocks of size 2^( 5) =       0.000459216374
  error estimate for blocks of size 2^( 6) =       0.000467370224
  error estimate for blocks of size 2^( 7) =       0.000472273712

      target function =                  N/A
              le_mean =     -16.925408425420
             les_mean =     286.806574133887
             stat err =       0.000461726296
             autocorr =       1.264764380843
              std dev =       0.580623746649
             le_variance =       0.337123935173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059291
                                         uncertainty =       0.003032211132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337162059291
                                         uncertainty =       0.003032211132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410562989
  error estimate for blocks of size 2^( 2) =       0.000423358113
  error estimate for blocks of size 2^( 3) =       0.000435936977
  error estimate for blocks of size 2^( 4) =       0.000448044875
  error estimate for blocks of size 2^( 5) =       0.000459216374
  error estimate for blocks of size 2^( 6) =       0.000467370224
  error estimate for blocks of size 2^( 7) =       0.000472273712

      target function =                  N/A
              le_mean =     -16.925408425420
             les_mean =     286.806574133934
             stat err =       0.000461726296
             autocorr =       1.264764380815
              std dev =       0.580623746685
             le_variance =       0.337123935214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925408425420        initial  <--
     1.4901e+06     1.4901e+07             2.9040e-10       -16.925408425420
     5.9605e+06     5.9605e+07             7.2599e-11       -16.925408425420
     2.3842e+07     2.3842e+08             1.8150e-11       -16.925408425420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2155
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9287
    reference variance = 0.289801
====================================================
  Execution time = 2.0985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335037068960
                                         uncertainty =       0.003559153350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335037068960
                                         uncertainty =       0.003559153350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409251877
  error estimate for blocks of size 2^( 2) =       0.000421865782
  error estimate for blocks of size 2^( 3) =       0.000434751511
  error estimate for blocks of size 2^( 4) =       0.000446992843
  error estimate for blocks of size 2^( 5) =       0.000456819646
  error estimate for blocks of size 2^( 6) =       0.000464704392
  error estimate for blocks of size 2^( 7) =       0.000468422803

      target function =                  N/A
              le_mean =     -16.924997547384
             les_mean =     286.790516008705
             stat err =       0.000459234921
             autocorr =       1.259181837967
              std dev =       0.578769554530
             le_variance =       0.334974197251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692499754738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924997547384       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924997547384       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924997547384       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924997547384       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924997547384       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924997542598       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924997544032       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924997543255       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.428775e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924997547384       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924997547384       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924997547384       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924997547551       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924997547384       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924997634267       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924997532390       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924997528003       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 6.071634e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924997547384       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924997547384       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924997547384       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924997479885       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924997547384       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924997710104       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924997610303       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924997546213       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.517922e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6484e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.679793
====================================================
  Execution time = 2.2526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.8715e-01
  Total weights = 2.0000e+06
  Execution time = 1.8871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853795
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853795
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439970325
  error estimate for blocks of size 2^( 2) =       0.000451343702
  error estimate for blocks of size 2^( 3) =       0.000463510656
  error estimate for blocks of size 2^( 4) =       0.000474263151
  error estimate for blocks of size 2^( 5) =       0.000484338072
  error estimate for blocks of size 2^( 6) =       0.000491896528
  error estimate for blocks of size 2^( 7) =       0.000496383127

      target function =                  N/A
              le_mean =     -16.924973598594
             les_mean =     286.841878892571
             stat err =       0.000486720219
             autocorr =       1.223804389308
              std dev =       0.622212000066
             le_variance =       0.387147773026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853778
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853778
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439970325
  error estimate for blocks of size 2^( 2) =       0.000451343702
  error estimate for blocks of size 2^( 3) =       0.000463510656
  error estimate for blocks of size 2^( 4) =       0.000474263151
  error estimate for blocks of size 2^( 5) =       0.000484338072
  error estimate for blocks of size 2^( 6) =       0.000491896528
  error estimate for blocks of size 2^( 7) =       0.000496383127

      target function =                  N/A
              le_mean =     -16.924973598594
             les_mean =     286.841878892555
             stat err =       0.000486720219
             autocorr =       1.223804389322
              std dev =       0.622212000053
             le_variance =       0.387147773009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853787
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853787
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439970325
  error estimate for blocks of size 2^( 2) =       0.000451343702
  error estimate for blocks of size 2^( 3) =       0.000463510656
  error estimate for blocks of size 2^( 4) =       0.000474263151
  error estimate for blocks of size 2^( 5) =       0.000484338072
  error estimate for blocks of size 2^( 6) =       0.000491896528
  error estimate for blocks of size 2^( 7) =       0.000496383127

      target function =                  N/A
              le_mean =     -16.924973598594
             les_mean =     286.841878892563
             stat err =       0.000486720219
             autocorr =       1.223804389321
              std dev =       0.622212000059
             le_variance =       0.387147773018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853794
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387263853794
                                         uncertainty =       0.042314622251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439970325
  error estimate for blocks of size 2^( 2) =       0.000451343702
  error estimate for blocks of size 2^( 3) =       0.000463510656
  error estimate for blocks of size 2^( 4) =       0.000474263151
  error estimate for blocks of size 2^( 5) =       0.000484338072
  error estimate for blocks of size 2^( 6) =       0.000491896528
  error estimate for blocks of size 2^( 7) =       0.000496383127

      target function =                  N/A
              le_mean =     -16.924973598594
             les_mean =     286.841878892570
             stat err =       0.000486720219
             autocorr =       1.223804389313
              std dev =       0.622212000065
             le_variance =       0.387147773025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924973598594        initial
     1.4901e+07     1.4901e+08             2.4288e-11       -16.924973598594  <--
     5.9605e+07     5.9605e+08             6.0716e-12       -16.924973598594
     2.3842e+08     2.3842e+09             1.5179e-12       -16.924973598594

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 3.2012e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.178962
====================================================
  Execution time = 2.0916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339769169407
                                         uncertainty =       0.004990161685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339769169407
                                         uncertainty =       0.004990161685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412126537
  error estimate for blocks of size 2^( 2) =       0.000424665090
  error estimate for blocks of size 2^( 3) =       0.000436991965
  error estimate for blocks of size 2^( 4) =       0.000447842967
  error estimate for blocks of size 2^( 5) =       0.000457248825
  error estimate for blocks of size 2^( 6) =       0.000463401743
  error estimate for blocks of size 2^( 7) =       0.000466831048

      target function =                  N/A
              le_mean =     -16.924583701749
             les_mean =     286.781229871992
             stat err =       0.000458831146
             autocorr =       1.239494551352
              std dev =       0.582834937480
             le_variance =       0.339696564348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692458370175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924583701749       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924583701749       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924583701749       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924583701749       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924583701716       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924583701692       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924583701702       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924583701291       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 8.309487e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924583701749       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924583701749       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924583701749       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924583701749       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924583701399       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924583709126       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924583702167       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924583703577       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.077388e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924583701749       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924583701749       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924583701749       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924583724333       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924583699277       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924583701749       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924583702969       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924583689708       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 5.193458e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6435e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.201983
====================================================
  Execution time = 2.0693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4326e-01
  Total weights = 2.0000e+06
  Execution time = 1.8760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764177
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764177
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414282108
  error estimate for blocks of size 2^( 2) =       0.000426743263
  error estimate for blocks of size 2^( 3) =       0.000438934515
  error estimate for blocks of size 2^( 4) =       0.000448885561
  error estimate for blocks of size 2^( 5) =       0.000458481373
  error estimate for blocks of size 2^( 6) =       0.000465092130
  error estimate for blocks of size 2^( 7) =       0.000469570903

      target function =                  N/A
              le_mean =     -16.924784264475
             les_mean =     286.791581558119
             stat err =       0.000460507492
             autocorr =       1.235608947792
              std dev =       0.585883376376
             le_variance =       0.343259330714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764191
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764191
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414282108
  error estimate for blocks of size 2^( 2) =       0.000426743263
  error estimate for blocks of size 2^( 3) =       0.000438934515
  error estimate for blocks of size 2^( 4) =       0.000448885561
  error estimate for blocks of size 2^( 5) =       0.000458481373
  error estimate for blocks of size 2^( 6) =       0.000465092130
  error estimate for blocks of size 2^( 7) =       0.000469570903

      target function =                  N/A
              le_mean =     -16.924784264476
             les_mean =     286.791581558137
             stat err =       0.000460507492
             autocorr =       1.235608947765
              std dev =       0.585883376388
             le_variance =       0.343259330728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764184
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764184
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414282108
  error estimate for blocks of size 2^( 2) =       0.000426743263
  error estimate for blocks of size 2^( 3) =       0.000438934515
  error estimate for blocks of size 2^( 4) =       0.000448885561
  error estimate for blocks of size 2^( 5) =       0.000458481373
  error estimate for blocks of size 2^( 6) =       0.000465092130
  error estimate for blocks of size 2^( 7) =       0.000469570903

      target function =                  N/A
              le_mean =     -16.924784264475
             les_mean =     286.791581558128
             stat err =       0.000460507492
             autocorr =       1.235608947778
              std dev =       0.585883376382
             le_variance =       0.343259330721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764178
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258764178
                                         uncertainty =       0.005403904178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414282108
  error estimate for blocks of size 2^( 2) =       0.000426743263
  error estimate for blocks of size 2^( 3) =       0.000438934515
  error estimate for blocks of size 2^( 4) =       0.000448885561
  error estimate for blocks of size 2^( 5) =       0.000458481373
  error estimate for blocks of size 2^( 6) =       0.000465092130
  error estimate for blocks of size 2^( 7) =       0.000469570903

      target function =                  N/A
              le_mean =     -16.924784264475
             les_mean =     286.791581558120
             stat err =       0.000460507492
             autocorr =       1.235608947793
              std dev =       0.585883376377
             le_variance =       0.343259330715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924784264475        initial
     3.7253e+06     3.7253e+07             8.3095e-11       -16.924784264476  <--
     1.4901e+07     1.4901e+08             2.0774e-11       -16.924784264475
     5.9605e+07     5.9605e+08             5.1935e-12       -16.924784264475

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 3.0158e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9447
    reference variance = 0.410201
====================================================
  Execution time = 2.1215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342802389772
                                         uncertainty =       0.005420835974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342802389772
                                         uncertainty =       0.005420835974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414029419
  error estimate for blocks of size 2^( 2) =       0.000426757201
  error estimate for blocks of size 2^( 3) =       0.000439280390
  error estimate for blocks of size 2^( 4) =       0.000450688650
  error estimate for blocks of size 2^( 5) =       0.000460827812
  error estimate for blocks of size 2^( 6) =       0.000468729678
  error estimate for blocks of size 2^( 7) =       0.000474420053

      target function =                  N/A
              le_mean =     -16.924677898302
             les_mean =     286.787562510079
             stat err =       0.000463666548
             autocorr =       1.254148968660
              std dev =       0.585526020097
             le_variance =       0.342840720211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692467789830e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924677898302       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924677898304       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924677898304       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924677898304       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924677898348       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924677897692       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924677898542       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924677897283       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.852590e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924677898302       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924677898303       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924677898303       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924677897464       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924677899635       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924677900038       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924677897574       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924677895107       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 9.631493e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924677898302       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924677898303       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924677898303       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924677899946       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924677896762       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924677896942       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924677897842       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924677908262       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.407864e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6651e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8441
    reference variance = 0.251132
====================================================
  Execution time = 2.0460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3496e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009546093
                                         uncertainty =       0.003277846492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009546093
                                         uncertainty =       0.003277846492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409243236
  error estimate for blocks of size 2^( 2) =       0.000421797288
  error estimate for blocks of size 2^( 3) =       0.000434475450
  error estimate for blocks of size 2^( 4) =       0.000446038514
  error estimate for blocks of size 2^( 5) =       0.000455666720
  error estimate for blocks of size 2^( 6) =       0.000462152503
  error estimate for blocks of size 2^( 7) =       0.000464674372

      target function =                  N/A
              le_mean =     -16.925698796163
             les_mean =     286.814239622806
             stat err =       0.000457133027
             autocorr =       1.247734487513
              std dev =       0.578757334175
             le_variance =       0.334960051861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009545959
                                         uncertainty =       0.003277846491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009545959
                                         uncertainty =       0.003277846491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409243236
  error estimate for blocks of size 2^( 2) =       0.000421797288
  error estimate for blocks of size 2^( 3) =       0.000434475450
  error estimate for blocks of size 2^( 4) =       0.000446038514
  error estimate for blocks of size 2^( 5) =       0.000455666720
  error estimate for blocks of size 2^( 6) =       0.000462152503
  error estimate for blocks of size 2^( 7) =       0.000464674371

      target function =                  N/A
              le_mean =     -16.925698796163
             les_mean =     286.814239622677
             stat err =       0.000457133027
             autocorr =       1.247734487520
              std dev =       0.578757334059
             le_variance =       0.334960051727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009546026
                                         uncertainty =       0.003277846492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009546026
                                         uncertainty =       0.003277846492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409243236
  error estimate for blocks of size 2^( 2) =       0.000421797288
  error estimate for blocks of size 2^( 3) =       0.000434475450
  error estimate for blocks of size 2^( 4) =       0.000446038514
  error estimate for blocks of size 2^( 5) =       0.000455666720
  error estimate for blocks of size 2^( 6) =       0.000462152503
  error estimate for blocks of size 2^( 7) =       0.000464674372

      target function =                  N/A
              le_mean =     -16.925698796163
             les_mean =     286.814239622742
             stat err =       0.000457133027
             autocorr =       1.247734487512
              std dev =       0.578757334117
             le_variance =       0.334960051794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009546085
                                         uncertainty =       0.003277846492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335009546085
                                         uncertainty =       0.003277846492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409243236
  error estimate for blocks of size 2^( 2) =       0.000421797288
  error estimate for blocks of size 2^( 3) =       0.000434475450
  error estimate for blocks of size 2^( 4) =       0.000446038514
  error estimate for blocks of size 2^( 5) =       0.000455666720
  error estimate for blocks of size 2^( 6) =       0.000462152503
  error estimate for blocks of size 2^( 7) =       0.000464674372

      target function =                  N/A
              le_mean =     -16.925698796163
             les_mean =     286.814239622798
             stat err =       0.000457133027
             autocorr =       1.247734487519
              std dev =       0.578757334167
             le_variance =       0.334960051853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925698796163        initial
     9.3132e+05     9.3132e+06             3.8526e-10       -16.925698796163  <--
     3.7253e+06     3.7253e+07             9.6315e-11       -16.925698796163
     1.4901e+07     1.4901e+08             2.4079e-11       -16.925698796163

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 2.9958e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6614e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.452288
====================================================
  Execution time = 2.2662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.7994e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380113628827
                                         uncertainty =       0.031881123430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380113628827
                                         uncertainty =       0.031881123430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435857402
  error estimate for blocks of size 2^( 2) =       0.000447673888
  error estimate for blocks of size 2^( 3) =       0.000460060680
  error estimate for blocks of size 2^( 4) =       0.000471137554
  error estimate for blocks of size 2^( 5) =       0.000481534131
  error estimate for blocks of size 2^( 6) =       0.000489548776
  error estimate for blocks of size 2^( 7) =       0.000492805121

      target function =                  N/A
              le_mean =     -16.924857339581
             les_mean =     286.830739124820
             stat err =       0.000483756395
             autocorr =       1.231869174058
              std dev =       0.616395449052
             le_variance =       0.379943349612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692485733958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924857339581       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924857339595       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924857339593       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924857339582       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924857339760       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924857339615       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924857339611       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924857339558       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.443505e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924857339581       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924857339585       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924857339584       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924857339584       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924857339213       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924857339554       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924857339725       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924857339313       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.608763e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924857339581       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924857339582       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924857339582       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924857339190       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924857340363       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924857340096       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924857339592       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924857341617       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 9.021911e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8197e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8603
    reference variance = 0.474349
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3804e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718691
                                         uncertainty =       0.003552123234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718691
                                         uncertainty =       0.003552123234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411117683
  error estimate for blocks of size 2^( 2) =       0.000423574156
  error estimate for blocks of size 2^( 3) =       0.000436813002
  error estimate for blocks of size 2^( 4) =       0.000448647753
  error estimate for blocks of size 2^( 5) =       0.000458586255
  error estimate for blocks of size 2^( 6) =       0.000466646968
  error estimate for blocks of size 2^( 7) =       0.000470294659

      target function =                  N/A
              le_mean =     -16.924447293134
             les_mean =     286.774951507401
             stat err =       0.000461043909
             autocorr =       1.257628187877
              std dev =       0.581408202856
             le_variance =       0.338035498348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718546
                                         uncertainty =       0.003552123233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718546
                                         uncertainty =       0.003552123233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411117683
  error estimate for blocks of size 2^( 2) =       0.000423574156
  error estimate for blocks of size 2^( 3) =       0.000436813002
  error estimate for blocks of size 2^( 4) =       0.000448647753
  error estimate for blocks of size 2^( 5) =       0.000458586254
  error estimate for blocks of size 2^( 6) =       0.000466646968
  error estimate for blocks of size 2^( 7) =       0.000470294659

      target function =                  N/A
              le_mean =     -16.924447293131
             les_mean =     286.774951507144
             stat err =       0.000461043908
             autocorr =       1.257628187695
              std dev =       0.581408202731
             le_variance =       0.338035498203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718618
                                         uncertainty =       0.003552123233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718618
                                         uncertainty =       0.003552123233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411117683
  error estimate for blocks of size 2^( 2) =       0.000423574156
  error estimate for blocks of size 2^( 3) =       0.000436813002
  error estimate for blocks of size 2^( 4) =       0.000448647753
  error estimate for blocks of size 2^( 5) =       0.000458586255
  error estimate for blocks of size 2^( 6) =       0.000466646968
  error estimate for blocks of size 2^( 7) =       0.000470294659

      target function =                  N/A
              le_mean =     -16.924447293132
             les_mean =     286.774951507272
             stat err =       0.000461043908
             autocorr =       1.257628187790
              std dev =       0.581408202794
             le_variance =       0.338035498276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718682
                                         uncertainty =       0.003552123234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338118718682
                                         uncertainty =       0.003552123234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411117683
  error estimate for blocks of size 2^( 2) =       0.000423574156
  error estimate for blocks of size 2^( 3) =       0.000436813002
  error estimate for blocks of size 2^( 4) =       0.000448647753
  error estimate for blocks of size 2^( 5) =       0.000458586255
  error estimate for blocks of size 2^( 6) =       0.000466646968
  error estimate for blocks of size 2^( 7) =       0.000470294659

      target function =                  N/A
              le_mean =     -16.924447293134
             les_mean =     286.774951507385
             stat err =       0.000461043909
             autocorr =       1.257628187871
              std dev =       0.581408202848
             le_variance =       0.338035498339


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924447293134        initial  <--
     2.3283e+05     2.3283e+06             1.4435e-09       -16.924447293131
     9.3132e+05     9.3132e+06             3.6088e-10       -16.924447293132
     3.7253e+06     3.7253e+07             9.0219e-11       -16.924447293134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9033
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8708
    reference variance = 0.224565
====================================================
  Execution time = 2.0766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344730884954
                                         uncertainty =       0.005070968318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344730884954
                                         uncertainty =       0.005070968318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415135148
  error estimate for blocks of size 2^( 2) =       0.000427105544
  error estimate for blocks of size 2^( 3) =       0.000439547118
  error estimate for blocks of size 2^( 4) =       0.000450861129
  error estimate for blocks of size 2^( 5) =       0.000461265352
  error estimate for blocks of size 2^( 6) =       0.000468245414
  error estimate for blocks of size 2^( 7) =       0.000472362736

      target function =                  N/A
              le_mean =     -16.924648866943
             les_mean =     286.788413478680
             stat err =       0.000463183658
             autocorr =       1.244879875604
              std dev =       0.587089756094
             le_variance =       0.344674381711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692464886694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924648866943       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924648866944       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924648866944       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924648866944       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924648868357       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924648866872       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924648867723       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924648868017       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.413537e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924648866943       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924648866943       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924648866943       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924648866985       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924648867490       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924648865849       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924648868476       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924648860798       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.533857e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924648866943       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924648866943       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924648866943       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924648866943       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924648864611       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924648872626       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924648871035       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924648859140       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 8.834601e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6349e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9045
    reference variance = 0.311339
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3720e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845284
                                         uncertainty =       0.003132248720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845284
                                         uncertainty =       0.003132248720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410611706
  error estimate for blocks of size 2^( 2) =       0.000423003611
  error estimate for blocks of size 2^( 3) =       0.000435354261
  error estimate for blocks of size 2^( 4) =       0.000446896534
  error estimate for blocks of size 2^( 5) =       0.000456865353
  error estimate for blocks of size 2^( 6) =       0.000463524579
  error estimate for blocks of size 2^( 7) =       0.000464132782

      target function =                  N/A
              le_mean =     -16.925520881472
             les_mean =     286.810460887117
             stat err =       0.000457854812
             autocorr =       1.243348607768
              std dev =       0.580692643802
             le_variance =       0.337203946566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845220
                                         uncertainty =       0.003132248719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845220
                                         uncertainty =       0.003132248719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410611706
  error estimate for blocks of size 2^( 2) =       0.000423003611
  error estimate for blocks of size 2^( 3) =       0.000435354261
  error estimate for blocks of size 2^( 4) =       0.000446896534
  error estimate for blocks of size 2^( 5) =       0.000456865353
  error estimate for blocks of size 2^( 6) =       0.000463524579
  error estimate for blocks of size 2^( 7) =       0.000464132782

      target function =                  N/A
              le_mean =     -16.925520881472
             les_mean =     286.810460887037
             stat err =       0.000457854812
             autocorr =       1.243348607808
              std dev =       0.580692643747
             le_variance =       0.337203946502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845252
                                         uncertainty =       0.003132248720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845252
                                         uncertainty =       0.003132248720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410611706
  error estimate for blocks of size 2^( 2) =       0.000423003611
  error estimate for blocks of size 2^( 3) =       0.000435354261
  error estimate for blocks of size 2^( 4) =       0.000446896534
  error estimate for blocks of size 2^( 5) =       0.000456865353
  error estimate for blocks of size 2^( 6) =       0.000463524579
  error estimate for blocks of size 2^( 7) =       0.000464132782

      target function =                  N/A
              le_mean =     -16.925520881472
             les_mean =     286.810460887077
             stat err =       0.000457854812
             autocorr =       1.243348607788
              std dev =       0.580692643774
             le_variance =       0.337203946534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845280
                                         uncertainty =       0.003132248720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337235845280
                                         uncertainty =       0.003132248720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410611706
  error estimate for blocks of size 2^( 2) =       0.000423003611
  error estimate for blocks of size 2^( 3) =       0.000435354261
  error estimate for blocks of size 2^( 4) =       0.000446896534
  error estimate for blocks of size 2^( 5) =       0.000456865353
  error estimate for blocks of size 2^( 6) =       0.000463524579
  error estimate for blocks of size 2^( 7) =       0.000464132782

      target function =                  N/A
              le_mean =     -16.925520881472
             les_mean =     286.810460887112
             stat err =       0.000457854812
             autocorr =       1.243348607771
              std dev =       0.580692643798
             le_variance =       0.337203946562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925520881472        initial  <--
     2.3283e+06     2.3283e+07             1.4135e-10       -16.925520881472
     9.3132e+06     9.3132e+07             3.5339e-11       -16.925520881472
     3.7253e+07     3.7253e+08             8.8346e-12       -16.925520881472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0441
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.169248
====================================================
  Execution time = 2.0695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3650e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336541336399
                                         uncertainty =       0.003574802318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336541336399
                                         uncertainty =       0.003574802318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410184627
  error estimate for blocks of size 2^( 2) =       0.000422485966
  error estimate for blocks of size 2^( 3) =       0.000434822193
  error estimate for blocks of size 2^( 4) =       0.000446707057
  error estimate for blocks of size 2^( 5) =       0.000456341921
  error estimate for blocks of size 2^( 6) =       0.000463374450
  error estimate for blocks of size 2^( 7) =       0.000466483224

      target function =                  N/A
              le_mean =     -16.924038249640
             les_mean =     286.759573363926
             stat err =       0.000458226663
             autocorr =       1.247963696121
              std dev =       0.580088662960
             le_variance =       0.336502856895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692403824964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924038249640       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924038249640       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924038249640       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924038249640       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924038249640       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924038260005       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924038227057       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924038257063       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924038256083       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.324354e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924038249640       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924038249640       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924038249640       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924038249640       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924038256070       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924038230300       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924038189224       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924038162012       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924038244792       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.310448e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924038249640       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924038249640       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924038249640       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924038249640       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924038270157       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924038100614       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924038338758       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924038255945       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924037945888       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 8.276926e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6197e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.324399
====================================================
  Execution time = 2.0809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4934e-01
  Total weights = 2.0000e+06
  Execution time = 2.1267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417936142
  error estimate for blocks of size 2^( 2) =       0.000430205325
  error estimate for blocks of size 2^( 3) =       0.000442340889
  error estimate for blocks of size 2^( 4) =       0.000454105491
  error estimate for blocks of size 2^( 5) =       0.000463440523
  error estimate for blocks of size 2^( 6) =       0.000469567206
  error estimate for blocks of size 2^( 7) =       0.000476735340

      target function =                  N/A
              le_mean =     -16.923878896826
             les_mean =     286.767017977184
             stat err =       0.000465962140
             autocorr =       1.243029409476
              std dev =       0.591050960083
             le_variance =       0.349341237415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417936142
  error estimate for blocks of size 2^( 2) =       0.000430205325
  error estimate for blocks of size 2^( 3) =       0.000442340889
  error estimate for blocks of size 2^( 4) =       0.000454105491
  error estimate for blocks of size 2^( 5) =       0.000463440523
  error estimate for blocks of size 2^( 6) =       0.000469567206
  error estimate for blocks of size 2^( 7) =       0.000476735340

      target function =                  N/A
              le_mean =     -16.923878896826
             les_mean =     286.767017977187
             stat err =       0.000465962140
             autocorr =       1.243029409481
              std dev =       0.591050960082
             le_variance =       0.349341237414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417936142
  error estimate for blocks of size 2^( 2) =       0.000430205325
  error estimate for blocks of size 2^( 3) =       0.000442340889
  error estimate for blocks of size 2^( 4) =       0.000454105491
  error estimate for blocks of size 2^( 5) =       0.000463440523
  error estimate for blocks of size 2^( 6) =       0.000469567206
  error estimate for blocks of size 2^( 7) =       0.000476735340

      target function =                  N/A
              le_mean =     -16.923878896826
             les_mean =     286.767017977185
             stat err =       0.000465962140
             autocorr =       1.243029409483
              std dev =       0.591050960082
             le_variance =       0.349341237414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349227291328
                                         uncertainty =       0.004945484922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417936142
  error estimate for blocks of size 2^( 2) =       0.000430205325
  error estimate for blocks of size 2^( 3) =       0.000442340889
  error estimate for blocks of size 2^( 4) =       0.000454105491
  error estimate for blocks of size 2^( 5) =       0.000463440523
  error estimate for blocks of size 2^( 6) =       0.000469567206
  error estimate for blocks of size 2^( 7) =       0.000476735340

      target function =                  N/A
              le_mean =     -16.923878896826
             les_mean =     286.767017977184
             stat err =       0.000465962140
             autocorr =       1.243029409479
              std dev =       0.591050960082
             le_variance =       0.349341237414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923878896826        initial
     2.3283e+07     2.3283e+08             1.3244e-11       -16.923878896826  <--
     9.3132e+07     9.3132e+08             3.3104e-12       -16.923878896826
     3.7253e+08     3.7253e+09             8.2769e-13       -16.923878896826

*****************************************************************************
Applying the update for shift_i =   2.3283e+07     and shift_s =   2.3283e+08
*****************************************************************************

  Execution time = 3.2277e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.414195
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334325092036
                                         uncertainty =       0.003584377997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334325092036
                                         uncertainty =       0.003584377997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408839066
  error estimate for blocks of size 2^( 2) =       0.000420963775
  error estimate for blocks of size 2^( 3) =       0.000433515931
  error estimate for blocks of size 2^( 4) =       0.000445086354
  error estimate for blocks of size 2^( 5) =       0.000454796584
  error estimate for blocks of size 2^( 6) =       0.000462449021
  error estimate for blocks of size 2^( 7) =       0.000469852857

      target function =                  N/A
              le_mean =     -16.925652767483
             les_mean =     286.812020201254
             stat err =       0.000458046204
             autocorr =       1.255202520328
              std dev =       0.578185751303
             le_variance =       0.334298763010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692565276748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925652767483       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925652767483       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925652767483       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925652767483       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925652767423       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925652760694       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925652769020       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925652768674       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 6.074585e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925652767483       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925652767483       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925652767483       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925652754124       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925652767483       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925652769538       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925652765751       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925652772118       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.518653e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925652767483       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925652767483       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925652767483       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925652769569       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925652785638       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925652770877       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925652795626       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925652752616       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.796705e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6260e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9115
    reference variance = 0.296634
====================================================
  Execution time = 2.0548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3752e-01
  Total weights = 2.0000e+06
  Execution time = 1.8788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177393
                                         uncertainty =       0.003090818695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177393
                                         uncertainty =       0.003090818695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410803707
  error estimate for blocks of size 2^( 2) =       0.000423734699
  error estimate for blocks of size 2^( 3) =       0.000436734304
  error estimate for blocks of size 2^( 4) =       0.000448415513
  error estimate for blocks of size 2^( 5) =       0.000458856087
  error estimate for blocks of size 2^( 6) =       0.000465554645
  error estimate for blocks of size 2^( 7) =       0.000470060410

      target function =                  N/A
              le_mean =     -16.924701140119
             les_mean =     286.783027885387
             stat err =       0.000460721664
             autocorr =       1.257791220780
              std dev =       0.580964174289
             le_variance =       0.337519371808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177380
                                         uncertainty =       0.003090818694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177380
                                         uncertainty =       0.003090818694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410803707
  error estimate for blocks of size 2^( 2) =       0.000423734699
  error estimate for blocks of size 2^( 3) =       0.000436734304
  error estimate for blocks of size 2^( 4) =       0.000448415513
  error estimate for blocks of size 2^( 5) =       0.000458856087
  error estimate for blocks of size 2^( 6) =       0.000465554645
  error estimate for blocks of size 2^( 7) =       0.000470060410

      target function =                  N/A
              le_mean =     -16.924701140119
             les_mean =     286.783027885375
             stat err =       0.000460721664
             autocorr =       1.257791220779
              std dev =       0.580964174278
             le_variance =       0.337519371795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177386
                                         uncertainty =       0.003090818694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177386
                                         uncertainty =       0.003090818694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410803707
  error estimate for blocks of size 2^( 2) =       0.000423734699
  error estimate for blocks of size 2^( 3) =       0.000436734304
  error estimate for blocks of size 2^( 4) =       0.000448415513
  error estimate for blocks of size 2^( 5) =       0.000458856087
  error estimate for blocks of size 2^( 6) =       0.000465554645
  error estimate for blocks of size 2^( 7) =       0.000470060410

      target function =                  N/A
              le_mean =     -16.924701140119
             les_mean =     286.783027885381
             stat err =       0.000460721664
             autocorr =       1.257791220781
              std dev =       0.580964174284
             le_variance =       0.337519371801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177392
                                         uncertainty =       0.003090818694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337460177392
                                         uncertainty =       0.003090818694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410803707
  error estimate for blocks of size 2^( 2) =       0.000423734699
  error estimate for blocks of size 2^( 3) =       0.000436734304
  error estimate for blocks of size 2^( 4) =       0.000448415513
  error estimate for blocks of size 2^( 5) =       0.000458856087
  error estimate for blocks of size 2^( 6) =       0.000465554645
  error estimate for blocks of size 2^( 7) =       0.000470060410

      target function =                  N/A
              le_mean =     -16.924701140119
             les_mean =     286.783027885386
             stat err =       0.000460721664
             autocorr =       1.257791220784
              std dev =       0.580964174289
             le_variance =       0.337519371807


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924701140119        initial
     5.8208e+06     5.8208e+07             6.0746e-11       -16.924701140119  <--
     2.3283e+07     2.3283e+08             1.5187e-11       -16.924701140119
     9.3132e+07     9.3132e+08             3.7967e-12       -16.924701140119

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 3.0057e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6323e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9944
    reference variance = 0.265063
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346348913256
                                         uncertainty =       0.012083935089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346348913256
                                         uncertainty =       0.012083935089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416239271
  error estimate for blocks of size 2^( 2) =       0.000428806147
  error estimate for blocks of size 2^( 3) =       0.000441543994
  error estimate for blocks of size 2^( 4) =       0.000453299699
  error estimate for blocks of size 2^( 5) =       0.000463831892
  error estimate for blocks of size 2^( 6) =       0.000472336637
  error estimate for blocks of size 2^( 7) =       0.000478696266

      target function =                  N/A
              le_mean =     -16.924294208810
             les_mean =     286.778244554196
             stat err =       0.000467041124
             autocorr =       1.258995392412
              std dev =       0.588651221945
             le_variance =       0.346510261097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692429420881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924294208810       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924294208811       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924294208812       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924294208813       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924294208928       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924294208813       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924294208813       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924294208234       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.286549e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924294208810       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924294208810       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924294208810       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924294208811       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924294208811       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924294208811       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924294208732       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924294210058       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 5.716374e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924294208810       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924294208810       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924294208810       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924294208810       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924294208810       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924294208806       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924294206189       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924294192839       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.429101e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195478 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6593e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9223
    reference variance = 0.207944
====================================================
  Execution time = 2.0672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3436e-01
  Total weights = 2.0000e+06
  Execution time = 1.8785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567327
                                         uncertainty =       0.003901698980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567327
                                         uncertainty =       0.003901698980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408876950
  error estimate for blocks of size 2^( 2) =       0.000421407121
  error estimate for blocks of size 2^( 3) =       0.000433844339
  error estimate for blocks of size 2^( 4) =       0.000445174529
  error estimate for blocks of size 2^( 5) =       0.000454151578
  error estimate for blocks of size 2^( 6) =       0.000461673219
  error estimate for blocks of size 2^( 7) =       0.000465306805

      target function =                  N/A
              le_mean =     -16.924998024170
             les_mean =     286.789918670781
             stat err =       0.000456576533
             autocorr =       1.246929546387
              std dev =       0.578239327444
             le_variance =       0.334360719803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567367
                                         uncertainty =       0.003901698978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567367
                                         uncertainty =       0.003901698978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408876950
  error estimate for blocks of size 2^( 2) =       0.000421407121
  error estimate for blocks of size 2^( 3) =       0.000433844339
  error estimate for blocks of size 2^( 4) =       0.000445174529
  error estimate for blocks of size 2^( 5) =       0.000454151578
  error estimate for blocks of size 2^( 6) =       0.000461673219
  error estimate for blocks of size 2^( 7) =       0.000465306805

      target function =                  N/A
              le_mean =     -16.924998024170
             les_mean =     286.789918670835
             stat err =       0.000456576533
             autocorr =       1.246929546331
              std dev =       0.578239327479
             le_variance =       0.334360719843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567347
                                         uncertainty =       0.003901698979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567347
                                         uncertainty =       0.003901698979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408876950
  error estimate for blocks of size 2^( 2) =       0.000421407121
  error estimate for blocks of size 2^( 3) =       0.000433844339
  error estimate for blocks of size 2^( 4) =       0.000445174529
  error estimate for blocks of size 2^( 5) =       0.000454151578
  error estimate for blocks of size 2^( 6) =       0.000461673219
  error estimate for blocks of size 2^( 7) =       0.000465306805

      target function =                  N/A
              le_mean =     -16.924998024170
             les_mean =     286.789918670808
             stat err =       0.000456576533
             autocorr =       1.246929546354
              std dev =       0.578239327461
             le_variance =       0.334360719823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567330
                                         uncertainty =       0.003901698980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334356567330
                                         uncertainty =       0.003901698980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408876950
  error estimate for blocks of size 2^( 2) =       0.000421407121
  error estimate for blocks of size 2^( 3) =       0.000433844339
  error estimate for blocks of size 2^( 4) =       0.000445174529
  error estimate for blocks of size 2^( 5) =       0.000454151578
  error estimate for blocks of size 2^( 6) =       0.000461673219
  error estimate for blocks of size 2^( 7) =       0.000465306805

      target function =                  N/A
              le_mean =     -16.924998024170
             les_mean =     286.789918670785
             stat err =       0.000456576533
             autocorr =       1.246929546389
              std dev =       0.578239327446
             le_variance =       0.334360719805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924998024170        initial
     1.4552e+06     1.4552e+07             2.2865e-10       -16.924998024170  <--
     5.8208e+06     5.8208e+07             5.7164e-11       -16.924998024170
     2.3283e+07     2.3283e+08             1.4291e-11       -16.924998024170

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 3.0172e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9431
    reference variance = 0.278286
====================================================
  Execution time = 2.2691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4460e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344728354919
                                         uncertainty =       0.005209969689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344728354919
                                         uncertainty =       0.005209969689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415090084
  error estimate for blocks of size 2^( 2) =       0.000427362138
  error estimate for blocks of size 2^( 3) =       0.000440139722
  error estimate for blocks of size 2^( 4) =       0.000451818364
  error estimate for blocks of size 2^( 5) =       0.000461885281
  error estimate for blocks of size 2^( 6) =       0.000469733357
  error estimate for blocks of size 2^( 7) =       0.000473066015

      target function =                  N/A
              le_mean =     -16.924847382209
             les_mean =     286.795058294806
             stat err =       0.000464125754
             autocorr =       1.250220506934
              std dev =       0.587026026708
             le_variance =       0.344599556032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692484738221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924847382209       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924847382216       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924847382219       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924847382224       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924847382151       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924847382237       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924847382251       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924847382249       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.120328e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924847382209       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924847382211       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924847382212       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924847382213       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924847382122       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924847381908       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924847382213       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924847382222       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.800819e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924847382209       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924847382210       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924847382210       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924847382611       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924847382210       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924847378630       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924847383191       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924847385586       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 7.002035e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8238e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502268e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8452
    reference variance = 0.19581
====================================================
  Execution time = 2.0550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3912e-01
  Total weights = 2.0000e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878617
                                         uncertainty =       0.004667458335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878617
                                         uncertainty =       0.004667458335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778550
  error estimate for blocks of size 2^( 2) =       0.000424413138
  error estimate for blocks of size 2^( 3) =       0.000436891385
  error estimate for blocks of size 2^( 4) =       0.000449527163
  error estimate for blocks of size 2^( 5) =       0.000460960184
  error estimate for blocks of size 2^( 6) =       0.000470018941
  error estimate for blocks of size 2^( 7) =       0.000476351283

      target function =                  N/A
              le_mean =     -16.924325437554
             les_mean =     286.771914495288
             stat err =       0.000464214393
             autocorr =       1.270895269508
              std dev =       0.582342810213
             le_variance =       0.339123148606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878611
                                         uncertainty =       0.004667458339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878611
                                         uncertainty =       0.004667458339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778550
  error estimate for blocks of size 2^( 2) =       0.000424413138
  error estimate for blocks of size 2^( 3) =       0.000436891385
  error estimate for blocks of size 2^( 4) =       0.000449527163
  error estimate for blocks of size 2^( 5) =       0.000460960184
  error estimate for blocks of size 2^( 6) =       0.000470018941
  error estimate for blocks of size 2^( 7) =       0.000476351283

      target function =                  N/A
              le_mean =     -16.924325437558
             les_mean =     286.771914495413
             stat err =       0.000464214393
             autocorr =       1.270895269361
              std dev =       0.582342810208
             le_variance =       0.339123148601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878614
                                         uncertainty =       0.004667458337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878614
                                         uncertainty =       0.004667458337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778550
  error estimate for blocks of size 2^( 2) =       0.000424413138
  error estimate for blocks of size 2^( 3) =       0.000436891385
  error estimate for blocks of size 2^( 4) =       0.000449527163
  error estimate for blocks of size 2^( 5) =       0.000460960184
  error estimate for blocks of size 2^( 6) =       0.000470018941
  error estimate for blocks of size 2^( 7) =       0.000476351283

      target function =                  N/A
              le_mean =     -16.924325437556
             les_mean =     286.771914495350
             stat err =       0.000464214393
             autocorr =       1.270895269429
              std dev =       0.582342810210
             le_variance =       0.339123148603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878617
                                         uncertainty =       0.004667458335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339089878617
                                         uncertainty =       0.004667458335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778550
  error estimate for blocks of size 2^( 2) =       0.000424413138
  error estimate for blocks of size 2^( 3) =       0.000436891385
  error estimate for blocks of size 2^( 4) =       0.000449527163
  error estimate for blocks of size 2^( 5) =       0.000460960184
  error estimate for blocks of size 2^( 6) =       0.000470018941
  error estimate for blocks of size 2^( 7) =       0.000476351283

      target function =                  N/A
              le_mean =     -16.924325437554
             les_mean =     286.771914495296
             stat err =       0.000464214393
             autocorr =       1.270895269487
              std dev =       0.582342810212
             le_variance =       0.339123148606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924325437554        initial
     3.6380e+05     3.6380e+06             1.1203e-09       -16.924325437558  <--
     1.4552e+06     1.4552e+07             2.8008e-10       -16.924325437556
     5.8208e+06     5.8208e+07             7.0020e-11       -16.924325437554

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 3.0057e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502267e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8302e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9605
    reference variance = 0.221647
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.6043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360545951193
                                         uncertainty =       0.027055297536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360545951193
                                         uncertainty =       0.027055297536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424515603
  error estimate for blocks of size 2^( 2) =       0.000436771799
  error estimate for blocks of size 2^( 3) =       0.000449286985
  error estimate for blocks of size 2^( 4) =       0.000460686901
  error estimate for blocks of size 2^( 5) =       0.000470635613
  error estimate for blocks of size 2^( 6) =       0.000478993805
  error estimate for blocks of size 2^( 7) =       0.000481121605

      target function =                  N/A
              le_mean =     -16.925066730367
             les_mean =     286.818310642025
             stat err =       0.000472859481
             autocorr =       1.240728868157
              std dev =       0.600355723598
             le_variance =       0.360426994857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692506673037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925066730367       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925066730392       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925066730390       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925066730399       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925066730415       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925066730401       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925066730362       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925066730386       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 4.575452e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925066730367       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925066730373       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925066730373       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925066730375       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925066730375       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925066730264       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925066730358       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925066730801       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.143863e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925066730367       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925066730369       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925066730369       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925066730369       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925066729936       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925066733323       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925066736321       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925066731467       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.859667e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6267e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291575e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464373e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502267e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9602
    reference variance = 0.154074
====================================================
  Execution time = 2.0814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4651e-01
  Total weights = 2.0000e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560632173
                                         uncertainty =       0.010746960057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560632173
                                         uncertainty =       0.010746960057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416240335
  error estimate for blocks of size 2^( 2) =       0.000428693659
  error estimate for blocks of size 2^( 3) =       0.000441762336
  error estimate for blocks of size 2^( 4) =       0.000453500406
  error estimate for blocks of size 2^( 5) =       0.000463498001
  error estimate for blocks of size 2^( 6) =       0.000469971001
  error estimate for blocks of size 2^( 7) =       0.000473760141

      target function =                  N/A
              le_mean =     -16.924232659726
             les_mean =     286.776162980178
             stat err =       0.000465182387
             autocorr =       1.248987814947
              std dev =       0.588652726904
             le_variance =       0.346512032892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560631954
                                         uncertainty =       0.010746960117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560631954
                                         uncertainty =       0.010746960117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416240335
  error estimate for blocks of size 2^( 2) =       0.000428693658
  error estimate for blocks of size 2^( 3) =       0.000441762336
  error estimate for blocks of size 2^( 4) =       0.000453500406
  error estimate for blocks of size 2^( 5) =       0.000463498000
  error estimate for blocks of size 2^( 6) =       0.000469971001
  error estimate for blocks of size 2^( 7) =       0.000473760141

      target function =                  N/A
              le_mean =     -16.924232659727
             les_mean =     286.776162979980
             stat err =       0.000465182387
             autocorr =       1.248987814339
              std dev =       0.588652726718
             le_variance =       0.346512032673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560632064
                                         uncertainty =       0.010746960087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560632064
                                         uncertainty =       0.010746960087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416240335
  error estimate for blocks of size 2^( 2) =       0.000428693659
  error estimate for blocks of size 2^( 3) =       0.000441762336
  error estimate for blocks of size 2^( 4) =       0.000453500406
  error estimate for blocks of size 2^( 5) =       0.000463498000
  error estimate for blocks of size 2^( 6) =       0.000469971001
  error estimate for blocks of size 2^( 7) =       0.000473760141

      target function =                  N/A
              le_mean =     -16.924232659726
             les_mean =     286.776162980079
             stat err =       0.000465182387
             autocorr =       1.248987814642
              std dev =       0.588652726811
             le_variance =       0.346512032782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560632159
                                         uncertainty =       0.010746960061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346560632159
                                         uncertainty =       0.010746960061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416240335
  error estimate for blocks of size 2^( 2) =       0.000428693659
  error estimate for blocks of size 2^( 3) =       0.000441762336
  error estimate for blocks of size 2^( 4) =       0.000453500406
  error estimate for blocks of size 2^( 5) =       0.000463498001
  error estimate for blocks of size 2^( 6) =       0.000469971001
  error estimate for blocks of size 2^( 7) =       0.000473760141

      target function =                  N/A
              le_mean =     -16.924232659726
             les_mean =     286.776162980165
             stat err =       0.000465182387
             autocorr =       1.248987814910
              std dev =       0.588652726893
             le_variance =       0.346512032878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924232659726        initial
     9.0949e+04     9.0949e+05             4.5755e-09       -16.924232659727  <--
     3.6380e+05     3.6380e+06             1.1439e-09       -16.924232659726
     1.4552e+06     1.4552e+07             2.8597e-10       -16.924232659726

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 3.0342e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291574e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694823e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480794e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464372e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054163e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502266e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8562
    reference variance = 0.191825
====================================================
  Execution time = 2.0773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3716e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337190176813
                                         uncertainty =       0.003945816080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337190176813
                                         uncertainty =       0.003945816080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410585581
  error estimate for blocks of size 2^( 2) =       0.000422885951
  error estimate for blocks of size 2^( 3) =       0.000436155796
  error estimate for blocks of size 2^( 4) =       0.000447457101
  error estimate for blocks of size 2^( 5) =       0.000456179507
  error estimate for blocks of size 2^( 6) =       0.000462696362
  error estimate for blocks of size 2^( 7) =       0.000466065443

      target function =                  N/A
              le_mean =     -16.925201348710
             les_mean =     286.799601563782
             stat err =       0.000458099603
             autocorr =       1.244836874393
              std dev =       0.580655696597
             le_variance =       0.337161037991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692520134871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925201348710       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925201348789       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925201348808       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925201348774       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925201348843       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925201348885       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925201348860       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925201348879       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.549090e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925201348710       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925201348730       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925201348734       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925201348720       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925201348757       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925201348779       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925201348751       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925201348633       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.872736e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925201348710       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925201348715       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925201348716       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925201348714       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925201348898       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925201348812       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925201348589       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925201348869       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 9.681846e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6275e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.320999e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291574e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400753e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578527e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672840e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492309e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895812e-02 1 1  ON 33
eH1_4                 5.480793e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464372e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527798e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054164e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502265e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784998e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8414
    reference variance = 0.212329
====================================================
  Execution time = 2.0671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4732e-01
  Total weights = 2.0000e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357251380
                                         uncertainty =       0.010040346658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357251380
                                         uncertainty =       0.010040346658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416723586
  error estimate for blocks of size 2^( 2) =       0.000428704222
  error estimate for blocks of size 2^( 3) =       0.000441857594
  error estimate for blocks of size 2^( 4) =       0.000452318299
  error estimate for blocks of size 2^( 5) =       0.000461487975
  error estimate for blocks of size 2^( 6) =       0.000469014959
  error estimate for blocks of size 2^( 7) =       0.000472567825

      target function =                  N/A
              le_mean =     -16.924787896531
             les_mean =     286.795762263715
             stat err =       0.000463847264
             autocorr =       1.238950157414
              std dev =       0.589336147540
             le_variance =       0.347317094798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357245402
                                         uncertainty =       0.010040346288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357245402
                                         uncertainty =       0.010040346288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416723583
  error estimate for blocks of size 2^( 2) =       0.000428704219
  error estimate for blocks of size 2^( 3) =       0.000441857590
  error estimate for blocks of size 2^( 4) =       0.000452318295
  error estimate for blocks of size 2^( 5) =       0.000461487971
  error estimate for blocks of size 2^( 6) =       0.000469014955
  error estimate for blocks of size 2^( 7) =       0.000472567822

      target function =                  N/A
              le_mean =     -16.924787896573
             les_mean =     286.795762259144
             stat err =       0.000463847261
             autocorr =       1.238950160604
              std dev =       0.589336142470
             le_variance =       0.347317088822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357248391
                                         uncertainty =       0.010040346473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357248391
                                         uncertainty =       0.010040346473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416723585
  error estimate for blocks of size 2^( 2) =       0.000428704221
  error estimate for blocks of size 2^( 3) =       0.000441857592
  error estimate for blocks of size 2^( 4) =       0.000452318297
  error estimate for blocks of size 2^( 5) =       0.000461487973
  error estimate for blocks of size 2^( 6) =       0.000469014957
  error estimate for blocks of size 2^( 7) =       0.000472567824

      target function =                  N/A
              le_mean =     -16.924787896552
             les_mean =     286.795762261429
             stat err =       0.000463847263
             autocorr =       1.238950159012
              std dev =       0.589336145005
             le_variance =       0.347317091810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357251006
                                         uncertainty =       0.010040346635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347357251006
                                         uncertainty =       0.010040346635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416723586
  error estimate for blocks of size 2^( 2) =       0.000428704222
  error estimate for blocks of size 2^( 3) =       0.000441857593
  error estimate for blocks of size 2^( 4) =       0.000452318298
  error estimate for blocks of size 2^( 5) =       0.000461487975
  error estimate for blocks of size 2^( 6) =       0.000469014958
  error estimate for blocks of size 2^( 7) =       0.000472567825

      target function =                  N/A
              le_mean =     -16.924787896534
             les_mean =     286.795762263429
             stat err =       0.000463847264
             autocorr =       1.238950157609
              std dev =       0.589336147223
             le_variance =       0.347317094424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924787896531        initial
     2.2737e+04     2.2737e+05             1.5491e-08       -16.924787896573  <--
     9.0949e+04     9.0949e+05             3.8727e-09       -16.924787896552
     3.6380e+05     3.6380e+06             9.6818e-10       -16.924787896534

*****************************************************************************
Applying the update for shift_i =   2.2737e+04     and shift_s =   2.2737e+05
*****************************************************************************

  Execution time = 3.0171e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434184e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379553e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291574e-02 1 1  ON 12
 ud_3                -1.595422e-02 1 1  ON 13
 ud_4                -6.968282e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578528e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672839e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492310e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895811e-02 1 1  ON 33
eH1_4                 5.480788e-03 1 1  ON 34
eH1_5                 3.926744e-02 1 1  ON 35
eH1_6                 9.464372e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527799e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054164e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502263e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784997e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961485e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6452e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.219609
====================================================
  Execution time = 2.2901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3181e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331797756880
                                         uncertainty =       0.002912098540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331797756880
                                         uncertainty =       0.002912098540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407314340
  error estimate for blocks of size 2^( 2) =       0.000419920157
  error estimate for blocks of size 2^( 3) =       0.000432657095
  error estimate for blocks of size 2^( 4) =       0.000443185593
  error estimate for blocks of size 2^( 5) =       0.000452269696
  error estimate for blocks of size 2^( 6) =       0.000458318303
  error estimate for blocks of size 2^( 7) =       0.000463289692

      target function =                  N/A
              le_mean =     -16.925256632875
             les_mean =     286.796121866724
             stat err =       0.000454265821
             autocorr =       1.243829125755
              std dev =       0.576029464469
             le_variance =       0.331809943936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692525663288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925256632875       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925256633150       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925256633131       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925256633210       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925256633194       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925256633302       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925256633275       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925256633272       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 6.253935e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925256632875       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925256632944       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925256632939       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925256632958       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925256632946       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925256632969       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925256632978       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925256632961       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.563507e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925256632875       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925256632893       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925256632891       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925256632896       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925256632901       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925256632896       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925256632901       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925256632928       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.908783e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8396e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434185e-02 1 1  ON 4
 uu_5                -9.781527e-02 1 1  ON 5
 uu_6                -1.245415e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379552e-01 1 1  ON 10
 ud_1                 1.721158e-01 1 1  ON 11
 ud_2                 5.291574e-02 1 1  ON 12
 ud_3                -1.595422e-02 1 1  ON 13
 ud_4                -6.968281e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578529e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315425e-01 1 1  ON 24
 eO_5                 4.915447e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672839e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492310e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374146e-02 1 1  ON 32
eH1_3                -3.895811e-02 1 1  ON 33
eH1_4                 5.480785e-03 1 1  ON 34
eH1_5                 3.926743e-02 1 1  ON 35
eH1_6                 9.464371e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527800e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054164e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502256e-03 1 1  ON 44
eH2_5                 4.201703e-02 1 1  ON 45
eH2_6                 9.784997e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961485e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8886
    reference variance = 0.223185
====================================================
  Execution time = 2.0652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4281e-01
  Total weights = 2.0000e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787381118
                                         uncertainty =       0.007012165392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787381118
                                         uncertainty =       0.007012165392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414010477
  error estimate for blocks of size 2^( 2) =       0.000426556233
  error estimate for blocks of size 2^( 3) =       0.000439041302
  error estimate for blocks of size 2^( 4) =       0.000450628335
  error estimate for blocks of size 2^( 5) =       0.000461514126
  error estimate for blocks of size 2^( 6) =       0.000469791417
  error estimate for blocks of size 2^( 7) =       0.000476022777

      target function =                  N/A
              le_mean =     -16.925583218517
             les_mean =     286.818176465516
             stat err =       0.000464489164
             autocorr =       1.258718196144
              std dev =       0.585499231405
             le_variance =       0.342809349976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787398085
                                         uncertainty =       0.007012166096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787398085
                                         uncertainty =       0.007012166096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414010487
  error estimate for blocks of size 2^( 2) =       0.000426556243
  error estimate for blocks of size 2^( 3) =       0.000439041311
  error estimate for blocks of size 2^( 4) =       0.000450628343
  error estimate for blocks of size 2^( 5) =       0.000461514133
  error estimate for blocks of size 2^( 6) =       0.000469791424
  error estimate for blocks of size 2^( 7) =       0.000476022785

      target function =                  N/A
              le_mean =     -16.925583218584
             les_mean =     286.818176484737
             stat err =       0.000464489171
             autocorr =       1.258718174505
              std dev =       0.585499245885
             le_variance =       0.342809366932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787389602
                                         uncertainty =       0.007012165744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787389602
                                         uncertainty =       0.007012165744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414010482
  error estimate for blocks of size 2^( 2) =       0.000426556238
  error estimate for blocks of size 2^( 3) =       0.000439041307
  error estimate for blocks of size 2^( 4) =       0.000450628339
  error estimate for blocks of size 2^( 5) =       0.000461514130
  error estimate for blocks of size 2^( 6) =       0.000469791421
  error estimate for blocks of size 2^( 7) =       0.000476022781

      target function =                  N/A
              le_mean =     -16.925583218550
             les_mean =     286.818176475128
             stat err =       0.000464489168
             autocorr =       1.258718185319
              std dev =       0.585499238646
             le_variance =       0.342809358455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787382179
                                         uncertainty =       0.007012165436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787382179
                                         uncertainty =       0.007012165436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414010478
  error estimate for blocks of size 2^( 2) =       0.000426556234
  error estimate for blocks of size 2^( 3) =       0.000439041303
  error estimate for blocks of size 2^( 4) =       0.000450628335
  error estimate for blocks of size 2^( 5) =       0.000461514126
  error estimate for blocks of size 2^( 6) =       0.000469791418
  error estimate for blocks of size 2^( 7) =       0.000476022778

      target function =                  N/A
              le_mean =     -16.925583218521
             les_mean =     286.818176466718
             stat err =       0.000464489164
             autocorr =       1.258718194788
              std dev =       0.585499232310
             le_variance =       0.342809351036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925583218517        initial
     5.6843e+03     5.6843e+04             6.2539e-08       -16.925583218584  <--
     2.2737e+04     2.2737e+05             1.5635e-08       -16.925583218550
     9.0949e+04     9.0949e+05             3.9088e-09       -16.925583218521

*****************************************************************************
Applying the update for shift_i =   5.6843e+03     and shift_s =   5.6843e+04
*****************************************************************************

  Execution time = 3.0194e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439265e-01 1 1  ON 1
 uu_2                 4.321001e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434186e-02 1 1  ON 4
 uu_5                -9.781528e-02 1 1  ON 5
 uu_6                -1.245416e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379552e-01 1 1  ON 10
 ud_1                 1.721157e-01 1 1  ON 11
 ud_2                 5.291572e-02 1 1  ON 12
 ud_3                -1.595421e-02 1 1  ON 13
 ud_4                -6.968281e-02 1 1  ON 14
 ud_5                -1.062116e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415903e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578534e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315426e-01 1 1  ON 24
 eO_5                 4.915448e-01 1 1  ON 25
 eO_6                 2.578148e-01 1 1  ON 26
 eO_7                -4.672837e-02 1 1  ON 27
 eO_8                -2.137783e-01 1 1  ON 28
 eO_9                -7.492313e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374148e-02 1 1  ON 32
eH1_3                -3.895811e-02 1 1  ON 33
eH1_4                 5.480778e-03 1 1  ON 34
eH1_5                 3.926740e-02 1 1  ON 35
eH1_6                 9.464370e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673618e-01 1 1  ON 38
eH1_9                 5.527802e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054165e-02 1 1  ON 42
eH2_3                -3.560399e-02 1 1  ON 43
eH2_4                 8.502238e-03 1 1  ON 44
eH2_5                 4.201702e-02 1 1  ON 45
eH2_6                 9.784997e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961488e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9725
    reference variance = 0.310958
====================================================
  Execution time = 2.0940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3884e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338892097728
                                         uncertainty =       0.003388537469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338892097728
                                         uncertainty =       0.003388537469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411607439
  error estimate for blocks of size 2^( 2) =       0.000424740134
  error estimate for blocks of size 2^( 3) =       0.000437458996
  error estimate for blocks of size 2^( 4) =       0.000448694100
  error estimate for blocks of size 2^( 5) =       0.000458455808
  error estimate for blocks of size 2^( 6) =       0.000464164983
  error estimate for blocks of size 2^( 7) =       0.000468309647

      target function =                  N/A
              le_mean =     -16.924640716647
             les_mean =     286.782304585556
             stat err =       0.000459906135
             autocorr =       1.248452362031
              std dev =       0.582100822347
             le_variance =       0.338841367377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692464071665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924640716647       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924640716929       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924640717266       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924640717639       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924640717417       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924640717466       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924640717476       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924640717578       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+03 is 2.463453e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924640716647       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924640716718       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924640716802       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924640716895       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924640716840       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924640716848       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924640716850       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924640716887       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 6.158732e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924640716647       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924640716665       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924640716686       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924640716709       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924640716696       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924640716686       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924640716668       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924640716735       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.539689e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6479e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439266e-01 1 1  ON 1
 uu_2                 4.321001e-02 1 1  ON 2
 uu_3                -1.912982e-02 1 1  ON 3
 uu_4                -6.434187e-02 1 1  ON 4
 uu_5                -9.781529e-02 1 1  ON 5
 uu_6                -1.245416e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023446e-01 1 1  ON 9
 ud_0                 4.379552e-01 1 1  ON 10
 ud_1                 1.721157e-01 1 1  ON 11
 ud_2                 5.291571e-02 1 1  ON 12
 ud_3                -1.595420e-02 1 1  ON 13
 ud_4                -6.968280e-02 1 1  ON 14
 ud_5                -1.062115e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415902e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694824e-01 1 1  ON 20
 eO_1                -4.483760e-01 1 1  ON 21
 eO_2                -2.578538e-02 1 1  ON 22
 eO_3                 2.984465e-01 1 1  ON 23
 eO_4                 5.315426e-01 1 1  ON 24
 eO_5                 4.915448e-01 1 1  ON 25
 eO_6                 2.578149e-01 1 1  ON 26
 eO_7                -4.672835e-02 1 1  ON 27
 eO_8                -2.137784e-01 1 1  ON 28
 eO_9                -7.492315e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374151e-02 1 1  ON 32
eH1_3                -3.895810e-02 1 1  ON 33
eH1_4                 5.480753e-03 1 1  ON 34
eH1_5                 3.926739e-02 1 1  ON 35
eH1_6                 9.464369e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673619e-01 1 1  ON 38
eH1_9                 5.527804e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054166e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502220e-03 1 1  ON 44
eH2_5                 4.201702e-02 1 1  ON 45
eH2_6                 9.784996e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961491e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9317
    reference variance = 0.283516
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3880e-01
  Total weights = 2.0000e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761751928
                                         uncertainty =       0.006549864933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761751928
                                         uncertainty =       0.006549864933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411582055
  error estimate for blocks of size 2^( 2) =       0.000424376823
  error estimate for blocks of size 2^( 3) =       0.000436217444
  error estimate for blocks of size 2^( 4) =       0.000446998200
  error estimate for blocks of size 2^( 5) =       0.000456616882
  error estimate for blocks of size 2^( 6) =       0.000464020198
  error estimate for blocks of size 2^( 7) =       0.000469845975

      target function =                  N/A
              le_mean =     -16.924964628223
             les_mean =     286.793227073987
             stat err =       0.000459370314
             autocorr =       1.245698634117
              std dev =       0.582064924881
             le_variance =       0.338799576777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761747931
                                         uncertainty =       0.006549858957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761747931
                                         uncertainty =       0.006549858957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411582053
  error estimate for blocks of size 2^( 2) =       0.000424376819
  error estimate for blocks of size 2^( 3) =       0.000436217438
  error estimate for blocks of size 2^( 4) =       0.000446998193
  error estimate for blocks of size 2^( 5) =       0.000456616876
  error estimate for blocks of size 2^( 6) =       0.000464020192
  error estimate for blocks of size 2^( 7) =       0.000469845974

      target function =                  N/A
              le_mean =     -16.924964628438
             les_mean =     286.793227077286
             stat err =       0.000459370309
             autocorr =       1.245698623172
              std dev =       0.582064921485
             le_variance =       0.338799572823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761749937
                                         uncertainty =       0.006549861945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761749937
                                         uncertainty =       0.006549861945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411582054
  error estimate for blocks of size 2^( 2) =       0.000424376821
  error estimate for blocks of size 2^( 3) =       0.000436217441
  error estimate for blocks of size 2^( 4) =       0.000446998197
  error estimate for blocks of size 2^( 5) =       0.000456616879
  error estimate for blocks of size 2^( 6) =       0.000464020195
  error estimate for blocks of size 2^( 7) =       0.000469845974

      target function =                  N/A
              le_mean =     -16.924964628330
             les_mean =     286.793227075643
             stat err =       0.000459370311
             autocorr =       1.245698628633
              std dev =       0.582064923190
             le_variance =       0.338799574808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761751680
                                         uncertainty =       0.006549864560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761751680
                                         uncertainty =       0.006549864560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411582055
  error estimate for blocks of size 2^( 2) =       0.000424376823
  error estimate for blocks of size 2^( 3) =       0.000436217443
  error estimate for blocks of size 2^( 4) =       0.000446998200
  error estimate for blocks of size 2^( 5) =       0.000456616881
  error estimate for blocks of size 2^( 6) =       0.000464020198
  error estimate for blocks of size 2^( 7) =       0.000469845975

      target function =                  N/A
              le_mean =     -16.924964628237
             les_mean =     286.793227074194
             stat err =       0.000459370313
             autocorr =       1.245698633425
              std dev =       0.582064924670
             le_variance =       0.338799576531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924964628223        initial
     1.4211e+03     1.4211e+04             2.4635e-07       -16.924964628438  <--
     5.6843e+03     5.6843e+04             6.1587e-08       -16.924964628330
     2.2737e+04     2.2737e+05             1.5397e-08       -16.924964628237

*****************************************************************************
Applying the update for shift_i =   1.4211e+03     and shift_s =   1.4211e+04
*****************************************************************************

  Execution time = 3.0578e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.099244e-01 1 1  ON 0
 uu_1                 1.439267e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912983e-02 1 1  ON 3
 uu_4                -6.434190e-02 1 1  ON 4
 uu_5                -9.781534e-02 1 1  ON 5
 uu_6                -1.245416e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023447e-01 1 1  ON 9
 ud_0                 4.379551e-01 1 1  ON 10
 ud_1                 1.721156e-01 1 1  ON 11
 ud_2                 5.291567e-02 1 1  ON 12
 ud_3                -1.595415e-02 1 1  ON 13
 ud_4                -6.968278e-02 1 1  ON 14
 ud_5                -1.062115e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415901e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694826e-01 1 1  ON 20
 eO_1                -4.483761e-01 1 1  ON 21
 eO_2                -2.578548e-02 1 1  ON 22
 eO_3                 2.984464e-01 1 1  ON 23
 eO_4                 5.315427e-01 1 1  ON 24
 eO_5                 4.915450e-01 1 1  ON 25
 eO_6                 2.578151e-01 1 1  ON 26
 eO_7                -4.672829e-02 1 1  ON 27
 eO_8                -2.137785e-01 1 1  ON 28
 eO_9                -7.492322e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374159e-02 1 1  ON 32
eH1_3                -3.895806e-02 1 1  ON 33
eH1_4                 5.480677e-03 1 1  ON 34
eH1_5                 3.926736e-02 1 1  ON 35
eH1_6                 9.464365e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673619e-01 1 1  ON 38
eH1_9                 5.527810e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054169e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502165e-03 1 1  ON 44
eH2_5                 4.201700e-02 1 1  ON 45
eH2_6                 9.784995e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7115e+01 secs
  Total Execution time = 2.2996e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
