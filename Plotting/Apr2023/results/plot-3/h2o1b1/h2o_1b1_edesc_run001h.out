Rank =    0  Free Memory = 76261 MB
Rank =    1  Free Memory = 76261 MB
Rank =    2  Free Memory = 76261 MB
Rank =    3  Free Memory = 76261 MB
Rank =    4  Free Memory = 76260 MB
Rank =    5  Free Memory = 76259 MB
Rank =    6  Free Memory = 76259 MB
Rank =    7  Free Memory = 76260 MB
Rank =    8  Free Memory = 76260 MB
Rank =    9  Free Memory = 76260 MB
Rank =   10  Free Memory = 76260 MB
Rank =   11  Free Memory = 76260 MB
Rank =   12  Free Memory = 76260 MB
Rank =   13  Free Memory = 76260 MB
Rank =   14  Free Memory = 76259 MB
Rank =   15  Free Memory = 76245 MB
Rank =   16  Free Memory = 76245 MB
Rank =   17  Free Memory = 76245 MB
Rank =   18  Free Memory = 76245 MB
Rank =   19  Free Memory = 76245 MB
Rank =   20  Free Memory = 76245 MB
Rank =   21  Free Memory = 76245 MB
Rank =   22  Free Memory = 76244 MB
Rank =   23  Free Memory = 76244 MB
Rank =   24  Free Memory = 76244 MB
Rank =   25  Free Memory = 76244 MB
Rank =   26  Free Memory = 76244 MB
Rank =   27  Free Memory = 76244 MB
Rank =   28  Free Memory = 76244 MB
Rank =   29  Free Memory = 76244 MB
Rank =   30  Free Memory = 76244 MB
Rank =   31  Free Memory = 76244 MB
Rank =   32  Free Memory = 90064 MB
Rank =   33  Free Memory = 90064 MB
Rank =   34  Free Memory = 90064 MB
Rank =   35  Free Memory = 90064 MB
Rank =   36  Free Memory = 90064 MB
Rank =   37  Free Memory = 90064 MB
Rank =   38  Free Memory = 90064 MB
Rank =   39  Free Memory = 90064 MB
Rank =   40  Free Memory = 90064 MB
Rank =   41  Free Memory = 90064 MB
Rank =   42  Free Memory = 90064 MB
Rank =   43  Free Memory = 90064 MB
Rank =   44  Free Memory = 90064 MB
Rank =   45  Free Memory = 90064 MB
Rank =   46  Free Memory = 90064 MB
Rank =   47  Free Memory = 90064 MB
Rank =   48  Free Memory = 90064 MB
Rank =   49  Free Memory = 90064 MB
Rank =   50  Free Memory = 90064 MB
Rank =   51  Free Memory = 90064 MB
Rank =   52  Free Memory = 90064 MB
Rank =   53  Free Memory = 90064 MB
Rank =   54  Free Memory = 90064 MB
Rank =   55  Free Memory = 90064 MB
Rank =   56  Free Memory = 90064 MB
Rank =   57  Free Memory = 90063 MB
Rank =   58  Free Memory = 90063 MB
Rank =   59  Free Memory = 90063 MB
Rank =   60  Free Memory = 90063 MB
Rank =   61  Free Memory = 90063 MB
Rank =   62  Free Memory = 90063 MB
Rank =   63  Free Memory = 90063 MB
Rank =   64  Free Memory = 90307 MB
Rank =   65  Free Memory = 90307 MB
Rank =   66  Free Memory = 90307 MB
Rank =   67  Free Memory = 90307 MB
Rank =   68  Free Memory = 90307 MB
Rank =   69  Free Memory = 90307 MB
Rank =   70  Free Memory = 90307 MB
Rank =   71  Free Memory = 90307 MB
Rank =   72  Free Memory = 90307 MB
Rank =   73  Free Memory = 90307 MB
Rank =   74  Free Memory = 90307 MB
Rank =   75  Free Memory = 90307 MB
Rank =   76  Free Memory = 90307 MB
Rank =   77  Free Memory = 90307 MB
Rank =   78  Free Memory = 90307 MB
Rank =   79  Free Memory = 90307 MB
Rank =   80  Free Memory = 90307 MB
Rank =   81  Free Memory = 90307 MB
Rank =   82  Free Memory = 90307 MB
Rank =   83  Free Memory = 90307 MB
Rank =   84  Free Memory = 90307 MB
Rank =   85  Free Memory = 90306 MB
Rank =   86  Free Memory = 90306 MB
Rank =   87  Free Memory = 90306 MB
Rank =   88  Free Memory = 90306 MB
Rank =   89  Free Memory = 90306 MB
Rank =   90  Free Memory = 90306 MB
Rank =   91  Free Memory = 90306 MB
Rank =   92  Free Memory = 90306 MB
Rank =   93  Free Memory = 90306 MB
Rank =   94  Free Memory = 90306 MB
Rank =   95  Free Memory = 90306 MB
Rank =   96  Free Memory = 87401 MB
Rank =   97  Free Memory = 87401 MB
Rank =   98  Free Memory = 87401 MB
Rank =   99  Free Memory = 87401 MB
Rank =  100  Free Memory = 87401 MB
Rank =  101  Free Memory = 87401 MB
Rank =  102  Free Memory = 87401 MB
Rank =  103  Free Memory = 87401 MB
Rank =  104  Free Memory = 87401 MB
Rank =  105  Free Memory = 87401 MB
Rank =  106  Free Memory = 87401 MB
Rank =  107  Free Memory = 87401 MB
Rank =  108  Free Memory = 87401 MB
Rank =  109  Free Memory = 87401 MB
Rank =  110  Free Memory = 87401 MB
Rank =  111  Free Memory = 87401 MB
Rank =  112  Free Memory = 87401 MB
Rank =  113  Free Memory = 87401 MB
Rank =  114  Free Memory = 87401 MB
Rank =  115  Free Memory = 87401 MB
Rank =  116  Free Memory = 87401 MB
Rank =  117  Free Memory = 87401 MB
Rank =  118  Free Memory = 87401 MB
Rank =  119  Free Memory = 87401 MB
Rank =  120  Free Memory = 87401 MB
Rank =  121  Free Memory = 87401 MB
Rank =  122  Free Memory = 87401 MB
Rank =  123  Free Memory = 87401 MB
Rank =  124  Free Memory = 87401 MB
Rank =  125  Free Memory = 87401 MB
Rank =  126  Free Memory = 87401 MB
Rank =  127  Free Memory = 87401 MB
  Input file(s): opt_h2o_1b1_edesc_run001h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001h.xml

  Project = H2O
  date    = 2023-03-06 20:00:31 PST
  host    = n0066.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 735

  Range of prime numbers to use as seeds over processors and threads = 5581-6703


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.081593e-01    1         1  ON     0
     uu_1                 1.417770e-01    1         1  ON     1
     uu_2                 4.117922e-02    1         1  ON     2
     uu_3                -2.025945e-02    1         1  ON     3
     uu_4                -6.380345e-02    1         1  ON     4
     uu_5                -9.657960e-02    1         1  ON     5
     uu_6                -1.231284e-01    1         1  ON     6
     uu_7                -1.364423e-01    1         1  ON     7
     uu_8                -1.290703e-01    1         1  ON     8
     uu_9                -9.978128e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.434508e-01    1         1  ON     0
     ud_1                 1.774977e-01    1         1  ON     1
     ud_2                 5.732892e-02    1         1  ON     2
     ud_3                -1.305458e-02    1         1  ON     3
     ud_4                -6.887302e-02    1         1  ON     4
     ud_5                -1.077707e-01    1         1  ON     5
     ud_6                -1.325765e-01    1         1  ON     6
     ud_7                -1.467603e-01    1         1  ON     7
     ud_8                -1.454807e-01    1         1  ON     8
     ud_9                -1.351190e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.647164e-01    1         1  ON     0
     eO_1                -4.429565e-01    1         1  ON     1
     eO_2                -2.112241e-02    1         1  ON     2
     eO_3                 3.007376e-01    1         1  ON     3
     eO_4                 5.262861e-01    1         1  ON     4
     eO_5                 4.823718e-01    1         1  ON     5
     eO_6                 2.507928e-01    1         1  ON     6
     eO_7                -4.899585e-02    1         1  ON     7
     eO_8                -2.108295e-01    1         1  ON     8
     eO_9                -7.177883e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.368153e-01    1         1  ON     0
     eH1_1                -1.377198e-01    1         1  ON     1
     eH1_2                -9.204017e-02    1         1  ON     2
     eH1_3                -3.799938e-02    1         1  ON     3
     eH1_4                 7.290196e-03    1         1  ON     4
     eH1_5                 4.117144e-02    1         1  ON     5
     eH1_6                 9.663575e-02    1         1  ON     6
     eH1_7                 1.470849e-01    1         1  ON     7
     eH1_8                 1.643005e-01    1         1  ON     8
     eH1_9                 5.149161e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.336030e-01    1         1  ON     0
     eH2_1                -1.347563e-01    1         1  ON     1
     eH2_2                -8.893503e-02    1         1  ON     2
     eH2_3                -3.493056e-02    1         1  ON     3
     eH2_4                 1.109303e-02    1         1  ON     4
     eH2_5                 4.339708e-02    1         1  ON     5
     eH2_6                 9.948451e-02    1         1  ON     6
     eH2_7                 1.513527e-01    1         1  ON     7
     eH2_8                 1.697964e-01    1         1  ON     8
     eH2_9                 3.488969e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.408331e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1484e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9639
    reference variance = 0.244943
====================================================
  Execution time = 2.1555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4080e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340850750059
                                         uncertainty =       0.003309738836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340850750059
                                         uncertainty =       0.003309738836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412797696
  error estimate for blocks of size 2^( 2) =       0.000426734297
  error estimate for blocks of size 2^( 3) =       0.000441754476
  error estimate for blocks of size 2^( 4) =       0.000456342270
  error estimate for blocks of size 2^( 5) =       0.000471644449
  error estimate for blocks of size 2^( 6) =       0.000483531312
  error estimate for blocks of size 2^( 7) =       0.000493563418

      target function =                  N/A
              le_mean =     -16.919499395048
             les_mean =     286.610263483516
             stat err =       0.000476270362
             autocorr =       1.331167129023
              std dev =       0.583784099543
             le_variance =       0.340803874879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691949939505e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919499395048       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919517151380       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919520921664       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919521045717       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919522405037       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919524792936       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919525096892       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919523964650       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.919523809864       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.919524458878       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.919524712116       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.442430e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919499395048       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919505539115       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919506650057       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919506725261       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919507119459       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919507644038       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919507848018       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919507638895       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.919507612236       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.890342e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919499395048       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919501094220       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919501401835       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919501441868       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919501546825       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919501673415       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919501719552       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919501710058       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.919501687495       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.132852e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7111e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.078886e-01                 1 1 ON  0
uu_1  1.416100e-01                 1 1 ON  1
uu_2  4.153424e-02                 1 1 ON  2
uu_3  -1.998597e-02                1 1 ON  3
uu_4  -6.390752e-02                1 1 ON  4
uu_5  -9.660625e-02                1 1 ON  5
uu_6  -1.229981e-01                1 1 ON  6
uu_7  -1.365041e-01                1 1 ON  7
uu_8  -1.292188e-01                1 1 ON  8
uu_9  -9.990901e-02                1 1 ON  9
ud_0  4.433908e-01                 1 1 ON  10
ud_1  1.773150e-01                 1 1 ON  11
ud_2  5.701114e-02                 1 1 ON  12
ud_3  -1.332169e-02                1 1 ON  13
ud_4  -6.879546e-02                1 1 ON  14
ud_5  -1.076953e-01                1 1 ON  15
ud_6  -1.323130e-01                1 1 ON  16
ud_7  -1.464107e-01                1 1 ON  17
ud_8  -1.454245e-01                1 1 ON  18
ud_9  -1.351006e-01                1 1 ON  19
eO_0  -7.648933e-01                1 1 ON  20
eO_1  -4.433436e-01                1 1 ON  21
eO_2  -2.138007e-02                1 1 ON  22
eO_3  3.008219e-01                 1 1 ON  23
eO_4  5.266752e-01                 1 1 ON  24
eO_5  4.826860e-01                 1 1 ON  25
eO_6  2.510221e-01                 1 1 ON  26
eO_7  -4.886760e-02                1 1 ON  27
eO_8  -2.109978e-01                1 1 ON  28
eO_9  -7.192698e-02                1 1 ON  29
eH1_0 -2.368504e-01                1 1 ON  30
eH1_1 -1.376444e-01                1 1 ON  31
eH1_2 -9.221898e-02                1 1 ON  32
eH1_3 -3.803606e-02                1 1 ON  33
eH1_4 7.251133e-03                 1 1 ON  34
eH1_5 4.105177e-02                 1 1 ON  35
eH1_6 9.651465e-02                 1 1 ON  36
eH1_7 1.470627e-01                 1 1 ON  37
eH1_8 1.645036e-01                 1 1 ON  38
eH1_9 5.170505e-02                 1 1 ON  39
eH2_0 -2.337598e-01                1 1 ON  40
eH2_1 -1.347532e-01                1 1 ON  41
eH2_2 -8.899082e-02                1 1 ON  42
eH2_3 -3.486584e-02                1 1 ON  43
eH2_4 1.094812e-02                 1 1 ON  44
eH2_5 4.350614e-02                 1 1 ON  45
eH2_6 9.946267e-02                 1 1 ON  46
eH2_7 1.512903e-01                 1 1 ON  47
eH2_8 1.699085e-01                 1 1 ON  48
eH2_9 3.505916e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.328076
====================================================
  Execution time = 2.2634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4552e-01
  Total weights = 2.0000e+06
  Execution time = 1.8825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345538788016
                                         uncertainty =       0.006196081903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345538788016
                                         uncertainty =       0.006196081903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415692845
  error estimate for blocks of size 2^( 2) =       0.000429196264
  error estimate for blocks of size 2^( 3) =       0.000443444971
  error estimate for blocks of size 2^( 4) =       0.000458692831
  error estimate for blocks of size 2^( 5) =       0.000472132637
  error estimate for blocks of size 2^( 6) =       0.000482817883
  error estimate for blocks of size 2^( 7) =       0.000489193136

      target function =                  N/A
              le_mean =     -16.919495328179
             les_mean =     286.614923070437
             stat err =       0.000475709122
             autocorr =       1.309597565643
              std dev =       0.587878459339
             le_variance =       0.345601082954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345342954042
                                         uncertainty =       0.006192479059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345342954042
                                         uncertainty =       0.006192479059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415574657
  error estimate for blocks of size 2^( 2) =       0.000429068283
  error estimate for blocks of size 2^( 3) =       0.000443304271
  error estimate for blocks of size 2^( 4) =       0.000458543306
  error estimate for blocks of size 2^( 5) =       0.000471959106
  error estimate for blocks of size 2^( 6) =       0.000482594802
  error estimate for blocks of size 2^( 7) =       0.000488921884

      target function =                  N/A
              le_mean =     -16.919484961532
             les_mean =     286.614375782492
             stat err =       0.000475504774
             autocorr =       1.309217050967
              std dev =       0.587711316626
             le_variance =       0.345404591690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345392595500
                                         uncertainty =       0.006192734013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345392595500
                                         uncertainty =       0.006192734013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415604615
  error estimate for blocks of size 2^( 2) =       0.000429097865
  error estimate for blocks of size 2^( 3) =       0.000443335306
  error estimate for blocks of size 2^( 4) =       0.000458576833
  error estimate for blocks of size 2^( 5) =       0.000472003224
  error estimate for blocks of size 2^( 6) =       0.000482657994
  error estimate for blocks of size 2^( 7) =       0.000489000330

      target function =                  N/A
              le_mean =     -16.919485328321
             les_mean =     286.614437994976
             stat err =       0.000475559595
             autocorr =       1.309330166687
              std dev =       0.587753683481
             le_variance =       0.345454392446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345518632826
                                         uncertainty =       0.006195638536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345518632826
                                         uncertainty =       0.006195638536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415680682
  error estimate for blocks of size 2^( 2) =       0.000429182052
  error estimate for blocks of size 2^( 3) =       0.000443428658
  error estimate for blocks of size 2^( 4) =       0.000458675362
  error estimate for blocks of size 2^( 5) =       0.000472113252
  error estimate for blocks of size 2^( 6) =       0.000482794351
  error estimate for blocks of size 2^( 7) =       0.000489164885

      target function =                  N/A
              le_mean =     -16.919493029197
             les_mean =     286.614825051606
             stat err =       0.000475686963
             autocorr =       1.309552194494
              std dev =       0.587861258595
             le_variance =       0.345580859356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919495328179        initial  <--
     2.5000e-01     2.5000e+00             1.4424e-03       -16.919484961532
     1.0000e+00     1.0000e+01             3.8903e-04       -16.919485328321
     4.0000e+00     4.0000e+01             1.1329e-04       -16.919493029197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1284
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.877
    reference variance = 0.35577
====================================================
  Execution time = 2.0961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3716e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188055060
                                         uncertainty =       0.004459165361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337188055060
                                         uncertainty =       0.004459165361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410582563
  error estimate for blocks of size 2^( 2) =       0.000424477455
  error estimate for blocks of size 2^( 3) =       0.000439453674
  error estimate for blocks of size 2^( 4) =       0.000454681358
  error estimate for blocks of size 2^( 5) =       0.000471106126
  error estimate for blocks of size 2^( 6) =       0.000484797695
  error estimate for blocks of size 2^( 7) =       0.000496233070

      target function =                  N/A
              le_mean =     -16.918795100533
             les_mean =     286.582783566747
             stat err =       0.000476704562
             autocorr =       1.348023969490
              std dev =       0.580651428565
             le_variance =       0.337156081495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691879510053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918795100533       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918796717964       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918797688494       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918798087790       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918798124118       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918798342945       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918798237628       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918798321291       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918798340803       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.776941e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918795100533       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918795521714       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918795785811       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918795897172       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918795907574       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918795966731       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918795935201       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918795952268       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918795956740       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.979635e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918795100533       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918795206935       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918795274514       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918795303219       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918795305981       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918795321135       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918795313031       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918795316937       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.306289e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6614e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.081393e-01 1 1  ON 0
 uu_1                 1.417547e-01 1 1  ON 1
 uu_2                 4.122901e-02 1 1  ON 2
 uu_3                -2.023413e-02 1 1  ON 3
 uu_4                -6.381856e-02 1 1  ON 4
 uu_5                -9.657802e-02 1 1  ON 5
 uu_6                -1.231238e-01 1 1  ON 6
 uu_7                -1.364503e-01 1 1  ON 7
 uu_8                -1.290873e-01 1 1  ON 8
 uu_9                -9.979887e-02 1 1  ON 9
 ud_0                 4.434609e-01 1 1  ON 10
 ud_1                 1.774700e-01 1 1  ON 11
 ud_2                 5.729319e-02 1 1  ON 12
 ud_3                -1.308923e-02 1 1  ON 13
 ud_4                -6.886452e-02 1 1  ON 14
 ud_5                -1.077550e-01 1 1  ON 15
 ud_6                -1.325579e-01 1 1  ON 16
 ud_7                -1.467349e-01 1 1  ON 17
 ud_8                -1.454676e-01 1 1  ON 18
 ud_9                -1.351104e-01 1 1  ON 19
 eO_0                -7.647313e-01 1 1  ON 20
 eO_1                -4.429910e-01 1 1  ON 21
 eO_2                -2.114045e-02 1 1  ON 22
 eO_3                 3.007384e-01 1 1  ON 23
 eO_4                 5.263226e-01 1 1  ON 24
 eO_5                 4.824021e-01 1 1  ON 25
 eO_6                 2.508118e-01 1 1  ON 26
 eO_7                -4.898740e-02 1 1  ON 27
 eO_8                -2.108423e-01 1 1  ON 28
 eO_9                -7.179205e-02 1 1  ON 29
eH1_0                -2.368244e-01 1 1  ON 30
eH1_1                -1.377287e-01 1 1  ON 31
eH1_2                -9.204814e-02 1 1  ON 32
eH1_3                -3.799078e-02 1 1  ON 33
eH1_4                 7.287671e-03 1 1  ON 34
eH1_5                 4.116655e-02 1 1  ON 35
eH1_6                 9.663329e-02 1 1  ON 36
eH1_7                 1.470836e-01 1 1  ON 37
eH1_8                 1.643090e-01 1 1  ON 38
eH1_9                 5.150747e-02 1 1  ON 39
eH2_0                -2.336115e-01 1 1  ON 40
eH2_1                -1.347666e-01 1 1  ON 41
eH2_2                -8.894614e-02 1 1  ON 42
eH2_3                -3.491837e-02 1 1  ON 43
eH2_4                 1.108021e-02 1 1  ON 44
eH2_5                 4.339529e-02 1 1  ON 45
eH2_6                 9.947099e-02 1 1  ON 46
eH2_7                 1.513582e-01 1 1  ON 47
eH2_8                 1.698151e-01 1 1  ON 48
eH2_9                 3.491101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 0.236823
====================================================
  Execution time = 2.0382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3884e-01
  Total weights = 2.0000e+06
  Execution time = 1.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864760300
                                         uncertainty =       0.002968852527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338864760300
                                         uncertainty =       0.002968852527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411603122
  error estimate for blocks of size 2^( 2) =       0.000426035599
  error estimate for blocks of size 2^( 3) =       0.000441464445
  error estimate for blocks of size 2^( 4) =       0.000457854561
  error estimate for blocks of size 2^( 5) =       0.000474631595
  error estimate for blocks of size 2^( 6) =       0.000488761672
  error estimate for blocks of size 2^( 7) =       0.000499955403

      target function =                  N/A
              le_mean =     -16.917646236794
             les_mean =     286.545588284751
             stat err =       0.000480300808
             autocorr =       1.361661984954
              std dev =       0.582094718129
             le_variance =       0.338834260874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338889132010
                                         uncertainty =       0.002968905650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338889132010
                                         uncertainty =       0.002968905650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411617926
  error estimate for blocks of size 2^( 2) =       0.000426045508
  error estimate for blocks of size 2^( 3) =       0.000441469910
  error estimate for blocks of size 2^( 4) =       0.000457856570
  error estimate for blocks of size 2^( 5) =       0.000474631084
  error estimate for blocks of size 2^( 6) =       0.000488760264
  error estimate for blocks of size 2^( 7) =       0.000499946285

      target function =                  N/A
              le_mean =     -16.917643839605
             les_mean =     286.545531548267
             stat err =       0.000480298551
             autocorr =       1.361551247882
              std dev =       0.582115653442
             le_variance =       0.338858633983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338880111752
                                         uncertainty =       0.002968899575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338880111752
                                         uncertainty =       0.002968899575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411612447
  error estimate for blocks of size 2^( 2) =       0.000426042142
  error estimate for blocks of size 2^( 3) =       0.000441468465
  error estimate for blocks of size 2^( 4) =       0.000457856664
  error estimate for blocks of size 2^( 5) =       0.000474632389
  error estimate for blocks of size 2^( 6) =       0.000488762160
  error estimate for blocks of size 2^( 7) =       0.000499951575

      target function =                  N/A
              le_mean =     -16.917644768837
             les_mean =     286.545553968533
             stat err =       0.000480300697
             autocorr =       1.361599662668
              std dev =       0.582107905280
             le_variance =       0.338849613390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338867068761
                                         uncertainty =       0.002968860772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338867068761
                                         uncertainty =       0.002968860772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411604525
  error estimate for blocks of size 2^( 2) =       0.000426036628
  error estimate for blocks of size 2^( 3) =       0.000441465130
  error estimate for blocks of size 2^( 4) =       0.000457854989
  error estimate for blocks of size 2^( 5) =       0.000474631852
  error estimate for blocks of size 2^( 6) =       0.000488761894
  error estimate for blocks of size 2^( 7) =       0.000499955066

      target function =                  N/A
              le_mean =     -16.917646032564
             les_mean =     286.545583683220
             stat err =       0.000480300950
             autocorr =       1.361653512783
              std dev =       0.582096701159
             le_variance =       0.338836569501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.917646236794        initial  <--
     2.5000e+00     2.5000e+01             1.7769e-04       -16.917643839605
     1.0000e+01     1.0000e+02             4.9796e-05       -16.917644768837
     4.0000e+01     4.0000e+02             1.3063e-05       -16.917646032564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8781
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.002
    reference variance = 0.320772
====================================================
  Execution time = 2.0653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4974e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349851546899
                                         uncertainty =       0.008431902172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349851546899
                                         uncertainty =       0.008431902172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418177261
  error estimate for blocks of size 2^( 2) =       0.000431468231
  error estimate for blocks of size 2^( 3) =       0.000445868608
  error estimate for blocks of size 2^( 4) =       0.000460424830
  error estimate for blocks of size 2^( 5) =       0.000474264551
  error estimate for blocks of size 2^( 6) =       0.000484100167
  error estimate for blocks of size 2^( 7) =       0.000492815866

      target function =                  N/A
              le_mean =     -16.918287694408
             les_mean =     286.578202778611
             stat err =       0.000477901353
             autocorr =       1.306037641188
              std dev =       0.591391953565
             le_variance =       0.349744442742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691828769441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918287694408       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918287985460       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918288045668       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918288059786       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918288032052       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918287989802       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918288020513       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918288013409       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.693353e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918287694408       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918287767482       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918287782628       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918287786231       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918287779186       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918287768255       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918287775982       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918287774295       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.290648e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918287694408       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918287712696       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918287716488       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918287717394       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918287715625       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918287712869       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918287714804       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918287714387       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.076323e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6147e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.081565e-01 1 1  ON 0
 uu_1                 1.417748e-01 1 1  ON 1
 uu_2                 4.118351e-02 1 1  ON 2
 uu_3                -2.025678e-02 1 1  ON 3
 uu_4                -6.380370e-02 1 1  ON 4
 uu_5                -9.657973e-02 1 1  ON 5
 uu_6                -1.231281e-01 1 1  ON 6
 uu_7                -1.364424e-01 1 1  ON 7
 uu_8                -1.290722e-01 1 1  ON 8
 uu_9                -9.978266e-02 1 1  ON 9
 ud_0                 4.434535e-01 1 1  ON 10
 ud_1                 1.774949e-01 1 1  ON 11
 ud_2                 5.732502e-02 1 1  ON 12
 ud_3                -1.305801e-02 1 1  ON 13
 ud_4                -6.887199e-02 1 1  ON 14
 ud_5                -1.077691e-01 1 1  ON 15
 ud_6                -1.325747e-01 1 1  ON 16
 ud_7                -1.467578e-01 1 1  ON 17
 ud_8                -1.454804e-01 1 1  ON 18
 ud_9                -1.351183e-01 1 1  ON 19
 eO_0                -7.647182e-01 1 1  ON 20
 eO_1                -4.429595e-01 1 1  ON 21
 eO_2                -2.112391e-02 1 1  ON 22
 eO_3                 3.007375e-01 1 1  ON 23
 eO_4                 5.262892e-01 1 1  ON 24
 eO_5                 4.823745e-01 1 1  ON 25
 eO_6                 2.507950e-01 1 1  ON 26
 eO_7                -4.899467e-02 1 1  ON 27
 eO_8                -2.108310e-01 1 1  ON 28
 eO_9                -7.177999e-02 1 1  ON 29
eH1_0                -2.368167e-01 1 1  ON 30
eH1_1                -1.377201e-01 1 1  ON 31
eH1_2                -9.204091e-02 1 1  ON 32
eH1_3                -3.799915e-02 1 1  ON 33
eH1_4                 7.290784e-03 1 1  ON 34
eH1_5                 4.117146e-02 1 1  ON 35
eH1_6                 9.663533e-02 1 1  ON 36
eH1_7                 1.470851e-01 1 1  ON 37
eH1_8                 1.643014e-01 1 1  ON 38
eH1_9                 5.149273e-02 1 1  ON 39
eH2_0                -2.336035e-01 1 1  ON 40
eH2_1                -1.347561e-01 1 1  ON 41
eH2_2                -8.893710e-02 1 1  ON 42
eH2_3                -3.493032e-02 1 1  ON 43
eH2_4                 1.109185e-02 1 1  ON 44
eH2_5                 4.339696e-02 1 1  ON 45
eH2_6                 9.948280e-02 1 1  ON 46
eH2_7                 1.513526e-01 1 1  ON 47
eH2_8                 1.697986e-01 1 1  ON 48
eH2_9                 3.489233e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9175
    reference variance = 0.199537
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4030e-01
  Total weights = 2.0000e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340331541749
                                         uncertainty =       0.003747980590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340331541749
                                         uncertainty =       0.003747980590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412489985
  error estimate for blocks of size 2^( 2) =       0.000426466129
  error estimate for blocks of size 2^( 3) =       0.000441067894
  error estimate for blocks of size 2^( 4) =       0.000455526162
  error estimate for blocks of size 2^( 5) =       0.000469046646
  error estimate for blocks of size 2^( 6) =       0.000480729125
  error estimate for blocks of size 2^( 7) =       0.000489368258

      target function =                  N/A
              le_mean =     -16.919373296696
             les_mean =     286.605488559030
             stat err =       0.000473667548
             autocorr =       1.318622383660
              std dev =       0.583348931803
             le_variance =       0.340295976236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340341519949
                                         uncertainty =       0.003748130475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340341519949
                                         uncertainty =       0.003748130475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412496030
  error estimate for blocks of size 2^( 2) =       0.000426471414
  error estimate for blocks of size 2^( 3) =       0.000441072467
  error estimate for blocks of size 2^( 4) =       0.000455529949
  error estimate for blocks of size 2^( 5) =       0.000469049588
  error estimate for blocks of size 2^( 6) =       0.000480731664
  error estimate for blocks of size 2^( 7) =       0.000489369378

      target function =                  N/A
              le_mean =     -16.919373564379
             les_mean =     286.605507591076
             stat err =       0.000473670145
             autocorr =       1.318598196038
              std dev =       0.583357480643
             le_variance =       0.340305950222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336597294
                                         uncertainty =       0.003748056868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340336597294
                                         uncertainty =       0.003748056868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412493048
  error estimate for blocks of size 2^( 2) =       0.000426468807
  error estimate for blocks of size 2^( 3) =       0.000441070212
  error estimate for blocks of size 2^( 4) =       0.000455528085
  error estimate for blocks of size 2^( 5) =       0.000469048143
  error estimate for blocks of size 2^( 6) =       0.000480730421
  error estimate for blocks of size 2^( 7) =       0.000489368839

      target function =                  N/A
              le_mean =     -16.919373431568
             les_mean =     286.605498176350
             stat err =       0.000473668872
             autocorr =       1.318610174504
              std dev =       0.583353263162
             le_variance =       0.340301029642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340332175403
                                         uncertainty =       0.003747990166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340332175403
                                         uncertainty =       0.003747990166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412490369
  error estimate for blocks of size 2^( 2) =       0.000426466465
  error estimate for blocks of size 2^( 3) =       0.000441068184
  error estimate for blocks of size 2^( 4) =       0.000455526403
  error estimate for blocks of size 2^( 5) =       0.000469046833
  error estimate for blocks of size 2^( 6) =       0.000480729287
  error estimate for blocks of size 2^( 7) =       0.000489368331

      target function =                  N/A
              le_mean =     -16.919373313520
             les_mean =     286.605489761734
             stat err =       0.000473667714
             autocorr =       1.318620853687
              std dev =       0.583349474690
             le_variance =       0.340296609621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919373296696        initial
     2.5000e+01     2.5000e+02             1.6934e-05       -16.919373564379  <--
     1.0000e+02     1.0000e+03             4.2906e-06       -16.919373431568
     4.0000e+02     4.0000e+03             1.0763e-06       -16.919373313520

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.9910e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119615e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731344e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492964e-02 1 1  ON 43
eH2_4                 1.108829e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.929
    reference variance = 0.1859
====================================================
  Execution time = 2.0805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4214e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342172948308
                                         uncertainty =       0.004871548999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342172948308
                                         uncertainty =       0.004871548999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605159
  error estimate for blocks of size 2^( 2) =       0.000427683715
  error estimate for blocks of size 2^( 3) =       0.000442957682
  error estimate for blocks of size 2^( 4) =       0.000458975251
  error estimate for blocks of size 2^( 5) =       0.000475029093
  error estimate for blocks of size 2^( 6) =       0.000489326126
  error estimate for blocks of size 2^( 7) =       0.000498942453

      target function =                  N/A
              le_mean =     -16.918466485124
             les_mean =     286.576646492214
             stat err =       0.000480568231
             autocorr =       1.350013838152
              std dev =       0.584926025263
             le_variance =       0.342138455029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691846648512e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918466485124       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918468023878       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918468476292       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918468558370       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918468760766       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918468685345       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918468666811       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918468680118       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918468681067       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 8.167628e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918466485124       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918466876315       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918466991861       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918467014587       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918467066477       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918467048459       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918467043203       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918467046058       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918467046487       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.054906e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918466485124       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918466583337       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918466612386       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918466618216       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918466631278       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918466626835       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918466625481       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918466626159       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918466626280       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 5.145046e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089634 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6373e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.081340e-01 1 1  ON 0
 uu_1                 1.417596e-01 1 1  ON 1
 uu_2                 4.121578e-02 1 1  ON 2
 uu_3                -2.024060e-02 1 1  ON 3
 uu_4                -6.380589e-02 1 1  ON 4
 uu_5                -9.658170e-02 1 1  ON 5
 uu_6                -1.231295e-01 1 1  ON 6
 uu_7                -1.364480e-01 1 1  ON 7
 uu_8                -1.290832e-01 1 1  ON 8
 uu_9                -9.978846e-02 1 1  ON 9
 ud_0                 4.434627e-01 1 1  ON 10
 ud_1                 1.774714e-01 1 1  ON 11
 ud_2                 5.729519e-02 1 1  ON 12
 ud_3                -1.308351e-02 1 1  ON 13
 ud_4                -6.887126e-02 1 1  ON 14
 ud_5                -1.077628e-01 1 1  ON 15
 ud_6                -1.325594e-01 1 1  ON 16
 ud_7                -1.467410e-01 1 1  ON 17
 ud_8                -1.454657e-01 1 1  ON 18
 ud_9                -1.351052e-01 1 1  ON 19
 eO_0                -7.647281e-01 1 1  ON 20
 eO_1                -4.429890e-01 1 1  ON 21
 eO_2                -2.113626e-02 1 1  ON 22
 eO_3                 3.007375e-01 1 1  ON 23
 eO_4                 5.263098e-01 1 1  ON 24
 eO_5                 4.823994e-01 1 1  ON 25
 eO_6                 2.508080e-01 1 1  ON 26
 eO_7                -4.898849e-02 1 1  ON 27
 eO_8                -2.108367e-01 1 1  ON 28
 eO_9                -7.178629e-02 1 1  ON 29
eH1_0                -2.368222e-01 1 1  ON 30
eH1_1                -1.377187e-01 1 1  ON 31
eH1_2                -9.205263e-02 1 1  ON 32
eH1_3                -3.799916e-02 1 1  ON 33
eH1_4                 7.292350e-03 1 1  ON 34
eH1_5                 4.116229e-02 1 1  ON 35
eH1_6                 9.662939e-02 1 1  ON 36
eH1_7                 1.470906e-01 1 1  ON 37
eH1_8                 1.643123e-01 1 1  ON 38
eH1_9                 5.150492e-02 1 1  ON 39
eH2_0                -2.336090e-01 1 1  ON 40
eH2_1                -1.347587e-01 1 1  ON 41
eH2_2                -8.895066e-02 1 1  ON 42
eH2_3                -3.492774e-02 1 1  ON 43
eH2_4                 1.108194e-02 1 1  ON 44
eH2_5                 4.340178e-02 1 1  ON 45
eH2_6                 9.947567e-02 1 1  ON 46
eH2_7                 1.513531e-01 1 1  ON 47
eH2_8                 1.698106e-01 1 1  ON 48
eH2_9                 3.490874e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9621
    reference variance = 0.353621
====================================================
  Execution time = 2.2519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3483e-01
  Total weights = 2.0000e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334498208757
                                         uncertainty =       0.002925935223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334498208757
                                         uncertainty =       0.002925935223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409160599
  error estimate for blocks of size 2^( 2) =       0.000422921028
  error estimate for blocks of size 2^( 3) =       0.000437734810
  error estimate for blocks of size 2^( 4) =       0.000452396218
  error estimate for blocks of size 2^( 5) =       0.000466084376
  error estimate for blocks of size 2^( 6) =       0.000476350392
  error estimate for blocks of size 2^( 7) =       0.000485111250

      target function =                  N/A
              le_mean =     -16.918740861751
             les_mean =     286.578616971243
             stat err =       0.000469985559
             autocorr =       1.319414996266
              std dev =       0.578640468326
             le_variance =       0.334824791584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334510482192
                                         uncertainty =       0.002926019653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334510482192
                                         uncertainty =       0.002926019653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409168108
  error estimate for blocks of size 2^( 2) =       0.000422927008
  error estimate for blocks of size 2^( 3) =       0.000437739257
  error estimate for blocks of size 2^( 4) =       0.000452399579
  error estimate for blocks of size 2^( 5) =       0.000466085580
  error estimate for blocks of size 2^( 6) =       0.000476349681
  error estimate for blocks of size 2^( 7) =       0.000485111019

      target function =                  N/A
              le_mean =     -16.918740507581
             les_mean =     286.578617276629
             stat err =       0.000469986465
             autocorr =       1.319371654428
              std dev =       0.578651087602
             le_variance =       0.334837081183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334505091845
                                         uncertainty =       0.002925978721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334505091845
                                         uncertainty =       0.002925978721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409164811
  error estimate for blocks of size 2^( 2) =       0.000422924418
  error estimate for blocks of size 2^( 3) =       0.000437737379
  error estimate for blocks of size 2^( 4) =       0.000452398231
  error estimate for blocks of size 2^( 5) =       0.000466085265
  error estimate for blocks of size 2^( 6) =       0.000476350343
  error estimate for blocks of size 2^( 7) =       0.000485111440

      target function =                  N/A
              le_mean =     -16.918740661759
             les_mean =     286.578617097184
             stat err =       0.000469986320
             autocorr =       1.319392106520
              std dev =       0.578646424622
             le_variance =       0.334831684728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334499087397
                                         uncertainty =       0.002925940692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334499087397
                                         uncertainty =       0.002925940692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409161137
  error estimate for blocks of size 2^( 2) =       0.000422921460
  error estimate for blocks of size 2^( 3) =       0.000437735138
  error estimate for blocks of size 2^( 4) =       0.000452396475
  error estimate for blocks of size 2^( 5) =       0.000466084492
  error estimate for blocks of size 2^( 6) =       0.000476350391
  error estimate for blocks of size 2^( 7) =       0.000485111278

      target function =                  N/A
              le_mean =     -16.918740834814
             les_mean =     286.578616939742
             stat err =       0.000469985659
             autocorr =       1.319412091716
              std dev =       0.578641228696
             le_variance =       0.334825671547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918740861751        initial  <--
     6.2500e+00     6.2500e+01             8.1676e-05       -16.918740507581
     2.5000e+01     2.5000e+02             2.0549e-05       -16.918740661759
     1.0000e+02     1.0000e+03             5.1450e-06       -16.918740834814

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0051
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119615e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731344e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492964e-02 1 1  ON 43
eH2_4                 1.108829e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8384e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9814
    reference variance = 0.224648
====================================================
  Execution time = 2.0817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335293326502
                                         uncertainty =       0.003152996346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335293326502
                                         uncertainty =       0.003152996346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409419270
  error estimate for blocks of size 2^( 2) =       0.000423747498
  error estimate for blocks of size 2^( 3) =       0.000438806023
  error estimate for blocks of size 2^( 4) =       0.000454267811
  error estimate for blocks of size 2^( 5) =       0.000469549834
  error estimate for blocks of size 2^( 6) =       0.000482959881
  error estimate for blocks of size 2^( 7) =       0.000493423816

      target function =                  N/A
              le_mean =     -16.918621264385
             les_mean =     286.574993596645
             stat err =       0.000475050336
             autocorr =       1.346302648135
              std dev =       0.579006283699
             le_variance =       0.335248276563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691862126439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918621264385       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918621436358       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918621472036       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918621479939       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918621466239       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918621484204       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918621484973       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918621486168       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.039452e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918621264385       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918621307449       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918621316384       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918621318364       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918621314932       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918621319406       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918621319600       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918621319905       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.011051e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918621264385       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918621275156       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918621277390       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918621277886       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918621277027       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918621278145       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918621278193       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918621278266       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 5.028366e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6400e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081474e-01 1 1  ON 0
 uu_1                 1.417669e-01 1 1  ON 1
 uu_2                 4.119791e-02 1 1  ON 2
 uu_3                -2.024818e-02 1 1  ON 3
 uu_4                -6.380437e-02 1 1  ON 4
 uu_5                -9.658046e-02 1 1  ON 5
 uu_6                -1.231266e-01 1 1  ON 6
 uu_7                -1.364428e-01 1 1  ON 7
 uu_8                -1.290785e-01 1 1  ON 8
 uu_9                -9.978730e-02 1 1  ON 9
 ud_0                 4.434614e-01 1 1  ON 10
 ud_1                 1.774861e-01 1 1  ON 11
 ud_2                 5.731184e-02 1 1  ON 12
 ud_3                -1.306950e-02 1 1  ON 13
 ud_4                -6.886885e-02 1 1  ON 14
 ud_5                -1.077640e-01 1 1  ON 15
 ud_6                -1.325678e-01 1 1  ON 16
 ud_7                -1.467495e-01 1 1  ON 17
 ud_8                -1.454791e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647241e-01 1 1  ON 20
 eO_1                -4.429705e-01 1 1  ON 21
 eO_2                -2.112884e-02 1 1  ON 22
 eO_3                 3.007374e-01 1 1  ON 23
 eO_4                 5.262998e-01 1 1  ON 24
 eO_5                 4.823843e-01 1 1  ON 25
 eO_6                 2.508025e-01 1 1  ON 26
 eO_7                -4.899081e-02 1 1  ON 27
 eO_8                -2.108360e-01 1 1  ON 28
 eO_9                -7.178404e-02 1 1  ON 29
eH1_0                -2.368205e-01 1 1  ON 30
eH1_1                -1.377209e-01 1 1  ON 31
eH1_2                -9.204425e-02 1 1  ON 32
eH1_3                -3.799829e-02 1 1  ON 33
eH1_4                 7.292073e-03 1 1  ON 34
eH1_5                 4.117098e-02 1 1  ON 35
eH1_6                 9.663434e-02 1 1  ON 36
eH1_7                 1.470858e-01 1 1  ON 37
eH1_8                 1.643045e-01 1 1  ON 38
eH1_9                 5.149670e-02 1 1  ON 39
eH2_0                -2.336050e-01 1 1  ON 40
eH2_1                -1.347553e-01 1 1  ON 41
eH2_2                -8.894432e-02 1 1  ON 42
eH2_3                -3.492950e-02 1 1  ON 43
eH2_4                 1.108785e-02 1 1  ON 44
eH2_5                 4.339680e-02 1 1  ON 45
eH2_6                 9.947730e-02 1 1  ON 46
eH2_7                 1.513521e-01 1 1  ON 47
eH2_8                 1.698060e-01 1 1  ON 48
eH2_9                 3.490103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9782
    reference variance = 0.237565
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4331e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285072848
                                         uncertainty =       0.004734656610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285072848
                                         uncertainty =       0.004734656610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414315152
  error estimate for blocks of size 2^( 2) =       0.000428157743
  error estimate for blocks of size 2^( 3) =       0.000442535900
  error estimate for blocks of size 2^( 4) =       0.000456652201
  error estimate for blocks of size 2^( 5) =       0.000470184837
  error estimate for blocks of size 2^( 6) =       0.000483152541
  error estimate for blocks of size 2^( 7) =       0.000491602427

      target function =                  N/A
              le_mean =     -16.918806044312
             les_mean =     286.589311883472
             stat err =       0.000475398002
             autocorr =       1.316597637447
              std dev =       0.585930106829
             le_variance =       0.343314090088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343286321016
                                         uncertainty =       0.004734860335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343286321016
                                         uncertainty =       0.004734860335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414315907
  error estimate for blocks of size 2^( 2) =       0.000428158310
  error estimate for blocks of size 2^( 3) =       0.000442536214
  error estimate for blocks of size 2^( 4) =       0.000456652136
  error estimate for blocks of size 2^( 5) =       0.000470184461
  error estimate for blocks of size 2^( 6) =       0.000483151792
  error estimate for blocks of size 2^( 7) =       0.000491601352

      target function =                  N/A
              le_mean =     -16.918805995947
             les_mean =     286.589311498255
             stat err =       0.000475397435
             autocorr =       1.316589701462
              std dev =       0.585931174656
             le_variance =       0.343315341434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285697831
                                         uncertainty =       0.004734758752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285697831
                                         uncertainty =       0.004734758752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414315530
  error estimate for blocks of size 2^( 2) =       0.000428158027
  error estimate for blocks of size 2^( 3) =       0.000442536056
  error estimate for blocks of size 2^( 4) =       0.000456652168
  error estimate for blocks of size 2^( 5) =       0.000470184648
  error estimate for blocks of size 2^( 6) =       0.000483152164
  error estimate for blocks of size 2^( 7) =       0.000491601887

      target function =                  N/A
              le_mean =     -16.918806019925
             les_mean =     286.589311684864
             stat err =       0.000475397717
             autocorr =       1.316593655924
              std dev =       0.585930641521
             le_variance =       0.343314716673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285150937
                                         uncertainty =       0.004734669386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285150937
                                         uncertainty =       0.004734669386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414315199
  error estimate for blocks of size 2^( 2) =       0.000428157778
  error estimate for blocks of size 2^( 3) =       0.000442535919
  error estimate for blocks of size 2^( 4) =       0.000456652197
  error estimate for blocks of size 2^( 5) =       0.000470184813
  error estimate for blocks of size 2^( 6) =       0.000483152494
  error estimate for blocks of size 2^( 7) =       0.000491602359

      target function =                  N/A
              le_mean =     -16.918806041245
             les_mean =     286.589311857994
             stat err =       0.000475397966
             autocorr =       1.316597139303
              std dev =       0.585930173637
             le_variance =       0.343314168378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918806044312        initial  <--
     6.2500e+01     6.2500e+02             8.0395e-06       -16.918805995947
     2.5000e+02     2.5000e+03             2.0111e-06       -16.918806019925
     1.0000e+03     1.0000e+04             5.0284e-07       -16.918806041245

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9743
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119615e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731344e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492964e-02 1 1  ON 43
eH2_4                 1.108829e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6936e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8126
    reference variance = 0.229432
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341265303450
                                         uncertainty =       0.003685768754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341265303450
                                         uncertainty =       0.003685768754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413018422
  error estimate for blocks of size 2^( 2) =       0.000426563151
  error estimate for blocks of size 2^( 3) =       0.000441072371
  error estimate for blocks of size 2^( 4) =       0.000455834459
  error estimate for blocks of size 2^( 5) =       0.000470112788
  error estimate for blocks of size 2^( 6) =       0.000480760531
  error estimate for blocks of size 2^( 7) =       0.000489681481

      target function =                  N/A
              le_mean =     -16.918871154469
             les_mean =     286.589369404558
             stat err =       0.000474097314
             autocorr =       1.317638101655
              std dev =       0.584096253736
             le_variance =       0.341168433629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691887115447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918871154469       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918871163038       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918871169222       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918871172658       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918871173684       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918871173756       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918871173580       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918871173723       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918871173665       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 8.725039e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918871154469       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918871156611       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918871158158       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918871159018       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918871159274       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918871159292       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918871159248       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918871159288       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918871159274       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.182426e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918871154469       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918871155004       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918871155391       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918871155606       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918871155674       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918871155679       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918871155659       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918871155681       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918871155671       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 5.456793e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6340e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.081482e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119637e-02 1 1  ON 2
 uu_3                -2.024872e-02 1 1  ON 3
 uu_4                -6.380439e-02 1 1  ON 4
 uu_5                -9.658014e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290782e-01 1 1  ON 8
 uu_9                -9.978686e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731327e-02 1 1  ON 12
 ud_3                -1.306829e-02 1 1  ON 13
 ud_4                -6.886892e-02 1 1  ON 14
 ud_5                -1.077645e-01 1 1  ON 15
 ud_6                -1.325690e-01 1 1  ON 16
 ud_7                -1.467503e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647235e-01 1 1  ON 20
 eO_1                -4.429686e-01 1 1  ON 21
 eO_2                -2.112850e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262984e-01 1 1  ON 24
 eO_5                 4.823829e-01 1 1  ON 25
 eO_6                 2.508017e-01 1 1  ON 26
 eO_7                -4.899112e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178349e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204320e-02 1 1  ON 32
eH1_3                -3.799845e-02 1 1  ON 33
eH1_4                 7.292546e-03 1 1  ON 34
eH1_5                 4.117147e-02 1 1  ON 35
eH1_6                 9.663404e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643040e-01 1 1  ON 38
eH1_9                 5.149614e-02 1 1  ON 39
eH2_0                -2.336050e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894332e-02 1 1  ON 42
eH2_3                -3.492959e-02 1 1  ON 43
eH2_4                 1.108820e-02 1 1  ON 44
eH2_5                 4.339662e-02 1 1  ON 45
eH2_6                 9.947765e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490027e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.7071
    reference variance = 2.71289
====================================================
  Execution time = 2.0860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.9995e-01
  Total weights = 2.0000e+06
  Execution time = 2.0603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399688002534
                                         uncertainty =       0.066107961990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399688002534
                                         uncertainty =       0.066107961990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447187317
  error estimate for blocks of size 2^( 2) =       0.000459675431
  error estimate for blocks of size 2^( 3) =       0.000473169330
  error estimate for blocks of size 2^( 4) =       0.000487515763
  error estimate for blocks of size 2^( 5) =       0.000500784225
  error estimate for blocks of size 2^( 6) =       0.000512245258
  error estimate for blocks of size 2^( 7) =       0.000521861739

      target function =                  N/A
              le_mean =     -16.918905888928
             les_mean =     286.649329271520
             stat err =       0.000505601746
             autocorr =       1.278315853882
              std dev =       0.632418368731
             le_variance =       0.399952993109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399687685228
                                         uncertainty =       0.066107716879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399687685228
                                         uncertainty =       0.066107716879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447187141
  error estimate for blocks of size 2^( 2) =       0.000459675238
  error estimate for blocks of size 2^( 3) =       0.000473169122
  error estimate for blocks of size 2^( 4) =       0.000487515541
  error estimate for blocks of size 2^( 5) =       0.000500783988
  error estimate for blocks of size 2^( 6) =       0.000512245024
  error estimate for blocks of size 2^( 7) =       0.000521861524

      target function =                  N/A
              le_mean =     -16.918905886398
             les_mean =     286.649328870888
             stat err =       0.000505601519
             autocorr =       1.278315712321
              std dev =       0.632418119652
             le_variance =       0.399952678064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399687843836
                                         uncertainty =       0.066107839387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399687843836
                                         uncertainty =       0.066107839387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447187229
  error estimate for blocks of size 2^( 2) =       0.000459675334
  error estimate for blocks of size 2^( 3) =       0.000473169226
  error estimate for blocks of size 2^( 4) =       0.000487515652
  error estimate for blocks of size 2^( 5) =       0.000500784107
  error estimate for blocks of size 2^( 6) =       0.000512245141
  error estimate for blocks of size 2^( 7) =       0.000521861631

      target function =                  N/A
              le_mean =     -16.918905887660
             les_mean =     286.649329071074
             stat err =       0.000505601633
             autocorr =       1.278315783060
              std dev =       0.632418244156
             le_variance =       0.399952835542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399687982695
                                         uncertainty =       0.066107946663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399687982695
                                         uncertainty =       0.066107946663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447187306
  error estimate for blocks of size 2^( 2) =       0.000459675418
  error estimate for blocks of size 2^( 3) =       0.000473169317
  error estimate for blocks of size 2^( 4) =       0.000487515749
  error estimate for blocks of size 2^( 5) =       0.000500784211
  error estimate for blocks of size 2^( 6) =       0.000512245243
  error estimate for blocks of size 2^( 7) =       0.000521861726

      target function =                  N/A
              le_mean =     -16.918905888769
             les_mean =     286.649329246456
             stat err =       0.000505601732
             autocorr =       1.278315845038
              std dev =       0.632418353158
             le_variance =       0.399952973411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918905888928        initial  <--
     6.2500e+02     6.2500e+03             8.7250e-07       -16.918905886398
     2.5000e+03     2.5000e+04             2.1824e-07       -16.918905887660
     1.0000e+04     1.0000e+05             5.4568e-08       -16.918905888769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7489
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119615e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731344e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492964e-02 1 1  ON 43
eH2_4                 1.108829e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9838
    reference variance = 0.188897
====================================================
  Execution time = 2.0694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3404e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334108515294
                                         uncertainty =       0.003271270301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334108515294
                                         uncertainty =       0.003271270301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408679027
  error estimate for blocks of size 2^( 2) =       0.000422645306
  error estimate for blocks of size 2^( 3) =       0.000437373912
  error estimate for blocks of size 2^( 4) =       0.000452590240
  error estimate for blocks of size 2^( 5) =       0.000466927862
  error estimate for blocks of size 2^( 6) =       0.000479585222
  error estimate for blocks of size 2^( 7) =       0.000485209708

      target function =                  N/A
              le_mean =     -16.919299646793
             les_mean =     286.596737465282
             stat err =       0.000471078258
             autocorr =       1.328683126554
              std dev =       0.577959422734
             le_variance =       0.334037094327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691929964679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919299646793       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919299647497       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919299647581       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919299647557       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919299647439       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919299647488       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919299647520       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919299647550       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 7.357964e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919299646793       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919299646969       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919299646990       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919299646984       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919299646952       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919299646966       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919299646970       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919299646977       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.839586e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919299646793       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919299646837       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919299646842       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919299646837       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919299646872       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919299646857       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919299646842       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919299646835       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+05 is 4.599024e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6222e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119617e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380441e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978681e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731342e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292532e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663405e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894327e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947766e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.331086
====================================================
  Execution time = 2.0245e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4293e-01
  Total weights = 2.0000e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927915364
                                         uncertainty =       0.008751711781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927915364
                                         uncertainty =       0.008751711781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414081093
  error estimate for blocks of size 2^( 2) =       0.000427731348
  error estimate for blocks of size 2^( 3) =       0.000442845307
  error estimate for blocks of size 2^( 4) =       0.000458471276
  error estimate for blocks of size 2^( 5) =       0.000473224736
  error estimate for blocks of size 2^( 6) =       0.000487065073
  error estimate for blocks of size 2^( 7) =       0.000495917751

      target function =                  N/A
              le_mean =     -16.919050695986
             les_mean =     286.597202584447
             stat err =       0.000478669709
             autocorr =       1.336291142743
              std dev =       0.585599097145
             le_variance =       0.342926302577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927943695
                                         uncertainty =       0.008751712549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927943695
                                         uncertainty =       0.008751712549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414081110
  error estimate for blocks of size 2^( 2) =       0.000427731362
  error estimate for blocks of size 2^( 3) =       0.000442845318
  error estimate for blocks of size 2^( 4) =       0.000458471284
  error estimate for blocks of size 2^( 5) =       0.000473224743
  error estimate for blocks of size 2^( 6) =       0.000487065080
  error estimate for blocks of size 2^( 7) =       0.000495917752

      target function =                  N/A
              le_mean =     -16.919050695917
             les_mean =     286.597202610427
             stat err =       0.000478669715
             autocorr =       1.336291064625
              std dev =       0.585599121325
             le_variance =       0.342926330896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927929530
                                         uncertainty =       0.008751712165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927929530
                                         uncertainty =       0.008751712165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414081101
  error estimate for blocks of size 2^( 2) =       0.000427731355
  error estimate for blocks of size 2^( 3) =       0.000442845312
  error estimate for blocks of size 2^( 4) =       0.000458471280
  error estimate for blocks of size 2^( 5) =       0.000473224740
  error estimate for blocks of size 2^( 6) =       0.000487065076
  error estimate for blocks of size 2^( 7) =       0.000495917752

      target function =                  N/A
              le_mean =     -16.919050695951
             les_mean =     286.597202597437
             stat err =       0.000478669712
             autocorr =       1.336291103681
              std dev =       0.585599109236
             le_variance =       0.342926316738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927917135
                                         uncertainty =       0.008751711829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342927917135
                                         uncertainty =       0.008751711829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414081094
  error estimate for blocks of size 2^( 2) =       0.000427731349
  error estimate for blocks of size 2^( 3) =       0.000442845308
  error estimate for blocks of size 2^( 4) =       0.000458471276
  error estimate for blocks of size 2^( 5) =       0.000473224737
  error estimate for blocks of size 2^( 6) =       0.000487065073
  error estimate for blocks of size 2^( 7) =       0.000495917751

      target function =                  N/A
              le_mean =     -16.919050695981
             les_mean =     286.597202586071
             stat err =       0.000478669709
             autocorr =       1.336291137855
              std dev =       0.585599098657
             le_variance =       0.342926304347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919050695986        initial  <--
     6.2500e+03     6.2500e+04             7.3580e-08       -16.919050695917
     2.5000e+04     2.5000e+05             1.8396e-08       -16.919050695951
     1.0000e+05     1.0000e+06             4.5990e-09       -16.919050695981

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6963
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119615e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731344e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492964e-02 1 1  ON 43
eH2_4                 1.108829e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5924e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 0.164254
====================================================
  Execution time = 2.0642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4094e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340862597925
                                         uncertainty =       0.006302747380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340862597925
                                         uncertainty =       0.006302747380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412881897
  error estimate for blocks of size 2^( 2) =       0.000426855824
  error estimate for blocks of size 2^( 3) =       0.000441428491
  error estimate for blocks of size 2^( 4) =       0.000456494877
  error estimate for blocks of size 2^( 5) =       0.000471307074
  error estimate for blocks of size 2^( 6) =       0.000484009756
  error estimate for blocks of size 2^( 7) =       0.000494687290

      target function =                  N/A
              le_mean =     -16.918165324664
             les_mean =     286.565260703441
             stat err =       0.000476624749
             autocorr =       1.332605181112
              std dev =       0.583903177968
             le_variance =       0.340942921241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691816532466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918165324664       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918165324799       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918165324839       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918165324819       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918165324858       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918165324873       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918165324816       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918165324905       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 7.245053e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918165324664       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918165324698       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918165324708       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918165324711       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918165324712       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918165324725       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918165324889       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918165324713       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.811268e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918165324664       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918165324673       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918165324675       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918165325202       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918165323492       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918165325582       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918165324244       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918165323606       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+06 is 4.528176e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6188e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119615e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731344e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492964e-02 1 1  ON 43
eH2_4                 1.108829e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.270779
====================================================
  Execution time = 2.0349e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4524e-01
  Total weights = 2.0000e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253423777
                                         uncertainty =       0.005659591135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253423777
                                         uncertainty =       0.005659591135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415474913
  error estimate for blocks of size 2^( 2) =       0.000429472574
  error estimate for blocks of size 2^( 3) =       0.000444119207
  error estimate for blocks of size 2^( 4) =       0.000459178995
  error estimate for blocks of size 2^( 5) =       0.000473898105
  error estimate for blocks of size 2^( 6) =       0.000485904306
  error estimate for blocks of size 2^( 7) =       0.000492943621

      target function =                  N/A
              le_mean =     -16.918328376716
             les_mean =     286.575073696800
             stat err =       0.000477981257
             autocorr =       1.323524917877
              std dev =       0.587570257107
             le_variance =       0.345238807037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253424562
                                         uncertainty =       0.005659591267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253424562
                                         uncertainty =       0.005659591267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415474914
  error estimate for blocks of size 2^( 2) =       0.000429472575
  error estimate for blocks of size 2^( 3) =       0.000444119207
  error estimate for blocks of size 2^( 4) =       0.000459178995
  error estimate for blocks of size 2^( 5) =       0.000473898105
  error estimate for blocks of size 2^( 6) =       0.000485904305
  error estimate for blocks of size 2^( 7) =       0.000492943620

      target function =                  N/A
              le_mean =     -16.918328376755
             les_mean =     286.575073698924
             stat err =       0.000477981256
             autocorr =       1.323524912146
              std dev =       0.587570257768
             le_variance =       0.345238807814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253424170
                                         uncertainty =       0.005659591201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253424170
                                         uncertainty =       0.005659591201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415474913
  error estimate for blocks of size 2^( 2) =       0.000429472575
  error estimate for blocks of size 2^( 3) =       0.000444119207
  error estimate for blocks of size 2^( 4) =       0.000459178995
  error estimate for blocks of size 2^( 5) =       0.000473898105
  error estimate for blocks of size 2^( 6) =       0.000485904305
  error estimate for blocks of size 2^( 7) =       0.000492943621

      target function =                  N/A
              le_mean =     -16.918328376736
             les_mean =     286.575073697862
             stat err =       0.000477981257
             autocorr =       1.323524915005
              std dev =       0.587570257438
             le_variance =       0.345238807425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253423826
                                         uncertainty =       0.005659591143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345253423826
                                         uncertainty =       0.005659591143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415474913
  error estimate for blocks of size 2^( 2) =       0.000429472574
  error estimate for blocks of size 2^( 3) =       0.000444119207
  error estimate for blocks of size 2^( 4) =       0.000459178995
  error estimate for blocks of size 2^( 5) =       0.000473898105
  error estimate for blocks of size 2^( 6) =       0.000485904306
  error estimate for blocks of size 2^( 7) =       0.000492943621

      target function =                  N/A
              le_mean =     -16.918328376718
             les_mean =     286.575073696933
             stat err =       0.000477981257
             autocorr =       1.323524917512
              std dev =       0.587570257149
             le_variance =       0.345238807086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918328376716        initial
     6.2500e+04     6.2500e+05             7.2451e-09       -16.918328376755  <--
     2.5000e+05     2.5000e+06             1.8113e-09       -16.918328376736
     1.0000e+06     1.0000e+07             4.5282e-10       -16.918328376718

*****************************************************************************
Applying the update for shift_i =   6.2500e+04     and shift_s =   6.2500e+05
*****************************************************************************

  Execution time = 2.9810e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292528e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6005e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.24205
====================================================
  Execution time = 2.0683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339448620546
                                         uncertainty =       0.003923811953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339448620546
                                         uncertainty =       0.003923811953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412134517
  error estimate for blocks of size 2^( 2) =       0.000425701911
  error estimate for blocks of size 2^( 3) =       0.000440650332
  error estimate for blocks of size 2^( 4) =       0.000456410958
  error estimate for blocks of size 2^( 5) =       0.000471168377
  error estimate for blocks of size 2^( 6) =       0.000483425013
  error estimate for blocks of size 2^( 7) =       0.000492973008

      target function =                  N/A
              le_mean =     -16.919085319457
             les_mean =     286.595157597266
             stat err =       0.000475994339
             autocorr =       1.333907142354
              std dev =       0.582846223328
             le_variance =       0.339709720048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691908531946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919085319457       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919085319941       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919085320140       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919085320093       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919085320154       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919085320131       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919085320132       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919085320128       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.354318e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919085319457       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919085319578       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919085319628       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919085319649       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919085319647       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919085319656       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919085319564       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919085319588       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 8.385861e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919085319457       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919085319487       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919085319500       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919085319497       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919085319507       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919085319324       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919085319531       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919085319509       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 2.096469e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6202e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731342e-02 1 1  ON 12
 ud_3                -1.306823e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112841e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292527e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.299275
====================================================
  Execution time = 2.0154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.5939e-01
  Total weights = 2.0000e+06
  Execution time = 1.8873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307258211
                                         uncertainty =       0.022936236807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307258211
                                         uncertainty =       0.022936236807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423906106
  error estimate for blocks of size 2^( 2) =       0.000437118011
  error estimate for blocks of size 2^( 3) =       0.000451891350
  error estimate for blocks of size 2^( 4) =       0.000466344409
  error estimate for blocks of size 2^( 5) =       0.000481686201
  error estimate for blocks of size 2^( 6) =       0.000494677483
  error estimate for blocks of size 2^( 7) =       0.000504897124

      target function =                  N/A
              le_mean =     -16.918625700499
             les_mean =     286.599288188112
             stat err =       0.000486901304
             autocorr =       1.319296862950
              std dev =       0.599493764953
             le_variance =       0.359392774217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307262575
                                         uncertainty =       0.022936242960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307262575
                                         uncertainty =       0.022936242960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423906109
  error estimate for blocks of size 2^( 2) =       0.000437118013
  error estimate for blocks of size 2^( 3) =       0.000451891351
  error estimate for blocks of size 2^( 4) =       0.000466344409
  error estimate for blocks of size 2^( 5) =       0.000481686201
  error estimate for blocks of size 2^( 6) =       0.000494677482
  error estimate for blocks of size 2^( 7) =       0.000504897122

      target function =                  N/A
              le_mean =     -16.918625700150
             les_mean =     286.599288180630
             stat err =       0.000486901303
             autocorr =       1.319296844017
              std dev =       0.599493768565
             le_variance =       0.359392778549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307260393
                                         uncertainty =       0.022936239884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307260393
                                         uncertainty =       0.022936239884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423906108
  error estimate for blocks of size 2^( 2) =       0.000437118012
  error estimate for blocks of size 2^( 3) =       0.000451891351
  error estimate for blocks of size 2^( 4) =       0.000466344409
  error estimate for blocks of size 2^( 5) =       0.000481686201
  error estimate for blocks of size 2^( 6) =       0.000494677482
  error estimate for blocks of size 2^( 7) =       0.000504897123

      target function =                  N/A
              le_mean =     -16.918625700325
             les_mean =     286.599288184371
             stat err =       0.000486901304
             autocorr =       1.319296853484
              std dev =       0.599493766759
             le_variance =       0.359392776383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307258484
                                         uncertainty =       0.022936237191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359307258484
                                         uncertainty =       0.022936237191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423906107
  error estimate for blocks of size 2^( 2) =       0.000437118011
  error estimate for blocks of size 2^( 3) =       0.000451891350
  error estimate for blocks of size 2^( 4) =       0.000466344409
  error estimate for blocks of size 2^( 5) =       0.000481686201
  error estimate for blocks of size 2^( 6) =       0.000494677483
  error estimate for blocks of size 2^( 7) =       0.000504897124

      target function =                  N/A
              le_mean =     -16.918625700477
             les_mean =     286.599288187645
             stat err =       0.000486901304
             autocorr =       1.319296861779
              std dev =       0.599493765179
             le_variance =       0.359392774488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918625700499        initial  <--
     1.5625e+04     1.5625e+05             3.3543e-08       -16.918625700150
     6.2500e+04     6.2500e+05             8.3859e-09       -16.918625700325
     2.5000e+05     2.5000e+06             2.0965e-09       -16.918625700477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0453
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292528e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0345
    reference variance = 0.276364
====================================================
  Execution time = 2.0672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339629758758
                                         uncertainty =       0.004852103542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339629758758
                                         uncertainty =       0.004852103542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412033174
  error estimate for blocks of size 2^( 2) =       0.000426172116
  error estimate for blocks of size 2^( 3) =       0.000440735764
  error estimate for blocks of size 2^( 4) =       0.000455553461
  error estimate for blocks of size 2^( 5) =       0.000470283387
  error estimate for blocks of size 2^( 6) =       0.000481862328
  error estimate for blocks of size 2^( 7) =       0.000490656549

      target function =                  N/A
              le_mean =     -16.918379981114
             les_mean =     286.571123688049
             stat err =       0.000474588931
             autocorr =       1.326694239656
              std dev =       0.582702902407
             le_variance =       0.339542672473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691837998111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918379981114       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918379981161       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918379981185       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918379981181       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918379981310       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918379981247       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918379981276       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918379981174       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 3.271087e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918379981114       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918379981125       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918379981131       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918379981134       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918379981135       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918379981659       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918379980771       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918379980690       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 8.177738e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918379981114       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918379981117       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918379981118       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918379982392       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918379980041       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918379979917       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918379981427       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918379982815       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 2.044433e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6249e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024881e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204311e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.201143
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3638e-01
  Total weights = 2.0000e+06
  Execution time = 1.8843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879216
                                         uncertainty =       0.005039191302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879216
                                         uncertainty =       0.005039191302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410111653
  error estimate for blocks of size 2^( 2) =       0.000424217682
  error estimate for blocks of size 2^( 3) =       0.000438706105
  error estimate for blocks of size 2^( 4) =       0.000453796296
  error estimate for blocks of size 2^( 5) =       0.000468806391
  error estimate for blocks of size 2^( 6) =       0.000482280596
  error estimate for blocks of size 2^( 7) =       0.000493261139

      target function =                  N/A
              le_mean =     -16.918525554993
             les_mean =     286.572889922382
             stat err =       0.000474536105
             autocorr =       1.338857341430
              std dev =       0.579985461570
             le_variance =       0.336383135633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879307
                                         uncertainty =       0.005039191335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879307
                                         uncertainty =       0.005039191335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410111653
  error estimate for blocks of size 2^( 2) =       0.000424217682
  error estimate for blocks of size 2^( 3) =       0.000438706104
  error estimate for blocks of size 2^( 4) =       0.000453796296
  error estimate for blocks of size 2^( 5) =       0.000468806391
  error estimate for blocks of size 2^( 6) =       0.000482280595
  error estimate for blocks of size 2^( 7) =       0.000493261138

      target function =                  N/A
              le_mean =     -16.918525555028
             les_mean =     286.572889923653
             stat err =       0.000474536105
             autocorr =       1.338857339554
              std dev =       0.579985461649
             le_variance =       0.336383135725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879261
                                         uncertainty =       0.005039191318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879261
                                         uncertainty =       0.005039191318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410111653
  error estimate for blocks of size 2^( 2) =       0.000424217682
  error estimate for blocks of size 2^( 3) =       0.000438706105
  error estimate for blocks of size 2^( 4) =       0.000453796296
  error estimate for blocks of size 2^( 5) =       0.000468806391
  error estimate for blocks of size 2^( 6) =       0.000482280596
  error estimate for blocks of size 2^( 7) =       0.000493261138

      target function =                  N/A
              le_mean =     -16.918525555010
             les_mean =     286.572889923018
             stat err =       0.000474536105
             autocorr =       1.338857340501
              std dev =       0.579985461610
             le_variance =       0.336383135679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879221
                                         uncertainty =       0.005039191304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336421879221
                                         uncertainty =       0.005039191304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410111653
  error estimate for blocks of size 2^( 2) =       0.000424217682
  error estimate for blocks of size 2^( 3) =       0.000438706105
  error estimate for blocks of size 2^( 4) =       0.000453796296
  error estimate for blocks of size 2^( 5) =       0.000468806391
  error estimate for blocks of size 2^( 6) =       0.000482280596
  error estimate for blocks of size 2^( 7) =       0.000493261139

      target function =                  N/A
              le_mean =     -16.918525554995
             les_mean =     286.572889922462
             stat err =       0.000474536105
             autocorr =       1.338857341316
              std dev =       0.579985461575
             le_variance =       0.336383135638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918525554993        initial
     1.5625e+05     1.5625e+06             3.2711e-09       -16.918525555028  <--
     6.2500e+05     6.2500e+06             8.1777e-10       -16.918525555010
     2.5000e+06     2.5000e+07             2.0444e-10       -16.918525554995

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 2.9984e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8634
    reference variance = 0.214902
====================================================
  Execution time = 2.0927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4479e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344880274269
                                         uncertainty =       0.006185137841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344880274269
                                         uncertainty =       0.006185137841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415205524
  error estimate for blocks of size 2^( 2) =       0.000428572874
  error estimate for blocks of size 2^( 3) =       0.000443291888
  error estimate for blocks of size 2^( 4) =       0.000457223561
  error estimate for blocks of size 2^( 5) =       0.000470998611
  error estimate for blocks of size 2^( 6) =       0.000482129778
  error estimate for blocks of size 2^( 7) =       0.000488339393

      target function =                  N/A
              le_mean =     -16.918192562331
             les_mean =     286.570030658048
             stat err =       0.000474672836
             autocorr =       1.306960650448
              std dev =       0.587189283213
             le_variance =       0.344791254321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691819256233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918192562331       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918192562488       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918192562548       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918192562556       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918192562570       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918192562540       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918192562540       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918192562559       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.011959e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918192562331       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918192562371       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918192562385       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918192562388       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918192562392       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918192562246       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918192562300       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918192562502       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.529911e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918192562331       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918192562341       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918192562345       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918192562297       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918192562600       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918192562624       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918192562406       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918192562209       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 6.324780e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6451e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112841e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894327e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.27238
====================================================
  Execution time = 2.0402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3928e-01
  Total weights = 2.0000e+06
  Execution time = 1.8771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291458273
                                         uncertainty =       0.003825391966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291458273
                                         uncertainty =       0.003825391966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871323
  error estimate for blocks of size 2^( 2) =       0.000425989137
  error estimate for blocks of size 2^( 3) =       0.000440802114
  error estimate for blocks of size 2^( 4) =       0.000456531214
  error estimate for blocks of size 2^( 5) =       0.000472055137
  error estimate for blocks of size 2^( 6) =       0.000485250068
  error estimate for blocks of size 2^( 7) =       0.000496610092

      target function =                  N/A
              le_mean =     -16.918451384736
             les_mean =     286.573273061209
             stat err =       0.000477611628
             autocorr =       1.344703928662
              std dev =       0.582474010730
             le_variance =       0.339275973176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291462835
                                         uncertainty =       0.003825392026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291462835
                                         uncertainty =       0.003825392026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871326
  error estimate for blocks of size 2^( 2) =       0.000425989139
  error estimate for blocks of size 2^( 3) =       0.000440802116
  error estimate for blocks of size 2^( 4) =       0.000456531216
  error estimate for blocks of size 2^( 5) =       0.000472055138
  error estimate for blocks of size 2^( 6) =       0.000485250068
  error estimate for blocks of size 2^( 7) =       0.000496610092

      target function =                  N/A
              le_mean =     -16.918451384726
             les_mean =     286.573273065432
             stat err =       0.000477611629
             autocorr =       1.344703914893
              std dev =       0.582474014649
             le_variance =       0.339275977742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291460554
                                         uncertainty =       0.003825391996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291460554
                                         uncertainty =       0.003825391996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871324
  error estimate for blocks of size 2^( 2) =       0.000425989138
  error estimate for blocks of size 2^( 3) =       0.000440802115
  error estimate for blocks of size 2^( 4) =       0.000456531215
  error estimate for blocks of size 2^( 5) =       0.000472055137
  error estimate for blocks of size 2^( 6) =       0.000485250068
  error estimate for blocks of size 2^( 7) =       0.000496610092

      target function =                  N/A
              le_mean =     -16.918451384731
             les_mean =     286.573273063320
             stat err =       0.000477611628
             autocorr =       1.344703921774
              std dev =       0.582474012690
             le_variance =       0.339275975459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291458558
                                         uncertainty =       0.003825391970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291458558
                                         uncertainty =       0.003825391970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871323
  error estimate for blocks of size 2^( 2) =       0.000425989137
  error estimate for blocks of size 2^( 3) =       0.000440802115
  error estimate for blocks of size 2^( 4) =       0.000456531214
  error estimate for blocks of size 2^( 5) =       0.000472055137
  error estimate for blocks of size 2^( 6) =       0.000485250068
  error estimate for blocks of size 2^( 7) =       0.000496610092

      target function =                  N/A
              le_mean =     -16.918451384735
             les_mean =     286.573273061473
             stat err =       0.000477611628
             autocorr =       1.344703927810
              std dev =       0.582474010975
             le_variance =       0.339275973461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918451384736        initial  <--
     3.9062e+04     3.9062e+05             1.0120e-08       -16.918451384726
     1.5625e+05     1.5625e+06             2.5299e-09       -16.918451384731
     6.2500e+05     6.2500e+06             6.3248e-10       -16.918451384735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8723
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.541176
====================================================
  Execution time = 2.2779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382639319
                                         uncertainty =       0.003078627230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382639319
                                         uncertainty =       0.003078627230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407701953
  error estimate for blocks of size 2^( 2) =       0.000421362879
  error estimate for blocks of size 2^( 3) =       0.000436494049
  error estimate for blocks of size 2^( 4) =       0.000451569705
  error estimate for blocks of size 2^( 5) =       0.000466712402
  error estimate for blocks of size 2^( 6) =       0.000478931580
  error estimate for blocks of size 2^( 7) =       0.000486917626

      target function =                  N/A
              le_mean =     -16.918612055889
             les_mean =     286.571875496063
             stat err =       0.000471032828
             autocorr =       1.334801754366
              std dev =       0.576577631039
             le_variance =       0.332441764614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691861205589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918612055889       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918612055904       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918612055909       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918612055892       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918612056170       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918612056172       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918612055906       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918612055476       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918612055113       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.151997e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918612055889       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918612055893       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918612055894       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918612055894       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918612056352       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918612056498       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918612057009       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918612056973       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918612055518       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.879996e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918612055889       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918612055890       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918612055890       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918612053093       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918612052953       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918612051960       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918612055722       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918612056958       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918612055081       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 7.199966e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8306e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8751
    reference variance = 0.246396
====================================================
  Execution time = 2.0228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4210e-01
  Total weights = 2.0000e+06
  Execution time = 1.8894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332645
                                         uncertainty =       0.004938481798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332645
                                         uncertainty =       0.004938481798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413583329
  error estimate for blocks of size 2^( 2) =       0.000426967769
  error estimate for blocks of size 2^( 3) =       0.000441055655
  error estimate for blocks of size 2^( 4) =       0.000455167518
  error estimate for blocks of size 2^( 5) =       0.000468073111
  error estimate for blocks of size 2^( 6) =       0.000479100127
  error estimate for blocks of size 2^( 7) =       0.000487851193

      target function =                  N/A
              le_mean =     -16.919460933630
             les_mean =     286.610260453960
             stat err =       0.000472547987
             autocorr =       1.305466663329
              std dev =       0.584895153324
             le_variance =       0.342102340382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332934
                                         uncertainty =       0.004938481800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332934
                                         uncertainty =       0.004938481800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413583329
  error estimate for blocks of size 2^( 2) =       0.000426967770
  error estimate for blocks of size 2^( 3) =       0.000441055655
  error estimate for blocks of size 2^( 4) =       0.000455167518
  error estimate for blocks of size 2^( 5) =       0.000468073111
  error estimate for blocks of size 2^( 6) =       0.000479100127
  error estimate for blocks of size 2^( 7) =       0.000487851193

      target function =                  N/A
              le_mean =     -16.919460933622
             les_mean =     286.610260453970
             stat err =       0.000472547987
             autocorr =       1.305466662407
              std dev =       0.584895153572
             le_variance =       0.342102340672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332789
                                         uncertainty =       0.004938481799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332789
                                         uncertainty =       0.004938481799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413583329
  error estimate for blocks of size 2^( 2) =       0.000426967770
  error estimate for blocks of size 2^( 3) =       0.000441055655
  error estimate for blocks of size 2^( 4) =       0.000455167518
  error estimate for blocks of size 2^( 5) =       0.000468073111
  error estimate for blocks of size 2^( 6) =       0.000479100127
  error estimate for blocks of size 2^( 7) =       0.000487851193

      target function =                  N/A
              le_mean =     -16.919460933626
             les_mean =     286.610260453965
             stat err =       0.000472547987
             autocorr =       1.305466662866
              std dev =       0.584895153448
             le_variance =       0.342102340527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332663
                                         uncertainty =       0.004938481799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342121332663
                                         uncertainty =       0.004938481799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413583329
  error estimate for blocks of size 2^( 2) =       0.000426967769
  error estimate for blocks of size 2^( 3) =       0.000441055655
  error estimate for blocks of size 2^( 4) =       0.000455167518
  error estimate for blocks of size 2^( 5) =       0.000468073111
  error estimate for blocks of size 2^( 6) =       0.000479100127
  error estimate for blocks of size 2^( 7) =       0.000487851193

      target function =                  N/A
              le_mean =     -16.919460933629
             les_mean =     286.610260453961
             stat err =       0.000472547987
             autocorr =       1.305466663268
              std dev =       0.584895153339
             le_variance =       0.342102340400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919460933630        initial  <--
     3.9062e+05     3.9062e+06             1.1520e-09       -16.919460933622
     1.5625e+06     1.5625e+07             2.8800e-10       -16.919460933626
     6.2500e+06     6.2500e+07             7.2000e-11       -16.919460933629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7535
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8066e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9019
    reference variance = 0.307029
====================================================
  Execution time = 2.0967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331035468499
                                         uncertainty =       0.002975986076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331035468499
                                         uncertainty =       0.002975986076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406846656
  error estimate for blocks of size 2^( 2) =       0.000420606497
  error estimate for blocks of size 2^( 3) =       0.000435569079
  error estimate for blocks of size 2^( 4) =       0.000451287178
  error estimate for blocks of size 2^( 5) =       0.000467038784
  error estimate for blocks of size 2^( 6) =       0.000480240561
  error estimate for blocks of size 2^( 7) =       0.000488414572

      target function =                  N/A
              le_mean =     -16.917986323864
             les_mean =     286.549309491234
             stat err =       0.000471745274
             autocorr =       1.344477735160
              std dev =       0.575368058120
             le_variance =       0.331048402305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691798632386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917986323864       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917986323865       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917986323866       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917986323539       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.917986323865       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.917986322830       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.917986323739       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.917986329073       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.356516e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917986323864       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917986323864       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917986323864       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917986323864       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.917986327907       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.917986311826       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.917986323598       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.917986322829       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 3.391281e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917986323864       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917986323864       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917986323864       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917986320213       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.917986323818       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.917986264155       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.917986318104       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.917986285020       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 8.477881e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6462e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9637
    reference variance = 0.279257
====================================================
  Execution time = 2.0277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4297e-01
  Total weights = 2.0000e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567425
                                         uncertainty =       0.005374716051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567425
                                         uncertainty =       0.005374716051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414110153
  error estimate for blocks of size 2^( 2) =       0.000428868245
  error estimate for blocks of size 2^( 3) =       0.000444500436
  error estimate for blocks of size 2^( 4) =       0.000460925626
  error estimate for blocks of size 2^( 5) =       0.000476820937
  error estimate for blocks of size 2^( 6) =       0.000492009633
  error estimate for blocks of size 2^( 7) =       0.000501698589

      target function =                  N/A
              le_mean =     -16.918917890833
             les_mean =     286.592756863481
             stat err =       0.000482863696
             autocorr =       1.359619396095
              std dev =       0.585640195174
             le_variance =       0.342974438204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567438
                                         uncertainty =       0.005374716052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567438
                                         uncertainty =       0.005374716052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414110153
  error estimate for blocks of size 2^( 2) =       0.000428868245
  error estimate for blocks of size 2^( 3) =       0.000444500436
  error estimate for blocks of size 2^( 4) =       0.000460925626
  error estimate for blocks of size 2^( 5) =       0.000476820937
  error estimate for blocks of size 2^( 6) =       0.000492009633
  error estimate for blocks of size 2^( 7) =       0.000501698589

      target function =                  N/A
              le_mean =     -16.918917890832
             les_mean =     286.592756863437
             stat err =       0.000482863696
             autocorr =       1.359619395992
              std dev =       0.585640195185
             le_variance =       0.342974438217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567432
                                         uncertainty =       0.005374716052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567432
                                         uncertainty =       0.005374716052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414110153
  error estimate for blocks of size 2^( 2) =       0.000428868245
  error estimate for blocks of size 2^( 3) =       0.000444500436
  error estimate for blocks of size 2^( 4) =       0.000460925626
  error estimate for blocks of size 2^( 5) =       0.000476820937
  error estimate for blocks of size 2^( 6) =       0.000492009633
  error estimate for blocks of size 2^( 7) =       0.000501698589

      target function =                  N/A
              le_mean =     -16.918917890833
             les_mean =     286.592756863459
             stat err =       0.000482863696
             autocorr =       1.359619396048
              std dev =       0.585640195180
             le_variance =       0.342974438210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567426
                                         uncertainty =       0.005374716051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343042567426
                                         uncertainty =       0.005374716051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414110153
  error estimate for blocks of size 2^( 2) =       0.000428868245
  error estimate for blocks of size 2^( 3) =       0.000444500436
  error estimate for blocks of size 2^( 4) =       0.000460925626
  error estimate for blocks of size 2^( 5) =       0.000476820937
  error estimate for blocks of size 2^( 6) =       0.000492009633
  error estimate for blocks of size 2^( 7) =       0.000501698589

      target function =                  N/A
              le_mean =     -16.918917890833
             les_mean =     286.592756863478
             stat err =       0.000482863696
             autocorr =       1.359619396087
              std dev =       0.585640195175
             le_variance =       0.342974438204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918917890833        initial  <--
     3.9062e+06     3.9062e+07             1.3565e-10       -16.918917890832
     1.5625e+07     1.5625e+08             3.3913e-11       -16.918917890833
     6.2500e+07     6.2500e+08             8.4779e-12       -16.918917890833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7380
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6206e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9521
    reference variance = 0.449154
====================================================
  Execution time = 2.1164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3131e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331331138998
                                         uncertainty =       0.002497586262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331331138998
                                         uncertainty =       0.002497586262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407007027
  error estimate for blocks of size 2^( 2) =       0.000421137861
  error estimate for blocks of size 2^( 3) =       0.000436214364
  error estimate for blocks of size 2^( 4) =       0.000451095429
  error estimate for blocks of size 2^( 5) =       0.000465980151
  error estimate for blocks of size 2^( 6) =       0.000478400498
  error estimate for blocks of size 2^( 7) =       0.000485389289

      target function =                  N/A
              le_mean =     -16.919006970500
             les_mean =     286.584106142853
             stat err =       0.000470216342
             autocorr =       1.334724466159
              std dev =       0.575594858102
             le_variance =       0.331309440674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691900697050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919006970500       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919006970500       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919006970500       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919006970500       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919006962841       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919006988362       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919006991065       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919006981363       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.919006980088       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 1.340617e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919006970500       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919006970500       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919006970500       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919006976367       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919006957749       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919006763168       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919006841304       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919006858459       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.919006971054       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 3.350647e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919006970500       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919006970500       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919006970500       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919006970500       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919006970500       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919006970500       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919006931341       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919006956876       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.919007436855       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 8.378683e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6591e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8647
    reference variance = 0.171828
====================================================
  Execution time = 2.0562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3477e-01
  Total weights = 2.0000e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049912
                                         uncertainty =       0.003318734294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049912
                                         uncertainty =       0.003318734294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409128726
  error estimate for blocks of size 2^( 2) =       0.000423022208
  error estimate for blocks of size 2^( 3) =       0.000437986743
  error estimate for blocks of size 2^( 4) =       0.000453304273
  error estimate for blocks of size 2^( 5) =       0.000467843084
  error estimate for blocks of size 2^( 6) =       0.000481285039
  error estimate for blocks of size 2^( 7) =       0.000487558212

      target function =                  N/A
              le_mean =     -16.918458597831
             les_mean =     286.569013788287
             stat err =       0.000472497652
             autocorr =       1.333765138836
              std dev =       0.578595393307
             le_variance =       0.334772629156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049911
                                         uncertainty =       0.003318734293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049911
                                         uncertainty =       0.003318734293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409128726
  error estimate for blocks of size 2^( 2) =       0.000423022208
  error estimate for blocks of size 2^( 3) =       0.000437986743
  error estimate for blocks of size 2^( 4) =       0.000453304273
  error estimate for blocks of size 2^( 5) =       0.000467843084
  error estimate for blocks of size 2^( 6) =       0.000481285039
  error estimate for blocks of size 2^( 7) =       0.000487558212

      target function =                  N/A
              le_mean =     -16.918458597831
             les_mean =     286.569013788282
             stat err =       0.000472497652
             autocorr =       1.333765138831
              std dev =       0.578595393306
             le_variance =       0.334772629155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049912
                                         uncertainty =       0.003318734293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049912
                                         uncertainty =       0.003318734293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409128726
  error estimate for blocks of size 2^( 2) =       0.000423022208
  error estimate for blocks of size 2^( 3) =       0.000437986743
  error estimate for blocks of size 2^( 4) =       0.000453304273
  error estimate for blocks of size 2^( 5) =       0.000467843084
  error estimate for blocks of size 2^( 6) =       0.000481285039
  error estimate for blocks of size 2^( 7) =       0.000487558212

      target function =                  N/A
              le_mean =     -16.918458597831
             les_mean =     286.569013788285
             stat err =       0.000472497652
             autocorr =       1.333765138834
              std dev =       0.578595393307
             le_variance =       0.334772629156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049912
                                         uncertainty =       0.003318734293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733049912
                                         uncertainty =       0.003318734293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409128726
  error estimate for blocks of size 2^( 2) =       0.000423022208
  error estimate for blocks of size 2^( 3) =       0.000437986743
  error estimate for blocks of size 2^( 4) =       0.000453304273
  error estimate for blocks of size 2^( 5) =       0.000467843084
  error estimate for blocks of size 2^( 6) =       0.000481285039
  error estimate for blocks of size 2^( 7) =       0.000487558212

      target function =                  N/A
              le_mean =     -16.918458597831
             les_mean =     286.569013788287
             stat err =       0.000472497652
             autocorr =       1.333765138842
              std dev =       0.578595393307
             le_variance =       0.334772629156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918458597831        initial  <--
     3.9062e+07     3.9062e+08             1.3406e-11       -16.918458597831
     1.5625e+08     1.5625e+09             3.3506e-12       -16.918458597831
     6.2500e+08     6.2500e+09             8.3787e-13       -16.918458597831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9617
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9013
    reference variance = 0.20215
====================================================
  Execution time = 2.2700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3594e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910858025
                                         uncertainty =       0.003254408777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910858025
                                         uncertainty =       0.003254408777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409839308
  error estimate for blocks of size 2^( 2) =       0.000423602848
  error estimate for blocks of size 2^( 3) =       0.000438611549
  error estimate for blocks of size 2^( 4) =       0.000454039663
  error estimate for blocks of size 2^( 5) =       0.000470300213
  error estimate for blocks of size 2^( 6) =       0.000484402366
  error estimate for blocks of size 2^( 7) =       0.000492343070

      target function =                  N/A
              le_mean =     -16.918758564909
             les_mean =     286.580327726598
             stat err =       0.000475271328
             autocorr =       1.344794769080
              std dev =       0.579600307871
             le_variance =       0.335936516884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691875856491e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918758564909       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918758564909       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918758564909       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918758564909       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918759035072       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918758718598       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918758693681       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918758580773       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918758606224       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.362855e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918758564909       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918758564909       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918758564909       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918758564909       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918758529780       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918758443295       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918760035451       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918757146069       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918757757612       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 3.400720e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918758564909       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918758564909       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918758564909       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918758564909       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918758692728       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918760292022       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918758694409       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918751946509       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918718501189       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.918758764233       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+09 is 8.475207e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8213e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0436
    reference variance = 0.382251
====================================================
  Execution time = 2.0336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4564e-01
  Total weights = 2.0000e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631314
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631314
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415715779
  error estimate for blocks of size 2^( 2) =       0.000429410836
  error estimate for blocks of size 2^( 3) =       0.000444262017
  error estimate for blocks of size 2^( 4) =       0.000459408862
  error estimate for blocks of size 2^( 5) =       0.000474038301
  error estimate for blocks of size 2^( 6) =       0.000486707123
  error estimate for blocks of size 2^( 7) =       0.000498747959

      target function =                  N/A
              le_mean =     -16.919459557886
             les_mean =     286.613750776076
             stat err =       0.000479725561
             autocorr =       1.331657995531
              std dev =       0.587910892858
             le_variance =       0.345639217941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631313
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631313
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415715779
  error estimate for blocks of size 2^( 2) =       0.000429410836
  error estimate for blocks of size 2^( 3) =       0.000444262017
  error estimate for blocks of size 2^( 4) =       0.000459408862
  error estimate for blocks of size 2^( 5) =       0.000474038301
  error estimate for blocks of size 2^( 6) =       0.000486707123
  error estimate for blocks of size 2^( 7) =       0.000498747959

      target function =                  N/A
              le_mean =     -16.919459557886
             les_mean =     286.613750776076
             stat err =       0.000479725561
             autocorr =       1.331657995532
              std dev =       0.587910892857
             le_variance =       0.345639217940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631313
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631313
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415715779
  error estimate for blocks of size 2^( 2) =       0.000429410836
  error estimate for blocks of size 2^( 3) =       0.000444262017
  error estimate for blocks of size 2^( 4) =       0.000459408862
  error estimate for blocks of size 2^( 5) =       0.000474038301
  error estimate for blocks of size 2^( 6) =       0.000486707123
  error estimate for blocks of size 2^( 7) =       0.000498747959

      target function =                  N/A
              le_mean =     -16.919459557886
             les_mean =     286.613750776076
             stat err =       0.000479725561
             autocorr =       1.331657995533
              std dev =       0.587910892857
             le_variance =       0.345639217940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631314
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345724631314
                                         uncertainty =       0.004500430338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415715779
  error estimate for blocks of size 2^( 2) =       0.000429410836
  error estimate for blocks of size 2^( 3) =       0.000444262017
  error estimate for blocks of size 2^( 4) =       0.000459408862
  error estimate for blocks of size 2^( 5) =       0.000474038301
  error estimate for blocks of size 2^( 6) =       0.000486707123
  error estimate for blocks of size 2^( 7) =       0.000498747959

      target function =                  N/A
              le_mean =     -16.919459557886
             les_mean =     286.613750776076
             stat err =       0.000479725561
             autocorr =       1.331657995531
              std dev =       0.587910892858
             le_variance =       0.345639217941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919459557886        initial
     3.9062e+08     3.9062e+09             1.3629e-12       -16.919459557886  <--
     1.5625e+09     1.5625e+10             3.4007e-13       -16.919459557886
     6.2500e+09     6.2500e+10             8.4752e-14       -16.919459557886

*****************************************************************************
Applying the update for shift_i =   3.9062e+08     and shift_s =   3.9062e+09
*****************************************************************************

  Execution time = 2.9756e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.21651
====================================================
  Execution time = 2.0714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.5297e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353031016307
                                         uncertainty =       0.013859729693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353031016307
                                         uncertainty =       0.013859729693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420100620
  error estimate for blocks of size 2^( 2) =       0.000433647085
  error estimate for blocks of size 2^( 3) =       0.000448619003
  error estimate for blocks of size 2^( 4) =       0.000463496342
  error estimate for blocks of size 2^( 5) =       0.000478620152
  error estimate for blocks of size 2^( 6) =       0.000492931354
  error estimate for blocks of size 2^( 7) =       0.000503915388

      target function =                  N/A
              le_mean =     -16.918608303175
             les_mean =     286.592275801838
             stat err =       0.000484740809
             autocorr =       1.331412165702
              std dev =       0.594111994556
             le_variance =       0.352969062076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691860830317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918608303175       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918608303175       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918608303175       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918608297806       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918608314324       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918608287543       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918608304203       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918608197577       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 6.308865e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918608303175       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918608303175       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918608303175       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918608186774       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918608318507       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918608337127       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918608173109       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918608283975       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.577075e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918608303175       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918608303175       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918608303175       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918608303175       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918608743070       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918608019279       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918608039057       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918608555235       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 3.942348e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6210e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8689
    reference variance = 0.208612
====================================================
  Execution time = 2.0236e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.6345e-01
  Total weights = 2.0000e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426289815
  error estimate for blocks of size 2^( 2) =       0.000439582067
  error estimate for blocks of size 2^( 3) =       0.000453914115
  error estimate for blocks of size 2^( 4) =       0.000467431532
  error estimate for blocks of size 2^( 5) =       0.000480878006
  error estimate for blocks of size 2^( 6) =       0.000491113692
  error estimate for blocks of size 2^( 7) =       0.000498882841

      target function =                  N/A
              le_mean =     -16.919314002814
             les_mean =     286.626632156959
             stat err =       0.000484576518
             autocorr =       1.292155605244
              std dev =       0.602864837983
             le_variance =       0.363446012876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426289815
  error estimate for blocks of size 2^( 2) =       0.000439582067
  error estimate for blocks of size 2^( 3) =       0.000453914115
  error estimate for blocks of size 2^( 4) =       0.000467431532
  error estimate for blocks of size 2^( 5) =       0.000480878006
  error estimate for blocks of size 2^( 6) =       0.000491113692
  error estimate for blocks of size 2^( 7) =       0.000498882841

      target function =                  N/A
              le_mean =     -16.919314002814
             les_mean =     286.626632156959
             stat err =       0.000484576518
             autocorr =       1.292155605244
              std dev =       0.602864837983
             le_variance =       0.363446012876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426289815
  error estimate for blocks of size 2^( 2) =       0.000439582067
  error estimate for blocks of size 2^( 3) =       0.000453914115
  error estimate for blocks of size 2^( 4) =       0.000467431532
  error estimate for blocks of size 2^( 5) =       0.000480878006
  error estimate for blocks of size 2^( 6) =       0.000491113692
  error estimate for blocks of size 2^( 7) =       0.000498882841

      target function =                  N/A
              le_mean =     -16.919314002814
             les_mean =     286.626632156959
             stat err =       0.000484576518
             autocorr =       1.292155605241
              std dev =       0.602864837983
             le_variance =       0.363446012876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363148025468
                                         uncertainty =       0.027962183106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426289815
  error estimate for blocks of size 2^( 2) =       0.000439582067
  error estimate for blocks of size 2^( 3) =       0.000453914115
  error estimate for blocks of size 2^( 4) =       0.000467431532
  error estimate for blocks of size 2^( 5) =       0.000480878006
  error estimate for blocks of size 2^( 6) =       0.000491113692
  error estimate for blocks of size 2^( 7) =       0.000498882841

      target function =                  N/A
              le_mean =     -16.919314002814
             les_mean =     286.626632156959
             stat err =       0.000484576518
             autocorr =       1.292155605246
              std dev =       0.602864837983
             le_variance =       0.363446012876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919314002814        initial
     9.7656e+07     9.7656e+08             6.3089e-12       -16.919314002814
     3.9062e+08     3.9062e+09             1.5771e-12       -16.919314002814  <--
     1.5625e+09     1.5625e+10             3.9423e-13       -16.919314002814

*****************************************************************************
Applying the update for shift_i =   3.9062e+08     and shift_s =   3.9062e+09
*****************************************************************************

  Execution time = 2.9655e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.858
    reference variance = 1.08982
====================================================
  Execution time = 2.0670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341965770961
                                         uncertainty =       0.003849817860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341965770961
                                         uncertainty =       0.003849817860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413533714
  error estimate for blocks of size 2^( 2) =       0.000427503578
  error estimate for blocks of size 2^( 3) =       0.000441931438
  error estimate for blocks of size 2^( 4) =       0.000457209402
  error estimate for blocks of size 2^( 5) =       0.000471477578
  error estimate for blocks of size 2^( 6) =       0.000481380372
  error estimate for blocks of size 2^( 7) =       0.000492628949

      target function =                  N/A
              le_mean =     -16.919313685749
             les_mean =     286.605195691291
             stat err =       0.000475674075
             autocorr =       1.323113560921
              std dev =       0.584824987105
             le_variance =       0.342020265542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691931368575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919313685749       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919313685749       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919313685749       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919313685749       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919313699481       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919313631684       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919313726487       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919313708790       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 4.920807e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919313685749       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919313685749       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919313685749       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919313785070       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919313657316       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919313685142       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919314112816       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919313851824       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.230392e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919313685749       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919313685749       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919313685749       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919313816034       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.919313268510       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.919313218254       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919313953208       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.919312787706       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 3.074715e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125402 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7358e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9123
    reference variance = 0.2682
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3206e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866470
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866470
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407466261
  error estimate for blocks of size 2^( 2) =       0.000421996915
  error estimate for blocks of size 2^( 3) =       0.000436823464
  error estimate for blocks of size 2^( 4) =       0.000451698843
  error estimate for blocks of size 2^( 5) =       0.000466098856
  error estimate for blocks of size 2^( 6) =       0.000477923031
  error estimate for blocks of size 2^( 7) =       0.000485322012

      target function =                  N/A
              le_mean =     -16.919402023138
             les_mean =     286.598222161832
             stat err =       0.000470260686
             autocorr =       1.331968755875
              std dev =       0.576244312158
             le_variance =       0.332057507295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866471
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866471
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407466261
  error estimate for blocks of size 2^( 2) =       0.000421996915
  error estimate for blocks of size 2^( 3) =       0.000436823464
  error estimate for blocks of size 2^( 4) =       0.000451698843
  error estimate for blocks of size 2^( 5) =       0.000466098856
  error estimate for blocks of size 2^( 6) =       0.000477923031
  error estimate for blocks of size 2^( 7) =       0.000485322012

      target function =                  N/A
              le_mean =     -16.919402023138
             les_mean =     286.598222161834
             stat err =       0.000470260686
             autocorr =       1.331968755871
              std dev =       0.576244312159
             le_variance =       0.332057507296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866471
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866471
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407466261
  error estimate for blocks of size 2^( 2) =       0.000421996915
  error estimate for blocks of size 2^( 3) =       0.000436823464
  error estimate for blocks of size 2^( 4) =       0.000451698843
  error estimate for blocks of size 2^( 5) =       0.000466098856
  error estimate for blocks of size 2^( 6) =       0.000477923031
  error estimate for blocks of size 2^( 7) =       0.000485322012

      target function =                  N/A
              le_mean =     -16.919402023138
             les_mean =     286.598222161833
             stat err =       0.000470260686
             autocorr =       1.331968755867
              std dev =       0.576244312158
             le_variance =       0.332057507295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866470
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332085866470
                                         uncertainty =       0.002733010789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407466261
  error estimate for blocks of size 2^( 2) =       0.000421996915
  error estimate for blocks of size 2^( 3) =       0.000436823464
  error estimate for blocks of size 2^( 4) =       0.000451698843
  error estimate for blocks of size 2^( 5) =       0.000466098856
  error estimate for blocks of size 2^( 6) =       0.000477923031
  error estimate for blocks of size 2^( 7) =       0.000485322012

      target function =                  N/A
              le_mean =     -16.919402023138
             les_mean =     286.598222161832
             stat err =       0.000470260686
             autocorr =       1.331968755878
              std dev =       0.576244312158
             le_variance =       0.332057507295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919402023138        initial
     9.7656e+07     9.7656e+08             4.9208e-12       -16.919402023138  <--
     3.9062e+08     3.9062e+09             1.2304e-12       -16.919402023138
     1.5625e+09     1.5625e+10             3.0747e-13       -16.919402023138

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 2.9982e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8004
    reference variance = 0.294246
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335130421411
                                         uncertainty =       0.003437133325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335130421411
                                         uncertainty =       0.003437133325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409396287
  error estimate for blocks of size 2^( 2) =       0.000423460905
  error estimate for blocks of size 2^( 3) =       0.000437677748
  error estimate for blocks of size 2^( 4) =       0.000452385148
  error estimate for blocks of size 2^( 5) =       0.000466547967
  error estimate for blocks of size 2^( 6) =       0.000477129610
  error estimate for blocks of size 2^( 7) =       0.000487205808

      target function =                  N/A
              le_mean =     -16.918413163543
             les_mean =     286.567914443832
             stat err =       0.000470817133
             autocorr =       1.322564064737
              std dev =       0.578973781002
             le_variance =       0.335210639087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691841316354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918413163543       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918413163543       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918413163544       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918413169952       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918413157946       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918413155371       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918413155393       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918413167051       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.748964e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918413163543       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918413163543       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918413163543       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918413157995       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918413163485       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918413162202       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918413097854       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918413150180       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 4.372245e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918413163543       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918413163543       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918413163543       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918413157553       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918413201444       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918412927191       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918413000349       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918412994503       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.092860e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6303e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9473
    reference variance = 0.366638
====================================================
  Execution time = 2.0112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.5241e-01
  Total weights = 2.0000e+06
  Execution time = 1.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419769219
  error estimate for blocks of size 2^( 2) =       0.000433487656
  error estimate for blocks of size 2^( 3) =       0.000448023233
  error estimate for blocks of size 2^( 4) =       0.000463412958
  error estimate for blocks of size 2^( 5) =       0.000475080434
  error estimate for blocks of size 2^( 6) =       0.000487574104
  error estimate for blocks of size 2^( 7) =       0.000498914267

      target function =                  N/A
              le_mean =     -16.918671300848
             les_mean =     286.593850804620
             stat err =       0.000481245441
             autocorr =       1.314353172502
              std dev =       0.593643322772
             le_variance =       0.352412394671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419769219
  error estimate for blocks of size 2^( 2) =       0.000433487656
  error estimate for blocks of size 2^( 3) =       0.000448023233
  error estimate for blocks of size 2^( 4) =       0.000463412958
  error estimate for blocks of size 2^( 5) =       0.000475080434
  error estimate for blocks of size 2^( 6) =       0.000487574104
  error estimate for blocks of size 2^( 7) =       0.000498914267

      target function =                  N/A
              le_mean =     -16.918671300848
             les_mean =     286.593850804615
             stat err =       0.000481245441
             autocorr =       1.314353172493
              std dev =       0.593643322771
             le_variance =       0.352412394671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419769219
  error estimate for blocks of size 2^( 2) =       0.000433487656
  error estimate for blocks of size 2^( 3) =       0.000448023233
  error estimate for blocks of size 2^( 4) =       0.000463412958
  error estimate for blocks of size 2^( 5) =       0.000475080434
  error estimate for blocks of size 2^( 6) =       0.000487574104
  error estimate for blocks of size 2^( 7) =       0.000498914267

      target function =                  N/A
              le_mean =     -16.918671300848
             les_mean =     286.593850804617
             stat err =       0.000481245441
             autocorr =       1.314353172500
              std dev =       0.593643322772
             le_variance =       0.352412394671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349031809846
                                         uncertainty =       0.015392968979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419769219
  error estimate for blocks of size 2^( 2) =       0.000433487656
  error estimate for blocks of size 2^( 3) =       0.000448023233
  error estimate for blocks of size 2^( 4) =       0.000463412958
  error estimate for blocks of size 2^( 5) =       0.000475080434
  error estimate for blocks of size 2^( 6) =       0.000487574104
  error estimate for blocks of size 2^( 7) =       0.000498914267

      target function =                  N/A
              le_mean =     -16.918671300848
             les_mean =     286.593850804619
             stat err =       0.000481245441
             autocorr =       1.314353172500
              std dev =       0.593643322772
             le_variance =       0.352412394671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918671300848        initial  <--
     2.4414e+07     2.4414e+08             1.7490e-11       -16.918671300848
     9.7656e+07     9.7656e+08             4.3722e-12       -16.918671300848
     3.9062e+08     3.9062e+09             1.0929e-12       -16.918671300848

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5203
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5830e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.848
    reference variance = 0.249349
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341570496236
                                         uncertainty =       0.004867775439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341570496236
                                         uncertainty =       0.004867775439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413197161
  error estimate for blocks of size 2^( 2) =       0.000427179165
  error estimate for blocks of size 2^( 3) =       0.000441912944
  error estimate for blocks of size 2^( 4) =       0.000456845150
  error estimate for blocks of size 2^( 5) =       0.000472110295
  error estimate for blocks of size 2^( 6) =       0.000484261902
  error estimate for blocks of size 2^( 7) =       0.000490456887

      target function =                  N/A
              le_mean =     -16.918208464106
             les_mean =     286.567241251971
             stat err =       0.000475918559
             autocorr =       1.326632471521
              std dev =       0.584349029051
             le_variance =       0.341463787753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691820846411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918208464106       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918208464106       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918208464106       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918208459339       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918208433452       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918208654654       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918208587332       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918206647872       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918208188438       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 1.818919e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918208464106       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918208464106       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918208464106       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918208469508       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918208409667       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918208511003       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918209278168       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918208418632       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918208109292       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 4.555827e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918208464106       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918208464106       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918208464106       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918208923363       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918206042556       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918210615091       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918211289067       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918207845899       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918207494732       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+09 is 1.137932e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131004 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6251e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8403
    reference variance = 0.191809
====================================================
  Execution time = 2.0448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4128e-01
  Total weights = 2.0000e+06
  Execution time = 1.8611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086038
  error estimate for blocks of size 2^( 2) =       0.000427068628
  error estimate for blocks of size 2^( 3) =       0.000442075056
  error estimate for blocks of size 2^( 4) =       0.000457017617
  error estimate for blocks of size 2^( 5) =       0.000472713514
  error estimate for blocks of size 2^( 6) =       0.000487067621
  error estimate for blocks of size 2^( 7) =       0.000495781781

      target function =                  N/A
              le_mean =     -16.918754480381
             les_mean =     286.585533146061
             stat err =       0.000478145133
             autocorr =       1.339795291458
              std dev =       0.584191877111
             le_variance =       0.341280149282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086038
  error estimate for blocks of size 2^( 2) =       0.000427068628
  error estimate for blocks of size 2^( 3) =       0.000442075056
  error estimate for blocks of size 2^( 4) =       0.000457017617
  error estimate for blocks of size 2^( 5) =       0.000472713514
  error estimate for blocks of size 2^( 6) =       0.000487067621
  error estimate for blocks of size 2^( 7) =       0.000495781781

      target function =                  N/A
              le_mean =     -16.918754480381
             les_mean =     286.585533146061
             stat err =       0.000478145133
             autocorr =       1.339795291458
              std dev =       0.584191877111
             le_variance =       0.341280149282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086038
  error estimate for blocks of size 2^( 2) =       0.000427068628
  error estimate for blocks of size 2^( 3) =       0.000442075056
  error estimate for blocks of size 2^( 4) =       0.000457017617
  error estimate for blocks of size 2^( 5) =       0.000472713514
  error estimate for blocks of size 2^( 6) =       0.000487067621
  error estimate for blocks of size 2^( 7) =       0.000495781781

      target function =                  N/A
              le_mean =     -16.918754480381
             les_mean =     286.585533146061
             stat err =       0.000478145133
             autocorr =       1.339795291454
              std dev =       0.584191877111
             le_variance =       0.341280149282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341202132648
                                         uncertainty =       0.005403147852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086038
  error estimate for blocks of size 2^( 2) =       0.000427068628
  error estimate for blocks of size 2^( 3) =       0.000442075056
  error estimate for blocks of size 2^( 4) =       0.000457017617
  error estimate for blocks of size 2^( 5) =       0.000472713514
  error estimate for blocks of size 2^( 6) =       0.000487067621
  error estimate for blocks of size 2^( 7) =       0.000495781781

      target function =                  N/A
              le_mean =     -16.918754480381
             les_mean =     286.585533146061
             stat err =       0.000478145133
             autocorr =       1.339795291459
              std dev =       0.584191877111
             le_variance =       0.341280149282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918754480381        initial
     2.4414e+08     2.4414e+09             1.8189e-12       -16.918754480381  <--
     9.7656e+08     9.7656e+09             4.5558e-13       -16.918754480381
     3.9062e+09     3.9062e+10             1.1379e-13       -16.918754480381

*****************************************************************************
Applying the update for shift_i =   2.4414e+08     and shift_s =   2.4414e+09
*****************************************************************************

  Execution time = 2.9853e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9697
    reference variance = 0.255719
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.2981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329731540750
                                         uncertainty =       0.002703992701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329731540750
                                         uncertainty =       0.002703992701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406087319
  error estimate for blocks of size 2^( 2) =       0.000420117864
  error estimate for blocks of size 2^( 3) =       0.000435203369
  error estimate for blocks of size 2^( 4) =       0.000450427641
  error estimate for blocks of size 2^( 5) =       0.000463864231
  error estimate for blocks of size 2^( 6) =       0.000475170833
  error estimate for blocks of size 2^( 7) =       0.000485512258

      target function =                  N/A
              le_mean =     -16.918272670617
             les_mean =     286.557763813732
             stat err =       0.000468743741
             autocorr =       1.332392280025
              std dev =       0.574294194029
             le_variance =       0.329813821296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691827267062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918272670617       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918272670617       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918272670617       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918272670617       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918272674447       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918272702982       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918272611216       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918272679659       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 8.859860e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918272670617       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918272670617       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918272670617       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918272797408       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918272591138       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918272706163       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918272752223       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918272787095       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.215262e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918272670617       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918272670617       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918272670617       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918272670617       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918273266124       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918273428504       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918272688637       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918272951198       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 5.540661e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7583e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9189
    reference variance = 0.276235
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3539e-01
  Total weights = 2.0000e+06
  Execution time = 1.8635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213763
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213763
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409508591
  error estimate for blocks of size 2^( 2) =       0.000423301704
  error estimate for blocks of size 2^( 3) =       0.000438076556
  error estimate for blocks of size 2^( 4) =       0.000454291727
  error estimate for blocks of size 2^( 5) =       0.000470898955
  error estimate for blocks of size 2^( 6) =       0.000485445354
  error estimate for blocks of size 2^( 7) =       0.000496759318

      target function =                  N/A
              le_mean =     -16.918420099713
             les_mean =     286.568333074730
             stat err =       0.000476848839
             autocorr =       1.355924238671
              std dev =       0.579132603158
             le_variance =       0.335394572041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213764
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213764
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409508591
  error estimate for blocks of size 2^( 2) =       0.000423301704
  error estimate for blocks of size 2^( 3) =       0.000438076556
  error estimate for blocks of size 2^( 4) =       0.000454291727
  error estimate for blocks of size 2^( 5) =       0.000470898955
  error estimate for blocks of size 2^( 6) =       0.000485445354
  error estimate for blocks of size 2^( 7) =       0.000496759318

      target function =                  N/A
              le_mean =     -16.918420099713
             les_mean =     286.568333074729
             stat err =       0.000476848839
             autocorr =       1.355924238654
              std dev =       0.579132603159
             le_variance =       0.335394572042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213764
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213764
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409508591
  error estimate for blocks of size 2^( 2) =       0.000423301704
  error estimate for blocks of size 2^( 3) =       0.000438076556
  error estimate for blocks of size 2^( 4) =       0.000454291727
  error estimate for blocks of size 2^( 5) =       0.000470898955
  error estimate for blocks of size 2^( 6) =       0.000485445354
  error estimate for blocks of size 2^( 7) =       0.000496759318

      target function =                  N/A
              le_mean =     -16.918420099713
             les_mean =     286.568333074730
             stat err =       0.000476848839
             autocorr =       1.355924238663
              std dev =       0.579132603159
             le_variance =       0.335394572041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213763
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486213763
                                         uncertainty =       0.003698816962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409508591
  error estimate for blocks of size 2^( 2) =       0.000423301704
  error estimate for blocks of size 2^( 3) =       0.000438076556
  error estimate for blocks of size 2^( 4) =       0.000454291727
  error estimate for blocks of size 2^( 5) =       0.000470898955
  error estimate for blocks of size 2^( 6) =       0.000485445354
  error estimate for blocks of size 2^( 7) =       0.000496759318

      target function =                  N/A
              le_mean =     -16.918420099713
             les_mean =     286.568333074730
             stat err =       0.000476848839
             autocorr =       1.355924238671
              std dev =       0.579132603158
             le_variance =       0.335394572041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918420099713        initial  <--
     6.1035e+07     6.1035e+08             8.8599e-12       -16.918420099713
     2.4414e+08     2.4414e+09             2.2153e-12       -16.918420099713
     9.7656e+08     9.7656e+09             5.5407e-13       -16.918420099713

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7709
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.287429
====================================================
  Execution time = 2.0696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500338787
                                         uncertainty =       0.002692050504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500338787
                                         uncertainty =       0.002692050504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411391576
  error estimate for blocks of size 2^( 2) =       0.000425003815
  error estimate for blocks of size 2^( 3) =       0.000440140393
  error estimate for blocks of size 2^( 4) =       0.000454936797
  error estimate for blocks of size 2^( 5) =       0.000469641601
  error estimate for blocks of size 2^( 6) =       0.000479761449
  error estimate for blocks of size 2^( 7) =       0.000488226987

      target function =                  N/A
              le_mean =     -16.918076123522
             les_mean =     286.559785610350
             stat err =       0.000473141708
             autocorr =       1.322731442186
              std dev =       0.581795546816
             le_variance =       0.338486058295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691807612352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918076123522       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918076123522       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918076123522       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918076123522       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918076285417       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918076067999       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918075635315       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918076058474       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918076464845       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 8.145781e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918076123522       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918076123522       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918076123522       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918076064895       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918075413778       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918076686571       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918078726880       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918078743851       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918077045733       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.044815e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918076123522       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918076123522       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918076123522       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918076123522       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918074340467       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918067657718       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918080696880       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918075833361       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918066926300       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.918088465815       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918047290521       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.918046480833       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.918103205648       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.918111843621       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.918102941334       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.917924751701       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.917879290755       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.918379947747       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.917578497261       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.918187235672       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.918431303579       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.918092853168       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.918101834865       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.918466786421       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.918143306514       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.916784974682       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.917698851793       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.917360730401       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.917672964912       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.919301875316       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.915353646697       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.919094592061       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.918073235385       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.919538317557       residual = 2.71e-04           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.918219379294       residual = 6.87e-06           smallest_sin_value = 9.93e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.38e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 5.066707e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6301e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.342543
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3839e-01
  Total weights = 2.0000e+06
  Execution time = 1.9309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951384
                                         uncertainty =       0.003412527871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951384
                                         uncertainty =       0.003412527871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411334043
  error estimate for blocks of size 2^( 2) =       0.000425157670
  error estimate for blocks of size 2^( 3) =       0.000440160619
  error estimate for blocks of size 2^( 4) =       0.000455132158
  error estimate for blocks of size 2^( 5) =       0.000470443423
  error estimate for blocks of size 2^( 6) =       0.000483722846
  error estimate for blocks of size 2^( 7) =       0.000491057403

      target function =                  N/A
              le_mean =     -16.918628848466
             les_mean =     286.578393332517
             stat err =       0.000475088957
             autocorr =       1.334014543335
              std dev =       0.581714182029
             le_variance =       0.338391389573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951385
                                         uncertainty =       0.003412527870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951385
                                         uncertainty =       0.003412527870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411334043
  error estimate for blocks of size 2^( 2) =       0.000425157670
  error estimate for blocks of size 2^( 3) =       0.000440160619
  error estimate for blocks of size 2^( 4) =       0.000455132158
  error estimate for blocks of size 2^( 5) =       0.000470443423
  error estimate for blocks of size 2^( 6) =       0.000483722846
  error estimate for blocks of size 2^( 7) =       0.000491057403

      target function =                  N/A
              le_mean =     -16.918628848466
             les_mean =     286.578393332517
             stat err =       0.000475088957
             autocorr =       1.334014543332
              std dev =       0.581714182029
             le_variance =       0.338391389573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951384
                                         uncertainty =       0.003412527871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951384
                                         uncertainty =       0.003412527871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411334043
  error estimate for blocks of size 2^( 2) =       0.000425157670
  error estimate for blocks of size 2^( 3) =       0.000440160619
  error estimate for blocks of size 2^( 4) =       0.000455132158
  error estimate for blocks of size 2^( 5) =       0.000470443423
  error estimate for blocks of size 2^( 6) =       0.000483722846
  error estimate for blocks of size 2^( 7) =       0.000491057403

      target function =                  N/A
              le_mean =     -16.918628848466
             les_mean =     286.578393332517
             stat err =       0.000475088957
             autocorr =       1.334014543333
              std dev =       0.581714182029
             le_variance =       0.338391389573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951384
                                         uncertainty =       0.003412527871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411951384
                                         uncertainty =       0.003412527871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411334043
  error estimate for blocks of size 2^( 2) =       0.000425157670
  error estimate for blocks of size 2^( 3) =       0.000440160619
  error estimate for blocks of size 2^( 4) =       0.000455132158
  error estimate for blocks of size 2^( 5) =       0.000470443423
  error estimate for blocks of size 2^( 6) =       0.000483722846
  error estimate for blocks of size 2^( 7) =       0.000491057403

      target function =                  N/A
              le_mean =     -16.918628848466
             les_mean =     286.578393332517
             stat err =       0.000475088957
             autocorr =       1.334014543336
              std dev =       0.581714182029
             le_variance =       0.338391389573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918628848466        initial  <--
     6.1035e+08     6.1035e+09             8.1458e-13       -16.918628848466
     2.4414e+09     2.4414e+10             2.0448e-13       -16.918628848466
     9.7656e+09     9.7656e+10             5.0667e-14       -16.918628848466

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0574
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6369e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.209602
====================================================
  Execution time = 2.0743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4591e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345983009060
                                         uncertainty =       0.006095687228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345983009060
                                         uncertainty =       0.006095687228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415881460
  error estimate for blocks of size 2^( 2) =       0.000429581523
  error estimate for blocks of size 2^( 3) =       0.000444311050
  error estimate for blocks of size 2^( 4) =       0.000458794051
  error estimate for blocks of size 2^( 5) =       0.000473216167
  error estimate for blocks of size 2^( 6) =       0.000485372234
  error estimate for blocks of size 2^( 7) =       0.000492768073

      target function =                  N/A
              le_mean =     -16.918737606471
             les_mean =     286.589596801638
             stat err =       0.000477537631
             autocorr =       1.318487695504
              std dev =       0.588145201449
             le_variance =       0.345914777987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691873760647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918737606471       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918737606471       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918737606471       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918737384724       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918738328436       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918736242883       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918740210164       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918744959021       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918728067387       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.918773264169       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918730257729       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 7.646223e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918737606471       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918737606471       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918737606471       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918723695149       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918737606471       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918721384913       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918726814831       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918742849784       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918716769517       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.918657988817       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918775128496       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.918649131673       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.918693651504       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.918918176531       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.918643705336       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.918257765126       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.920328448248       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.918215800617       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.918021312828       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.917938201304       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.919931002735       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.917087500204       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.922785659703       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.920781665664       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.920119461487       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.918673468763       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.917940322533       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.919342508322       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.921918972506       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.920046039815       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.916009818922       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.917017046583       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.914926860226       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.917344749405       residual = 4.24e-04           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.922745459365       residual = 2.21e-03           smallest_sin_value = 9.99e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 1.889668e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918737606471       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918737606471       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918737606471       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918720495966       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918719845050       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918690501538       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918810751520       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918818726938       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918579724242       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.918623988843       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918915753459       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.918070103710       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.918977317235       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.918408457752       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.915361884768       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.919273299079       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910669686758       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.911721370976       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.926558090570       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.919620016171       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.914136393401       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.911475796530       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.925796304843       residual = 6.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.928438845437       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909265135567       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.922257172960       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.902998754196       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.917358358006       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.920017583313       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.930824223225       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.918674876573       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.915728700327       residual = 1.20e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.898245083144       residual = 5.26e-02           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 4.976416e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6287e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.234052
====================================================
  Execution time = 2.2293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.0000e+06
  Execution time = 1.8638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409285173
  error estimate for blocks of size 2^( 2) =       0.000423627040
  error estimate for blocks of size 2^( 3) =       0.000438128682
  error estimate for blocks of size 2^( 4) =       0.000453685048
  error estimate for blocks of size 2^( 5) =       0.000468513044
  error estimate for blocks of size 2^( 6) =       0.000483319745
  error estimate for blocks of size 2^( 7) =       0.000493296166

      target function =                  N/A
              le_mean =     -16.919172266166
             les_mean =     286.593418710272
             stat err =       0.000474703501
             autocorr =       1.345218544890
              std dev =       0.578816642445
             le_variance =       0.335028705572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409285173
  error estimate for blocks of size 2^( 2) =       0.000423627040
  error estimate for blocks of size 2^( 3) =       0.000438128682
  error estimate for blocks of size 2^( 4) =       0.000453685048
  error estimate for blocks of size 2^( 5) =       0.000468513044
  error estimate for blocks of size 2^( 6) =       0.000483319745
  error estimate for blocks of size 2^( 7) =       0.000493296166

      target function =                  N/A
              le_mean =     -16.919172266166
             les_mean =     286.593418710272
             stat err =       0.000474703501
             autocorr =       1.345218544898
              std dev =       0.578816642445
             le_variance =       0.335028705572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409285173
  error estimate for blocks of size 2^( 2) =       0.000423627040
  error estimate for blocks of size 2^( 3) =       0.000438128682
  error estimate for blocks of size 2^( 4) =       0.000453685048
  error estimate for blocks of size 2^( 5) =       0.000468513044
  error estimate for blocks of size 2^( 6) =       0.000483319745
  error estimate for blocks of size 2^( 7) =       0.000493296166

      target function =                  N/A
              le_mean =     -16.919172266166
             les_mean =     286.593418710272
             stat err =       0.000474703501
             autocorr =       1.345218544890
              std dev =       0.578816642445
             le_variance =       0.335028705572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335026370834
                                         uncertainty =       0.003528284966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409285173
  error estimate for blocks of size 2^( 2) =       0.000423627040
  error estimate for blocks of size 2^( 3) =       0.000438128682
  error estimate for blocks of size 2^( 4) =       0.000453685048
  error estimate for blocks of size 2^( 5) =       0.000468513044
  error estimate for blocks of size 2^( 6) =       0.000483319745
  error estimate for blocks of size 2^( 7) =       0.000493296166

      target function =                  N/A
              le_mean =     -16.919172266166
             les_mean =     286.593418710272
             stat err =       0.000474703501
             autocorr =       1.345218544892
              std dev =       0.578816642445
             le_variance =       0.335028705572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919172266166        initial  <--
     6.1035e+09     6.1035e+10             7.6462e-14       -16.919172266166
     2.4414e+10     2.4414e+11             1.8897e-14       -16.919172266166
     9.7656e+10     9.7656e+11             4.9764e-15       -16.919172266166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6919
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.7472
    reference variance = 4.9316
====================================================
  Execution time = 2.0955e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3969e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339462623216
                                         uncertainty =       0.004310445850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339462623216
                                         uncertainty =       0.004310445850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412120737
  error estimate for blocks of size 2^( 2) =       0.000426010443
  error estimate for blocks of size 2^( 3) =       0.000440820209
  error estimate for blocks of size 2^( 4) =       0.000456152323
  error estimate for blocks of size 2^( 5) =       0.000471083378
  error estimate for blocks of size 2^( 6) =       0.000482523313
  error estimate for blocks of size 2^( 7) =       0.000490503969

      target function =                  N/A
              le_mean =     -16.918197918861
             les_mean =     286.565107656262
             stat err =       0.000475065746
             autocorr =       1.328796568312
              std dev =       0.582826736135
             le_variance =       0.339687004354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691819791886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918197918861       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918197918861       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918197918861       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918197918861       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918199137040       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918200642653       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918175499159       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918182914794       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918160003420       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.918189441339       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.917383670679       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.917961454058       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.918466037381       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.918765786014       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.918889833642       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.919510226421       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.916476293197       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.919345924805       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.919281117629       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.915283959578       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.918667113596       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.922063009037       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.914642310597       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.911536494238       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.922572061673       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914445996693       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.912081253168       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.916257822433       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.925062342512       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.918776871165       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.920576686997       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.918907225553       residual = 1.18e-04           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 8.630184e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918197918861       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918197918861       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918197918861       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918197918861       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918197918861       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918053031208       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918365410657       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.917858257312       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.918488684522       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.917510852057       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918776183283       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.918984006199       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.918065381958       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.921243760781       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.918614119232       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.919893592970       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913502999862       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.896862306068       residual = 6.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.936081895359       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.932561108243       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893571749721       residual = 8.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.930843477876       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.926562368830       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914457798241       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.926476019209       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.944250032109       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906091743113       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.947506870991       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.896396318474       residual = 7.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.932268519927       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.916793504589       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.921251218854       residual = 1.60e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.918579532928       residual = 2.30e-04           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 2.198663e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918197918861       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918197918861       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918197918861       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.918136650080       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.917979947951       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.918486259902       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.918796654138       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916531094168       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.917862990948       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.915448020478       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.938564889674       residual = 5.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.873780592694       residual = 2.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.878525027888       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.986576601120       residual = 6.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.927207359335       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.934543806680       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.061828009139       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.880635168161       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.937986119380       residual = 4.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.814794628846       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.856762738396       residual = 4.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.018855169142       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.800620837039       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.885839990387       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.931506394082       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.870567502140       residual = 3.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.854100522669       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.882339381019       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.163500224617       residual = 8.13e+00           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.843363827744       residual = 8.17e-01           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 5.805879e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6498e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8964
    reference variance = 0.162113
====================================================
  Execution time = 2.0653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.0000e+06
  Execution time = 1.8713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409721665
  error estimate for blocks of size 2^( 2) =       0.000423337514
  error estimate for blocks of size 2^( 3) =       0.000438040290
  error estimate for blocks of size 2^( 4) =       0.000453329261
  error estimate for blocks of size 2^( 5) =       0.000467949755
  error estimate for blocks of size 2^( 6) =       0.000481391658
  error estimate for blocks of size 2^( 7) =       0.000491616739

      target function =                  N/A
              le_mean =     -16.918925830500
             les_mean =     286.585794776018
             stat err =       0.000473571853
             autocorr =       1.335961388477
              std dev =       0.579433935768
             le_variance =       0.335743685920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409721665
  error estimate for blocks of size 2^( 2) =       0.000423337514
  error estimate for blocks of size 2^( 3) =       0.000438040290
  error estimate for blocks of size 2^( 4) =       0.000453329261
  error estimate for blocks of size 2^( 5) =       0.000467949755
  error estimate for blocks of size 2^( 6) =       0.000481391658
  error estimate for blocks of size 2^( 7) =       0.000491616739

      target function =                  N/A
              le_mean =     -16.918925830500
             les_mean =     286.585794776018
             stat err =       0.000473571853
             autocorr =       1.335961388478
              std dev =       0.579433935768
             le_variance =       0.335743685920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409721665
  error estimate for blocks of size 2^( 2) =       0.000423337514
  error estimate for blocks of size 2^( 3) =       0.000438040290
  error estimate for blocks of size 2^( 4) =       0.000453329261
  error estimate for blocks of size 2^( 5) =       0.000467949755
  error estimate for blocks of size 2^( 6) =       0.000481391658
  error estimate for blocks of size 2^( 7) =       0.000491616739

      target function =                  N/A
              le_mean =     -16.918925830500
             les_mean =     286.585794776018
             stat err =       0.000473571853
             autocorr =       1.335961388468
              std dev =       0.579433935768
             le_variance =       0.335743685920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785353574
                                         uncertainty =       0.003130666287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409721665
  error estimate for blocks of size 2^( 2) =       0.000423337514
  error estimate for blocks of size 2^( 3) =       0.000438040290
  error estimate for blocks of size 2^( 4) =       0.000453329261
  error estimate for blocks of size 2^( 5) =       0.000467949755
  error estimate for blocks of size 2^( 6) =       0.000481391658
  error estimate for blocks of size 2^( 7) =       0.000491616739

      target function =                  N/A
              le_mean =     -16.918925830500
             les_mean =     286.585794776018
             stat err =       0.000473571853
             autocorr =       1.335961388478
              std dev =       0.579433935768
             le_variance =       0.335743685920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918925830500        initial  <--
     6.1035e+10     6.1035e+11             8.6302e-15       -16.918925830500
     2.4414e+11     2.4414e+12             2.1987e-15       -16.918925830500
     9.7656e+11     9.7656e+12             5.8059e-16       -16.918925830500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0746
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.213969
====================================================
  Execution time = 2.0923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3735e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337383120591
                                         uncertainty =       0.003464014354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337383120591
                                         uncertainty =       0.003464014354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410701573
  error estimate for blocks of size 2^( 2) =       0.000424814169
  error estimate for blocks of size 2^( 3) =       0.000439610585
  error estimate for blocks of size 2^( 4) =       0.000455674855
  error estimate for blocks of size 2^( 5) =       0.000470584004
  error estimate for blocks of size 2^( 6) =       0.000485090415
  error estimate for blocks of size 2^( 7) =       0.000496824509

      target function =                  N/A
              le_mean =     -16.917859035979
             les_mean =     286.551305756063
             stat err =       0.000477043446
             autocorr =       1.349159000798
              std dev =       0.580819734065
             le_variance =       0.337351563480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691785903598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917859035979       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917859035979       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917859035979       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917859035979       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.917859035979       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.917553768795       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.919499867231       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915720027152       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.922305111002       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.920451978272       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.919312283729       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.917630005038       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907777164215       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.924386884439       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.918769354079       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909698317969       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911064559136       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.869864546769       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.932842706115       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.974502594155       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904653048927       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.882329584247       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.856175169573       residual = 4.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.879899216748       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.056964042871       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.933708043825       residual = 5.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.996716401990       residual = 7.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906987705885       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.967635907092       residual = 3.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.865603883660       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.922577587007       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.901032339609       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.904624526473       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.928005246955       residual = 2.07e-02           smallest_sin_value = 9.99e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 8.043461e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917859035979       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917859035979       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917859035979       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917309543326       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.932171492119       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916174746508       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.917620049446       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912941138612       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.917843046244       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.914674127169       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.900409750178       residual = 4.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.924033504709       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.936284604725       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.900638042300       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.889759814224       residual = 9.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.950348764173       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.009804827933       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.852000181310       residual = 5.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.074654666382       residual = 3.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.875779663095       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.838721867637       residual = 9.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.005224738663       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.796431122686       residual = 1.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.756103810012       residual = 3.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.469691140517       residual = 2.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.328024250379       residual = 2.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.002128137734       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.909651977763       residual = 5.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.749772136814       residual = 3.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.938681584349       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.849039001678       residual = 6.68e-01           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.825947798064       residual = 1.07e+00           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.927609572700       residual = 2.70e-01           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 1.385700e-16

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917859035979       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917859035979       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6538e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8566
    reference variance = 0.305918
====================================================
  Execution time = 2.0365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3518e-01
  Total weights = 2.0000e+06
  Execution time = 1.8677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409378130
  error estimate for blocks of size 2^( 2) =       0.000423324750
  error estimate for blocks of size 2^( 3) =       0.000437466632
  error estimate for blocks of size 2^( 4) =       0.000452287185
  error estimate for blocks of size 2^( 5) =       0.000467159218
  error estimate for blocks of size 2^( 6) =       0.000479301527
  error estimate for blocks of size 2^( 7) =       0.000488658112

      target function =                  N/A
              le_mean =     -16.918381130459
             les_mean =     286.566800815102
             stat err =       0.000471851510
             autocorr =       1.328499583513
              std dev =       0.578948104079
             le_variance =       0.335180907217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409378130
  error estimate for blocks of size 2^( 2) =       0.000423324750
  error estimate for blocks of size 2^( 3) =       0.000437466632
  error estimate for blocks of size 2^( 4) =       0.000452287185
  error estimate for blocks of size 2^( 5) =       0.000467159218
  error estimate for blocks of size 2^( 6) =       0.000479301527
  error estimate for blocks of size 2^( 7) =       0.000488658112

      target function =                  N/A
              le_mean =     -16.918381130459
             les_mean =     286.566800815102
             stat err =       0.000471851510
             autocorr =       1.328499583512
              std dev =       0.578948104079
             le_variance =       0.335180907217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409378130
  error estimate for blocks of size 2^( 2) =       0.000423324750
  error estimate for blocks of size 2^( 3) =       0.000437466632
  error estimate for blocks of size 2^( 4) =       0.000452287185
  error estimate for blocks of size 2^( 5) =       0.000467159218
  error estimate for blocks of size 2^( 6) =       0.000479301527
  error estimate for blocks of size 2^( 7) =       0.000488658112

      target function =                  N/A
              le_mean =     -16.918381130459
             les_mean =     286.566800815102
             stat err =       0.000471851510
             autocorr =       1.328499583513
              std dev =       0.578948104079
             le_variance =       0.335180907217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335149417077
                                         uncertainty =       0.004993470784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409378130
  error estimate for blocks of size 2^( 2) =       0.000423324750
  error estimate for blocks of size 2^( 3) =       0.000437466632
  error estimate for blocks of size 2^( 4) =       0.000452287185
  error estimate for blocks of size 2^( 5) =       0.000467159218
  error estimate for blocks of size 2^( 6) =       0.000479301527
  error estimate for blocks of size 2^( 7) =       0.000488658112

      target function =                  N/A
              le_mean =     -16.918381130459
             les_mean =     286.566800815102
             stat err =       0.000471851510
             autocorr =       1.328499583513
              std dev =       0.578948104079
             le_variance =       0.335180907217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918381130459        initial  <--
     6.1035e+11     6.1035e+12             8.0435e-16       -16.918381130459
     2.4414e+12     2.4414e+13             1.3857e-16       -16.918381130459
     9.7656e+12     9.7656e+13             0.0000e+00       -16.918381130459

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7805
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9402
    reference variance = 0.331998
====================================================
  Execution time = 2.1193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334257420341
                                         uncertainty =       0.002755972899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334257420341
                                         uncertainty =       0.002755972899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408830089
  error estimate for blocks of size 2^( 2) =       0.000423080842
  error estimate for blocks of size 2^( 3) =       0.000437881586
  error estimate for blocks of size 2^( 4) =       0.000452970116
  error estimate for blocks of size 2^( 5) =       0.000466231607
  error estimate for blocks of size 2^( 6) =       0.000478248290
  error estimate for blocks of size 2^( 7) =       0.000488050590

      target function =                  N/A
              le_mean =     -16.918787471701
             les_mean =     286.579653428522
             stat err =       0.000471375151
             autocorr =       1.329375485657
              std dev =       0.578173056340
             le_variance =       0.334284083078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691878747170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918787471701       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918787471701       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918787471701       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918787471701       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918787471701       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918787471701       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6697e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.190962
====================================================
  Execution time = 2.2302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4557e-01
  Total weights = 2.0000e+06
  Execution time = 1.8644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415675155
  error estimate for blocks of size 2^( 2) =       0.000429046070
  error estimate for blocks of size 2^( 3) =       0.000443589038
  error estimate for blocks of size 2^( 4) =       0.000459307698
  error estimate for blocks of size 2^( 5) =       0.000474432204
  error estimate for blocks of size 2^( 6) =       0.000486583291
  error estimate for blocks of size 2^( 7) =       0.000494981198

      target function =                  N/A
              le_mean =     -16.918624989347
             les_mean =     286.585443025828
             stat err =       0.000478826098
             autocorr =       1.326928409368
              std dev =       0.587853441309
             le_variance =       0.345571668459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415675155
  error estimate for blocks of size 2^( 2) =       0.000429046070
  error estimate for blocks of size 2^( 3) =       0.000443589038
  error estimate for blocks of size 2^( 4) =       0.000459307698
  error estimate for blocks of size 2^( 5) =       0.000474432204
  error estimate for blocks of size 2^( 6) =       0.000486583291
  error estimate for blocks of size 2^( 7) =       0.000494981198

      target function =                  N/A
              le_mean =     -16.918624989347
             les_mean =     286.585443025828
             stat err =       0.000478826098
             autocorr =       1.326928409368
              std dev =       0.587853441309
             le_variance =       0.345571668459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415675155
  error estimate for blocks of size 2^( 2) =       0.000429046070
  error estimate for blocks of size 2^( 3) =       0.000443589038
  error estimate for blocks of size 2^( 4) =       0.000459307698
  error estimate for blocks of size 2^( 5) =       0.000474432204
  error estimate for blocks of size 2^( 6) =       0.000486583291
  error estimate for blocks of size 2^( 7) =       0.000494981198

      target function =                  N/A
              le_mean =     -16.918624989347
             les_mean =     286.585443025828
             stat err =       0.000478826098
             autocorr =       1.326928409368
              std dev =       0.587853441309
             le_variance =       0.345571668459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345553894864
                                         uncertainty =       0.004591626663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415675155
  error estimate for blocks of size 2^( 2) =       0.000429046070
  error estimate for blocks of size 2^( 3) =       0.000443589038
  error estimate for blocks of size 2^( 4) =       0.000459307698
  error estimate for blocks of size 2^( 5) =       0.000474432204
  error estimate for blocks of size 2^( 6) =       0.000486583291
  error estimate for blocks of size 2^( 7) =       0.000494981198

      target function =                  N/A
              le_mean =     -16.918624989347
             les_mean =     286.585443025828
             stat err =       0.000478826098
             autocorr =       1.326928409368
              std dev =       0.587853441309
             le_variance =       0.345571668459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918624989347        initial  <--
     6.1035e+12     6.1035e+13             0.0000e+00       -16.918624989347
     2.4414e+13     2.4414e+14             0.0000e+00       -16.918624989347
     9.7656e+13     9.7656e+14             0.0000e+00       -16.918624989347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7299
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9886
    reference variance = 0.305318
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6920e+01
  VMC Evar = 3.3370e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333742562171
                                         uncertainty =       0.002654747254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333742562171
                                         uncertainty =       0.002654747254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408473802
  error estimate for blocks of size 2^( 2) =       0.000421975674
  error estimate for blocks of size 2^( 3) =       0.000436286652
  error estimate for blocks of size 2^( 4) =       0.000451572890
  error estimate for blocks of size 2^( 5) =       0.000465500460
  error estimate for blocks of size 2^( 6) =       0.000477998731
  error estimate for blocks of size 2^( 7) =       0.000486468388

      target function =                  N/A
              le_mean =     -16.919532846524
             les_mean =     286.604293271391
             stat err =       0.000470385117
             autocorr =       1.326107495011
              std dev =       0.577669190498
             le_variance =       0.333701693650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691953284652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919532846524       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919532846524       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919532846524       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919532846524       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.17e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919532846524       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919532846524       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.17e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6403e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.986
    reference variance = 0.305596
====================================================
  Execution time = 2.0138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.0000e+06
  Execution time = 1.8693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056322
  error estimate for blocks of size 2^( 2) =       0.000423024338
  error estimate for blocks of size 2^( 3) =       0.000438372882
  error estimate for blocks of size 2^( 4) =       0.000453319986
  error estimate for blocks of size 2^( 5) =       0.000466942385
  error estimate for blocks of size 2^( 6) =       0.000479890088
  error estimate for blocks of size 2^( 7) =       0.000488131379

      target function =                  N/A
              le_mean =     -16.918512268564
             les_mean =     286.570711363329
             stat err =       0.000472070959
             autocorr =       1.331828642720
              std dev =       0.578492998327
             le_variance =       0.334654149113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056322
  error estimate for blocks of size 2^( 2) =       0.000423024338
  error estimate for blocks of size 2^( 3) =       0.000438372882
  error estimate for blocks of size 2^( 4) =       0.000453319986
  error estimate for blocks of size 2^( 5) =       0.000466942385
  error estimate for blocks of size 2^( 6) =       0.000479890088
  error estimate for blocks of size 2^( 7) =       0.000488131379

      target function =                  N/A
              le_mean =     -16.918512268564
             les_mean =     286.570711363329
             stat err =       0.000472070959
             autocorr =       1.331828642720
              std dev =       0.578492998327
             le_variance =       0.334654149113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056322
  error estimate for blocks of size 2^( 2) =       0.000423024338
  error estimate for blocks of size 2^( 3) =       0.000438372882
  error estimate for blocks of size 2^( 4) =       0.000453319986
  error estimate for blocks of size 2^( 5) =       0.000466942385
  error estimate for blocks of size 2^( 6) =       0.000479890088
  error estimate for blocks of size 2^( 7) =       0.000488131379

      target function =                  N/A
              le_mean =     -16.918512268564
             les_mean =     286.570711363329
             stat err =       0.000472070959
             autocorr =       1.331828642720
              std dev =       0.578492998327
             le_variance =       0.334654149113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622062029
                                         uncertainty =       0.003161984131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409056322
  error estimate for blocks of size 2^( 2) =       0.000423024338
  error estimate for blocks of size 2^( 3) =       0.000438372882
  error estimate for blocks of size 2^( 4) =       0.000453319986
  error estimate for blocks of size 2^( 5) =       0.000466942385
  error estimate for blocks of size 2^( 6) =       0.000479890088
  error estimate for blocks of size 2^( 7) =       0.000488131379

      target function =                  N/A
              le_mean =     -16.918512268564
             les_mean =     286.570711363329
             stat err =       0.000472070959
             autocorr =       1.331828642720
              std dev =       0.578492998327
             le_variance =       0.334654149113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918512268564        initial  <--
     6.1035e+13     6.1035e+14             0.0000e+00       -16.918512268564
     2.4414e+14     2.4414e+15             0.0000e+00       -16.918512268564
     9.7656e+14     9.7656e+15             0.0000e+00       -16.918512268564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5644
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8328
    reference variance = 0.335437
====================================================
  Execution time = 2.0955e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640295809
                                         uncertainty =       0.007520210613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342640295809
                                         uncertainty =       0.007520210613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413893541
  error estimate for blocks of size 2^( 2) =       0.000427868429
  error estimate for blocks of size 2^( 3) =       0.000442828427
  error estimate for blocks of size 2^( 4) =       0.000457677806
  error estimate for blocks of size 2^( 5) =       0.000472569386
  error estimate for blocks of size 2^( 6) =       0.000485957372
  error estimate for blocks of size 2^( 7) =       0.000496162511

      target function =                  N/A
              le_mean =     -16.919227369231
             les_mean =     286.602870327068
             stat err =       0.000478091769
             autocorr =       1.334274648892
              std dev =       0.585333859125
             le_variance =       0.342615726638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691922736923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919227369231       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919227369231       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919227369231       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919227369231       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919227369231       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919227369231       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6453e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0007
    reference variance = 0.285018
====================================================
  Execution time = 2.0232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4420e-01
  Total weights = 2.0000e+06
  Execution time = 1.8696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414850099
  error estimate for blocks of size 2^( 2) =       0.000428705197
  error estimate for blocks of size 2^( 3) =       0.000444212717
  error estimate for blocks of size 2^( 4) =       0.000459610583
  error estimate for blocks of size 2^( 5) =       0.000474494751
  error estimate for blocks of size 2^( 6) =       0.000488484131
  error estimate for blocks of size 2^( 7) =       0.000495218373

      target function =                  N/A
              le_mean =     -16.918391840582
             les_mean =     286.576183508003
             stat err =       0.000479451959
             autocorr =       1.335696537985
              std dev =       0.586686635799
             le_variance =       0.344201208625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414850099
  error estimate for blocks of size 2^( 2) =       0.000428705197
  error estimate for blocks of size 2^( 3) =       0.000444212717
  error estimate for blocks of size 2^( 4) =       0.000459610583
  error estimate for blocks of size 2^( 5) =       0.000474494751
  error estimate for blocks of size 2^( 6) =       0.000488484131
  error estimate for blocks of size 2^( 7) =       0.000495218373

      target function =                  N/A
              le_mean =     -16.918391840582
             les_mean =     286.576183508003
             stat err =       0.000479451959
             autocorr =       1.335696537985
              std dev =       0.586686635799
             le_variance =       0.344201208625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414850099
  error estimate for blocks of size 2^( 2) =       0.000428705197
  error estimate for blocks of size 2^( 3) =       0.000444212717
  error estimate for blocks of size 2^( 4) =       0.000459610583
  error estimate for blocks of size 2^( 5) =       0.000474494751
  error estimate for blocks of size 2^( 6) =       0.000488484131
  error estimate for blocks of size 2^( 7) =       0.000495218373

      target function =                  N/A
              le_mean =     -16.918391840582
             les_mean =     286.576183508003
             stat err =       0.000479451959
             autocorr =       1.335696537985
              std dev =       0.586686635799
             le_variance =       0.344201208625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344168122651
                                         uncertainty =       0.009721750621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414850099
  error estimate for blocks of size 2^( 2) =       0.000428705197
  error estimate for blocks of size 2^( 3) =       0.000444212717
  error estimate for blocks of size 2^( 4) =       0.000459610583
  error estimate for blocks of size 2^( 5) =       0.000474494751
  error estimate for blocks of size 2^( 6) =       0.000488484131
  error estimate for blocks of size 2^( 7) =       0.000495218373

      target function =                  N/A
              le_mean =     -16.918391840582
             les_mean =     286.576183508003
             stat err =       0.000479451959
             autocorr =       1.335696537985
              std dev =       0.586686635799
             le_variance =       0.344201208625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918391840582        initial  <--
     6.1035e+14     6.1035e+15             0.0000e+00       -16.918391840582
     2.4414e+15     2.4414e+16             0.0000e+00       -16.918391840582
     9.7656e+15     9.7656e+16             0.0000e+00       -16.918391840582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2242
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9421
    reference variance = 0.276014
====================================================
  Execution time = 2.0977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346744984365
                                         uncertainty =       0.006010577065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346744984365
                                         uncertainty =       0.006010577065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416285394
  error estimate for blocks of size 2^( 2) =       0.000430395472
  error estimate for blocks of size 2^( 3) =       0.000445613065
  error estimate for blocks of size 2^( 4) =       0.000461460998
  error estimate for blocks of size 2^( 5) =       0.000476002074
  error estimate for blocks of size 2^( 6) =       0.000487212186
  error estimate for blocks of size 2^( 7) =       0.000497743671

      target function =                  N/A
              le_mean =     -16.919001271396
             les_mean =     286.599190907364
             stat err =       0.000480604732
             autocorr =       1.332888246103
              std dev =       0.588716450554
             le_variance =       0.346587059153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691900127140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919001271396       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919001271396       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919001271396       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919001271396       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919001271396       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919001271396       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6489e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9586
    reference variance = 0.22125
====================================================
  Execution time = 2.0360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3337e-01
  Total weights = 2.0000e+06
  Execution time = 1.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408271117
  error estimate for blocks of size 2^( 2) =       0.000422287955
  error estimate for blocks of size 2^( 3) =       0.000437884137
  error estimate for blocks of size 2^( 4) =       0.000453289027
  error estimate for blocks of size 2^( 5) =       0.000467813622
  error estimate for blocks of size 2^( 6) =       0.000479669028
  error estimate for blocks of size 2^( 7) =       0.000487855685

      target function =                  N/A
              le_mean =     -16.918759436386
             les_mean =     286.577791309208
             stat err =       0.000472156840
             autocorr =       1.337442926911
              std dev =       0.577382550472
             le_variance =       0.333370609590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408271117
  error estimate for blocks of size 2^( 2) =       0.000422287955
  error estimate for blocks of size 2^( 3) =       0.000437884137
  error estimate for blocks of size 2^( 4) =       0.000453289027
  error estimate for blocks of size 2^( 5) =       0.000467813622
  error estimate for blocks of size 2^( 6) =       0.000479669028
  error estimate for blocks of size 2^( 7) =       0.000487855685

      target function =                  N/A
              le_mean =     -16.918759436386
             les_mean =     286.577791309208
             stat err =       0.000472156840
             autocorr =       1.337442926911
              std dev =       0.577382550472
             le_variance =       0.333370609590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408271117
  error estimate for blocks of size 2^( 2) =       0.000422287955
  error estimate for blocks of size 2^( 3) =       0.000437884137
  error estimate for blocks of size 2^( 4) =       0.000453289027
  error estimate for blocks of size 2^( 5) =       0.000467813622
  error estimate for blocks of size 2^( 6) =       0.000479669028
  error estimate for blocks of size 2^( 7) =       0.000487855685

      target function =                  N/A
              le_mean =     -16.918759436386
             les_mean =     286.577791309208
             stat err =       0.000472156840
             autocorr =       1.337442926911
              std dev =       0.577382550472
             le_variance =       0.333370609590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332278163625
                                         uncertainty =       0.003260570099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408271117
  error estimate for blocks of size 2^( 2) =       0.000422287955
  error estimate for blocks of size 2^( 3) =       0.000437884137
  error estimate for blocks of size 2^( 4) =       0.000453289027
  error estimate for blocks of size 2^( 5) =       0.000467813622
  error estimate for blocks of size 2^( 6) =       0.000479669028
  error estimate for blocks of size 2^( 7) =       0.000487855685

      target function =                  N/A
              le_mean =     -16.918759436386
             les_mean =     286.577791309208
             stat err =       0.000472156840
             autocorr =       1.337442926911
              std dev =       0.577382550472
             le_variance =       0.333370609590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918759436386        initial  <--
     6.1035e+15     6.1035e+16             0.0000e+00       -16.918759436386
     2.4414e+16     2.4414e+17             0.0000e+00       -16.918759436386
     9.7656e+16     9.7656e+17             0.0000e+00       -16.918759436386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7639
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6259e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.236007
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3820e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338023114540
                                         uncertainty =       0.003394088495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338023114540
                                         uncertainty =       0.003394088495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411215680
  error estimate for blocks of size 2^( 2) =       0.000424750000
  error estimate for blocks of size 2^( 3) =       0.000439750859
  error estimate for blocks of size 2^( 4) =       0.000454584445
  error estimate for blocks of size 2^( 5) =       0.000468666378
  error estimate for blocks of size 2^( 6) =       0.000480893856
  error estimate for blocks of size 2^( 7) =       0.000489806396

      target function =                  N/A
              le_mean =     -16.918935415834
             les_mean =     286.588572107790
             stat err =       0.000473487769
             autocorr =       1.325800552903
              std dev =       0.581546792393
             le_variance =       0.338196671743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691893541583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918935415834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918935415834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918935415834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918935415834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918935415834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918935415834       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6140e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8401
    reference variance = 0.312815
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4181e-01
  Total weights = 2.0000e+06
  Execution time = 1.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413407639
  error estimate for blocks of size 2^( 2) =       0.000427258696
  error estimate for blocks of size 2^( 3) =       0.000441863484
  error estimate for blocks of size 2^( 4) =       0.000457175466
  error estimate for blocks of size 2^( 5) =       0.000470893147
  error estimate for blocks of size 2^( 6) =       0.000484049977
  error estimate for blocks of size 2^( 7) =       0.000491892735

      target function =                  N/A
              le_mean =     -16.918781626573
             les_mean =     286.586983309178
             stat err =       0.000476002831
             autocorr =       1.325751345232
              std dev =       0.584646690238
             le_variance =       0.341811752406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413407639
  error estimate for blocks of size 2^( 2) =       0.000427258696
  error estimate for blocks of size 2^( 3) =       0.000441863484
  error estimate for blocks of size 2^( 4) =       0.000457175466
  error estimate for blocks of size 2^( 5) =       0.000470893147
  error estimate for blocks of size 2^( 6) =       0.000484049977
  error estimate for blocks of size 2^( 7) =       0.000491892735

      target function =                  N/A
              le_mean =     -16.918781626573
             les_mean =     286.586983309178
             stat err =       0.000476002831
             autocorr =       1.325751345232
              std dev =       0.584646690238
             le_variance =       0.341811752406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413407639
  error estimate for blocks of size 2^( 2) =       0.000427258696
  error estimate for blocks of size 2^( 3) =       0.000441863484
  error estimate for blocks of size 2^( 4) =       0.000457175466
  error estimate for blocks of size 2^( 5) =       0.000470893147
  error estimate for blocks of size 2^( 6) =       0.000484049977
  error estimate for blocks of size 2^( 7) =       0.000491892735

      target function =                  N/A
              le_mean =     -16.918781626573
             les_mean =     286.586983309178
             stat err =       0.000476002831
             autocorr =       1.325751345232
              std dev =       0.584646690238
             le_variance =       0.341811752406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341709500353
                                         uncertainty =       0.006295655660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413407639
  error estimate for blocks of size 2^( 2) =       0.000427258696
  error estimate for blocks of size 2^( 3) =       0.000441863484
  error estimate for blocks of size 2^( 4) =       0.000457175466
  error estimate for blocks of size 2^( 5) =       0.000470893147
  error estimate for blocks of size 2^( 6) =       0.000484049977
  error estimate for blocks of size 2^( 7) =       0.000491892735

      target function =                  N/A
              le_mean =     -16.918781626573
             les_mean =     286.586983309178
             stat err =       0.000476002831
             autocorr =       1.325751345232
              std dev =       0.584646690238
             le_variance =       0.341811752406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918781626573        initial  <--
     6.1035e+16     6.1035e+17             0.0000e+00       -16.918781626573
     2.4414e+17     2.4414e+18             0.0000e+00       -16.918781626573
     9.7656e+17     9.7656e+18             0.0000e+00       -16.918781626573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8106
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.222923
====================================================
  Execution time = 2.0796e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.6450e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364506619302
                                         uncertainty =       0.023263464902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364506619302
                                         uncertainty =       0.023263464902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426910121
  error estimate for blocks of size 2^( 2) =       0.000440684215
  error estimate for blocks of size 2^( 3) =       0.000455665668
  error estimate for blocks of size 2^( 4) =       0.000470855960
  error estimate for blocks of size 2^( 5) =       0.000485553282
  error estimate for blocks of size 2^( 6) =       0.000497324098
  error estimate for blocks of size 2^( 7) =       0.000508607079

      target function =                  N/A
              le_mean =     -16.919011386945
             les_mean =     286.617450631386
             stat err =       0.000490585105
             autocorr =       1.320552934601
              std dev =       0.603742082401
             le_variance =       0.364504502061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691901138695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919011386945       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919011386945       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919011386945       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919011386945       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919011386945       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919011386945       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6326e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9822
    reference variance = 0.379397
====================================================
  Execution time = 2.0237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3487e-01
  Total weights = 2.0000e+06
  Execution time = 1.8622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409186423
  error estimate for blocks of size 2^( 2) =       0.000422837235
  error estimate for blocks of size 2^( 3) =       0.000437121494
  error estimate for blocks of size 2^( 4) =       0.000452540535
  error estimate for blocks of size 2^( 5) =       0.000465853418
  error estimate for blocks of size 2^( 6) =       0.000478745375
  error estimate for blocks of size 2^( 7) =       0.000486873999

      target function =                  N/A
              le_mean =     -16.919429854546
             les_mean =     286.601973493783
             stat err =       0.000471003332
             autocorr =       1.324968421507
              std dev =       0.578676989610
             le_variance =       0.334867058304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409186423
  error estimate for blocks of size 2^( 2) =       0.000422837235
  error estimate for blocks of size 2^( 3) =       0.000437121494
  error estimate for blocks of size 2^( 4) =       0.000452540535
  error estimate for blocks of size 2^( 5) =       0.000465853418
  error estimate for blocks of size 2^( 6) =       0.000478745375
  error estimate for blocks of size 2^( 7) =       0.000486873999

      target function =                  N/A
              le_mean =     -16.919429854546
             les_mean =     286.601973493783
             stat err =       0.000471003332
             autocorr =       1.324968421507
              std dev =       0.578676989610
             le_variance =       0.334867058304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409186423
  error estimate for blocks of size 2^( 2) =       0.000422837235
  error estimate for blocks of size 2^( 3) =       0.000437121494
  error estimate for blocks of size 2^( 4) =       0.000452540535
  error estimate for blocks of size 2^( 5) =       0.000465853418
  error estimate for blocks of size 2^( 6) =       0.000478745375
  error estimate for blocks of size 2^( 7) =       0.000486873999

      target function =                  N/A
              le_mean =     -16.919429854546
             les_mean =     286.601973493783
             stat err =       0.000471003332
             autocorr =       1.324968421507
              std dev =       0.578676989610
             le_variance =       0.334867058304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334862703665
                                         uncertainty =       0.002548694652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409186423
  error estimate for blocks of size 2^( 2) =       0.000422837235
  error estimate for blocks of size 2^( 3) =       0.000437121494
  error estimate for blocks of size 2^( 4) =       0.000452540535
  error estimate for blocks of size 2^( 5) =       0.000465853418
  error estimate for blocks of size 2^( 6) =       0.000478745375
  error estimate for blocks of size 2^( 7) =       0.000486873999

      target function =                  N/A
              le_mean =     -16.919429854546
             les_mean =     286.601973493783
             stat err =       0.000471003332
             autocorr =       1.324968421507
              std dev =       0.578676989610
             le_variance =       0.334867058304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919429854546        initial  <--
     6.1035e+17     6.1035e+18             0.0000e+00       -16.919429854546
     2.4414e+18     2.4414e+19             0.0000e+00       -16.919429854546
     9.7656e+18     9.7656e+19             0.0000e+00       -16.919429854546

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.1291
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9461e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9536
    reference variance = 0.414252
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342449582765
                                         uncertainty =       0.004952383754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342449582765
                                         uncertainty =       0.004952383754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413784947
  error estimate for blocks of size 2^( 2) =       0.000427907306
  error estimate for blocks of size 2^( 3) =       0.000442914609
  error estimate for blocks of size 2^( 4) =       0.000458503858
  error estimate for blocks of size 2^( 5) =       0.000473443142
  error estimate for blocks of size 2^( 6) =       0.000485133219
  error estimate for blocks of size 2^( 7) =       0.000495254238

      target function =                  N/A
              le_mean =     -16.918758207465
             les_mean =     286.586815076207
             stat err =       0.000478083614
             autocorr =       1.334929539305
              std dev =       0.585180283969
             le_variance =       0.342435964747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691875820747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918758207465       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918758207465       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918758207465       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918758207465       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918758207465       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 8.549885e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918758207465       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918758207465       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.918758207465       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 2.137471e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6346e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.88
    reference variance = 0.191748
====================================================
  Execution time = 2.0336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3692e-01
  Total weights = 2.0000e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410441346
  error estimate for blocks of size 2^( 2) =       0.000424672628
  error estimate for blocks of size 2^( 3) =       0.000439389054
  error estimate for blocks of size 2^( 4) =       0.000454741188
  error estimate for blocks of size 2^( 5) =       0.000467825044
  error estimate for blocks of size 2^( 6) =       0.000479267643
  error estimate for blocks of size 2^( 7) =       0.000489583152

      target function =                  N/A
              le_mean =     -16.917816303575
             les_mean =     286.549432509704
             stat err =       0.000472854257
             autocorr =       1.327248979554
              std dev =       0.580451717767
             le_variance =       0.336924196659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410441346
  error estimate for blocks of size 2^( 2) =       0.000424672628
  error estimate for blocks of size 2^( 3) =       0.000439389054
  error estimate for blocks of size 2^( 4) =       0.000454741188
  error estimate for blocks of size 2^( 5) =       0.000467825044
  error estimate for blocks of size 2^( 6) =       0.000479267643
  error estimate for blocks of size 2^( 7) =       0.000489583152

      target function =                  N/A
              le_mean =     -16.917816303575
             les_mean =     286.549432509704
             stat err =       0.000472854257
             autocorr =       1.327248979554
              std dev =       0.580451717767
             le_variance =       0.336924196659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410441346
  error estimate for blocks of size 2^( 2) =       0.000424672628
  error estimate for blocks of size 2^( 3) =       0.000439389054
  error estimate for blocks of size 2^( 4) =       0.000454741188
  error estimate for blocks of size 2^( 5) =       0.000467825044
  error estimate for blocks of size 2^( 6) =       0.000479267643
  error estimate for blocks of size 2^( 7) =       0.000489583152

      target function =                  N/A
              le_mean =     -16.917816303575
             les_mean =     286.549432509704
             stat err =       0.000472854257
             autocorr =       1.327248979554
              std dev =       0.580451717767
             le_variance =       0.336924196659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336979925852
                                         uncertainty =       0.003187940931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410441346
  error estimate for blocks of size 2^( 2) =       0.000424672628
  error estimate for blocks of size 2^( 3) =       0.000439389054
  error estimate for blocks of size 2^( 4) =       0.000454741188
  error estimate for blocks of size 2^( 5) =       0.000467825044
  error estimate for blocks of size 2^( 6) =       0.000479267643
  error estimate for blocks of size 2^( 7) =       0.000489583152

      target function =                  N/A
              le_mean =     -16.917816303575
             les_mean =     286.549432509704
             stat err =       0.000472854257
             autocorr =       1.327248979554
              std dev =       0.580451717767
             le_variance =       0.336924196659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.917816303575        initial  <--
     6.1035e+18     6.1035e+19             0.0000e+00       -16.917816303575
     2.4414e+19     2.4414e+20             8.5499e-24       -16.917816303575
     9.7656e+19     9.7656e+20             2.1375e-24       -16.917816303575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7234
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9339
    reference variance = 0.219173
====================================================
  Execution time = 2.0631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6920e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337014769474
                                         uncertainty =       0.002994303065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337014769474
                                         uncertainty =       0.002994303065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410456666
  error estimate for blocks of size 2^( 2) =       0.000424603070
  error estimate for blocks of size 2^( 3) =       0.000439455122
  error estimate for blocks of size 2^( 4) =       0.000454416209
  error estimate for blocks of size 2^( 5) =       0.000469974466
  error estimate for blocks of size 2^( 6) =       0.000481581244
  error estimate for blocks of size 2^( 7) =       0.000492729532

      target function =                  N/A
              le_mean =     -16.919634886415
             les_mean =     286.610993871253
             stat err =       0.000474675363
             autocorr =       1.337392102512
              std dev =       0.580473384517
             le_variance =       0.336949350133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691963488642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919634886415       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919634886415       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+19 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919634886415       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919634886415       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919634886415       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919634886415       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6109e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9331
    reference variance = 0.236482
====================================================
  Execution time = 2.0270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3759e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410844553
  error estimate for blocks of size 2^( 2) =       0.000424605682
  error estimate for blocks of size 2^( 3) =       0.000439798275
  error estimate for blocks of size 2^( 4) =       0.000454137279
  error estimate for blocks of size 2^( 5) =       0.000467767334
  error estimate for blocks of size 2^( 6) =       0.000480244128
  error estimate for blocks of size 2^( 7) =       0.000490775460

      target function =                  N/A
              le_mean =     -16.919380413298
             les_mean =     286.603019893940
             stat err =       0.000473231050
             autocorr =       1.326757033514
              std dev =       0.581021938344
             le_variance =       0.337586492837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410844553
  error estimate for blocks of size 2^( 2) =       0.000424605682
  error estimate for blocks of size 2^( 3) =       0.000439798275
  error estimate for blocks of size 2^( 4) =       0.000454137279
  error estimate for blocks of size 2^( 5) =       0.000467767334
  error estimate for blocks of size 2^( 6) =       0.000480244128
  error estimate for blocks of size 2^( 7) =       0.000490775460

      target function =                  N/A
              le_mean =     -16.919380413298
             les_mean =     286.603019893940
             stat err =       0.000473231050
             autocorr =       1.326757033514
              std dev =       0.581021938344
             le_variance =       0.337586492837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410844553
  error estimate for blocks of size 2^( 2) =       0.000424605682
  error estimate for blocks of size 2^( 3) =       0.000439798275
  error estimate for blocks of size 2^( 4) =       0.000454137279
  error estimate for blocks of size 2^( 5) =       0.000467767334
  error estimate for blocks of size 2^( 6) =       0.000480244128
  error estimate for blocks of size 2^( 7) =       0.000490775460

      target function =                  N/A
              le_mean =     -16.919380413298
             les_mean =     286.603019893940
             stat err =       0.000473231050
             autocorr =       1.326757033514
              std dev =       0.581021938344
             le_variance =       0.337586492837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337546490921
                                         uncertainty =       0.003763747559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410844553
  error estimate for blocks of size 2^( 2) =       0.000424605682
  error estimate for blocks of size 2^( 3) =       0.000439798275
  error estimate for blocks of size 2^( 4) =       0.000454137279
  error estimate for blocks of size 2^( 5) =       0.000467767334
  error estimate for blocks of size 2^( 6) =       0.000480244128
  error estimate for blocks of size 2^( 7) =       0.000490775460

      target function =                  N/A
              le_mean =     -16.919380413298
             les_mean =     286.603019893940
             stat err =       0.000473231050
             autocorr =       1.326757033514
              std dev =       0.581021938344
             le_variance =       0.337586492837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919380413298        initial  <--
     6.1035e+19     6.1035e+20             0.0000e+00       -16.919380413298
     2.4414e+20     2.4414e+21             0.0000e+00       -16.919380413298
     9.7656e+20     9.7656e+21             0.0000e+00       -16.919380413298

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6806
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9686
    reference variance = 0.256376
====================================================
  Execution time = 2.2679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334347105086
                                         uncertainty =       0.002692037929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334347105086
                                         uncertainty =       0.002692037929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409165323
  error estimate for blocks of size 2^( 2) =       0.000422916926
  error estimate for blocks of size 2^( 3) =       0.000438114356
  error estimate for blocks of size 2^( 4) =       0.000454335249
  error estimate for blocks of size 2^( 5) =       0.000468903613
  error estimate for blocks of size 2^( 6) =       0.000483335850
  error estimate for blocks of size 2^( 7) =       0.000490552337

      target function =                  N/A
              le_mean =     -16.918948082707
             les_mean =     286.585636581129
             stat err =       0.000474281762
             autocorr =       1.343616131348
              std dev =       0.578647149128
             le_variance =       0.334832523194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691894808271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918948082707       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918948082707       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918948082707       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918948082707       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918948082707       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918948082707       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8203e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.282142
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3730e-01
  Total weights = 2.0000e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410672621
  error estimate for blocks of size 2^( 2) =       0.000424967351
  error estimate for blocks of size 2^( 3) =       0.000440031482
  error estimate for blocks of size 2^( 4) =       0.000455524742
  error estimate for blocks of size 2^( 5) =       0.000470571221
  error estimate for blocks of size 2^( 6) =       0.000484791582
  error estimate for blocks of size 2^( 7) =       0.000495992211

      target function =                  N/A
              le_mean =     -16.917956006897
             les_mean =     286.554539285234
             stat err =       0.000476719939
             autocorr =       1.347519735944
              std dev =       0.580778789722
             le_variance =       0.337304002591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410672621
  error estimate for blocks of size 2^( 2) =       0.000424967351
  error estimate for blocks of size 2^( 3) =       0.000440031482
  error estimate for blocks of size 2^( 4) =       0.000455524742
  error estimate for blocks of size 2^( 5) =       0.000470571221
  error estimate for blocks of size 2^( 6) =       0.000484791582
  error estimate for blocks of size 2^( 7) =       0.000495992211

      target function =                  N/A
              le_mean =     -16.917956006897
             les_mean =     286.554539285234
             stat err =       0.000476719939
             autocorr =       1.347519735944
              std dev =       0.580778789722
             le_variance =       0.337304002591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410672621
  error estimate for blocks of size 2^( 2) =       0.000424967351
  error estimate for blocks of size 2^( 3) =       0.000440031482
  error estimate for blocks of size 2^( 4) =       0.000455524742
  error estimate for blocks of size 2^( 5) =       0.000470571221
  error estimate for blocks of size 2^( 6) =       0.000484791582
  error estimate for blocks of size 2^( 7) =       0.000495992211

      target function =                  N/A
              le_mean =     -16.917956006897
             les_mean =     286.554539285234
             stat err =       0.000476719939
             autocorr =       1.347519735944
              std dev =       0.580778789722
             le_variance =       0.337304002591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337298059272
                                         uncertainty =       0.003972827092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410672621
  error estimate for blocks of size 2^( 2) =       0.000424967351
  error estimate for blocks of size 2^( 3) =       0.000440031482
  error estimate for blocks of size 2^( 4) =       0.000455524742
  error estimate for blocks of size 2^( 5) =       0.000470571221
  error estimate for blocks of size 2^( 6) =       0.000484791582
  error estimate for blocks of size 2^( 7) =       0.000495992211

      target function =                  N/A
              le_mean =     -16.917956006897
             les_mean =     286.554539285234
             stat err =       0.000476719939
             autocorr =       1.347519735944
              std dev =       0.580778789722
             le_variance =       0.337304002591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.917956006897        initial  <--
     6.1035e+20     6.1035e+21             0.0000e+00       -16.917956006897
     2.4414e+21     2.4414e+22             0.0000e+00       -16.917956006897
     9.7656e+21     9.7656e+22             0.0000e+00       -16.917956006897

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9207
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8129e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9365
    reference variance = 0.166367
====================================================
  Execution time = 2.0550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.5220e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352289809154
                                         uncertainty =       0.011715290014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352289809154
                                         uncertainty =       0.011715290014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419645576
  error estimate for blocks of size 2^( 2) =       0.000433778247
  error estimate for blocks of size 2^( 3) =       0.000448380364
  error estimate for blocks of size 2^( 4) =       0.000464010106
  error estimate for blocks of size 2^( 5) =       0.000480818233
  error estimate for blocks of size 2^( 6) =       0.000492758671
  error estimate for blocks of size 2^( 7) =       0.000500853225

      target function =                  N/A
              le_mean =     -16.919147005970
             les_mean =     286.609740052926
             stat err =       0.000484610059
             autocorr =       1.333581462943
              std dev =       0.593468465374
             le_variance =       0.352204819394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691914700597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919147005970       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919147005970       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919147005970       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+21 is 4.086734e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919147005970       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919147005970       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919147005970       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 1.021683e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919147005970       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919147005970       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919147005970       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 2.554209e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6200e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9434
    reference variance = 0.156866
====================================================
  Execution time = 2.0497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.3759e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410846118
  error estimate for blocks of size 2^( 2) =       0.000424910285
  error estimate for blocks of size 2^( 3) =       0.000439943613
  error estimate for blocks of size 2^( 4) =       0.000454768340
  error estimate for blocks of size 2^( 5) =       0.000468828632
  error estimate for blocks of size 2^( 6) =       0.000482736716
  error estimate for blocks of size 2^( 7) =       0.000491525143

      target function =                  N/A
              le_mean =     -16.918131414717
             les_mean =     286.560759462349
             stat err =       0.000474464708
             autocorr =       1.333673283814
              std dev =       0.581024152269
             le_variance =       0.337589065520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410846118
  error estimate for blocks of size 2^( 2) =       0.000424910285
  error estimate for blocks of size 2^( 3) =       0.000439943613
  error estimate for blocks of size 2^( 4) =       0.000454768340
  error estimate for blocks of size 2^( 5) =       0.000468828632
  error estimate for blocks of size 2^( 6) =       0.000482736716
  error estimate for blocks of size 2^( 7) =       0.000491525143

      target function =                  N/A
              le_mean =     -16.918131414717
             les_mean =     286.560759462349
             stat err =       0.000474464708
             autocorr =       1.333673283814
              std dev =       0.581024152269
             le_variance =       0.337589065520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410846118
  error estimate for blocks of size 2^( 2) =       0.000424910285
  error estimate for blocks of size 2^( 3) =       0.000439943613
  error estimate for blocks of size 2^( 4) =       0.000454768340
  error estimate for blocks of size 2^( 5) =       0.000468828632
  error estimate for blocks of size 2^( 6) =       0.000482736716
  error estimate for blocks of size 2^( 7) =       0.000491525143

      target function =                  N/A
              le_mean =     -16.918131414717
             les_mean =     286.560759462349
             stat err =       0.000474464708
             autocorr =       1.333673283814
              std dev =       0.581024152269
             le_variance =       0.337589065520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337731663715
                                         uncertainty =       0.003991083991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410846118
  error estimate for blocks of size 2^( 2) =       0.000424910285
  error estimate for blocks of size 2^( 3) =       0.000439943613
  error estimate for blocks of size 2^( 4) =       0.000454768340
  error estimate for blocks of size 2^( 5) =       0.000468828632
  error estimate for blocks of size 2^( 6) =       0.000482736716
  error estimate for blocks of size 2^( 7) =       0.000491525143

      target function =                  N/A
              le_mean =     -16.918131414717
             les_mean =     286.560759462349
             stat err =       0.000474464708
             autocorr =       1.333673283814
              std dev =       0.581024152269
             le_variance =       0.337589065520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918131414717        initial  <--
     6.1035e+21     6.1035e+22             4.0867e-26       -16.918131414717
     2.4414e+22     2.4414e+23             1.0217e-26       -16.918131414717
     9.7656e+22     9.7656e+23             2.5542e-27       -16.918131414717

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9004
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8999
    reference variance = 0.353102
====================================================
  Execution time = 2.0631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4862e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348370431792
                                         uncertainty =       0.006823517880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348370431792
                                         uncertainty =       0.006823517880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417506653
  error estimate for blocks of size 2^( 2) =       0.000431558134
  error estimate for blocks of size 2^( 3) =       0.000445898808
  error estimate for blocks of size 2^( 4) =       0.000460622547
  error estimate for blocks of size 2^( 5) =       0.000475196191
  error estimate for blocks of size 2^( 6) =       0.000488170591
  error estimate for blocks of size 2^( 7) =       0.000498537088

      target function =                  N/A
              le_mean =     -16.917937276699
             les_mean =     286.565225135009
             stat err =       0.000480631604
             autocorr =       1.325250108165
              std dev =       0.590443571391
             le_variance =       0.348623610997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691793727670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917937276699       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917937276699       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917937276699       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917937276696       residual = 8.71e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+22 is 5.346694e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917937276699       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917937276699       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917937276699       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917937276710       residual = 8.71e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 1.336673e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.917937276699       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.917937276699       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.917937276699       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.917937276710       residual = 8.71e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 3.341684e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6140e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9829
    reference variance = 0.228336
====================================================
  Execution time = 2.0154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3647e-01
  Total weights = 2.0000e+06
  Execution time = 1.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410163832
  error estimate for blocks of size 2^( 2) =       0.000423908503
  error estimate for blocks of size 2^( 3) =       0.000438539525
  error estimate for blocks of size 2^( 4) =       0.000453731755
  error estimate for blocks of size 2^( 5) =       0.000467704195
  error estimate for blocks of size 2^( 6) =       0.000479156730
  error estimate for blocks of size 2^( 7) =       0.000487161879

      target function =                  N/A
              le_mean =     -16.919433596398
             les_mean =     286.603701792333
             stat err =       0.000471938640
             autocorr =       1.323903558973
              std dev =       0.580059253556
             le_variance =       0.336468737636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410163832
  error estimate for blocks of size 2^( 2) =       0.000423908503
  error estimate for blocks of size 2^( 3) =       0.000438539525
  error estimate for blocks of size 2^( 4) =       0.000453731755
  error estimate for blocks of size 2^( 5) =       0.000467704195
  error estimate for blocks of size 2^( 6) =       0.000479156730
  error estimate for blocks of size 2^( 7) =       0.000487161879

      target function =                  N/A
              le_mean =     -16.919433596398
             les_mean =     286.603701792333
             stat err =       0.000471938640
             autocorr =       1.323903558973
              std dev =       0.580059253556
             le_variance =       0.336468737636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410163832
  error estimate for blocks of size 2^( 2) =       0.000423908503
  error estimate for blocks of size 2^( 3) =       0.000438539525
  error estimate for blocks of size 2^( 4) =       0.000453731755
  error estimate for blocks of size 2^( 5) =       0.000467704195
  error estimate for blocks of size 2^( 6) =       0.000479156730
  error estimate for blocks of size 2^( 7) =       0.000487161879

      target function =                  N/A
              le_mean =     -16.919433596398
             les_mean =     286.603701792333
             stat err =       0.000471938640
             autocorr =       1.323903558973
              std dev =       0.580059253556
             le_variance =       0.336468737636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336521876059
                                         uncertainty =       0.003780722711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410163832
  error estimate for blocks of size 2^( 2) =       0.000423908503
  error estimate for blocks of size 2^( 3) =       0.000438539525
  error estimate for blocks of size 2^( 4) =       0.000453731755
  error estimate for blocks of size 2^( 5) =       0.000467704195
  error estimate for blocks of size 2^( 6) =       0.000479156730
  error estimate for blocks of size 2^( 7) =       0.000487161879

      target function =                  N/A
              le_mean =     -16.919433596398
             les_mean =     286.603701792333
             stat err =       0.000471938640
             autocorr =       1.323903558973
              std dev =       0.580059253556
             le_variance =       0.336468737636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919433596398        initial  <--
     6.1035e+22     6.1035e+23             5.3467e-27       -16.919433596398
     2.4414e+23     2.4414e+24             1.3367e-27       -16.919433596398
     9.7656e+23     9.7656e+24             3.3417e-28       -16.919433596398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5464
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.0158
    reference variance = 0.318749
====================================================
  Execution time = 2.2623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.4345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343521047763
                                         uncertainty =       0.006240303594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343521047763
                                         uncertainty =       0.006240303594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414397245
  error estimate for blocks of size 2^( 2) =       0.000428298169
  error estimate for blocks of size 2^( 3) =       0.000442913418
  error estimate for blocks of size 2^( 4) =       0.000458474615
  error estimate for blocks of size 2^( 5) =       0.000474636072
  error estimate for blocks of size 2^( 6) =       0.000489692871
  error estimate for blocks of size 2^( 7) =       0.000501287788

      target function =                  N/A
              le_mean =     -16.918522452047
             les_mean =     286.579851942755
             stat err =       0.000481022836
             autocorr =       1.347403495904
              std dev =       0.586046204706
             le_variance =       0.343450154050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691852245205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918522452047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918522452047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918522452047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918522452047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918522452047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918522452047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8129e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8562
    reference variance = 0.26357
====================================================
  Execution time = 2.0211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6920e+01
  VMC Evar = 3.5399e-01
  Total weights = 2.0000e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420707353
  error estimate for blocks of size 2^( 2) =       0.000433965905
  error estimate for blocks of size 2^( 3) =       0.000448178844
  error estimate for blocks of size 2^( 4) =       0.000463073350
  error estimate for blocks of size 2^( 5) =       0.000478109963
  error estimate for blocks of size 2^( 6) =       0.000489438256
  error estimate for blocks of size 2^( 7) =       0.000495961547

      target function =                  N/A
              le_mean =     -16.919529639769
             les_mean =     286.624472407086
             stat err =       0.000481645779
             autocorr =       1.310675898266
              std dev =       0.594970043826
             le_variance =       0.353989353050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420707353
  error estimate for blocks of size 2^( 2) =       0.000433965905
  error estimate for blocks of size 2^( 3) =       0.000448178844
  error estimate for blocks of size 2^( 4) =       0.000463073350
  error estimate for blocks of size 2^( 5) =       0.000478109963
  error estimate for blocks of size 2^( 6) =       0.000489438256
  error estimate for blocks of size 2^( 7) =       0.000495961547

      target function =                  N/A
              le_mean =     -16.919529639769
             les_mean =     286.624472407086
             stat err =       0.000481645779
             autocorr =       1.310675898266
              std dev =       0.594970043826
             le_variance =       0.353989353050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420707353
  error estimate for blocks of size 2^( 2) =       0.000433965905
  error estimate for blocks of size 2^( 3) =       0.000448178844
  error estimate for blocks of size 2^( 4) =       0.000463073350
  error estimate for blocks of size 2^( 5) =       0.000478109963
  error estimate for blocks of size 2^( 6) =       0.000489438256
  error estimate for blocks of size 2^( 7) =       0.000495961547

      target function =                  N/A
              le_mean =     -16.919529639769
             les_mean =     286.624472407086
             stat err =       0.000481645779
             autocorr =       1.310675898266
              std dev =       0.594970043826
             le_variance =       0.353989353050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354013017129
                                         uncertainty =       0.009265613357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420707353
  error estimate for blocks of size 2^( 2) =       0.000433965905
  error estimate for blocks of size 2^( 3) =       0.000448178844
  error estimate for blocks of size 2^( 4) =       0.000463073350
  error estimate for blocks of size 2^( 5) =       0.000478109963
  error estimate for blocks of size 2^( 6) =       0.000489438256
  error estimate for blocks of size 2^( 7) =       0.000495961547

      target function =                  N/A
              le_mean =     -16.919529639769
             les_mean =     286.624472407086
             stat err =       0.000481645779
             autocorr =       1.310675898266
              std dev =       0.594970043826
             le_variance =       0.353989353050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919529639769        initial  <--
     6.1035e+23     6.1035e+24             0.0000e+00       -16.919529639769
     2.4414e+24     2.4414e+25             0.0000e+00       -16.919529639769
     9.7656e+24     9.7656e+25             0.0000e+00       -16.919529639769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6044
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.186046
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257712057
                                         uncertainty =       0.005807516763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257712057
                                         uncertainty =       0.005807516763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411877130
  error estimate for blocks of size 2^( 2) =       0.000425695465
  error estimate for blocks of size 2^( 3) =       0.000440406956
  error estimate for blocks of size 2^( 4) =       0.000454742365
  error estimate for blocks of size 2^( 5) =       0.000468630630
  error estimate for blocks of size 2^( 6) =       0.000480094378
  error estimate for blocks of size 2^( 7) =       0.000485767943

      target function =                  N/A
              le_mean =     -16.919458459996
             les_mean =     286.607359949518
             stat err =       0.000472308829
             autocorr =       1.314972809502
              std dev =       0.582482222576
             le_variance =       0.339285539617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691945846000e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919458459996       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919458459996       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919458459996       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919458615316       residual = 6.24e+05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+24 is 5.240292e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919458459996       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919458459996       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919458459997       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 8.697581e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919458459996       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919458459996       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919458459996       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.919458459997       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 3.275183e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6099e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.887
    reference variance = 0.160878
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6918e+01
  VMC Evar = 3.4529e-01
  Total weights = 2.0000e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415507447
  error estimate for blocks of size 2^( 2) =       0.000429101438
  error estimate for blocks of size 2^( 3) =       0.000443867434
  error estimate for blocks of size 2^( 4) =       0.000459469500
  error estimate for blocks of size 2^( 5) =       0.000474712112
  error estimate for blocks of size 2^( 6) =       0.000486673418
  error estimate for blocks of size 2^( 7) =       0.000494823810

      target function =                  N/A
              le_mean =     -16.918357648666
             les_mean =     286.576118233197
             stat err =       0.000478919710
             autocorr =       1.328519083276
              std dev =       0.587616267358
             le_variance =       0.345292877664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415507447
  error estimate for blocks of size 2^( 2) =       0.000429101438
  error estimate for blocks of size 2^( 3) =       0.000443867434
  error estimate for blocks of size 2^( 4) =       0.000459469500
  error estimate for blocks of size 2^( 5) =       0.000474712112
  error estimate for blocks of size 2^( 6) =       0.000486673418
  error estimate for blocks of size 2^( 7) =       0.000494823810

      target function =                  N/A
              le_mean =     -16.918357648666
             les_mean =     286.576118233197
             stat err =       0.000478919710
             autocorr =       1.328519083276
              std dev =       0.587616267358
             le_variance =       0.345292877664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415507447
  error estimate for blocks of size 2^( 2) =       0.000429101438
  error estimate for blocks of size 2^( 3) =       0.000443867434
  error estimate for blocks of size 2^( 4) =       0.000459469500
  error estimate for blocks of size 2^( 5) =       0.000474712112
  error estimate for blocks of size 2^( 6) =       0.000486673418
  error estimate for blocks of size 2^( 7) =       0.000494823810

      target function =                  N/A
              le_mean =     -16.918357648666
             les_mean =     286.576118233197
             stat err =       0.000478919710
             autocorr =       1.328519083276
              std dev =       0.587616267358
             le_variance =       0.345292877664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345343842033
                                         uncertainty =       0.011159585003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415507447
  error estimate for blocks of size 2^( 2) =       0.000429101438
  error estimate for blocks of size 2^( 3) =       0.000443867434
  error estimate for blocks of size 2^( 4) =       0.000459469500
  error estimate for blocks of size 2^( 5) =       0.000474712112
  error estimate for blocks of size 2^( 6) =       0.000486673418
  error estimate for blocks of size 2^( 7) =       0.000494823810

      target function =                  N/A
              le_mean =     -16.918357648666
             les_mean =     286.576118233197
             stat err =       0.000478919710
             autocorr =       1.328519083276
              std dev =       0.587616267358
             le_variance =       0.345292877664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918357648666        initial  <--
     6.1035e+24     6.1035e+25             5.2403e-29       -16.918357648666
     2.4414e+25     2.4414e+26             8.6976e-30       -16.918357648666
     9.7656e+25     9.7656e+26             3.2752e-30       -16.918357648666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8670
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.350624
====================================================
  Execution time = 2.0617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.7116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371208791002
                                         uncertainty =       0.021429769865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371208791002
                                         uncertainty =       0.021429769865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430787501
  error estimate for blocks of size 2^( 2) =       0.000444968143
  error estimate for blocks of size 2^( 3) =       0.000459413383
  error estimate for blocks of size 2^( 4) =       0.000474860375
  error estimate for blocks of size 2^( 5) =       0.000489210259
  error estimate for blocks of size 2^( 6) =       0.000502438575
  error estimate for blocks of size 2^( 7) =       0.000512624059

      target function =                  N/A
              le_mean =     -16.918738652077
             les_mean =     286.614873134330
             stat err =       0.000494783317
             autocorr =       1.319179540101
              std dev =       0.609225526905
             le_variance =       0.371155742633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691873865208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918738652077       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918738652077       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918738652077       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918738652077       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.918738652077       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.918738652077       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6119e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.131996
====================================================
  Execution time = 2.2397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.0000e+06
  Execution time = 1.9138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409417171
  error estimate for blocks of size 2^( 2) =       0.000423252468
  error estimate for blocks of size 2^( 3) =       0.000437679514
  error estimate for blocks of size 2^( 4) =       0.000452676453
  error estimate for blocks of size 2^( 5) =       0.000465855217
  error estimate for blocks of size 2^( 6) =       0.000477823344
  error estimate for blocks of size 2^( 7) =       0.000485651192

      target function =                  N/A
              le_mean =     -16.919194005130
             les_mean =     286.594370455410
             stat err =       0.000470501551
             autocorr =       1.320656926216
              std dev =       0.579003315880
             le_variance =       0.335244839800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409417171
  error estimate for blocks of size 2^( 2) =       0.000423252468
  error estimate for blocks of size 2^( 3) =       0.000437679514
  error estimate for blocks of size 2^( 4) =       0.000452676453
  error estimate for blocks of size 2^( 5) =       0.000465855217
  error estimate for blocks of size 2^( 6) =       0.000477823344
  error estimate for blocks of size 2^( 7) =       0.000485651192

      target function =                  N/A
              le_mean =     -16.919194005130
             les_mean =     286.594370455410
             stat err =       0.000470501551
             autocorr =       1.320656926216
              std dev =       0.579003315880
             le_variance =       0.335244839800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409417171
  error estimate for blocks of size 2^( 2) =       0.000423252468
  error estimate for blocks of size 2^( 3) =       0.000437679514
  error estimate for blocks of size 2^( 4) =       0.000452676453
  error estimate for blocks of size 2^( 5) =       0.000465855217
  error estimate for blocks of size 2^( 6) =       0.000477823344
  error estimate for blocks of size 2^( 7) =       0.000485651192

      target function =                  N/A
              le_mean =     -16.919194005130
             les_mean =     286.594370455410
             stat err =       0.000470501551
             autocorr =       1.320656926216
              std dev =       0.579003315880
             le_variance =       0.335244839800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335290251998
                                         uncertainty =       0.003693628548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409417171
  error estimate for blocks of size 2^( 2) =       0.000423252468
  error estimate for blocks of size 2^( 3) =       0.000437679514
  error estimate for blocks of size 2^( 4) =       0.000452676453
  error estimate for blocks of size 2^( 5) =       0.000465855217
  error estimate for blocks of size 2^( 6) =       0.000477823344
  error estimate for blocks of size 2^( 7) =       0.000485651192

      target function =                  N/A
              le_mean =     -16.919194005130
             les_mean =     286.594370455410
             stat err =       0.000470501551
             autocorr =       1.320656926216
              std dev =       0.579003315880
             le_variance =       0.335244839800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.919194005130        initial  <--
     6.1035e+25     6.1035e+26             0.0000e+00       -16.919194005130
     2.4414e+26     2.4414e+27             0.0000e+00       -16.919194005130
     9.7656e+26     9.7656e+27             0.0000e+00       -16.919194005130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0553
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.6444
    reference variance = 9.42295
====================================================
  Execution time = 2.0604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062680183
                                         uncertainty =       0.003441886226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062680183
                                         uncertainty =       0.003441886226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412132519
  error estimate for blocks of size 2^( 2) =       0.000425570181
  error estimate for blocks of size 2^( 3) =       0.000440809632
  error estimate for blocks of size 2^( 4) =       0.000456820905
  error estimate for blocks of size 2^( 5) =       0.000472854692
  error estimate for blocks of size 2^( 6) =       0.000486185614
  error estimate for blocks of size 2^( 7) =       0.000494421436

      target function =                  N/A
              le_mean =     -16.919213749624
             les_mean =     286.599500161262
             stat err =       0.000477570662
             autocorr =       1.342769637275
              std dev =       0.582843397205
             le_variance =       0.339706425665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691921374962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919213749624       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919213749624       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919213749643       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+26 is 3.529404e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919213749624       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919213749624       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919213749624       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919213749624       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919213749701       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 2.205878e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283088 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9399
    reference variance = 0.194451
====================================================
  Execution time = 2.0210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.0000e+06
  Execution time = 1.9210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409287684
  error estimate for blocks of size 2^( 2) =       0.000423051675
  error estimate for blocks of size 2^( 3) =       0.000437701166
  error estimate for blocks of size 2^( 4) =       0.000452119423
  error estimate for blocks of size 2^( 5) =       0.000465334951
  error estimate for blocks of size 2^( 6) =       0.000476194709
  error estimate for blocks of size 2^( 7) =       0.000484810035

      target function =                  N/A
              le_mean =     -16.918890174819
             les_mean =     286.583877396178
             stat err =       0.000469614779
             autocorr =       1.316516057087
              std dev =       0.578820193249
             le_variance =       0.335032816113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409287684
  error estimate for blocks of size 2^( 2) =       0.000423051675
  error estimate for blocks of size 2^( 3) =       0.000437701166
  error estimate for blocks of size 2^( 4) =       0.000452119423
  error estimate for blocks of size 2^( 5) =       0.000465334951
  error estimate for blocks of size 2^( 6) =       0.000476194709
  error estimate for blocks of size 2^( 7) =       0.000484810035

      target function =                  N/A
              le_mean =     -16.918890174819
             les_mean =     286.583877396178
             stat err =       0.000469614779
             autocorr =       1.316516057087
              std dev =       0.578820193249
             le_variance =       0.335032816113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409287684
  error estimate for blocks of size 2^( 2) =       0.000423051675
  error estimate for blocks of size 2^( 3) =       0.000437701166
  error estimate for blocks of size 2^( 4) =       0.000452119423
  error estimate for blocks of size 2^( 5) =       0.000465334951
  error estimate for blocks of size 2^( 6) =       0.000476194709
  error estimate for blocks of size 2^( 7) =       0.000484810035

      target function =                  N/A
              le_mean =     -16.918890174819
             les_mean =     286.583877396178
             stat err =       0.000469614779
             autocorr =       1.316516057087
              std dev =       0.578820193249
             le_variance =       0.335032816113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335074442321
                                         uncertainty =       0.003902542417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409287684
  error estimate for blocks of size 2^( 2) =       0.000423051675
  error estimate for blocks of size 2^( 3) =       0.000437701166
  error estimate for blocks of size 2^( 4) =       0.000452119423
  error estimate for blocks of size 2^( 5) =       0.000465334951
  error estimate for blocks of size 2^( 6) =       0.000476194709
  error estimate for blocks of size 2^( 7) =       0.000484810035

      target function =                  N/A
              le_mean =     -16.918890174819
             les_mean =     286.583877396178
             stat err =       0.000469614779
             autocorr =       1.316516057087
              std dev =       0.578820193249
             le_variance =       0.335032816113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918890174819        initial  <--
     6.1035e+26     6.1035e+27             3.5294e-31       -16.918890174819
     2.4414e+27     2.4414e+28             0.0000e+00       -16.918890174819
     9.7656e+27     9.7656e+28             2.2059e-32       -16.918890174819

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9121
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.243284
====================================================
  Execution time = 2.0603e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3648e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336443321333
                                         uncertainty =       0.003520251519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336443321333
                                         uncertainty =       0.003520251519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410171998
  error estimate for blocks of size 2^( 2) =       0.000423854193
  error estimate for blocks of size 2^( 3) =       0.000438141430
  error estimate for blocks of size 2^( 4) =       0.000452630076
  error estimate for blocks of size 2^( 5) =       0.000467036110
  error estimate for blocks of size 2^( 6) =       0.000479409067
  error estimate for blocks of size 2^( 7) =       0.000488068428

      target function =                  N/A
              le_mean =     -16.919150476108
             les_mean =     286.594134800552
             stat err =       0.000471785920
             autocorr =       1.322994184782
              std dev =       0.580070802223
             le_variance =       0.336482135592


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691915047611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919150476108       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919150476108       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919150476111       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+27 is 3.307284e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919150476108       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919150476108       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919150475878       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+28 is 8.268209e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.919150476108       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.919150476108       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.919150475878       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 2.067052e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6096e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.255483
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6919e+01
  VMC Evar = 3.3753e-01
  Total weights = 2.0000e+06
  Execution time = 1.9243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410812560
  error estimate for blocks of size 2^( 2) =       0.000424470986
  error estimate for blocks of size 2^( 3) =       0.000439169620
  error estimate for blocks of size 2^( 4) =       0.000453637577
  error estimate for blocks of size 2^( 5) =       0.000468738532
  error estimate for blocks of size 2^( 6) =       0.000480943976
  error estimate for blocks of size 2^( 7) =       0.000490661847

      target function =                  N/A
              le_mean =     -16.918637959362
             les_mean =     286.577844150524
             stat err =       0.000473495483
             autocorr =       1.328447066125
              std dev =       0.580976694300
             le_variance =       0.337533919320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410812560
  error estimate for blocks of size 2^( 2) =       0.000424470986
  error estimate for blocks of size 2^( 3) =       0.000439169620
  error estimate for blocks of size 2^( 4) =       0.000453637577
  error estimate for blocks of size 2^( 5) =       0.000468738532
  error estimate for blocks of size 2^( 6) =       0.000480943976
  error estimate for blocks of size 2^( 7) =       0.000490661847

      target function =                  N/A
              le_mean =     -16.918637959362
             les_mean =     286.577844150524
             stat err =       0.000473495483
             autocorr =       1.328447066125
              std dev =       0.580976694300
             le_variance =       0.337533919320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410812560
  error estimate for blocks of size 2^( 2) =       0.000424470986
  error estimate for blocks of size 2^( 3) =       0.000439169620
  error estimate for blocks of size 2^( 4) =       0.000453637577
  error estimate for blocks of size 2^( 5) =       0.000468738532
  error estimate for blocks of size 2^( 6) =       0.000480943976
  error estimate for blocks of size 2^( 7) =       0.000490661847

      target function =                  N/A
              le_mean =     -16.918637959362
             les_mean =     286.577844150524
             stat err =       0.000473495483
             autocorr =       1.328447066125
              std dev =       0.580976694300
             le_variance =       0.337533919320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337588593894
                                         uncertainty =       0.003897964084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410812560
  error estimate for blocks of size 2^( 2) =       0.000424470986
  error estimate for blocks of size 2^( 3) =       0.000439169620
  error estimate for blocks of size 2^( 4) =       0.000453637577
  error estimate for blocks of size 2^( 5) =       0.000468738532
  error estimate for blocks of size 2^( 6) =       0.000480943976
  error estimate for blocks of size 2^( 7) =       0.000490661847

      target function =                  N/A
              le_mean =     -16.918637959362
             les_mean =     286.577844150524
             stat err =       0.000473495483
             autocorr =       1.328447066125
              std dev =       0.580976694300
             le_variance =       0.337533919320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.918637959362        initial  <--
     6.1035e+27     6.1035e+28             3.3073e-32       -16.918637959362
     2.4414e+28     2.4414e+29             8.2682e-33       -16.918637959362
     9.7656e+28     9.7656e+29             2.0671e-33       -16.918637959362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2258
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.081483e-01 1 1  ON 0
 uu_1                 1.417681e-01 1 1  ON 1
 uu_2                 4.119616e-02 1 1  ON 2
 uu_3                -2.024880e-02 1 1  ON 3
 uu_4                -6.380440e-02 1 1  ON 4
 uu_5                -9.658011e-02 1 1  ON 5
 uu_6                -1.231270e-01 1 1  ON 6
 uu_7                -1.364427e-01 1 1  ON 7
 uu_8                -1.290781e-01 1 1  ON 8
 uu_9                -9.978680e-02 1 1  ON 9
 ud_0                 4.434613e-01 1 1  ON 10
 ud_1                 1.774866e-01 1 1  ON 11
 ud_2                 5.731343e-02 1 1  ON 12
 ud_3                -1.306822e-02 1 1  ON 13
 ud_4                -6.886896e-02 1 1  ON 14
 ud_5                -1.077646e-01 1 1  ON 15
 ud_6                -1.325691e-01 1 1  ON 16
 ud_7                -1.467504e-01 1 1  ON 17
 ud_8                -1.454794e-01 1 1  ON 18
 ud_9                -1.351164e-01 1 1  ON 19
 eO_0                -7.647234e-01 1 1  ON 20
 eO_1                -4.429685e-01 1 1  ON 21
 eO_2                -2.112840e-02 1 1  ON 22
 eO_3                 3.007372e-01 1 1  ON 23
 eO_4                 5.262983e-01 1 1  ON 24
 eO_5                 4.823828e-01 1 1  ON 25
 eO_6                 2.508016e-01 1 1  ON 26
 eO_7                -4.899114e-02 1 1  ON 27
 eO_8                -2.108355e-01 1 1  ON 28
 eO_9                -7.178344e-02 1 1  ON 29
eH1_0                -2.368207e-01 1 1  ON 30
eH1_1                -1.377207e-01 1 1  ON 31
eH1_2                -9.204312e-02 1 1  ON 32
eH1_3                -3.799846e-02 1 1  ON 33
eH1_4                 7.292529e-03 1 1  ON 34
eH1_5                 4.117151e-02 1 1  ON 35
eH1_6                 9.663406e-02 1 1  ON 36
eH1_7                 1.470854e-01 1 1  ON 37
eH1_8                 1.643039e-01 1 1  ON 38
eH1_9                 5.149609e-02 1 1  ON 39
eH2_0                -2.336049e-01 1 1  ON 40
eH2_1                -1.347556e-01 1 1  ON 41
eH2_2                -8.894326e-02 1 1  ON 42
eH2_3                -3.492963e-02 1 1  ON 43
eH2_4                 1.108828e-02 1 1  ON 44
eH2_5                 4.339658e-02 1 1  ON 45
eH2_6                 9.947767e-02 1 1  ON 46
eH2_7                 1.513522e-01 1 1  ON 47
eH2_8                 1.698053e-01 1 1  ON 48
eH2_9                 3.490022e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6327e+01 secs
  Total Execution time = 2.2772e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
