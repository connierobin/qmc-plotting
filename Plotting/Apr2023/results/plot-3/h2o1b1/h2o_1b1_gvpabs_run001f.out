Rank =    0  Free Memory = 79794 MB
Rank =    1  Free Memory = 79794 MB
Rank =    2  Free Memory = 79794 MB
Rank =    3  Free Memory = 79794 MB
Rank =    4  Free Memory = 79793 MB
Rank =    5  Free Memory = 79793 MB
Rank =    6  Free Memory = 79793 MB
Rank =    7  Free Memory = 79792 MB
Rank =    8  Free Memory = 79792 MB
Rank =    9  Free Memory = 79792 MB
Rank =   10  Free Memory = 79792 MB
Rank =   11  Free Memory = 79792 MB
Rank =   12  Free Memory = 79792 MB
Rank =   13  Free Memory = 79792 MB
Rank =   14  Free Memory = 79792 MB
Rank =   15  Free Memory = 79780 MB
Rank =   16  Free Memory = 79780 MB
Rank =   17  Free Memory = 79779 MB
Rank =   18  Free Memory = 79779 MB
Rank =   19  Free Memory = 79779 MB
Rank =   20  Free Memory = 79779 MB
Rank =   21  Free Memory = 79779 MB
Rank =   22  Free Memory = 79778 MB
Rank =   23  Free Memory = 79778 MB
Rank =   24  Free Memory = 79778 MB
Rank =   25  Free Memory = 79778 MB
Rank =   26  Free Memory = 79778 MB
Rank =   27  Free Memory = 79778 MB
Rank =   28  Free Memory = 79778 MB
Rank =   29  Free Memory = 79778 MB
Rank =   30  Free Memory = 79778 MB
Rank =   31  Free Memory = 79778 MB
Rank =   32  Free Memory = 75890 MB
Rank =   33  Free Memory = 75890 MB
Rank =   34  Free Memory = 75890 MB
Rank =   35  Free Memory = 75890 MB
Rank =   36  Free Memory = 75890 MB
Rank =   37  Free Memory = 75890 MB
Rank =   38  Free Memory = 75890 MB
Rank =   39  Free Memory = 75890 MB
Rank =   40  Free Memory = 75890 MB
Rank =   41  Free Memory = 75890 MB
Rank =   42  Free Memory = 75890 MB
Rank =   43  Free Memory = 75890 MB
Rank =   44  Free Memory = 75890 MB
Rank =   45  Free Memory = 75890 MB
Rank =   46  Free Memory = 75890 MB
Rank =   47  Free Memory = 75890 MB
Rank =   48  Free Memory = 75890 MB
Rank =   49  Free Memory = 75890 MB
Rank =   50  Free Memory = 75890 MB
Rank =   51  Free Memory = 75890 MB
Rank =   52  Free Memory = 75890 MB
Rank =   53  Free Memory = 75890 MB
Rank =   54  Free Memory = 75890 MB
Rank =   55  Free Memory = 75890 MB
Rank =   56  Free Memory = 75890 MB
Rank =   57  Free Memory = 75890 MB
Rank =   58  Free Memory = 75890 MB
Rank =   59  Free Memory = 75890 MB
Rank =   60  Free Memory = 75890 MB
Rank =   61  Free Memory = 75890 MB
Rank =   62  Free Memory = 75890 MB
Rank =   63  Free Memory = 75890 MB
Rank =   64  Free Memory = 85688 MB
Rank =   65  Free Memory = 85688 MB
Rank =   66  Free Memory = 85688 MB
Rank =   67  Free Memory = 85688 MB
Rank =   68  Free Memory = 85688 MB
Rank =   69  Free Memory = 85688 MB
Rank =   70  Free Memory = 85688 MB
Rank =   71  Free Memory = 85688 MB
Rank =   72  Free Memory = 85688 MB
Rank =   73  Free Memory = 85688 MB
Rank =   74  Free Memory = 85688 MB
Rank =   75  Free Memory = 85688 MB
Rank =   76  Free Memory = 85688 MB
Rank =   77  Free Memory = 85688 MB
Rank =   78  Free Memory = 85688 MB
Rank =   79  Free Memory = 85688 MB
Rank =   80  Free Memory = 85688 MB
Rank =   81  Free Memory = 85687 MB
Rank =   82  Free Memory = 85687 MB
Rank =   83  Free Memory = 85687 MB
Rank =   84  Free Memory = 85687 MB
Rank =   85  Free Memory = 85687 MB
Rank =   86  Free Memory = 85687 MB
Rank =   87  Free Memory = 85687 MB
Rank =   88  Free Memory = 85687 MB
Rank =   89  Free Memory = 85687 MB
Rank =   90  Free Memory = 85687 MB
Rank =   91  Free Memory = 85687 MB
Rank =   92  Free Memory = 85687 MB
Rank =   93  Free Memory = 85687 MB
Rank =   94  Free Memory = 85687 MB
Rank =   95  Free Memory = 85687 MB
Rank =   96  Free Memory = 88610 MB
Rank =   97  Free Memory = 88610 MB
Rank =   98  Free Memory = 88610 MB
Rank =   99  Free Memory = 88610 MB
Rank =  100  Free Memory = 88610 MB
Rank =  101  Free Memory = 88610 MB
Rank =  102  Free Memory = 88610 MB
Rank =  103  Free Memory = 88610 MB
Rank =  104  Free Memory = 88610 MB
Rank =  105  Free Memory = 88610 MB
Rank =  106  Free Memory = 88610 MB
Rank =  107  Free Memory = 88610 MB
Rank =  108  Free Memory = 88610 MB
Rank =  109  Free Memory = 88610 MB
Rank =  110  Free Memory = 88610 MB
Rank =  111  Free Memory = 88610 MB
Rank =  112  Free Memory = 88610 MB
Rank =  113  Free Memory = 88610 MB
Rank =  114  Free Memory = 88610 MB
Rank =  115  Free Memory = 88610 MB
Rank =  116  Free Memory = 88610 MB
Rank =  117  Free Memory = 88610 MB
Rank =  118  Free Memory = 88610 MB
Rank =  119  Free Memory = 88610 MB
Rank =  120  Free Memory = 88610 MB
Rank =  121  Free Memory = 88610 MB
Rank =  122  Free Memory = 88610 MB
Rank =  123  Free Memory = 88610 MB
Rank =  124  Free Memory = 88610 MB
Rank =  125  Free Memory = 88610 MB
Rank =  126  Free Memory = 88610 MB
Rank =  127  Free Memory = 88610 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001f.xml

  Project = H2O
  date    = 2023-03-30 18:54:31 PDT
  host    = n0026.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 343

  Range of prime numbers to use as seeds over processors and threads = 2333-3359


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.092933e-01    1         1  ON     0
     uu_1                 1.425581e-01    1         1  ON     1
     uu_2                 4.090837e-02    1         1  ON     2
     uu_3                -2.150581e-02    1         1  ON     3
     uu_4                -6.690997e-02    1         1  ON     4
     uu_5                -1.013426e-01    1         1  ON     5
     uu_6                -1.282010e-01    1         1  ON     6
     uu_7                -1.411935e-01    1         1  ON     7
     uu_8                -1.329673e-01    1         1  ON     8
     uu_9                -1.043536e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.443527e-01    1         1  ON     0
     ud_1                 1.801295e-01    1         1  ON     1
     ud_2                 6.325054e-02    1         1  ON     2
     ud_3                -6.192833e-03    1         1  ON     3
     ud_4                -6.411883e-02    1         1  ON     4
     ud_5                -1.066798e-01    1         1  ON     5
     ud_6                -1.344888e-01    1         1  ON     6
     ud_7                -1.516146e-01    1         1  ON     7
     ud_8                -1.521892e-01    1         1  ON     8
     ud_9                -1.426112e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.585650e-01    1         1  ON     0
     eO_1                -4.404406e-01    1         1  ON     1
     eO_2                -2.262437e-02    1         1  ON     2
     eO_3                 2.977541e-01    1         1  ON     3
     eO_4                 5.252170e-01    1         1  ON     4
     eO_5                 4.870201e-01    1         1  ON     5
     eO_6                 2.596886e-01    1         1  ON     6
     eO_7                -4.096972e-02    1         1  ON     7
     eO_8                -2.205874e-01    1         1  ON     8
     eO_9                -8.532273e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.414798e-01    1         1  ON     0
     eH1_1                -1.440753e-01    1         1  ON     1
     eH1_2                -9.924639e-02    1         1  ON     2
     eH1_3                -4.540298e-02    1         1  ON     3
     eH1_4                 2.880356e-03    1         1  ON     4
     eH1_5                 3.773231e-02    1         1  ON     5
     eH1_6                 9.700215e-02    1         1  ON     6
     eH1_7                 1.538045e-01    1         1  ON     7
     eH1_8                 1.762282e-01    1         1  ON     8
     eH1_9                 6.658133e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.395720e-01    1         1  ON     0
     eH2_1                -1.418636e-01    1         1  ON     1
     eH2_2                -9.688539e-02    1         1  ON     2
     eH2_3                -4.316091e-02    1         1  ON     3
     eH2_4                 5.105057e-03    1         1  ON     4
     eH2_5                 3.979582e-02    1         1  ON     5
     eH2_6                 9.952831e-02    1         1  ON     6
     eH2_7                 1.556286e-01    1         1  ON     7
     eH2_8                 1.821134e-01    1         1  ON     8
     eH2_9                 5.595293e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 3.975358e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.5681e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8572
    reference variance = 0.426028
====================================================
  Execution time = 2.2499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7335e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373257205754
                                         uncertainty =       0.036289881860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373257205754
                                         uncertainty =       0.036289881860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432059621
  error estimate for blocks of size 2^( 2) =       0.000444543296
  error estimate for blocks of size 2^( 3) =       0.000456637630
  error estimate for blocks of size 2^( 4) =       0.000467805107
  error estimate for blocks of size 2^( 5) =       0.000476574049
  error estimate for blocks of size 2^( 6) =       0.000482337429
  error estimate for blocks of size 2^( 7) =       0.000484818319

      target function =                  N/A
              le_mean =     -16.905388196350
             les_mean =     286.165500915654
             stat err =       0.000477883726
             autocorr =       1.223368011502
              std dev =       0.611024576468
             le_variance =       0.373351033048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690538819635e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905388196350       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905411918196       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905419404195       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905419115573       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905424220955       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905424673443       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905425149179       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905425567957       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905425229749       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905425002975       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905425008006       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.858034e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905388196350       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905397325321       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905401172790       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905400976629       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905401790784       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905402511968       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905402803366       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905402974932       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905402838229       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.565218e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905388196350       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905390834271       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905392107452       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905392074412       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905392161756       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905392384850       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905392499227       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905392531042       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905392526609       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.803754e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8036e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.091883e-01                 1 1 ON  0
uu_1  1.424577e-01                 1 1 ON  1
uu_2  4.098654e-02                 1 1 ON  2
uu_3  -2.158953e-02                1 1 ON  3
uu_4  -6.678967e-02                1 1 ON  4
uu_5  -1.013889e-01                1 1 ON  5
uu_6  -1.282100e-01                1 1 ON  6
uu_7  -1.411330e-01                1 1 ON  7
uu_8  -1.329454e-01                1 1 ON  8
uu_9  -1.044388e-01                1 1 ON  9
ud_0  4.450092e-01                 1 1 ON  10
ud_1  1.806478e-01                 1 1 ON  11
ud_2  6.296803e-02                 1 1 ON  12
ud_3  -6.566458e-03                1 1 ON  13
ud_4  -6.416706e-02                1 1 ON  14
ud_5  -1.067172e-01                1 1 ON  15
ud_6  -1.346759e-01                1 1 ON  16
ud_7  -1.516904e-01                1 1 ON  17
ud_8  -1.522521e-01                1 1 ON  18
ud_9  -1.426548e-01                1 1 ON  19
eO_0  -7.589093e-01                1 1 ON  20
eO_1  -4.403678e-01                1 1 ON  21
eO_2  -2.241366e-02                1 1 ON  22
eO_3  2.979711e-01                 1 1 ON  23
eO_4  5.251940e-01                 1 1 ON  24
eO_5  4.870858e-01                 1 1 ON  25
eO_6  2.597077e-01                 1 1 ON  26
eO_7  -4.095301e-02                1 1 ON  27
eO_8  -2.206628e-01                1 1 ON  28
eO_9  -8.545400e-02                1 1 ON  29
eH1_0 -2.419382e-01                1 1 ON  30
eH1_1 -1.442568e-01                1 1 ON  31
eH1_2 -9.910582e-02                1 1 ON  32
eH1_3 -4.523340e-02                1 1 ON  33
eH1_4 2.968541e-03                 1 1 ON  34
eH1_5 3.778037e-02                 1 1 ON  35
eH1_6 9.686474e-02                 1 1 ON  36
eH1_7 1.538855e-01                 1 1 ON  37
eH1_8 1.763665e-01                 1 1 ON  38
eH1_9 6.671499e-02                 1 1 ON  39
eH2_0 -2.398939e-01                1 1 ON  40
eH2_1 -1.420753e-01                1 1 ON  41
eH2_2 -9.679402e-02                1 1 ON  42
eH2_3 -4.307545e-02                1 1 ON  43
eH2_4 5.157522e-03                 1 1 ON  44
eH2_5 3.983089e-02                 1 1 ON  45
eH2_6 9.953899e-02                 1 1 ON  46
eH2_7 1.555646e-01                 1 1 ON  47
eH2_8 1.822010e-01                 1 1 ON  48
eH2_9 5.616674e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8823
    reference variance = 0.372178
====================================================
  Execution time = 2.2382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4269e-01
  Total weights = 2.0000e+06
  Execution time = 1.8818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342346695079
                                         uncertainty =       0.010755856139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342346695079
                                         uncertainty =       0.010755856139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413687585
  error estimate for blocks of size 2^( 2) =       0.000426501807
  error estimate for blocks of size 2^( 3) =       0.000439673170
  error estimate for blocks of size 2^( 4) =       0.000452238817
  error estimate for blocks of size 2^( 5) =       0.000463082646
  error estimate for blocks of size 2^( 6) =       0.000472399935
  error estimate for blocks of size 2^( 7) =       0.000477621392

      target function =                  N/A
              le_mean =     -16.906609654684
             les_mean =     286.175724680671
             stat err =       0.000466335698
             autocorr =       1.270727263275
              std dev =       0.585042593280
             le_variance =       0.342274835952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343477375754
                                         uncertainty =       0.010761351682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343477375754
                                         uncertainty =       0.010761351682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414369931
  error estimate for blocks of size 2^( 2) =       0.000427113120
  error estimate for blocks of size 2^( 3) =       0.000440203772
  error estimate for blocks of size 2^( 4) =       0.000452702103
  error estimate for blocks of size 2^( 5) =       0.000463494653
  error estimate for blocks of size 2^( 6) =       0.000472792808
  error estimate for blocks of size 2^( 7) =       0.000477995042

      target function =                  N/A
              le_mean =     -16.906621967024
             les_mean =     286.177271042798
             stat err =       0.000466746152
             autocorr =       1.268776208742
              std dev =       0.586007575587
             le_variance =       0.343404878645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343197562166
                                         uncertainty =       0.010751563727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343197562166
                                         uncertainty =       0.010751563727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414201160
  error estimate for blocks of size 2^( 2) =       0.000426957319
  error estimate for blocks of size 2^( 3) =       0.000440064295
  error estimate for blocks of size 2^( 4) =       0.000452573444
  error estimate for blocks of size 2^( 5) =       0.000463374361
  error estimate for blocks of size 2^( 6) =       0.000472680145
  error estimate for blocks of size 2^( 7) =       0.000477885560

      target function =                  N/A
              le_mean =     -16.906617370074
             les_mean =     286.176835927974
             stat err =       0.000466628377
             autocorr =       1.269169631110
              std dev =       0.585768897647
             le_variance =       0.343125201451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342458385061
                                         uncertainty =       0.010754483673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342458385061
                                         uncertainty =       0.010754483673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413755031
  error estimate for blocks of size 2^( 2) =       0.000426560136
  error estimate for blocks of size 2^( 3) =       0.000439721657
  error estimate for blocks of size 2^( 4) =       0.000452278506
  error estimate for blocks of size 2^( 5) =       0.000463115691
  error estimate for blocks of size 2^( 6) =       0.000472431512
  error estimate for blocks of size 2^( 7) =       0.000477650460

      target function =                  N/A
              le_mean =     -16.906609461888
             les_mean =     286.175829776597
             stat err =       0.000466369042
             autocorr =       1.270494688931
              std dev =       0.585137976042
             le_variance =       0.342386451006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906609654684        initial
     2.5000e-01     2.5000e+00             1.8580e-03       -16.906621967024  <--
     1.0000e+00     1.0000e+01             6.5652e-04       -16.906617370074
     4.0000e+00     4.0000e+01             1.8038e-04       -16.906609461888

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.1894e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.090522e-01 1 1  ON 0
 uu_1                 1.423023e-01 1 1  ON 1
 uu_2                 4.099685e-02 1 1  ON 2
 uu_3                -2.169831e-02 1 1  ON 3
 uu_4                -6.671057e-02 1 1  ON 4
 uu_5                -1.014645e-01 1 1  ON 5
 uu_6                -1.282533e-01 1 1  ON 6
 uu_7                -1.410024e-01 1 1  ON 7
 uu_8                -1.328684e-01 1 1  ON 8
 uu_9                -1.046753e-01 1 1  ON 9
 ud_0                 4.462107e-01 1 1  ON 10
 ud_1                 1.813864e-01 1 1  ON 11
 ud_2                 6.281264e-02 1 1  ON 12
 ud_3                -7.133276e-03 1 1  ON 13
 ud_4                -6.437292e-02 1 1  ON 14
 ud_5                -1.068225e-01 1 1  ON 15
 ud_6                -1.349707e-01 1 1  ON 16
 ud_7                -1.518611e-01 1 1  ON 17
 ud_8                -1.524030e-01 1 1  ON 18
 ud_9                -1.427590e-01 1 1  ON 19
 eO_0                -7.595217e-01 1 1  ON 20
 eO_1                -4.402450e-01 1 1  ON 21
 eO_2                -2.206983e-02 1 1  ON 22
 eO_3                 2.982719e-01 1 1  ON 23
 eO_4                 5.252945e-01 1 1  ON 24
 eO_5                 4.873795e-01 1 1  ON 25
 eO_6                 2.597891e-01 1 1  ON 26
 eO_7                -4.088811e-02 1 1  ON 27
 eO_8                -2.208776e-01 1 1  ON 28
 eO_9                -8.584941e-02 1 1  ON 29
eH1_0                -2.430897e-01 1 1  ON 30
eH1_1                -1.446108e-01 1 1  ON 31
eH1_2                -9.888190e-02 1 1  ON 32
eH1_3                -4.490173e-02 1 1  ON 33
eH1_4                 3.141125e-03 1 1  ON 34
eH1_5                 3.790482e-02 1 1  ON 35
eH1_6                 9.651361e-02 1 1  ON 36
eH1_7                 1.541222e-01 1 1  ON 37
eH1_8                 1.767849e-01 1 1  ON 38
eH1_9                 6.712787e-02 1 1  ON 39
eH2_0                -2.407675e-01 1 1  ON 40
eH2_1                -1.425145e-01 1 1  ON 41
eH2_2                -9.667865e-02 1 1  ON 42
eH2_3                -4.291927e-02 1 1  ON 43
eH2_4                 5.231668e-03 1 1  ON 44
eH2_5                 3.991106e-02 1 1  ON 45
eH2_6                 9.959982e-02 1 1  ON 46
eH2_7                 1.553937e-01 1 1  ON 47
eH2_8                 1.824758e-01 1 1  ON 48
eH2_9                 5.682178e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6870e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9258
    reference variance = 0.171982
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012241412
                                         uncertainty =       0.004077988752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012241412
                                         uncertainty =       0.004077988752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411096064
  error estimate for blocks of size 2^( 2) =       0.000423920657
  error estimate for blocks of size 2^( 3) =       0.000437367567
  error estimate for blocks of size 2^( 4) =       0.000449240567
  error estimate for blocks of size 2^( 5) =       0.000459669615
  error estimate for blocks of size 2^( 6) =       0.000468203418
  error estimate for blocks of size 2^( 7) =       0.000476250032

      target function =                  N/A
              le_mean =     -16.906804087636
             les_mean =     286.178024236071
             stat err =       0.000463340908
             autocorr =       1.270324439290
              std dev =       0.581377628874
             le_variance =       0.337999947355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680408764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906804087636       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906809546010       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906817741985       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906822578151       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906823201346       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906825401263       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906824957130       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906825869192       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906826828370       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906827599028       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906827405912       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906826995174       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906827272614       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906827060339       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.112469e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906804087636       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807236706       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906812733765       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906814968342       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906815007309       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906815353842       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906815149184       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906815194100       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906815554006       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906815581055       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906815689273       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.223604e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906804087636       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906805257293       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807593421       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906808291661       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906808443994       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906808540748       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906808415230       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906808318358       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906808402020       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.216693e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032289 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5901e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.091633e-01 1 1  ON 0
 uu_1                 1.423614e-01 1 1  ON 1
 uu_2                 4.096743e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660615e-02 1 1  ON 4
 uu_5                -1.014615e-01 1 1  ON 5
 uu_6                -1.283799e-01 1 1  ON 6
 uu_7                -1.412785e-01 1 1  ON 7
 uu_8                -1.332540e-01 1 1  ON 8
 uu_9                -1.049618e-01 1 1  ON 9
 ud_0                 4.474343e-01 1 1  ON 10
 ud_1                 1.822223e-01 1 1  ON 11
 ud_2                 6.293667e-02 1 1  ON 12
 ud_3                -7.377896e-03 1 1  ON 13
 ud_4                -6.473777e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349470e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529347e-01 1 1  ON 18
 ud_9                -1.433345e-01 1 1  ON 19
 eO_0                -7.599094e-01 1 1  ON 20
 eO_1                -4.401080e-01 1 1  ON 21
 eO_2                -2.176621e-02 1 1  ON 22
 eO_3                 2.985368e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877352e-01 1 1  ON 25
 eO_6                 2.599343e-01 1 1  ON 26
 eO_7                -4.075154e-02 1 1  ON 27
 eO_8                -2.213036e-01 1 1  ON 28
 eO_9                -8.635930e-02 1 1  ON 29
eH1_0                -2.442202e-01 1 1  ON 30
eH1_1                -1.451571e-01 1 1  ON 31
eH1_2                -9.867238e-02 1 1  ON 32
eH1_3                -4.492842e-02 1 1  ON 33
eH1_4                 3.212256e-03 1 1  ON 34
eH1_5                 3.812739e-02 1 1  ON 35
eH1_6                 9.664012e-02 1 1  ON 36
eH1_7                 1.541402e-01 1 1  ON 37
eH1_8                 1.770965e-01 1 1  ON 38
eH1_9                 6.777554e-02 1 1  ON 39
eH2_0                -2.418881e-01 1 1  ON 40
eH2_1                -1.428362e-01 1 1  ON 41
eH2_2                -9.657255e-02 1 1  ON 42
eH2_3                -4.255221e-02 1 1  ON 43
eH2_4                 5.488067e-03 1 1  ON 44
eH2_5                 4.023580e-02 1 1  ON 45
eH2_6                 9.950155e-02 1 1  ON 46
eH2_7                 1.552628e-01 1 1  ON 47
eH2_8                 1.826518e-01 1 1  ON 48
eH2_9                 5.728421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.912
    reference variance = 0.318461
====================================================
  Execution time = 1.9927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3648e-01
  Total weights = 2.0000e+06
  Execution time = 1.8710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335818373423
                                         uncertainty =       0.003187578219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335818373423
                                         uncertainty =       0.003187578219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409789697
  error estimate for blocks of size 2^( 2) =       0.000422378491
  error estimate for blocks of size 2^( 3) =       0.000435523013
  error estimate for blocks of size 2^( 4) =       0.000447917620
  error estimate for blocks of size 2^( 5) =       0.000459030016
  error estimate for blocks of size 2^( 6) =       0.000464699188
  error estimate for blocks of size 2^( 7) =       0.000469542402

      target function =                  N/A
              le_mean =     -16.906336209908
             les_mean =     286.160059066568
             stat err =       0.000460297307
             autocorr =       1.261696204129
              std dev =       0.579530147672
             le_variance =       0.335855192061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336908839224
                                         uncertainty =       0.003194808120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336908839224
                                         uncertainty =       0.003194808120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410454431
  error estimate for blocks of size 2^( 2) =       0.000422984344
  error estimate for blocks of size 2^( 3) =       0.000436062635
  error estimate for blocks of size 2^( 4) =       0.000448402342
  error estimate for blocks of size 2^( 5) =       0.000459489536
  error estimate for blocks of size 2^( 6) =       0.000465155196
  error estimate for blocks of size 2^( 7) =       0.000469981989

      target function =                  N/A
              le_mean =     -16.906336592954
             les_mean =     286.161162506008
             stat err =       0.000460757266
             autocorr =       1.260127495107
              std dev =       0.580470223383
             le_variance =       0.336945680234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337101453177
                                         uncertainty =       0.003196265915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337101453177
                                         uncertainty =       0.003196265915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571746
  error estimate for blocks of size 2^( 2) =       0.000423096931
  error estimate for blocks of size 2^( 3) =       0.000436170615
  error estimate for blocks of size 2^( 4) =       0.000448510369
  error estimate for blocks of size 2^( 5) =       0.000459600754
  error estimate for blocks of size 2^( 6) =       0.000465266399
  error estimate for blocks of size 2^( 7) =       0.000470082508

      target function =                  N/A
              le_mean =     -16.906340771817
             les_mean =     286.161496441354
             stat err =       0.000460865008
             autocorr =       1.259996532746
              std dev =       0.580636131432
             le_variance =       0.337138317125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336069039159
                                         uncertainty =       0.003189384003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336069039159
                                         uncertainty =       0.003189384003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409942593
  error estimate for blocks of size 2^( 2) =       0.000422517658
  error estimate for blocks of size 2^( 3) =       0.000435647075
  error estimate for blocks of size 2^( 4) =       0.000448030382
  error estimate for blocks of size 2^( 5) =       0.000459138288
  error estimate for blocks of size 2^( 6) =       0.000464806568
  error estimate for blocks of size 2^( 7) =       0.000469642454

      target function =                  N/A
              le_mean =     -16.906334941202
             les_mean =     286.160266835190
             stat err =       0.000460404423
             autocorr =       1.261342084655
              std dev =       0.579746374842
             le_variance =       0.336105859142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906336209908        initial
     6.2500e-02     6.2500e-01             3.1125e-03       -16.906336592954
     2.5000e-01     2.5000e+00             1.2236e-03       -16.906340771817  <--
     1.0000e+00     1.0000e+01             4.2167e-04       -16.906334941202

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9424e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.091633e-01 1 1  ON 0
 uu_1                 1.423614e-01 1 1  ON 1
 uu_2                 4.096743e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660615e-02 1 1  ON 4
 uu_5                -1.014615e-01 1 1  ON 5
 uu_6                -1.283799e-01 1 1  ON 6
 uu_7                -1.412785e-01 1 1  ON 7
 uu_8                -1.332540e-01 1 1  ON 8
 uu_9                -1.049618e-01 1 1  ON 9
 ud_0                 4.474343e-01 1 1  ON 10
 ud_1                 1.822223e-01 1 1  ON 11
 ud_2                 6.293667e-02 1 1  ON 12
 ud_3                -7.377896e-03 1 1  ON 13
 ud_4                -6.473777e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349470e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529347e-01 1 1  ON 18
 ud_9                -1.433345e-01 1 1  ON 19
 eO_0                -7.599094e-01 1 1  ON 20
 eO_1                -4.401080e-01 1 1  ON 21
 eO_2                -2.176621e-02 1 1  ON 22
 eO_3                 2.985368e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877352e-01 1 1  ON 25
 eO_6                 2.599343e-01 1 1  ON 26
 eO_7                -4.075154e-02 1 1  ON 27
 eO_8                -2.213036e-01 1 1  ON 28
 eO_9                -8.635930e-02 1 1  ON 29
eH1_0                -2.442202e-01 1 1  ON 30
eH1_1                -1.451571e-01 1 1  ON 31
eH1_2                -9.867238e-02 1 1  ON 32
eH1_3                -4.492842e-02 1 1  ON 33
eH1_4                 3.212256e-03 1 1  ON 34
eH1_5                 3.812739e-02 1 1  ON 35
eH1_6                 9.664012e-02 1 1  ON 36
eH1_7                 1.541402e-01 1 1  ON 37
eH1_8                 1.770965e-01 1 1  ON 38
eH1_9                 6.777554e-02 1 1  ON 39
eH2_0                -2.418881e-01 1 1  ON 40
eH2_1                -1.428362e-01 1 1  ON 41
eH2_2                -9.657255e-02 1 1  ON 42
eH2_3                -4.255221e-02 1 1  ON 43
eH2_4                 5.488067e-03 1 1  ON 44
eH2_5                 4.023580e-02 1 1  ON 45
eH2_6                 9.950155e-02 1 1  ON 46
eH2_7                 1.552628e-01 1 1  ON 47
eH2_8                 1.826518e-01 1 1  ON 48
eH2_9                 5.728421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5332e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9152
    reference variance = 0.253531
====================================================
  Execution time = 2.0199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338235120344
                                         uncertainty =       0.003258178967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338235120344
                                         uncertainty =       0.003258178967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411211612
  error estimate for blocks of size 2^( 2) =       0.000424130042
  error estimate for blocks of size 2^( 3) =       0.000436979691
  error estimate for blocks of size 2^( 4) =       0.000449738918
  error estimate for blocks of size 2^( 5) =       0.000460280564
  error estimate for blocks of size 2^( 6) =       0.000469385372
  error estimate for blocks of size 2^( 7) =       0.000474543480

      target function =                  N/A
              le_mean =     -16.906409337620
             les_mean =     286.164866501177
             stat err =       0.000463487083
             autocorr =       1.270411837347
              std dev =       0.581541038194
             le_variance =       0.338189979104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640933762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409337620       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410776139       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413621133       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416384001       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414701796       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906418538634       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906417612750       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906416135902       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906416736605       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906418292798       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906417967737       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906418714559       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906418743785       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.281482e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409337620       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410156871       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411933835       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906412794589       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906412475033       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413683702       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413286985       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906412395320       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906412852519       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906413078146       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.154577e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409337620       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409638598       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410368306       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410513907       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410584011       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410786509       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410594364       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410485046       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.341939e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5758e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093258e-01 1 1  ON 0
 uu_1                 1.426311e-01 1 1  ON 1
 uu_2                 4.097714e-02 1 1  ON 2
 uu_3                -2.136276e-02 1 1  ON 3
 uu_4                -6.677213e-02 1 1  ON 4
 uu_5                -1.014182e-01 1 1  ON 5
 uu_6                -1.286954e-01 1 1  ON 6
 uu_7                -1.417286e-01 1 1  ON 7
 uu_8                -1.334978e-01 1 1  ON 8
 uu_9                -1.050170e-01 1 1  ON 9
 ud_0                 4.477310e-01 1 1  ON 10
 ud_1                 1.825559e-01 1 1  ON 11
 ud_2                 6.305378e-02 1 1  ON 12
 ud_3                -7.610819e-03 1 1  ON 13
 ud_4                -6.479151e-02 1 1  ON 14
 ud_5                -1.067873e-01 1 1  ON 15
 ud_6                -1.349303e-01 1 1  ON 16
 ud_7                -1.519693e-01 1 1  ON 17
 ud_8                -1.531775e-01 1 1  ON 18
 ud_9                -1.433641e-01 1 1  ON 19
 eO_0                -7.603349e-01 1 1  ON 20
 eO_1                -4.401020e-01 1 1  ON 21
 eO_2                -2.138674e-02 1 1  ON 22
 eO_3                 2.989928e-01 1 1  ON 23
 eO_4                 5.255104e-01 1 1  ON 24
 eO_5                 4.880319e-01 1 1  ON 25
 eO_6                 2.601269e-01 1 1  ON 26
 eO_7                -4.081106e-02 1 1  ON 27
 eO_8                -2.216893e-01 1 1  ON 28
 eO_9                -8.686033e-02 1 1  ON 29
eH1_0                -2.450344e-01 1 1  ON 30
eH1_1                -1.453176e-01 1 1  ON 31
eH1_2                -9.891742e-02 1 1  ON 32
eH1_3                -4.496800e-02 1 1  ON 33
eH1_4                 3.044667e-03 1 1  ON 34
eH1_5                 3.782338e-02 1 1  ON 35
eH1_6                 9.659656e-02 1 1  ON 36
eH1_7                 1.544236e-01 1 1  ON 37
eH1_8                 1.776445e-01 1 1  ON 38
eH1_9                 6.859100e-02 1 1  ON 39
eH2_0                -2.423712e-01 1 1  ON 40
eH2_1                -1.430501e-01 1 1  ON 41
eH2_2                -9.664964e-02 1 1  ON 42
eH2_3                -4.250526e-02 1 1  ON 43
eH2_4                 5.702194e-03 1 1  ON 44
eH2_5                 4.012919e-02 1 1  ON 45
eH2_6                 9.938494e-02 1 1  ON 46
eH2_7                 1.552317e-01 1 1  ON 47
eH2_8                 1.827189e-01 1 1  ON 48
eH2_9                 5.795596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.238139
====================================================
  Execution time = 1.9905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4832e-01
  Total weights = 2.0000e+06
  Execution time = 1.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348194103191
                                         uncertainty =       0.005876738087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348194103191
                                         uncertainty =       0.005876738087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417206545
  error estimate for blocks of size 2^( 2) =       0.000430209483
  error estimate for blocks of size 2^( 3) =       0.000443806257
  error estimate for blocks of size 2^( 4) =       0.000456338205
  error estimate for blocks of size 2^( 5) =       0.000467438823
  error estimate for blocks of size 2^( 6) =       0.000476113243
  error estimate for blocks of size 2^( 7) =       0.000480444893

      target function =                  N/A
              le_mean =     -16.906505168320
             les_mean =     286.178039434140
             stat err =       0.000470083791
             autocorr =       1.269545669303
              std dev =       0.590019153741
             le_variance =       0.348122601782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348684866284
                                         uncertainty =       0.005887474488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348684866284
                                         uncertainty =       0.005887474488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417500403
  error estimate for blocks of size 2^( 2) =       0.000430482550
  error estimate for blocks of size 2^( 3) =       0.000444048932
  error estimate for blocks of size 2^( 4) =       0.000456557752
  error estimate for blocks of size 2^( 5) =       0.000467652962
  error estimate for blocks of size 2^( 6) =       0.000476317712
  error estimate for blocks of size 2^( 7) =       0.000480636214

      target function =                  N/A
              le_mean =     -16.906503633858
             les_mean =     286.178478121167
             stat err =       0.000470291160
             autocorr =       1.268877895109
              std dev =       0.590434732896
             le_variance =       0.348613173810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348589741053
                                         uncertainty =       0.005886815716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348589741053
                                         uncertainty =       0.005886815716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417443473
  error estimate for blocks of size 2^( 2) =       0.000430427595
  error estimate for blocks of size 2^( 3) =       0.000443996866
  error estimate for blocks of size 2^( 4) =       0.000456510474
  error estimate for blocks of size 2^( 5) =       0.000467610276
  error estimate for blocks of size 2^( 6) =       0.000476280317
  error estimate for blocks of size 2^( 7) =       0.000480594800

      target function =                  N/A
              le_mean =     -16.906503484707
             les_mean =     286.178378010678
             stat err =       0.000470248967
             autocorr =       1.268996281814
              std dev =       0.590354221232
             le_variance =       0.348518106527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348236209046
                                         uncertainty =       0.005877913657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348236209046
                                         uncertainty =       0.005877913657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417231771
  error estimate for blocks of size 2^( 2) =       0.000430231846
  error estimate for blocks of size 2^( 3) =       0.000443824238
  error estimate for blocks of size 2^( 4) =       0.000456353713
  error estimate for blocks of size 2^( 5) =       0.000467455012
  error estimate for blocks of size 2^( 6) =       0.000476129391
  error estimate for blocks of size 2^( 7) =       0.000480458249

      target function =                  N/A
              le_mean =     -16.906504387211
             les_mean =     286.178055122676
             stat err =       0.000470099091
             autocorr =       1.269474787822
              std dev =       0.590054829638
             le_variance =       0.348164701979


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906505168320        initial  <--
     6.2500e-02     6.2500e-01             3.2815e-03       -16.906503633858
     2.5000e-01     2.5000e+00             8.1546e-04       -16.906503484707
     1.0000e+00     1.0000e+01             2.3419e-04       -16.906504387211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3959
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.091633e-01 1 1  ON 0
 uu_1                 1.423614e-01 1 1  ON 1
 uu_2                 4.096743e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660615e-02 1 1  ON 4
 uu_5                -1.014615e-01 1 1  ON 5
 uu_6                -1.283799e-01 1 1  ON 6
 uu_7                -1.412785e-01 1 1  ON 7
 uu_8                -1.332540e-01 1 1  ON 8
 uu_9                -1.049618e-01 1 1  ON 9
 ud_0                 4.474343e-01 1 1  ON 10
 ud_1                 1.822223e-01 1 1  ON 11
 ud_2                 6.293667e-02 1 1  ON 12
 ud_3                -7.377896e-03 1 1  ON 13
 ud_4                -6.473777e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349470e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529347e-01 1 1  ON 18
 ud_9                -1.433345e-01 1 1  ON 19
 eO_0                -7.599094e-01 1 1  ON 20
 eO_1                -4.401080e-01 1 1  ON 21
 eO_2                -2.176621e-02 1 1  ON 22
 eO_3                 2.985368e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877352e-01 1 1  ON 25
 eO_6                 2.599343e-01 1 1  ON 26
 eO_7                -4.075154e-02 1 1  ON 27
 eO_8                -2.213036e-01 1 1  ON 28
 eO_9                -8.635930e-02 1 1  ON 29
eH1_0                -2.442202e-01 1 1  ON 30
eH1_1                -1.451571e-01 1 1  ON 31
eH1_2                -9.867238e-02 1 1  ON 32
eH1_3                -4.492842e-02 1 1  ON 33
eH1_4                 3.212256e-03 1 1  ON 34
eH1_5                 3.812739e-02 1 1  ON 35
eH1_6                 9.664012e-02 1 1  ON 36
eH1_7                 1.541402e-01 1 1  ON 37
eH1_8                 1.770965e-01 1 1  ON 38
eH1_9                 6.777554e-02 1 1  ON 39
eH2_0                -2.418881e-01 1 1  ON 40
eH2_1                -1.428362e-01 1 1  ON 41
eH2_2                -9.657255e-02 1 1  ON 42
eH2_3                -4.255221e-02 1 1  ON 43
eH2_4                 5.488067e-03 1 1  ON 44
eH2_5                 4.023580e-02 1 1  ON 45
eH2_6                 9.950155e-02 1 1  ON 46
eH2_7                 1.552628e-01 1 1  ON 47
eH2_8                 1.826518e-01 1 1  ON 48
eH2_9                 5.728421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9237
    reference variance = 0.296128
====================================================
  Execution time = 2.0343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3537e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335303524954
                                         uncertainty =       0.003060027329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335303524954
                                         uncertainty =       0.003060027329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409496366
  error estimate for blocks of size 2^( 2) =       0.000422270925
  error estimate for blocks of size 2^( 3) =       0.000434968306
  error estimate for blocks of size 2^( 4) =       0.000447277059
  error estimate for blocks of size 2^( 5) =       0.000458413762
  error estimate for blocks of size 2^( 6) =       0.000467740613
  error estimate for blocks of size 2^( 7) =       0.000472082441

      target function =                  N/A
              le_mean =     -16.906116080654
             les_mean =     286.152135313097
             stat err =       0.000461378469
             autocorr =       1.269446906788
              std dev =       0.579115315152
             le_variance =       0.335374548243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611608065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116080654       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906117772390       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906119194944       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906120087673       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906119671893       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906119544548       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906119700034       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906119579302       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906119679556       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.720732e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116080654       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116599042       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116944047       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906117279012       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906117345639       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906117158191       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906117167617       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906117184813       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906117177045       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.220391e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116080654       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116218000       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116303766       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116395742       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116429041       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116376311       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116372984       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116377465       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.075598e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5910e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091833e-01 1 1  ON 0
 uu_1                 1.424138e-01 1 1  ON 1
 uu_2                 4.097042e-02 1 1  ON 2
 uu_3                -2.138756e-02 1 1  ON 3
 uu_4                -6.661449e-02 1 1  ON 4
 uu_5                -1.014481e-01 1 1  ON 5
 uu_6                -1.284032e-01 1 1  ON 6
 uu_7                -1.413345e-01 1 1  ON 7
 uu_8                -1.332913e-01 1 1  ON 8
 uu_9                -1.049814e-01 1 1  ON 9
 ud_0                 4.474864e-01 1 1  ON 10
 ud_1                 1.822651e-01 1 1  ON 11
 ud_2                 6.295146e-02 1 1  ON 12
 ud_3                -7.456347e-03 1 1  ON 13
 ud_4                -6.473751e-02 1 1  ON 14
 ud_5                -1.069150e-01 1 1  ON 15
 ud_6                -1.349700e-01 1 1  ON 16
 ud_7                -1.519798e-01 1 1  ON 17
 ud_8                -1.529323e-01 1 1  ON 18
 ud_9                -1.433242e-01 1 1  ON 19
 eO_0                -7.599774e-01 1 1  ON 20
 eO_1                -4.400781e-01 1 1  ON 21
 eO_2                -2.173965e-02 1 1  ON 22
 eO_3                 2.985738e-01 1 1  ON 23
 eO_4                 5.254062e-01 1 1  ON 24
 eO_5                 4.877390e-01 1 1  ON 25
 eO_6                 2.599344e-01 1 1  ON 26
 eO_7                -4.072600e-02 1 1  ON 27
 eO_8                -2.213271e-01 1 1  ON 28
 eO_9                -8.641451e-02 1 1  ON 29
eH1_0                -2.443153e-01 1 1  ON 30
eH1_1                -1.452131e-01 1 1  ON 31
eH1_2                -9.868310e-02 1 1  ON 32
eH1_3                -4.489590e-02 1 1  ON 33
eH1_4                 3.240288e-03 1 1  ON 34
eH1_5                 3.815538e-02 1 1  ON 35
eH1_6                 9.663002e-02 1 1  ON 36
eH1_7                 1.541230e-01 1 1  ON 37
eH1_8                 1.771203e-01 1 1  ON 38
eH1_9                 6.785423e-02 1 1  ON 39
eH2_0                -2.420101e-01 1 1  ON 40
eH2_1                -1.429243e-01 1 1  ON 41
eH2_2                -9.659271e-02 1 1  ON 42
eH2_3                -4.255603e-02 1 1  ON 43
eH2_4                 5.549050e-03 1 1  ON 44
eH2_5                 4.024410e-02 1 1  ON 45
eH2_6                 9.948960e-02 1 1  ON 46
eH2_7                 1.552661e-01 1 1  ON 47
eH2_8                 1.827049e-01 1 1  ON 48
eH2_9                 5.738121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9376
    reference variance = 0.333202
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.0000e+06
  Execution time = 1.8709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335499287200
                                         uncertainty =       0.003539009356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335499287200
                                         uncertainty =       0.003539009356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409539304
  error estimate for blocks of size 2^( 2) =       0.000422399935
  error estimate for blocks of size 2^( 3) =       0.000435599580
  error estimate for blocks of size 2^( 4) =       0.000447387620
  error estimate for blocks of size 2^( 5) =       0.000457857769
  error estimate for blocks of size 2^( 6) =       0.000464157059
  error estimate for blocks of size 2^( 7) =       0.000468609726

      target function =                  N/A
              le_mean =     -16.905375885092
             les_mean =     286.127178531385
             stat err =       0.000459503044
             autocorr =       1.258883696756
              std dev =       0.579176037893
             le_variance =       0.335444882869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335646205378
                                         uncertainty =       0.003540708355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335646205378
                                         uncertainty =       0.003540708355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409628922
  error estimate for blocks of size 2^( 2) =       0.000422482009
  error estimate for blocks of size 2^( 3) =       0.000435671050
  error estimate for blocks of size 2^( 4) =       0.000447452352
  error estimate for blocks of size 2^( 5) =       0.000457917674
  error estimate for blocks of size 2^( 6) =       0.000464216693
  error estimate for blocks of size 2^( 7) =       0.000468660221

      target function =                  N/A
              le_mean =     -16.905375193175
             les_mean =     286.127301961231
             stat err =       0.000459561735
             autocorr =       1.258654392419
              std dev =       0.579302776635
             le_variance =       0.335591707017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335574283692
                                         uncertainty =       0.003540081240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335574283692
                                         uncertainty =       0.003540081240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409585045
  error estimate for blocks of size 2^( 2) =       0.000422441671
  error estimate for blocks of size 2^( 3) =       0.000435635122
  error estimate for blocks of size 2^( 4) =       0.000447419117
  error estimate for blocks of size 2^( 5) =       0.000457886324
  error estimate for blocks of size 2^( 6) =       0.000464185597
  error estimate for blocks of size 2^( 7) =       0.000468633171

      target function =                  N/A
              le_mean =     -16.905375400454
             les_mean =     286.127237080417
             stat err =       0.000459531052
             autocorr =       1.258755976550
              std dev =       0.579240725362
             le_variance =       0.335519817918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335507464522
                                         uncertainty =       0.003539158213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335507464522
                                         uncertainty =       0.003539158213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409544291
  error estimate for blocks of size 2^( 2) =       0.000422404451
  error estimate for blocks of size 2^( 3) =       0.000435603314
  error estimate for blocks of size 2^( 4) =       0.000447390851
  error estimate for blocks of size 2^( 5) =       0.000457860631
  error estimate for blocks of size 2^( 6) =       0.000464159951
  error estimate for blocks of size 2^( 7) =       0.000468612000

      target function =                  N/A
              le_mean =     -16.905375800169
             les_mean =     286.127183829566
             stat err =       0.000459505858
             autocorr =       1.258868460586
              std dev =       0.579183090532
             le_variance =       0.335453052358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905375885092        initial  <--
     6.2500e-01     6.2500e+00             4.7207e-04       -16.905375193175
     2.5000e+00     2.5000e+01             1.2204e-04       -16.905375400454
     1.0000e+01     1.0000e+02             3.0756e-05       -16.905375800169

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6252
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091633e-01 1 1  ON 0
 uu_1                 1.423614e-01 1 1  ON 1
 uu_2                 4.096743e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660615e-02 1 1  ON 4
 uu_5                -1.014615e-01 1 1  ON 5
 uu_6                -1.283799e-01 1 1  ON 6
 uu_7                -1.412785e-01 1 1  ON 7
 uu_8                -1.332540e-01 1 1  ON 8
 uu_9                -1.049618e-01 1 1  ON 9
 ud_0                 4.474343e-01 1 1  ON 10
 ud_1                 1.822223e-01 1 1  ON 11
 ud_2                 6.293667e-02 1 1  ON 12
 ud_3                -7.377896e-03 1 1  ON 13
 ud_4                -6.473777e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349470e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529347e-01 1 1  ON 18
 ud_9                -1.433345e-01 1 1  ON 19
 eO_0                -7.599094e-01 1 1  ON 20
 eO_1                -4.401080e-01 1 1  ON 21
 eO_2                -2.176621e-02 1 1  ON 22
 eO_3                 2.985368e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877352e-01 1 1  ON 25
 eO_6                 2.599343e-01 1 1  ON 26
 eO_7                -4.075154e-02 1 1  ON 27
 eO_8                -2.213036e-01 1 1  ON 28
 eO_9                -8.635930e-02 1 1  ON 29
eH1_0                -2.442202e-01 1 1  ON 30
eH1_1                -1.451571e-01 1 1  ON 31
eH1_2                -9.867238e-02 1 1  ON 32
eH1_3                -4.492842e-02 1 1  ON 33
eH1_4                 3.212256e-03 1 1  ON 34
eH1_5                 3.812739e-02 1 1  ON 35
eH1_6                 9.664012e-02 1 1  ON 36
eH1_7                 1.541402e-01 1 1  ON 37
eH1_8                 1.770965e-01 1 1  ON 38
eH1_9                 6.777554e-02 1 1  ON 39
eH2_0                -2.418881e-01 1 1  ON 40
eH2_1                -1.428362e-01 1 1  ON 41
eH2_2                -9.657255e-02 1 1  ON 42
eH2_3                -4.255221e-02 1 1  ON 43
eH2_4                 5.488067e-03 1 1  ON 44
eH2_5                 4.023580e-02 1 1  ON 45
eH2_6                 9.950155e-02 1 1  ON 46
eH2_7                 1.552628e-01 1 1  ON 47
eH2_8                 1.826518e-01 1 1  ON 48
eH2_9                 5.728421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.339295
====================================================
  Execution time = 2.0318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7920e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379339016630
                                         uncertainty =       0.036703375571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379339016630
                                         uncertainty =       0.036703375571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435431517
  error estimate for blocks of size 2^( 2) =       0.000447482164
  error estimate for blocks of size 2^( 3) =       0.000460652471
  error estimate for blocks of size 2^( 4) =       0.000472322760
  error estimate for blocks of size 2^( 5) =       0.000483670215
  error estimate for blocks of size 2^( 6) =       0.000490296663
  error estimate for blocks of size 2^( 7) =       0.000496187759

      target function =                  N/A
              le_mean =     -16.905766671827
             les_mean =     286.184147785024
             stat err =       0.000485619349
             autocorr =       1.243804843819
              std dev =       0.615793157136
             le_variance =       0.379201212376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576667183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905766671827       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766948299       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905767114422       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905767180935       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905767313197       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905767356768       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905767369587       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905767366824       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.990730e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905766671827       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766742517       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766784265       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766801417       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905766835889       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905766845859       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905766849116       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905766848707       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.019413e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905766671827       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766689600       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766700050       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766704373       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905766713081       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905766715517       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905766716330       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905766716244       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.562509e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5919e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.091609e-01 1 1  ON 0
 uu_1                 1.423641e-01 1 1  ON 1
 uu_2                 4.096538e-02 1 1  ON 2
 uu_3                -2.136746e-02 1 1  ON 3
 uu_4                -6.660774e-02 1 1  ON 4
 uu_5                -1.014563e-01 1 1  ON 5
 uu_6                -1.283901e-01 1 1  ON 6
 uu_7                -1.412852e-01 1 1  ON 7
 uu_8                -1.332522e-01 1 1  ON 8
 uu_9                -1.049565e-01 1 1  ON 9
 ud_0                 4.474394e-01 1 1  ON 10
 ud_1                 1.822255e-01 1 1  ON 11
 ud_2                 6.293473e-02 1 1  ON 12
 ud_3                -7.383711e-03 1 1  ON 13
 ud_4                -6.474451e-02 1 1  ON 14
 ud_5                -1.068975e-01 1 1  ON 15
 ud_6                -1.349478e-01 1 1  ON 16
 ud_7                -1.520050e-01 1 1  ON 17
 ud_8                -1.529328e-01 1 1  ON 18
 ud_9                -1.433305e-01 1 1  ON 19
 eO_0                -7.599162e-01 1 1  ON 20
 eO_1                -4.401041e-01 1 1  ON 21
 eO_2                -2.176263e-02 1 1  ON 22
 eO_3                 2.985376e-01 1 1  ON 23
 eO_4                 5.253724e-01 1 1  ON 24
 eO_5                 4.877367e-01 1 1  ON 25
 eO_6                 2.599333e-01 1 1  ON 26
 eO_7                -4.074940e-02 1 1  ON 27
 eO_8                -2.213044e-01 1 1  ON 28
 eO_9                -8.636252e-02 1 1  ON 29
eH1_0                -2.442291e-01 1 1  ON 30
eH1_1                -1.451623e-01 1 1  ON 31
eH1_2                -9.867762e-02 1 1  ON 32
eH1_3                -4.492511e-02 1 1  ON 33
eH1_4                 3.210027e-03 1 1  ON 34
eH1_5                 3.812360e-02 1 1  ON 35
eH1_6                 9.664370e-02 1 1  ON 36
eH1_7                 1.541428e-01 1 1  ON 37
eH1_8                 1.771029e-01 1 1  ON 38
eH1_9                 6.778391e-02 1 1  ON 39
eH2_0                -2.418965e-01 1 1  ON 40
eH2_1                -1.428411e-01 1 1  ON 41
eH2_2                -9.656933e-02 1 1  ON 42
eH2_3                -4.255758e-02 1 1  ON 43
eH2_4                 5.492151e-03 1 1  ON 44
eH2_5                 4.023369e-02 1 1  ON 45
eH2_6                 9.950020e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9141
    reference variance = 0.230206
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3046e-01
  Total weights = 2.0000e+06
  Execution time = 1.8816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330496041062
                                         uncertainty =       0.002708017482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330496041062
                                         uncertainty =       0.002708017482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406478806
  error estimate for blocks of size 2^( 2) =       0.000418809657
  error estimate for blocks of size 2^( 3) =       0.000431533529
  error estimate for blocks of size 2^( 4) =       0.000443446272
  error estimate for blocks of size 2^( 5) =       0.000454055871
  error estimate for blocks of size 2^( 6) =       0.000462558729
  error estimate for blocks of size 2^( 7) =       0.000465464739

      target function =                  N/A
              le_mean =     -16.906138266264
             les_mean =     286.147960951986
             stat err =       0.000456381403
             autocorr =       1.260608018954
              std dev =       0.574847840017
             le_variance =       0.330450039172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330516310155
                                         uncertainty =       0.002708138980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330516310155
                                         uncertainty =       0.002708138980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406491267
  error estimate for blocks of size 2^( 2) =       0.000418821161
  error estimate for blocks of size 2^( 3) =       0.000431544008
  error estimate for blocks of size 2^( 4) =       0.000443455931
  error estimate for blocks of size 2^( 5) =       0.000454065176
  error estimate for blocks of size 2^( 6) =       0.000462568503
  error estimate for blocks of size 2^( 7) =       0.000465474250

      target function =                  N/A
              le_mean =     -16.906138082211
             les_mean =     286.147974989207
             stat err =       0.000456390965
             autocorr =       1.260583558387
              std dev =       0.574865462231
             le_variance =       0.330470299666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330506307640
                                         uncertainty =       0.002708077367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330506307640
                                         uncertainty =       0.002708077367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406485117
  error estimate for blocks of size 2^( 2) =       0.000418815480
  error estimate for blocks of size 2^( 3) =       0.000431538826
  error estimate for blocks of size 2^( 4) =       0.000443451148
  error estimate for blocks of size 2^( 5) =       0.000454060565
  error estimate for blocks of size 2^( 6) =       0.000462563675
  error estimate for blocks of size 2^( 7) =       0.000465469550

      target function =                  N/A
              le_mean =     -16.906138170077
             les_mean =     286.147967961735
             stat err =       0.000456386234
             autocorr =       1.260595564626
              std dev =       0.574856765841
             le_variance =       0.330460301234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330497327607
                                         uncertainty =       0.002708024933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330497327607
                                         uncertainty =       0.002708024933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406479597
  error estimate for blocks of size 2^( 2) =       0.000418810386
  error estimate for blocks of size 2^( 3) =       0.000431534192
  error estimate for blocks of size 2^( 4) =       0.000443446882
  error estimate for blocks of size 2^( 5) =       0.000454056458
  error estimate for blocks of size 2^( 6) =       0.000462559349
  error estimate for blocks of size 2^( 7) =       0.000465465341

      target function =                  N/A
              le_mean =     -16.906138253942
             les_mean =     286.147961821337
             stat err =       0.000456382007
             autocorr =       1.260606454443
              std dev =       0.574848958549
             le_variance =       0.330451325145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906138266264        initial  <--
     6.2500e+00     6.2500e+01             3.9907e-05       -16.906138082211
     2.5000e+01     2.5000e+02             1.0194e-05       -16.906138170077
     1.0000e+02     1.0000e+03             2.5625e-06       -16.906138253942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5264
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.091633e-01 1 1  ON 0
 uu_1                 1.423614e-01 1 1  ON 1
 uu_2                 4.096743e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660615e-02 1 1  ON 4
 uu_5                -1.014615e-01 1 1  ON 5
 uu_6                -1.283799e-01 1 1  ON 6
 uu_7                -1.412785e-01 1 1  ON 7
 uu_8                -1.332540e-01 1 1  ON 8
 uu_9                -1.049618e-01 1 1  ON 9
 ud_0                 4.474343e-01 1 1  ON 10
 ud_1                 1.822223e-01 1 1  ON 11
 ud_2                 6.293667e-02 1 1  ON 12
 ud_3                -7.377896e-03 1 1  ON 13
 ud_4                -6.473777e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349470e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529347e-01 1 1  ON 18
 ud_9                -1.433345e-01 1 1  ON 19
 eO_0                -7.599094e-01 1 1  ON 20
 eO_1                -4.401080e-01 1 1  ON 21
 eO_2                -2.176621e-02 1 1  ON 22
 eO_3                 2.985368e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877352e-01 1 1  ON 25
 eO_6                 2.599343e-01 1 1  ON 26
 eO_7                -4.075154e-02 1 1  ON 27
 eO_8                -2.213036e-01 1 1  ON 28
 eO_9                -8.635930e-02 1 1  ON 29
eH1_0                -2.442202e-01 1 1  ON 30
eH1_1                -1.451571e-01 1 1  ON 31
eH1_2                -9.867238e-02 1 1  ON 32
eH1_3                -4.492842e-02 1 1  ON 33
eH1_4                 3.212256e-03 1 1  ON 34
eH1_5                 3.812739e-02 1 1  ON 35
eH1_6                 9.664012e-02 1 1  ON 36
eH1_7                 1.541402e-01 1 1  ON 37
eH1_8                 1.770965e-01 1 1  ON 38
eH1_9                 6.777554e-02 1 1  ON 39
eH2_0                -2.418881e-01 1 1  ON 40
eH2_1                -1.428362e-01 1 1  ON 41
eH2_2                -9.657255e-02 1 1  ON 42
eH2_3                -4.255221e-02 1 1  ON 43
eH2_4                 5.488067e-03 1 1  ON 44
eH2_5                 4.023580e-02 1 1  ON 45
eH2_6                 9.950155e-02 1 1  ON 46
eH2_7                 1.552628e-01 1 1  ON 47
eH2_8                 1.826518e-01 1 1  ON 48
eH2_9                 5.728421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5452e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9329
    reference variance = 0.402032
====================================================
  Execution time = 2.0284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333869760021
                                         uncertainty =       0.002782945145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333869760021
                                         uncertainty =       0.002782945145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408529651
  error estimate for blocks of size 2^( 2) =       0.000421101075
  error estimate for blocks of size 2^( 3) =       0.000434289115
  error estimate for blocks of size 2^( 4) =       0.000446350894
  error estimate for blocks of size 2^( 5) =       0.000457792258
  error estimate for blocks of size 2^( 6) =       0.000464379448
  error estimate for blocks of size 2^( 7) =       0.000467456786

      target function =                  N/A
              le_mean =     -16.906415568319
             les_mean =     286.160680153627
             stat err =       0.000458994846
             autocorr =       1.262317060491
              std dev =       0.577748173363
             le_variance =       0.333792951824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641556832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906415568319       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906415569020       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906415558546       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906415563527       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906415576936       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906415580830       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906415582325       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906415581919       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.707866e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906415568319       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906415568495       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906415565863       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906415567120       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906415570462       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906415571448       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906415571811       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906415571708       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.427852e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906415568319       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906415568363       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906415567704       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906415568019       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906415568854       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906415569100       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906415569191       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906415569165       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.570184e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5925e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.091634e-01 1 1  ON 0
 uu_1                 1.423617e-01 1 1  ON 1
 uu_2                 4.096783e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660638e-02 1 1  ON 4
 uu_5                -1.014608e-01 1 1  ON 5
 uu_6                -1.283807e-01 1 1  ON 6
 uu_7                -1.412791e-01 1 1  ON 7
 uu_8                -1.332545e-01 1 1  ON 8
 uu_9                -1.049619e-01 1 1  ON 9
 ud_0                 4.474351e-01 1 1  ON 10
 ud_1                 1.822228e-01 1 1  ON 11
 ud_2                 6.293685e-02 1 1  ON 12
 ud_3                -7.378455e-03 1 1  ON 13
 ud_4                -6.473809e-02 1 1  ON 14
 ud_5                -1.068968e-01 1 1  ON 15
 ud_6                -1.349468e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529347e-01 1 1  ON 18
 ud_9                -1.433348e-01 1 1  ON 19
 eO_0                -7.599097e-01 1 1  ON 20
 eO_1                -4.401078e-01 1 1  ON 21
 eO_2                -2.176586e-02 1 1  ON 22
 eO_3                 2.985371e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877354e-01 1 1  ON 25
 eO_6                 2.599346e-01 1 1  ON 26
 eO_7                -4.075140e-02 1 1  ON 27
 eO_8                -2.213042e-01 1 1  ON 28
 eO_9                -8.635978e-02 1 1  ON 29
eH1_0                -2.442212e-01 1 1  ON 30
eH1_1                -1.451571e-01 1 1  ON 31
eH1_2                -9.867263e-02 1 1  ON 32
eH1_3                -4.492802e-02 1 1  ON 33
eH1_4                 3.212320e-03 1 1  ON 34
eH1_5                 3.812725e-02 1 1  ON 35
eH1_6                 9.664010e-02 1 1  ON 36
eH1_7                 1.541404e-01 1 1  ON 37
eH1_8                 1.770966e-01 1 1  ON 38
eH1_9                 6.777608e-02 1 1  ON 39
eH2_0                -2.418895e-01 1 1  ON 40
eH2_1                -1.428368e-01 1 1  ON 41
eH2_2                -9.657241e-02 1 1  ON 42
eH2_3                -4.255250e-02 1 1  ON 43
eH2_4                 5.488524e-03 1 1  ON 44
eH2_5                 4.023564e-02 1 1  ON 45
eH2_6                 9.950152e-02 1 1  ON 46
eH2_7                 1.552631e-01 1 1  ON 47
eH2_8                 1.826526e-01 1 1  ON 48
eH2_9                 5.728503e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.379878
====================================================
  Execution time = 2.2187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4248e-01
  Total weights = 2.0000e+06
  Execution time = 1.8702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342597846671
                                         uncertainty =       0.007883040855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342597846671
                                         uncertainty =       0.007883040855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413810487
  error estimate for blocks of size 2^( 2) =       0.000426379450
  error estimate for blocks of size 2^( 3) =       0.000439146265
  error estimate for blocks of size 2^( 4) =       0.000451816318
  error estimate for blocks of size 2^( 5) =       0.000462748491
  error estimate for blocks of size 2^( 6) =       0.000470345193
  error estimate for blocks of size 2^( 7) =       0.000474886534

      target function =                  N/A
              le_mean =     -16.906090726529
             les_mean =     286.158381721515
             stat err =       0.000464949134
             autocorr =       1.262431726236
              std dev =       0.585216403664
             le_variance =       0.342478239118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342599242514
                                         uncertainty =       0.007883133082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342599242514
                                         uncertainty =       0.007883133082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413811330
  error estimate for blocks of size 2^( 2) =       0.000426380188
  error estimate for blocks of size 2^( 3) =       0.000439146876
  error estimate for blocks of size 2^( 4) =       0.000451816857
  error estimate for blocks of size 2^( 5) =       0.000462748989
  error estimate for blocks of size 2^( 6) =       0.000470345774
  error estimate for blocks of size 2^( 7) =       0.000474887068

      target function =                  N/A
              le_mean =     -16.906090738304
             les_mean =     286.158383514675
             stat err =       0.000464949672
             autocorr =       1.262429504915
              std dev =       0.585217595557
             le_variance =       0.342479634149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342598543486
                                         uncertainty =       0.007883086968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342598543486
                                         uncertainty =       0.007883086968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413810908
  error estimate for blocks of size 2^( 2) =       0.000426379818
  error estimate for blocks of size 2^( 3) =       0.000439146570
  error estimate for blocks of size 2^( 4) =       0.000451816587
  error estimate for blocks of size 2^( 5) =       0.000462748739
  error estimate for blocks of size 2^( 6) =       0.000470345483
  error estimate for blocks of size 2^( 7) =       0.000474886800

      target function =                  N/A
              le_mean =     -16.906090732393
             les_mean =     286.158382616179
             stat err =       0.000464949402
             autocorr =       1.262430615395
              std dev =       0.585216998666
             le_variance =       0.342478935527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342597933729
                                         uncertainty =       0.007883046619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342597933729
                                         uncertainty =       0.007883046619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413810540
  error estimate for blocks of size 2^( 2) =       0.000426379496
  error estimate for blocks of size 2^( 3) =       0.000439146303
  error estimate for blocks of size 2^( 4) =       0.000451816352
  error estimate for blocks of size 2^( 5) =       0.000462748522
  error estimate for blocks of size 2^( 6) =       0.000470345229
  error estimate for blocks of size 2^( 7) =       0.000474886567

      target function =                  N/A
              le_mean =     -16.906090727260
             les_mean =     286.158381833221
             stat err =       0.000464949168
             autocorr =       1.262431587369
              std dev =       0.585216478002
             le_variance =       0.342478326125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906090726529        initial
     6.2500e+01     6.2500e+02             5.7079e-06       -16.906090738304  <--
     2.5000e+02     2.5000e+03             1.4279e-06       -16.906090732393
     1.0000e+03     1.0000e+04             3.5702e-07       -16.906090727260

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 3.5448e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380124e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9137
    reference variance = 0.150509
====================================================
  Execution time = 2.0456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341459753145
                                         uncertainty =       0.005213443013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341459753145
                                         uncertainty =       0.005213443013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413115382
  error estimate for blocks of size 2^( 2) =       0.000425490318
  error estimate for blocks of size 2^( 3) =       0.000437622107
  error estimate for blocks of size 2^( 4) =       0.000448850138
  error estimate for blocks of size 2^( 5) =       0.000458908649
  error estimate for blocks of size 2^( 6) =       0.000466546681
  error estimate for blocks of size 2^( 7) =       0.000472655110

      target function =                  N/A
              le_mean =     -16.905566937850
             les_mean =     286.139521957574
             stat err =       0.000461740144
             autocorr =       1.249259143046
              std dev =       0.584233376406
             le_variance =       0.341328638107


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556693785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566937850       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567041998       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567163761       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905567133575       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905567104028       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905567098662       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905567112148       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905567102647       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.772046e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566937850       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566964126       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566994776       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566987867       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566980524       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566978742       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566982157       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566979712       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.439287e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566937850       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566944434       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566952110       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566950423       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566948590       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566948118       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566948974       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566948359       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.110336e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6103e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.091650e-01 1 1  ON 0
 uu_1                 1.423646e-01 1 1  ON 1
 uu_2                 4.097011e-02 1 1  ON 2
 uu_3                -2.136644e-02 1 1  ON 3
 uu_4                -6.660700e-02 1 1  ON 4
 uu_5                -1.014580e-01 1 1  ON 5
 uu_6                -1.283831e-01 1 1  ON 6
 uu_7                -1.412838e-01 1 1  ON 7
 uu_8                -1.332596e-01 1 1  ON 8
 uu_9                -1.049639e-01 1 1  ON 9
 ud_0                 4.474420e-01 1 1  ON 10
 ud_1                 1.822280e-01 1 1  ON 11
 ud_2                 6.293758e-02 1 1  ON 12
 ud_3                -7.381470e-03 1 1  ON 13
 ud_4                -6.474025e-02 1 1  ON 14
 ud_5                -1.068956e-01 1 1  ON 15
 ud_6                -1.349456e-01 1 1  ON 16
 ud_7                -1.520036e-01 1 1  ON 17
 ud_8                -1.529380e-01 1 1  ON 18
 ud_9                -1.433390e-01 1 1  ON 19
 eO_0                -7.599117e-01 1 1  ON 20
 eO_1                -4.401068e-01 1 1  ON 21
 eO_2                -2.176355e-02 1 1  ON 22
 eO_3                 2.985411e-01 1 1  ON 23
 eO_4                 5.253720e-01 1 1  ON 24
 eO_5                 4.877378e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.075155e-02 1 1  ON 27
 eO_8                -2.213091e-01 1 1  ON 28
 eO_9                -8.636372e-02 1 1  ON 29
eH1_0                -2.442278e-01 1 1  ON 30
eH1_1                -1.451590e-01 1 1  ON 31
eH1_2                -9.867513e-02 1 1  ON 32
eH1_3                -4.492545e-02 1 1  ON 33
eH1_4                 3.213722e-03 1 1  ON 34
eH1_5                 3.812834e-02 1 1  ON 35
eH1_6                 9.663972e-02 1 1  ON 36
eH1_7                 1.541406e-01 1 1  ON 37
eH1_8                 1.770980e-01 1 1  ON 38
eH1_9                 6.777987e-02 1 1  ON 39
eH2_0                -2.418977e-01 1 1  ON 40
eH2_1                -1.428392e-01 1 1  ON 41
eH2_2                -9.657204e-02 1 1  ON 42
eH2_3                -4.255194e-02 1 1  ON 43
eH2_4                 5.489868e-03 1 1  ON 44
eH2_5                 4.023629e-02 1 1  ON 45
eH2_6                 9.949959e-02 1 1  ON 46
eH2_7                 1.552632e-01 1 1  ON 47
eH2_8                 1.826566e-01 1 1  ON 48
eH2_9                 5.729015e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9478
    reference variance = 0.658234
====================================================
  Execution time = 2.0228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3454e-01
  Total weights = 2.0000e+06
  Execution time = 1.8720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334552071809
                                         uncertainty =       0.003013390201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334552071809
                                         uncertainty =       0.003013390201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985012
  error estimate for blocks of size 2^( 2) =       0.000421487224
  error estimate for blocks of size 2^( 3) =       0.000434931089
  error estimate for blocks of size 2^( 4) =       0.000446834645
  error estimate for blocks of size 2^( 5) =       0.000456767357
  error estimate for blocks of size 2^( 6) =       0.000464834398
  error estimate for blocks of size 2^( 7) =       0.000469949393

      target function =                  N/A
              le_mean =     -16.905182427724
             les_mean =     286.119730227511
             stat err =       0.000459596448
             autocorr =       1.262811539340
              std dev =       0.578392150839
             le_variance =       0.334537480152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334563365073
                                         uncertainty =       0.003013501956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334563365073
                                         uncertainty =       0.003013501956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408991920
  error estimate for blocks of size 2^( 2) =       0.000421493485
  error estimate for blocks of size 2^( 3) =       0.000434936549
  error estimate for blocks of size 2^( 4) =       0.000446839531
  error estimate for blocks of size 2^( 5) =       0.000456771831
  error estimate for blocks of size 2^( 6) =       0.000464839104
  error estimate for blocks of size 2^( 7) =       0.000469954142

      target function =                  N/A
              le_mean =     -16.905182411733
             les_mean =     286.119740987458
             stat err =       0.000459601152
             autocorr =       1.262794730830
              std dev =       0.578401919754
             le_variance =       0.334548780776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334557748063
                                         uncertainty =       0.003013446224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334557748063
                                         uncertainty =       0.003013446224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408988484
  error estimate for blocks of size 2^( 2) =       0.000421490371
  error estimate for blocks of size 2^( 3) =       0.000434933832
  error estimate for blocks of size 2^( 4) =       0.000446837098
  error estimate for blocks of size 2^( 5) =       0.000456769601
  error estimate for blocks of size 2^( 6) =       0.000464836761
  error estimate for blocks of size 2^( 7) =       0.000469951778

      target function =                  N/A
              le_mean =     -16.905182419133
             les_mean =     286.119735617043
             stat err =       0.000459598810
             autocorr =       1.262803075296
              std dev =       0.578397060982
             le_variance =       0.334543160153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334552782119
                                         uncertainty =       0.003013397208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334552782119
                                         uncertainty =       0.003013397208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985447
  error estimate for blocks of size 2^( 2) =       0.000421487617
  error estimate for blocks of size 2^( 3) =       0.000434931433
  error estimate for blocks of size 2^( 4) =       0.000446834952
  error estimate for blocks of size 2^( 5) =       0.000456767637
  error estimate for blocks of size 2^( 6) =       0.000464834694
  error estimate for blocks of size 2^( 7) =       0.000469949691

      target function =                  N/A
              le_mean =     -16.905182426598
             les_mean =     286.119730900207
             stat err =       0.000459596743
             autocorr =       1.262810479252
              std dev =       0.578392765284
             le_variance =       0.334538190933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905182427724        initial  <--
     1.5625e+01     1.5625e+02             1.7720e-05       -16.905182411733
     6.2500e+01     6.2500e+02             4.4393e-06       -16.905182419133
     2.5000e+02     2.5000e+03             1.1103e-06       -16.905182426598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7542
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380124e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0231
    reference variance = 0.231865
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4134e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341082833827
                                         uncertainty =       0.004587920889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341082833827
                                         uncertainty =       0.004587920889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413122072
  error estimate for blocks of size 2^( 2) =       0.000425616453
  error estimate for blocks of size 2^( 3) =       0.000438535296
  error estimate for blocks of size 2^( 4) =       0.000450969869
  error estimate for blocks of size 2^( 5) =       0.000460461315
  error estimate for blocks of size 2^( 6) =       0.000467021231
  error estimate for blocks of size 2^( 7) =       0.000472720874

      target function =                  N/A
              le_mean =     -16.906737338322
             les_mean =     286.179106949874
             stat err =       0.000462793322
             autocorr =       1.254923837539
              std dev =       0.584242837823
             le_variance =       0.341339693548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673733832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906737338322       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906737334936       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737328794       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737328542       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906737330056       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737332016       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906737332558       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737333495       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.724290e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906737338322       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906737337475       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737335938       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737335872       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906737336252       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737336740       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906737336875       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737337111       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.311493e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906737338322       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906737338110       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737337725       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737337709       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906737337804       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737337927       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906737337964       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906737338016       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.077921e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6043e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423627e-01 1 1  ON 1
 uu_2                 4.096901e-02 1 1  ON 2
 uu_3                -2.136678e-02 1 1  ON 3
 uu_4                -6.660712e-02 1 1  ON 4
 uu_5                -1.014584e-01 1 1  ON 5
 uu_6                -1.283835e-01 1 1  ON 6
 uu_7                -1.412813e-01 1 1  ON 7
 uu_8                -1.332562e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474378e-01 1 1  ON 10
 ud_1                 1.822244e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380246e-03 1 1  ON 13
 ud_4                -6.473910e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529350e-01 1 1  ON 18
 ud_9                -1.433358e-01 1 1  ON 19
 eO_0                -7.599110e-01 1 1  ON 20
 eO_1                -4.401069e-01 1 1  ON 21
 eO_2                -2.176476e-02 1 1  ON 22
 eO_3                 2.985384e-01 1 1  ON 23
 eO_4                 5.253719e-01 1 1  ON 24
 eO_5                 4.877362e-01 1 1  ON 25
 eO_6                 2.599352e-01 1 1  ON 26
 eO_7                -4.075102e-02 1 1  ON 27
 eO_8                -2.213061e-01 1 1  ON 28
 eO_9                -8.636142e-02 1 1  ON 29
eH1_0                -2.442246e-01 1 1  ON 30
eH1_1                -1.451575e-01 1 1  ON 31
eH1_2                -9.867356e-02 1 1  ON 32
eH1_3                -4.492652e-02 1 1  ON 33
eH1_4                 3.212634e-03 1 1  ON 34
eH1_5                 3.812679e-02 1 1  ON 35
eH1_6                 9.664010e-02 1 1  ON 36
eH1_7                 1.541408e-01 1 1  ON 37
eH1_8                 1.770970e-01 1 1  ON 38
eH1_9                 6.777796e-02 1 1  ON 39
eH2_0                -2.418942e-01 1 1  ON 40
eH2_1                -1.428389e-01 1 1  ON 41
eH2_2                -9.657198e-02 1 1  ON 42
eH2_3                -4.255336e-02 1 1  ON 43
eH2_4                 5.490133e-03 1 1  ON 44
eH2_5                 4.023524e-02 1 1  ON 45
eH2_6                 9.950140e-02 1 1  ON 46
eH2_7                 1.552638e-01 1 1  ON 47
eH2_8                 1.826549e-01 1 1  ON 48
eH2_9                 5.728775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9188
    reference variance = 0.194097
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7128e-01
  Total weights = 2.0000e+06
  Execution time = 1.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371423160920
                                         uncertainty =       0.035360740056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371423160920
                                         uncertainty =       0.035360740056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430857813
  error estimate for blocks of size 2^( 2) =       0.000443212274
  error estimate for blocks of size 2^( 3) =       0.000454868819
  error estimate for blocks of size 2^( 4) =       0.000465930251
  error estimate for blocks of size 2^( 5) =       0.000476357254
  error estimate for blocks of size 2^( 6) =       0.000484735951
  error estimate for blocks of size 2^( 7) =       0.000490062204

      target function =                  N/A
              le_mean =     -16.906722391918
             les_mean =     286.208538760971
             stat err =       0.000479271415
             autocorr =       1.237357257929
              std dev =       0.609324961915
             le_variance =       0.371276909213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371424025063
                                         uncertainty =       0.035360744997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371424025063
                                         uncertainty =       0.035360744997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430858314
  error estimate for blocks of size 2^( 2) =       0.000443212723
  error estimate for blocks of size 2^( 3) =       0.000454869209
  error estimate for blocks of size 2^( 4) =       0.000465930595
  error estimate for blocks of size 2^( 5) =       0.000476357615
  error estimate for blocks of size 2^( 6) =       0.000484736311
  error estimate for blocks of size 2^( 7) =       0.000490062595

      target function =                  N/A
              le_mean =     -16.906722388096
             les_mean =     286.208539496588
             stat err =       0.000479271779
             autocorr =       1.237356255037
              std dev =       0.609325671605
             le_variance =       0.371277774077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371423593067
                                         uncertainty =       0.035360742454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371423593067
                                         uncertainty =       0.035360742454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430858063
  error estimate for blocks of size 2^( 2) =       0.000443212499
  error estimate for blocks of size 2^( 3) =       0.000454869014
  error estimate for blocks of size 2^( 4) =       0.000465930423
  error estimate for blocks of size 2^( 5) =       0.000476357434
  error estimate for blocks of size 2^( 6) =       0.000484736131
  error estimate for blocks of size 2^( 7) =       0.000490062400

      target function =                  N/A
              le_mean =     -16.906722389999
             les_mean =     286.208539128583
             stat err =       0.000479271597
             autocorr =       1.237356756119
              std dev =       0.609325316823
             le_variance =       0.371277341721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371423214939
                                         uncertainty =       0.035360740354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371423214939
                                         uncertainty =       0.035360740354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430857844
  error estimate for blocks of size 2^( 2) =       0.000443212302
  error estimate for blocks of size 2^( 3) =       0.000454868844
  error estimate for blocks of size 2^( 4) =       0.000465930272
  error estimate for blocks of size 2^( 5) =       0.000476357277
  error estimate for blocks of size 2^( 6) =       0.000484735973
  error estimate for blocks of size 2^( 7) =       0.000490062229

      target function =                  N/A
              le_mean =     -16.906722391678
             les_mean =     286.208538806905
             stat err =       0.000479271438
             autocorr =       1.237357195196
              std dev =       0.609325006279
             le_variance =       0.371276963277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906722391918        initial  <--
     1.5625e+02     1.5625e+03             1.7243e-06       -16.906722388096
     6.2500e+02     6.2500e+03             4.3115e-07       -16.906722389999
     2.5000e+03     2.5000e+04             1.0779e-07       -16.906722391678

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8827
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380124e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8467
    reference variance = 0.482645
====================================================
  Execution time = 2.0517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154934699
                                         uncertainty =       0.005222481999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154934699
                                         uncertainty =       0.005222481999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411190286
  error estimate for blocks of size 2^( 2) =       0.000424384691
  error estimate for blocks of size 2^( 3) =       0.000437238996
  error estimate for blocks of size 2^( 4) =       0.000448522826
  error estimate for blocks of size 2^( 5) =       0.000459390652
  error estimate for blocks of size 2^( 6) =       0.000466434911
  error estimate for blocks of size 2^( 7) =       0.000471798436

      target function =                  N/A
              le_mean =     -16.906950237689
             les_mean =     286.183121073465
             stat err =       0.000461536706
             autocorr =       1.259873090335
              std dev =       0.581510879400
             le_variance =       0.338154902860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690695023769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906950237689       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906950238245       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906950238460       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906950237923       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906950237595       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906950237457       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906950237672       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906950237714       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.686224e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906950237689       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906950237828       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906950237882       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906950237747       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906950237665       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906950237627       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906950237686       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906950237695       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.215673e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906950237689       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906950237724       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906950237737       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906950237703       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906950237683       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906950237674       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906950237689       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906950237671       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.053925e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6070e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096901e-02 1 1  ON 2
 uu_3                -2.136687e-02 1 1  ON 3
 uu_4                -6.660710e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332561e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293742e-02 1 1  ON 12
 ud_3                -7.380138e-03 1 1  ON 13
 ud_4                -6.473904e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213060e-01 1 1  ON 28
 eO_9                -8.636126e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867337e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212510e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770970e-01 1 1  ON 38
eH1_9                 6.777770e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489900e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950139e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8286
    reference variance = 0.246857
====================================================
  Execution time = 2.0000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3490e-01
  Total weights = 2.0000e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692297001
                                         uncertainty =       0.003468639745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692297001
                                         uncertainty =       0.003468639745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409204882
  error estimate for blocks of size 2^( 2) =       0.000421997745
  error estimate for blocks of size 2^( 3) =       0.000435247645
  error estimate for blocks of size 2^( 4) =       0.000448169158
  error estimate for blocks of size 2^( 5) =       0.000459016135
  error estimate for blocks of size 2^( 6) =       0.000466072803
  error estimate for blocks of size 2^( 7) =       0.000469497046

      target function =                  N/A
              le_mean =     -16.905270994295
             les_mean =     286.123084494633
             stat err =       0.000460688785
             autocorr =       1.267458262040
              std dev =       0.578703094450
             le_variance =       0.334897271525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692323932
                                         uncertainty =       0.003468640061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692323932
                                         uncertainty =       0.003468640061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409204899
  error estimate for blocks of size 2^( 2) =       0.000421997759
  error estimate for blocks of size 2^( 3) =       0.000435247655
  error estimate for blocks of size 2^( 4) =       0.000448169167
  error estimate for blocks of size 2^( 5) =       0.000459016144
  error estimate for blocks of size 2^( 6) =       0.000466072811
  error estimate for blocks of size 2^( 7) =       0.000469497053

      target function =                  N/A
              le_mean =     -16.905270994200
             les_mean =     286.123084518350
             stat err =       0.000460688793
             autocorr =       1.267458205360
              std dev =       0.578703117729
             le_variance =       0.334897298469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692310461
                                         uncertainty =       0.003468639903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692310461
                                         uncertainty =       0.003468639903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409204891
  error estimate for blocks of size 2^( 2) =       0.000421997752
  error estimate for blocks of size 2^( 3) =       0.000435247650
  error estimate for blocks of size 2^( 4) =       0.000448169162
  error estimate for blocks of size 2^( 5) =       0.000459016139
  error estimate for blocks of size 2^( 6) =       0.000466072807
  error estimate for blocks of size 2^( 7) =       0.000469497049

      target function =                  N/A
              le_mean =     -16.905270994247
             les_mean =     286.123084506483
             stat err =       0.000460688789
             autocorr =       1.267458233709
              std dev =       0.578703106085
             le_variance =       0.334897284992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692298684
                                         uncertainty =       0.003468639764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334692298684
                                         uncertainty =       0.003468639764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409204883
  error estimate for blocks of size 2^( 2) =       0.000421997746
  error estimate for blocks of size 2^( 3) =       0.000435247645
  error estimate for blocks of size 2^( 4) =       0.000448169158
  error estimate for blocks of size 2^( 5) =       0.000459016135
  error estimate for blocks of size 2^( 6) =       0.000466072803
  error estimate for blocks of size 2^( 7) =       0.000469497046

      target function =                  N/A
              le_mean =     -16.905270994289
             les_mean =     286.123084496114
             stat err =       0.000460688786
             autocorr =       1.267458258495
              std dev =       0.578703095904
             le_variance =       0.334897273209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905270994295        initial  <--
     1.5625e+03     1.5625e+04             1.6862e-07       -16.905270994200
     6.2500e+03     6.2500e+04             4.2157e-08       -16.905270994247
     2.5000e+04     2.5000e+05             1.0539e-08       -16.905270994289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4764
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380124e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.164715
====================================================
  Execution time = 2.0497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3364e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333674318578
                                         uncertainty =       0.002620793181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333674318578
                                         uncertainty =       0.002620793181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408438461
  error estimate for blocks of size 2^( 2) =       0.000421152259
  error estimate for blocks of size 2^( 3) =       0.000434699635
  error estimate for blocks of size 2^( 4) =       0.000447457858
  error estimate for blocks of size 2^( 5) =       0.000458502317
  error estimate for blocks of size 2^( 6) =       0.000466846259
  error estimate for blocks of size 2^( 7) =       0.000471939616

      target function =                  N/A
              le_mean =     -16.904773190090
             les_mean =     286.105000395210
             stat err =       0.000461186513
             autocorr =       1.274969901321
              std dev =       0.577619211632
             le_variance =       0.333643953646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690477319009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904773190090       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904773190117       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904773190181       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904773190163       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904773190218       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904773190211       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904773190216       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904773190210       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.867826e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904773190090       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904773190097       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904773190113       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904773190108       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904773190122       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904773190111       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904773190192       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904773190121       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 4.669574e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904773190090       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904773190092       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904773190096       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904773190095       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904773190098       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904773190050       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904773190049       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904773190023       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.167394e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055406 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6088e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380127e-03 1 1  ON 13
 ud_4                -6.473904e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212514e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489893e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.169738
====================================================
  Execution time = 1.9964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6762e-01
  Total weights = 2.0000e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713486748
                                         uncertainty =       0.032664267812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713486748
                                         uncertainty =       0.032664267812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428728421
  error estimate for blocks of size 2^( 2) =       0.000440811262
  error estimate for blocks of size 2^( 3) =       0.000453223500
  error estimate for blocks of size 2^( 4) =       0.000464843451
  error estimate for blocks of size 2^( 5) =       0.000474424311
  error estimate for blocks of size 2^( 6) =       0.000480278085
  error estimate for blocks of size 2^( 7) =       0.000482941973

      target function =                  N/A
              le_mean =     -16.905741484741
             les_mean =     286.171711083157
             stat err =       0.000475621955
             autocorr =       1.230719944388
              std dev =       0.606313547652
             le_variance =       0.367616118066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713503786
                                         uncertainty =       0.032664269991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713503786
                                         uncertainty =       0.032664269991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428728431
  error estimate for blocks of size 2^( 2) =       0.000440811271
  error estimate for blocks of size 2^( 3) =       0.000453223509
  error estimate for blocks of size 2^( 4) =       0.000464843459
  error estimate for blocks of size 2^( 5) =       0.000474424319
  error estimate for blocks of size 2^( 6) =       0.000480278092
  error estimate for blocks of size 2^( 7) =       0.000482941980

      target function =                  N/A
              le_mean =     -16.905741484638
             les_mean =     286.171711096719
             stat err =       0.000475621963
             autocorr =       1.230719926184
              std dev =       0.606313561700
             le_variance =       0.367616135101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713495267
                                         uncertainty =       0.032664268902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713495267
                                         uncertainty =       0.032664268902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428728426
  error estimate for blocks of size 2^( 2) =       0.000440811267
  error estimate for blocks of size 2^( 3) =       0.000453223504
  error estimate for blocks of size 2^( 4) =       0.000464843455
  error estimate for blocks of size 2^( 5) =       0.000474424315
  error estimate for blocks of size 2^( 6) =       0.000480278088
  error estimate for blocks of size 2^( 7) =       0.000482941976

      target function =                  N/A
              le_mean =     -16.905741484690
             les_mean =     286.171711089938
             stat err =       0.000475621959
             autocorr =       1.230719935291
              std dev =       0.606313554676
             le_variance =       0.367616126584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713487813
                                         uncertainty =       0.032664267948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367713487813
                                         uncertainty =       0.032664267948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428728422
  error estimate for blocks of size 2^( 2) =       0.000440811263
  error estimate for blocks of size 2^( 3) =       0.000453223501
  error estimate for blocks of size 2^( 4) =       0.000464843452
  error estimate for blocks of size 2^( 5) =       0.000474424312
  error estimate for blocks of size 2^( 6) =       0.000480278085
  error estimate for blocks of size 2^( 7) =       0.000482941973

      target function =                  N/A
              le_mean =     -16.905741484735
             les_mean =     286.171711084005
             stat err =       0.000475621956
             autocorr =       1.230719943253
              std dev =       0.606313548530
             le_variance =       0.367616119131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905741484741        initial  <--
     1.5625e+04     1.5625e+05             1.8678e-08       -16.905741484638
     6.2500e+04     6.2500e+05             4.6696e-09       -16.905741484690
     2.5000e+05     2.5000e+06             1.1674e-09       -16.905741484735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4269
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380124e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5523e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.226306
====================================================
  Execution time = 2.0464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338318181316
                                         uncertainty =       0.003681638859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338318181316
                                         uncertainty =       0.003681638859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411362522
  error estimate for blocks of size 2^( 2) =       0.000424190241
  error estimate for blocks of size 2^( 3) =       0.000437603227
  error estimate for blocks of size 2^( 4) =       0.000449207039
  error estimate for blocks of size 2^( 5) =       0.000459720280
  error estimate for blocks of size 2^( 6) =       0.000469156711
  error estimate for blocks of size 2^( 7) =       0.000471875784

      target function =                  N/A
              le_mean =     -16.906087948214
             les_mean =     286.154247792805
             stat err =       0.000462489954
             autocorr =       1.264023541457
              std dev =       0.581754457897
             le_variance =       0.338438249283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608794821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087948214       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906087948215       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087948216       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087948214       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087948128       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906087948201       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087948351       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906087948313       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.896550e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087948214       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906087948214       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087948214       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087948026       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087946014       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906087948422       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087948170       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906087947449       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 4.741378e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906087948214       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906087948214       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087948214       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087948214       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087948769       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906087948218       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087948044       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906087947497       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 1.185344e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6120e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380124e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8282
    reference variance = 0.300507
====================================================
  Execution time = 2.1769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4480e-01
  Total weights = 2.0000e+06
  Execution time = 1.8587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804297310
                                         uncertainty =       0.007173536229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804297310
                                         uncertainty =       0.007173536229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415212691
  error estimate for blocks of size 2^( 2) =       0.000428014552
  error estimate for blocks of size 2^( 3) =       0.000440821707
  error estimate for blocks of size 2^( 4) =       0.000453010385
  error estimate for blocks of size 2^( 5) =       0.000463804669
  error estimate for blocks of size 2^( 6) =       0.000471028341
  error estimate for blocks of size 2^( 7) =       0.000476475425

      target function =                  N/A
              le_mean =     -16.905181061512
             les_mean =     286.129949708316
             stat err =       0.000466079705
             autocorr =       1.260024951582
              std dev =       0.587199419464
             le_variance =       0.344803158218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804298500
                                         uncertainty =       0.007173536215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804298500
                                         uncertainty =       0.007173536215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415212692
  error estimate for blocks of size 2^( 2) =       0.000428014552
  error estimate for blocks of size 2^( 3) =       0.000440821707
  error estimate for blocks of size 2^( 4) =       0.000453010386
  error estimate for blocks of size 2^( 5) =       0.000463804669
  error estimate for blocks of size 2^( 6) =       0.000471028342
  error estimate for blocks of size 2^( 7) =       0.000476475426

      target function =                  N/A
              le_mean =     -16.905181061519
             les_mean =     286.129949709742
             stat err =       0.000466079705
             autocorr =       1.260024950139
              std dev =       0.587199420477
             le_variance =       0.344803159408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804297905
                                         uncertainty =       0.007173536222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804297905
                                         uncertainty =       0.007173536222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415212692
  error estimate for blocks of size 2^( 2) =       0.000428014552
  error estimate for blocks of size 2^( 3) =       0.000440821707
  error estimate for blocks of size 2^( 4) =       0.000453010385
  error estimate for blocks of size 2^( 5) =       0.000463804669
  error estimate for blocks of size 2^( 6) =       0.000471028341
  error estimate for blocks of size 2^( 7) =       0.000476475425

      target function =                  N/A
              le_mean =     -16.905181061515
             les_mean =     286.129949709029
             stat err =       0.000466079705
             autocorr =       1.260024950860
              std dev =       0.587199419970
             le_variance =       0.344803158813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804297384
                                         uncertainty =       0.007173536229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344804297384
                                         uncertainty =       0.007173536229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415212691
  error estimate for blocks of size 2^( 2) =       0.000428014552
  error estimate for blocks of size 2^( 3) =       0.000440821707
  error estimate for blocks of size 2^( 4) =       0.000453010385
  error estimate for blocks of size 2^( 5) =       0.000463804669
  error estimate for blocks of size 2^( 6) =       0.000471028341
  error estimate for blocks of size 2^( 7) =       0.000476475425

      target function =                  N/A
              le_mean =     -16.905181061512
             les_mean =     286.129949708405
             stat err =       0.000466079705
             autocorr =       1.260024951495
              std dev =       0.587199419527
             le_variance =       0.344803158293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905181061512        initial
     1.5625e+05     1.5625e+06             1.8965e-09       -16.905181061519  <--
     6.2500e+05     6.2500e+06             4.7414e-10       -16.905181061515
     2.5000e+06     2.5000e+07             1.1853e-10       -16.905181061512

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 3.1222e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380125e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8827
    reference variance = 0.31068
====================================================
  Execution time = 2.2401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3382e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333875484059
                                         uncertainty =       0.005568476155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333875484059
                                         uncertainty =       0.005568476155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408546022
  error estimate for blocks of size 2^( 2) =       0.000421398807
  error estimate for blocks of size 2^( 3) =       0.000435123327
  error estimate for blocks of size 2^( 4) =       0.000446916471
  error estimate for blocks of size 2^( 5) =       0.000458685636
  error estimate for blocks of size 2^( 6) =       0.000467235514
  error estimate for blocks of size 2^( 7) =       0.000473765703

      target function =                  N/A
              le_mean =     -16.906127995109
             les_mean =     286.150983324109
             stat err =       0.000461650831
             autocorr =       1.276865847900
              std dev =       0.577771325008
             le_variance =       0.333819704002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612799511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127995109       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127995127       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127995170       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127995192       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127995171       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127995146       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127995165       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906127995192       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 7.876134e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127995109       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127995114       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127995124       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127995126       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127995212       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127995220       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127995024       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906127995209       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.969036e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127995109       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127995110       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127995113       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127994980       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127995003       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127994742       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127995209       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906127994988       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 4.922592e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7987e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473904e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212517e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8201
    reference variance = 0.208687
====================================================
  Execution time = 1.9821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3739e-01
  Total weights = 2.0000e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198744440
                                         uncertainty =       0.005370816576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198744440
                                         uncertainty =       0.005370816576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410725515
  error estimate for blocks of size 2^( 2) =       0.000423303626
  error estimate for blocks of size 2^( 3) =       0.000435123495
  error estimate for blocks of size 2^( 4) =       0.000446234647
  error estimate for blocks of size 2^( 5) =       0.000454409691
  error estimate for blocks of size 2^( 6) =       0.000462252144
  error estimate for blocks of size 2^( 7) =       0.000467286355

      target function =                  N/A
              le_mean =     -16.905968768066
             les_mean =     286.149170715647
             stat err =       0.000457545709
             autocorr =       1.240982358576
              std dev =       0.580853593887
             le_variance =       0.337390897532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198748478
                                         uncertainty =       0.005370816675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198748478
                                         uncertainty =       0.005370816675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410725518
  error estimate for blocks of size 2^( 2) =       0.000423303628
  error estimate for blocks of size 2^( 3) =       0.000435123497
  error estimate for blocks of size 2^( 4) =       0.000446234648
  error estimate for blocks of size 2^( 5) =       0.000454409693
  error estimate for blocks of size 2^( 6) =       0.000462252146
  error estimate for blocks of size 2^( 7) =       0.000467286356

      target function =                  N/A
              le_mean =     -16.905968768043
             les_mean =     286.149170718902
             stat err =       0.000457545711
             autocorr =       1.240982352808
              std dev =       0.580853597362
             le_variance =       0.337390901568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198746459
                                         uncertainty =       0.005370816625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198746459
                                         uncertainty =       0.005370816625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410725516
  error estimate for blocks of size 2^( 2) =       0.000423303627
  error estimate for blocks of size 2^( 3) =       0.000435123496
  error estimate for blocks of size 2^( 4) =       0.000446234647
  error estimate for blocks of size 2^( 5) =       0.000454409692
  error estimate for blocks of size 2^( 6) =       0.000462252145
  error estimate for blocks of size 2^( 7) =       0.000467286355

      target function =                  N/A
              le_mean =     -16.905968768054
             les_mean =     286.149170717274
             stat err =       0.000457545710
             autocorr =       1.240982355696
              std dev =       0.580853595624
             le_variance =       0.337390899550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198744692
                                         uncertainty =       0.005370816582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337198744692
                                         uncertainty =       0.005370816582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410725515
  error estimate for blocks of size 2^( 2) =       0.000423303626
  error estimate for blocks of size 2^( 3) =       0.000435123495
  error estimate for blocks of size 2^( 4) =       0.000446234647
  error estimate for blocks of size 2^( 5) =       0.000454409691
  error estimate for blocks of size 2^( 6) =       0.000462252144
  error estimate for blocks of size 2^( 7) =       0.000467286355

      target function =                  N/A
              le_mean =     -16.905968768064
             les_mean =     286.149170715850
             stat err =       0.000457545709
             autocorr =       1.240982358226
              std dev =       0.580853594104
             le_variance =       0.337390897784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905968768066        initial  <--
     3.9062e+04     3.9062e+05             7.8761e-09       -16.905968768043
     1.5625e+05     1.5625e+06             1.9690e-09       -16.905968768054
     6.2500e+05     6.2500e+06             4.9226e-10       -16.905968768064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3017
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380125e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9586
    reference variance = 0.386652
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337616942607
                                         uncertainty =       0.003200390930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337616942607
                                         uncertainty =       0.003200390930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410823409
  error estimate for blocks of size 2^( 2) =       0.000423412210
  error estimate for blocks of size 2^( 3) =       0.000436895902
  error estimate for blocks of size 2^( 4) =       0.000449122960
  error estimate for blocks of size 2^( 5) =       0.000458913678
  error estimate for blocks of size 2^( 6) =       0.000466802613
  error estimate for blocks of size 2^( 7) =       0.000471546298

      target function =                  N/A
              le_mean =     -16.905763549287
             les_mean =     286.142392762474
             stat err =       0.000461596387
             autocorr =       1.262450731409
              std dev =       0.580992036807
             le_variance =       0.337551746833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576354929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763549287       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763549291       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763549292       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763549292       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763549358       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763549926       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763550528       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763549521       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 7.698114e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763549287       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763549288       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763549288       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763549395       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763549271       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763549285       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763549291       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763550458       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.924528e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905763549287       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763549288       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763549288       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905763549288       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905763549715       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905763545640       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905763548426       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763546681       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 4.811310e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6056e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.186933
====================================================
  Execution time = 1.9977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4825e-01
  Total weights = 2.0000e+06
  Execution time = 1.8554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201046
                                         uncertainty =       0.007642675549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201046
                                         uncertainty =       0.007642675549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417282699
  error estimate for blocks of size 2^( 2) =       0.000429417156
  error estimate for blocks of size 2^( 3) =       0.000442143139
  error estimate for blocks of size 2^( 4) =       0.000454180043
  error estimate for blocks of size 2^( 5) =       0.000464541018
  error estimate for blocks of size 2^( 6) =       0.000472623792
  error estimate for blocks of size 2^( 7) =       0.000477263837

      target function =                  N/A
              le_mean =     -16.906463561364
             les_mean =     286.176759679424
             stat err =       0.000467152172
             autocorr =       1.253302735078
              std dev =       0.590126852323
             le_variance =       0.348249701832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201543
                                         uncertainty =       0.007642675569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201543
                                         uncertainty =       0.007642675569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417282699
  error estimate for blocks of size 2^( 2) =       0.000429417156
  error estimate for blocks of size 2^( 3) =       0.000442143139
  error estimate for blocks of size 2^( 4) =       0.000454180043
  error estimate for blocks of size 2^( 5) =       0.000464541018
  error estimate for blocks of size 2^( 6) =       0.000472623792
  error estimate for blocks of size 2^( 7) =       0.000477263837

      target function =                  N/A
              le_mean =     -16.906463561362
             les_mean =     286.176759679851
             stat err =       0.000467152172
             autocorr =       1.253302734466
              std dev =       0.590126852744
             le_variance =       0.348249702330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201295
                                         uncertainty =       0.007642675559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201295
                                         uncertainty =       0.007642675559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417282699
  error estimate for blocks of size 2^( 2) =       0.000429417156
  error estimate for blocks of size 2^( 3) =       0.000442143139
  error estimate for blocks of size 2^( 4) =       0.000454180043
  error estimate for blocks of size 2^( 5) =       0.000464541018
  error estimate for blocks of size 2^( 6) =       0.000472623792
  error estimate for blocks of size 2^( 7) =       0.000477263837

      target function =                  N/A
              le_mean =     -16.906463561363
             les_mean =     286.176759679638
             stat err =       0.000467152172
             autocorr =       1.253302734773
              std dev =       0.590126852533
             le_variance =       0.348249702081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201077
                                         uncertainty =       0.007642675550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348295201077
                                         uncertainty =       0.007642675550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417282699
  error estimate for blocks of size 2^( 2) =       0.000429417156
  error estimate for blocks of size 2^( 3) =       0.000442143139
  error estimate for blocks of size 2^( 4) =       0.000454180043
  error estimate for blocks of size 2^( 5) =       0.000464541018
  error estimate for blocks of size 2^( 6) =       0.000472623792
  error estimate for blocks of size 2^( 7) =       0.000477263837

      target function =                  N/A
              le_mean =     -16.906463561364
             les_mean =     286.176759679451
             stat err =       0.000467152172
             autocorr =       1.253302735041
              std dev =       0.590126852349
             le_variance =       0.348249701863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906463561364        initial  <--
     3.9062e+05     3.9062e+06             7.6981e-10       -16.906463561362
     1.5625e+06     1.5625e+07             1.9245e-10       -16.906463561363
     6.2500e+06     6.2500e+07             4.8113e-11       -16.906463561364

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4325
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380125e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9448
    reference variance = 0.312767
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334767166323
                                         uncertainty =       0.003827869358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334767166323
                                         uncertainty =       0.003827869358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409163927
  error estimate for blocks of size 2^( 2) =       0.000422204962
  error estimate for blocks of size 2^( 3) =       0.000435487143
  error estimate for blocks of size 2^( 4) =       0.000448145741
  error estimate for blocks of size 2^( 5) =       0.000459004494
  error estimate for blocks of size 2^( 6) =       0.000464602276
  error estimate for blocks of size 2^( 7) =       0.000469329577

      target function =                  N/A
              le_mean =     -16.905912086196
             les_mean =     286.144693536829
             stat err =       0.000460270522
             autocorr =       1.265411121114
              std dev =       0.578645174575
             le_variance =       0.334830238059


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591208620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912086196       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912086196       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912086196       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912086196       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912087313       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912089641       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905912086123       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905912086401       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.901423e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912086196       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912086196       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912086196       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912085432       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912083457       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912087043       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905912087267       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905912091651       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.725359e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912086196       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912086196       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912086196       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912085279       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912103115       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912069268       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911793769       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905912094068       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 4.314041e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065845 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5958e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380125e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8846
    reference variance = 0.24809
====================================================
  Execution time = 1.9841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3140e-01
  Total weights = 2.0000e+06
  Execution time = 1.8588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973948
                                         uncertainty =       0.002983514757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973948
                                         uncertainty =       0.002983514757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407061284
  error estimate for blocks of size 2^( 2) =       0.000420023745
  error estimate for blocks of size 2^( 3) =       0.000433773394
  error estimate for blocks of size 2^( 4) =       0.000446198263
  error estimate for blocks of size 2^( 5) =       0.000457331813
  error estimate for blocks of size 2^( 6) =       0.000466999678
  error estimate for blocks of size 2^( 7) =       0.000473643348

      target function =                  N/A
              le_mean =     -16.906236682697
             les_mean =     286.152236383553
             stat err =       0.000461043276
             autocorr =       1.282814287024
              std dev =       0.575671588555
             le_variance =       0.331397777869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973992
                                         uncertainty =       0.002983514758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973992
                                         uncertainty =       0.002983514758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407061284
  error estimate for blocks of size 2^( 2) =       0.000420023745
  error estimate for blocks of size 2^( 3) =       0.000433773394
  error estimate for blocks of size 2^( 4) =       0.000446198264
  error estimate for blocks of size 2^( 5) =       0.000457331813
  error estimate for blocks of size 2^( 6) =       0.000466999678
  error estimate for blocks of size 2^( 7) =       0.000473643348

      target function =                  N/A
              le_mean =     -16.906236682698
             les_mean =     286.152236383606
             stat err =       0.000461043276
             autocorr =       1.282814286957
              std dev =       0.575671588593
             le_variance =       0.331397777913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973970
                                         uncertainty =       0.002983514757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973970
                                         uncertainty =       0.002983514757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407061284
  error estimate for blocks of size 2^( 2) =       0.000420023745
  error estimate for blocks of size 2^( 3) =       0.000433773394
  error estimate for blocks of size 2^( 4) =       0.000446198264
  error estimate for blocks of size 2^( 5) =       0.000457331813
  error estimate for blocks of size 2^( 6) =       0.000466999678
  error estimate for blocks of size 2^( 7) =       0.000473643348

      target function =                  N/A
              le_mean =     -16.906236682698
             les_mean =     286.152236383579
             stat err =       0.000461043276
             autocorr =       1.282814286979
              std dev =       0.575671588574
             le_variance =       0.331397777891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973951
                                         uncertainty =       0.002983514757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331430973951
                                         uncertainty =       0.002983514757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407061284
  error estimate for blocks of size 2^( 2) =       0.000420023745
  error estimate for blocks of size 2^( 3) =       0.000433773394
  error estimate for blocks of size 2^( 4) =       0.000446198263
  error estimate for blocks of size 2^( 5) =       0.000457331813
  error estimate for blocks of size 2^( 6) =       0.000466999678
  error estimate for blocks of size 2^( 7) =       0.000473643348

      target function =                  N/A
              le_mean =     -16.906236682697
             les_mean =     286.152236383557
             stat err =       0.000461043276
             autocorr =       1.282814287017
              std dev =       0.575671588557
             le_variance =       0.331397777872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906236682697        initial
     3.9062e+06     3.9062e+07             6.9014e-11       -16.906236682698  <--
     1.5625e+07     1.5625e+08             1.7254e-11       -16.906236682698
     6.2500e+07     6.2500e+08             4.3140e-12       -16.906236682697

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 2.9397e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380125e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9384
    reference variance = 0.387528
====================================================
  Execution time = 2.0277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4046e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340496190219
                                         uncertainty =       0.004828841909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340496190219
                                         uncertainty =       0.004828841909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412588317
  error estimate for blocks of size 2^( 2) =       0.000425418537
  error estimate for blocks of size 2^( 3) =       0.000438293344
  error estimate for blocks of size 2^( 4) =       0.000451010828
  error estimate for blocks of size 2^( 5) =       0.000462255754
  error estimate for blocks of size 2^( 6) =       0.000471429288
  error estimate for blocks of size 2^( 7) =       0.000477788826

      target function =                  N/A
              le_mean =     -16.905337643996
             les_mean =     286.130898925529
             stat err =       0.000465621174
             autocorr =       1.273595720610
              std dev =       0.583487993248
             le_variance =       0.340458238264


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533764400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905337643996       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905337643996       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905337643996       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337643996       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905337643925       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905337645174       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905337643179       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905337644438       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.709271e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905337643996       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905337643996       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905337643996       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337643969       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905337645710       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905337641522       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905337642974       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905337644682       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 9.273167e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905337643996       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905337643996       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905337643996       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337643996       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905337642666       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905337643828       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905337638215       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905337634146       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 2.318294e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5796e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.222599
====================================================
  Execution time = 2.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3716e-01
  Total weights = 2.0000e+06
  Execution time = 1.8484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270498
                                         uncertainty =       0.003114346713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270498
                                         uncertainty =       0.003114346713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410582892
  error estimate for blocks of size 2^( 2) =       0.000423714428
  error estimate for blocks of size 2^( 3) =       0.000437094148
  error estimate for blocks of size 2^( 4) =       0.000449995545
  error estimate for blocks of size 2^( 5) =       0.000460510903
  error estimate for blocks of size 2^( 6) =       0.000467247691
  error estimate for blocks of size 2^( 7) =       0.000472739872

      target function =                  N/A
              le_mean =     -16.906025025029
             les_mean =     286.150838601174
             stat err =       0.000462623503
             autocorr =       1.269561330897
              std dev =       0.580651894728
             le_variance =       0.337156622851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270587
                                         uncertainty =       0.003114346714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270587
                                         uncertainty =       0.003114346714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410582892
  error estimate for blocks of size 2^( 2) =       0.000423714428
  error estimate for blocks of size 2^( 3) =       0.000437094148
  error estimate for blocks of size 2^( 4) =       0.000449995545
  error estimate for blocks of size 2^( 5) =       0.000460510903
  error estimate for blocks of size 2^( 6) =       0.000467247691
  error estimate for blocks of size 2^( 7) =       0.000472739872

      target function =                  N/A
              le_mean =     -16.906025025030
             les_mean =     286.150838601308
             stat err =       0.000462623503
             autocorr =       1.269561330752
              std dev =       0.580651894804
             le_variance =       0.337156622940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270542
                                         uncertainty =       0.003114346714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270542
                                         uncertainty =       0.003114346714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410582892
  error estimate for blocks of size 2^( 2) =       0.000423714428
  error estimate for blocks of size 2^( 3) =       0.000437094148
  error estimate for blocks of size 2^( 4) =       0.000449995545
  error estimate for blocks of size 2^( 5) =       0.000460510903
  error estimate for blocks of size 2^( 6) =       0.000467247691
  error estimate for blocks of size 2^( 7) =       0.000472739872

      target function =                  N/A
              le_mean =     -16.906025025030
             les_mean =     286.150838601241
             stat err =       0.000462623503
             autocorr =       1.269561330815
              std dev =       0.580651894766
             le_variance =       0.337156622895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270503
                                         uncertainty =       0.003114346713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161270503
                                         uncertainty =       0.003114346713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410582892
  error estimate for blocks of size 2^( 2) =       0.000423714428
  error estimate for blocks of size 2^( 3) =       0.000437094148
  error estimate for blocks of size 2^( 4) =       0.000449995545
  error estimate for blocks of size 2^( 5) =       0.000460510903
  error estimate for blocks of size 2^( 6) =       0.000467247691
  error estimate for blocks of size 2^( 7) =       0.000472739872

      target function =                  N/A
              le_mean =     -16.906025025029
             les_mean =     286.150838601183
             stat err =       0.000462623503
             autocorr =       1.269561330889
              std dev =       0.580651894732
             le_variance =       0.337156622856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906025025029        initial
     9.7656e+05     9.7656e+06             3.7093e-10       -16.906025025030  <--
     3.9062e+06     3.9062e+07             9.2732e-11       -16.906025025030
     1.5625e+07     1.5625e+08             2.3183e-11       -16.906025025029

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.9431e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8584
    reference variance = 0.298606
====================================================
  Execution time = 2.0434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339243494423
                                         uncertainty =       0.005261062224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339243494423
                                         uncertainty =       0.005261062224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411840660
  error estimate for blocks of size 2^( 2) =       0.000424541017
  error estimate for blocks of size 2^( 3) =       0.000437700274
  error estimate for blocks of size 2^( 4) =       0.000449172619
  error estimate for blocks of size 2^( 5) =       0.000459483606
  error estimate for blocks of size 2^( 6) =       0.000466750627
  error estimate for blocks of size 2^( 7) =       0.000472963441

      target function =                  N/A
              le_mean =     -16.906522257221
             les_mean =     286.169720122352
             stat err =       0.000462092573
             autocorr =       1.258924064914
              std dev =       0.582430646568
             le_variance =       0.339225458062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652225722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906522257221       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906522257217       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906522257224       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906522257174       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906522257110       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906522257240       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906522257144       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906522257328       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.260770e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906522257221       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906522257220       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906522257222       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906522257321       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906522257190       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906522257569       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906522253136       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906522259715       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.151920e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906522257221       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906522257221       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906522257221       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906522257221       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906522257270       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906522254442       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906522254956       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906522264012       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 7.879831e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6000e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212515e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489891e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.260039
====================================================
  Execution time = 1.9873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3540e-01
  Total weights = 2.0000e+06
  Execution time = 1.8504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905190
                                         uncertainty =       0.002892914383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905190
                                         uncertainty =       0.002892914383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409510744
  error estimate for blocks of size 2^( 2) =       0.000421985825
  error estimate for blocks of size 2^( 3) =       0.000434506900
  error estimate for blocks of size 2^( 4) =       0.000446400770
  error estimate for blocks of size 2^( 5) =       0.000456362333
  error estimate for blocks of size 2^( 6) =       0.000463527138
  error estimate for blocks of size 2^( 7) =       0.000468213635

      target function =                  N/A
              le_mean =     -16.906235643581
             les_mean =     286.156201566762
             stat err =       0.000458625969
             autocorr =       1.254257436148
              std dev =       0.579135647476
             le_variance =       0.335398098178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905585
                                         uncertainty =       0.002892914385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905585
                                         uncertainty =       0.002892914385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409510744
  error estimate for blocks of size 2^( 2) =       0.000421985825
  error estimate for blocks of size 2^( 3) =       0.000434506900
  error estimate for blocks of size 2^( 4) =       0.000446400770
  error estimate for blocks of size 2^( 5) =       0.000456362333
  error estimate for blocks of size 2^( 6) =       0.000463527138
  error estimate for blocks of size 2^( 7) =       0.000468213635

      target function =                  N/A
              le_mean =     -16.906235643587
             les_mean =     286.156201567356
             stat err =       0.000458625969
             autocorr =       1.254257435396
              std dev =       0.579135647817
             le_variance =       0.335398098572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905388
                                         uncertainty =       0.002892914384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905388
                                         uncertainty =       0.002892914384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409510744
  error estimate for blocks of size 2^( 2) =       0.000421985825
  error estimate for blocks of size 2^( 3) =       0.000434506900
  error estimate for blocks of size 2^( 4) =       0.000446400770
  error estimate for blocks of size 2^( 5) =       0.000456362333
  error estimate for blocks of size 2^( 6) =       0.000463527138
  error estimate for blocks of size 2^( 7) =       0.000468213635

      target function =                  N/A
              le_mean =     -16.906235643584
             les_mean =     286.156201567059
             stat err =       0.000458625969
             autocorr =       1.254257435776
              std dev =       0.579135647646
             le_variance =       0.335398098375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905215
                                         uncertainty =       0.002892914383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335505905215
                                         uncertainty =       0.002892914383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409510744
  error estimate for blocks of size 2^( 2) =       0.000421985825
  error estimate for blocks of size 2^( 3) =       0.000434506900
  error estimate for blocks of size 2^( 4) =       0.000446400770
  error estimate for blocks of size 2^( 5) =       0.000456362333
  error estimate for blocks of size 2^( 6) =       0.000463527138
  error estimate for blocks of size 2^( 7) =       0.000468213635

      target function =                  N/A
              le_mean =     -16.906235643581
             les_mean =     286.156201566799
             stat err =       0.000458625969
             autocorr =       1.254257436105
              std dev =       0.579135647497
             le_variance =       0.335398098202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906235643581        initial
     2.4414e+05     2.4414e+06             1.2608e-09       -16.906235643587  <--
     9.7656e+05     9.7656e+06             3.1519e-10       -16.906235643584
     3.9062e+06     3.9062e+07             7.8798e-11       -16.906235643581

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 2.9204e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9193
    reference variance = 0.275859
====================================================
  Execution time = 2.2281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342613656367
                                         uncertainty =       0.005914117710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342613656367
                                         uncertainty =       0.005914117710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413926121
  error estimate for blocks of size 2^( 2) =       0.000427150845
  error estimate for blocks of size 2^( 3) =       0.000440046499
  error estimate for blocks of size 2^( 4) =       0.000453496478
  error estimate for blocks of size 2^( 5) =       0.000464762519
  error estimate for blocks of size 2^( 6) =       0.000473468019
  error estimate for blocks of size 2^( 7) =       0.000478059652

      target function =                  N/A
              le_mean =     -16.905940926555
             les_mean =     286.153508107503
             stat err =       0.000467446667
             autocorr =       1.275317938309
              std dev =       0.585379933620
             le_variance =       0.342669666685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594092655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905940926555       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905940926591       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940926603       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940926600       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905940926571       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905940926591       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905940926524       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905940926636       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.804614e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905940926555       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905940926564       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940926567       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940926568       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905940926554       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905940926438       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905940926639       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905940926608       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.201155e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905940926555       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905940926557       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940926558       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940926557       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905940927074       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905940926763       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905940927012       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905940927416       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.002887e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7821e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380127e-03 1 1  ON 13
 ud_4                -6.473904e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867337e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8792
    reference variance = 0.216956
====================================================
  Execution time = 2.2104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3693e-01
  Total weights = 2.0000e+06
  Execution time = 1.8695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009743474
                                         uncertainty =       0.002810046603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009743474
                                         uncertainty =       0.002810046603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447456
  error estimate for blocks of size 2^( 2) =       0.000423166616
  error estimate for blocks of size 2^( 3) =       0.000436495635
  error estimate for blocks of size 2^( 4) =       0.000449465549
  error estimate for blocks of size 2^( 5) =       0.000460179958
  error estimate for blocks of size 2^( 6) =       0.000467404481
  error estimate for blocks of size 2^( 7) =       0.000471440737

      target function =                  N/A
              le_mean =     -16.905939931730
             les_mean =     286.147739035560
             stat err =       0.000462122681
             autocorr =       1.267650208316
              std dev =       0.580460359333
             le_variance =       0.336934228757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009747893
                                         uncertainty =       0.002810046657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009747893
                                         uncertainty =       0.002810046657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447459
  error estimate for blocks of size 2^( 2) =       0.000423166619
  error estimate for blocks of size 2^( 3) =       0.000436495638
  error estimate for blocks of size 2^( 4) =       0.000449465551
  error estimate for blocks of size 2^( 5) =       0.000460179960
  error estimate for blocks of size 2^( 6) =       0.000467404483
  error estimate for blocks of size 2^( 7) =       0.000471440739

      target function =                  N/A
              le_mean =     -16.905939931722
             les_mean =     286.147739039688
             stat err =       0.000462122683
             autocorr =       1.267650202795
              std dev =       0.580460363139
             le_variance =       0.336934233176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009745684
                                         uncertainty =       0.002810046630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009745684
                                         uncertainty =       0.002810046630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447458
  error estimate for blocks of size 2^( 2) =       0.000423166618
  error estimate for blocks of size 2^( 3) =       0.000436495636
  error estimate for blocks of size 2^( 4) =       0.000449465550
  error estimate for blocks of size 2^( 5) =       0.000460179959
  error estimate for blocks of size 2^( 6) =       0.000467404482
  error estimate for blocks of size 2^( 7) =       0.000471440738

      target function =                  N/A
              le_mean =     -16.905939931726
             les_mean =     286.147739037624
             stat err =       0.000462122682
             autocorr =       1.267650205553
              std dev =       0.580460361236
             le_variance =       0.336934230967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009743750
                                         uncertainty =       0.002810046606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337009743750
                                         uncertainty =       0.002810046606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410447456
  error estimate for blocks of size 2^( 2) =       0.000423166617
  error estimate for blocks of size 2^( 3) =       0.000436495635
  error estimate for blocks of size 2^( 4) =       0.000449465549
  error estimate for blocks of size 2^( 5) =       0.000460179958
  error estimate for blocks of size 2^( 6) =       0.000467404482
  error estimate for blocks of size 2^( 7) =       0.000471440737

      target function =                  N/A
              le_mean =     -16.905939931730
             les_mean =     286.147739035818
             stat err =       0.000462122681
             autocorr =       1.267650207965
              std dev =       0.580460359571
             le_variance =       0.336934229034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905939931730        initial  <--
     6.1035e+04     6.1035e+05             4.8046e-09       -16.905939931722
     2.4414e+05     2.4414e+06             1.2012e-09       -16.905939931726
     9.7656e+05     9.7656e+06             3.0029e-10       -16.905939931730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5382
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8844
    reference variance = 0.392584
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343105771620
                                         uncertainty =       0.006838027947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343105771620
                                         uncertainty =       0.006838027947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414257847
  error estimate for blocks of size 2^( 2) =       0.000426512226
  error estimate for blocks of size 2^( 3) =       0.000439266187
  error estimate for blocks of size 2^( 4) =       0.000450982182
  error estimate for blocks of size 2^( 5) =       0.000462885330
  error estimate for blocks of size 2^( 6) =       0.000470566053
  error estimate for blocks of size 2^( 7) =       0.000476612525

      target function =                  N/A
              le_mean =     -16.905908300036
             les_mean =     286.152954405349
             stat err =       0.000465261523
             autocorr =       1.261399886229
              std dev =       0.585849065661
             le_variance =       0.343219127736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590830004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905908300036       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905908300037       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905908300037       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905908300036       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905908299525       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905908300156       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905908300278       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905908300316       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.776123e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905908300036       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905908300036       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905908300036       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905908299975       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905908300801       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905908300914       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905908300048       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905908298469       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.194030e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905908300036       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905908300036       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905908300036       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905908299661       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905908303061       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905908296415       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905908298477       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905908292586       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.985073e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5849e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473904e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9759
    reference variance = 0.361926
====================================================
  Execution time = 1.9624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4479e-01
  Total weights = 2.0000e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151119
                                         uncertainty =       0.009108881976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151119
                                         uncertainty =       0.009108881976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415205154
  error estimate for blocks of size 2^( 2) =       0.000427523521
  error estimate for blocks of size 2^( 3) =       0.000440050586
  error estimate for blocks of size 2^( 4) =       0.000451330897
  error estimate for blocks of size 2^( 5) =       0.000460420976
  error estimate for blocks of size 2^( 6) =       0.000468846576
  error estimate for blocks of size 2^( 7) =       0.000469970088

      target function =                  N/A
              le_mean =     -16.906127050156
             les_mean =     286.161922302732
             stat err =       0.000462642134
             autocorr =       1.241551944724
              std dev =       0.587188759357
             le_variance =       0.344790639116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151280
                                         uncertainty =       0.009108881974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151280
                                         uncertainty =       0.009108881974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415205154
  error estimate for blocks of size 2^( 2) =       0.000427523521
  error estimate for blocks of size 2^( 3) =       0.000440050586
  error estimate for blocks of size 2^( 4) =       0.000451330897
  error estimate for blocks of size 2^( 5) =       0.000460420976
  error estimate for blocks of size 2^( 6) =       0.000468846576
  error estimate for blocks of size 2^( 7) =       0.000469970088

      target function =                  N/A
              le_mean =     -16.906127050154
             les_mean =     286.161922302830
             stat err =       0.000462642134
             autocorr =       1.241551944552
              std dev =       0.587188759495
             le_variance =       0.344790639277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151200
                                         uncertainty =       0.009108881975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151200
                                         uncertainty =       0.009108881975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415205154
  error estimate for blocks of size 2^( 2) =       0.000427523521
  error estimate for blocks of size 2^( 3) =       0.000440050586
  error estimate for blocks of size 2^( 4) =       0.000451330897
  error estimate for blocks of size 2^( 5) =       0.000460420976
  error estimate for blocks of size 2^( 6) =       0.000468846576
  error estimate for blocks of size 2^( 7) =       0.000469970088

      target function =                  N/A
              le_mean =     -16.906127050155
             les_mean =     286.161922302781
             stat err =       0.000462642134
             autocorr =       1.241551944637
              std dev =       0.587188759426
             le_variance =       0.344790639196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151129
                                         uncertainty =       0.009108881976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344855151129
                                         uncertainty =       0.009108881976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415205154
  error estimate for blocks of size 2^( 2) =       0.000427523521
  error estimate for blocks of size 2^( 3) =       0.000440050586
  error estimate for blocks of size 2^( 4) =       0.000451330897
  error estimate for blocks of size 2^( 5) =       0.000460420976
  error estimate for blocks of size 2^( 6) =       0.000468846576
  error estimate for blocks of size 2^( 7) =       0.000469970088

      target function =                  N/A
              le_mean =     -16.906127050156
             les_mean =     286.161922302738
             stat err =       0.000462642134
             autocorr =       1.241551944711
              std dev =       0.587188759366
             le_variance =       0.344790639126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906127050156        initial  <--
     6.1035e+05     6.1035e+06             4.7761e-10       -16.906127050154
     2.4414e+06     2.4414e+07             1.1940e-10       -16.906127050155
     9.7656e+06     9.7656e+07             2.9851e-11       -16.906127050156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1127
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.180731
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333837651780
                                         uncertainty =       0.002765953653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333837651780
                                         uncertainty =       0.002765953653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408533302
  error estimate for blocks of size 2^( 2) =       0.000421108746
  error estimate for blocks of size 2^( 3) =       0.000433877247
  error estimate for blocks of size 2^( 4) =       0.000446242509
  error estimate for blocks of size 2^( 5) =       0.000456917857
  error estimate for blocks of size 2^( 6) =       0.000463744549
  error estimate for blocks of size 2^( 7) =       0.000467550146

      target function =                  N/A
              le_mean =     -16.906498422820
             les_mean =     286.163487671486
             stat err =       0.000458613765
             autocorr =       1.260199326847
              std dev =       0.577753336266
             le_variance =       0.333798917566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649842282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498422820       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498422820       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498422821       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498422821       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498422821       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498422821       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498426949       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498424771       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.255854e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498422820       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498422820       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498422820       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498416871       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498422820       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498422820       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498426727       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498413196       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.063965e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498422820       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498422820       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498422820       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498422820       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498415666       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498421177       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498424717       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498455227       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 2.659910e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5949e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9751
    reference variance = 0.192059
====================================================
  Execution time = 1.9878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2902e-01
  Total weights = 2.0000e+06
  Execution time = 1.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612373
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612373
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405596445
  error estimate for blocks of size 2^( 2) =       0.000418190021
  error estimate for blocks of size 2^( 3) =       0.000431579166
  error estimate for blocks of size 2^( 4) =       0.000444581792
  error estimate for blocks of size 2^( 5) =       0.000454490470
  error estimate for blocks of size 2^( 6) =       0.000463637944
  error estimate for blocks of size 2^( 7) =       0.000468737457

      target function =                  N/A
              le_mean =     -16.905403403308
             les_mean =     286.121681017148
             stat err =       0.000457861916
             autocorr =       1.274326639124
              std dev =       0.573599993976
             le_variance =       0.329016953089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612365
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612365
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405596445
  error estimate for blocks of size 2^( 2) =       0.000418190021
  error estimate for blocks of size 2^( 3) =       0.000431579166
  error estimate for blocks of size 2^( 4) =       0.000444581792
  error estimate for blocks of size 2^( 5) =       0.000454490470
  error estimate for blocks of size 2^( 6) =       0.000463637944
  error estimate for blocks of size 2^( 7) =       0.000468737457

      target function =                  N/A
              le_mean =     -16.905403403308
             les_mean =     286.121681017136
             stat err =       0.000457861916
             autocorr =       1.274326639125
              std dev =       0.573599993969
             le_variance =       0.329016953082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612369
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612369
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405596445
  error estimate for blocks of size 2^( 2) =       0.000418190021
  error estimate for blocks of size 2^( 3) =       0.000431579166
  error estimate for blocks of size 2^( 4) =       0.000444581792
  error estimate for blocks of size 2^( 5) =       0.000454490470
  error estimate for blocks of size 2^( 6) =       0.000463637944
  error estimate for blocks of size 2^( 7) =       0.000468737457

      target function =                  N/A
              le_mean =     -16.905403403308
             les_mean =     286.121681017142
             stat err =       0.000457861916
             autocorr =       1.274326639116
              std dev =       0.573599993973
             le_variance =       0.329016953085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612373
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097612373
                                         uncertainty =       0.002617301866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405596445
  error estimate for blocks of size 2^( 2) =       0.000418190021
  error estimate for blocks of size 2^( 3) =       0.000431579166
  error estimate for blocks of size 2^( 4) =       0.000444581792
  error estimate for blocks of size 2^( 5) =       0.000454490470
  error estimate for blocks of size 2^( 6) =       0.000463637944
  error estimate for blocks of size 2^( 7) =       0.000468737457

      target function =                  N/A
              le_mean =     -16.905403403308
             les_mean =     286.121681017147
             stat err =       0.000457861916
             autocorr =       1.274326639117
              std dev =       0.573599993976
             le_variance =       0.329016953089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905403403308        initial  <--
     6.1035e+06     6.1035e+07             4.2559e-11       -16.905403403308
     2.4414e+07     2.4414e+08             1.0640e-11       -16.905403403308
     9.7656e+07     9.7656e+08             2.6599e-12       -16.905403403308

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2901
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5245e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8777
    reference variance = 0.240943
====================================================
  Execution time = 2.0045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3271e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332681520576
                                         uncertainty =       0.003502679609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332681520576
                                         uncertainty =       0.003502679609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407863559
  error estimate for blocks of size 2^( 2) =       0.000420008379
  error estimate for blocks of size 2^( 3) =       0.000432503091
  error estimate for blocks of size 2^( 4) =       0.000444168297
  error estimate for blocks of size 2^( 5) =       0.000452540523
  error estimate for blocks of size 2^( 6) =       0.000459947169
  error estimate for blocks of size 2^( 7) =       0.000464856331

      target function =                  N/A
              le_mean =     -16.905888206882
             les_mean =     286.141761262000
             stat err =       0.000455378080
             autocorr =       1.246563582990
              std dev =       0.576806176079
             le_variance =       0.332705364763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588820688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905888206882       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905888206882       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905888206882       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905888206882       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905888201472       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905888258238       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905888249957       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905888171868       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 5.326699e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905888206882       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905888206882       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905888206882       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905888206882       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905888150911       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905888279357       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905888160430       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905888098421       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 1.331688e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905888206882       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905888206882       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905888206882       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905888426357       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905888206882       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905889903763       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905889759237       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905885201870       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 3.318584e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5551e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.94
    reference variance = 0.523937
====================================================
  Execution time = 1.9684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3533e-01
  Total weights = 2.0000e+06
  Execution time = 1.8785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666291
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666291
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409468874
  error estimate for blocks of size 2^( 2) =       0.000422044636
  error estimate for blocks of size 2^( 3) =       0.000435508189
  error estimate for blocks of size 2^( 4) =       0.000448078037
  error estimate for blocks of size 2^( 5) =       0.000459988361
  error estimate for blocks of size 2^( 6) =       0.000469628974
  error estimate for blocks of size 2^( 7) =       0.000477214108

      target function =                  N/A
              le_mean =     -16.906223066268
             les_mean =     286.155707715774
             stat err =       0.000463727370
             autocorr =       1.282577659885
              std dev =       0.579076434531
             le_variance =       0.335329517030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666296
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666296
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409468874
  error estimate for blocks of size 2^( 2) =       0.000422044636
  error estimate for blocks of size 2^( 3) =       0.000435508189
  error estimate for blocks of size 2^( 4) =       0.000448078037
  error estimate for blocks of size 2^( 5) =       0.000459988361
  error estimate for blocks of size 2^( 6) =       0.000469628974
  error estimate for blocks of size 2^( 7) =       0.000477214108

      target function =                  N/A
              le_mean =     -16.906223066268
             les_mean =     286.155707715778
             stat err =       0.000463727370
             autocorr =       1.282577659881
              std dev =       0.579076434535
             le_variance =       0.335329517034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666293
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666293
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409468874
  error estimate for blocks of size 2^( 2) =       0.000422044636
  error estimate for blocks of size 2^( 3) =       0.000435508189
  error estimate for blocks of size 2^( 4) =       0.000448078037
  error estimate for blocks of size 2^( 5) =       0.000459988361
  error estimate for blocks of size 2^( 6) =       0.000469628974
  error estimate for blocks of size 2^( 7) =       0.000477214108

      target function =                  N/A
              le_mean =     -16.906223066268
             les_mean =     286.155707715776
             stat err =       0.000463727370
             autocorr =       1.282577659886
              std dev =       0.579076434533
             le_variance =       0.335329517032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666292
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335403666292
                                         uncertainty =       0.002993536117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409468874
  error estimate for blocks of size 2^( 2) =       0.000422044636
  error estimate for blocks of size 2^( 3) =       0.000435508189
  error estimate for blocks of size 2^( 4) =       0.000448078037
  error estimate for blocks of size 2^( 5) =       0.000459988361
  error estimate for blocks of size 2^( 6) =       0.000469628974
  error estimate for blocks of size 2^( 7) =       0.000477214108

      target function =                  N/A
              le_mean =     -16.906223066268
             les_mean =     286.155707715774
             stat err =       0.000463727370
             autocorr =       1.282577659888
              std dev =       0.579076434532
             le_variance =       0.335329517030


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906223066268        initial  <--
     6.1035e+07     6.1035e+08             5.3267e-12       -16.906223066268
     2.4414e+08     2.4414e+09             1.3317e-12       -16.906223066268
     9.7656e+08     9.7656e+09             3.3186e-13       -16.906223066268

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1693
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9413
    reference variance = 0.236308
====================================================
  Execution time = 2.0256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347097781781
                                         uncertainty =       0.006791184030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347097781781
                                         uncertainty =       0.006791184030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416544612
  error estimate for blocks of size 2^( 2) =       0.000429314174
  error estimate for blocks of size 2^( 3) =       0.000442201257
  error estimate for blocks of size 2^( 4) =       0.000454146387
  error estimate for blocks of size 2^( 5) =       0.000464926424
  error estimate for blocks of size 2^( 6) =       0.000472436184
  error estimate for blocks of size 2^( 7) =       0.000477228654

      target function =                  N/A
              le_mean =     -16.906208119868
             les_mean =     286.166891647028
             stat err =       0.000467184412
             autocorr =       1.257921801653
              std dev =       0.589083040186
             le_variance =       0.347018828235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620811987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906208119868       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906208119868       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906208119868       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906207754493       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906207742685       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906205715933       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906211008914       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906207890182       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 4.863503e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906208119868       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906208119868       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906208119868       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906208119868       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906208426922       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906209514071       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906209646616       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906208274015       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 1.214117e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906208119868       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906208119868       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906208119868       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906209150378       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906208119868       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906209790220       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906208021523       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906207722449       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 3.034697e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5870e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9335
    reference variance = 0.383687
====================================================
  Execution time = 1.9701e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3926e-01
  Total weights = 2.0000e+06
  Execution time = 1.8769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863580
  error estimate for blocks of size 2^( 2) =       0.000424787271
  error estimate for blocks of size 2^( 3) =       0.000438103057
  error estimate for blocks of size 2^( 4) =       0.000450517802
  error estimate for blocks of size 2^( 5) =       0.000461360023
  error estimate for blocks of size 2^( 6) =       0.000469913463
  error estimate for blocks of size 2^( 7) =       0.000475042745

      target function =                  N/A
              le_mean =     -16.905629940599
             les_mean =     286.139586736696
             stat err =       0.000464208508
             autocorr =       1.270338355969
              std dev =       0.582463061368
             le_variance =       0.339263217858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863580
  error estimate for blocks of size 2^( 2) =       0.000424787271
  error estimate for blocks of size 2^( 3) =       0.000438103057
  error estimate for blocks of size 2^( 4) =       0.000450517802
  error estimate for blocks of size 2^( 5) =       0.000461360023
  error estimate for blocks of size 2^( 6) =       0.000469913463
  error estimate for blocks of size 2^( 7) =       0.000475042745

      target function =                  N/A
              le_mean =     -16.905629940599
             les_mean =     286.139586736696
             stat err =       0.000464208508
             autocorr =       1.270338355974
              std dev =       0.582463061368
             le_variance =       0.339263217858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863580
  error estimate for blocks of size 2^( 2) =       0.000424787271
  error estimate for blocks of size 2^( 3) =       0.000438103057
  error estimate for blocks of size 2^( 4) =       0.000450517802
  error estimate for blocks of size 2^( 5) =       0.000461360023
  error estimate for blocks of size 2^( 6) =       0.000469913463
  error estimate for blocks of size 2^( 7) =       0.000475042745

      target function =                  N/A
              le_mean =     -16.905629940599
             les_mean =     286.139586736696
             stat err =       0.000464208508
             autocorr =       1.270338355973
              std dev =       0.582463061368
             le_variance =       0.339263217858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339292654495
                                         uncertainty =       0.004099957957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863580
  error estimate for blocks of size 2^( 2) =       0.000424787271
  error estimate for blocks of size 2^( 3) =       0.000438103057
  error estimate for blocks of size 2^( 4) =       0.000450517802
  error estimate for blocks of size 2^( 5) =       0.000461360023
  error estimate for blocks of size 2^( 6) =       0.000469913463
  error estimate for blocks of size 2^( 7) =       0.000475042745

      target function =                  N/A
              le_mean =     -16.905629940599
             les_mean =     286.139586736696
             stat err =       0.000464208508
             autocorr =       1.270338355974
              std dev =       0.582463061368
             le_variance =       0.339263217858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905629940599        initial  <--
     6.1035e+08     6.1035e+09             4.8635e-13       -16.905629940599
     2.4414e+09     2.4414e+10             1.2141e-13       -16.905629940599
     9.7656e+09     9.7656e+10             3.0347e-14       -16.905629940599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1728
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.7929
    reference variance = 0.597376
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3564e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335650500009
                                         uncertainty =       0.002890576249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335650500009
                                         uncertainty =       0.002890576249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409659233
  error estimate for blocks of size 2^( 2) =       0.000423029696
  error estimate for blocks of size 2^( 3) =       0.000436582666
  error estimate for blocks of size 2^( 4) =       0.000449743889
  error estimate for blocks of size 2^( 5) =       0.000461762735
  error estimate for blocks of size 2^( 6) =       0.000470739708
  error estimate for blocks of size 2^( 7) =       0.000477563002

      target function =                  N/A
              le_mean =     -16.905514185045
             les_mean =     286.132051067717
             stat err =       0.000464952334
             autocorr =       1.288164622910
              std dev =       0.579345643606
             le_variance =       0.335641374765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551418505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905514185045       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905514185045       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905514185045       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905512472561       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905512593220       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905511568792       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905514088967       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905513888838       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 4.777952e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905514185045       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905514185045       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905514185045       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905514506891       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905513411335       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905508678998       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905513751328       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905517090044       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905522099626       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 1.195941e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905514185045       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905514185045       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905514185045       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905503220566       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905498001902       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905513116075       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905504511560       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654080026       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905614219302       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905407310960       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905656120421       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906758398421       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.903983928692       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905142585916       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896617202325       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.896338086573       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909465989108       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904901787854       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904469896168       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908184653421       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.916786679906       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.895344172134       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906223686786       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.922280242188       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.895307055490       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.910031261108       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.895250999161       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.896235854576       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906451648398       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.934080638331       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.910874280443       residual = 3.84e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.903977295757       residual = 4.28e-04           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 2.626463e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6005e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.280012
====================================================
  Execution time = 2.1849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4318e-01
  Total weights = 2.0000e+06
  Execution time = 1.8805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414235727
  error estimate for blocks of size 2^( 2) =       0.000427393460
  error estimate for blocks of size 2^( 3) =       0.000440350475
  error estimate for blocks of size 2^( 4) =       0.000452514072
  error estimate for blocks of size 2^( 5) =       0.000463173202
  error estimate for blocks of size 2^( 6) =       0.000470858520
  error estimate for blocks of size 2^( 7) =       0.000475342695

      target function =                  N/A
              le_mean =     -16.904795999059
             les_mean =     286.115310073808
             stat err =       0.000465472122
             autocorr =       1.262676925802
              std dev =       0.585817783614
             le_variance =       0.343182475599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414235727
  error estimate for blocks of size 2^( 2) =       0.000427393460
  error estimate for blocks of size 2^( 3) =       0.000440350475
  error estimate for blocks of size 2^( 4) =       0.000452514072
  error estimate for blocks of size 2^( 5) =       0.000463173202
  error estimate for blocks of size 2^( 6) =       0.000470858520
  error estimate for blocks of size 2^( 7) =       0.000475342695

      target function =                  N/A
              le_mean =     -16.904795999059
             les_mean =     286.115310073808
             stat err =       0.000465472122
             autocorr =       1.262676925803
              std dev =       0.585817783614
             le_variance =       0.343182475599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414235727
  error estimate for blocks of size 2^( 2) =       0.000427393460
  error estimate for blocks of size 2^( 3) =       0.000440350475
  error estimate for blocks of size 2^( 4) =       0.000452514072
  error estimate for blocks of size 2^( 5) =       0.000463173202
  error estimate for blocks of size 2^( 6) =       0.000470858520
  error estimate for blocks of size 2^( 7) =       0.000475342695

      target function =                  N/A
              le_mean =     -16.904795999059
             les_mean =     286.115310073808
             stat err =       0.000465472122
             autocorr =       1.262676925801
              std dev =       0.585817783614
             le_variance =       0.343182475599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343274184033
                                         uncertainty =       0.006242082074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414235727
  error estimate for blocks of size 2^( 2) =       0.000427393460
  error estimate for blocks of size 2^( 3) =       0.000440350475
  error estimate for blocks of size 2^( 4) =       0.000452514072
  error estimate for blocks of size 2^( 5) =       0.000463173202
  error estimate for blocks of size 2^( 6) =       0.000470858520
  error estimate for blocks of size 2^( 7) =       0.000475342695

      target function =                  N/A
              le_mean =     -16.904795999059
             les_mean =     286.115310073808
             stat err =       0.000465472122
             autocorr =       1.262676925802
              std dev =       0.585817783614
             le_variance =       0.343182475598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904795999059        initial
     6.1035e+09     6.1035e+10             4.7780e-14       -16.904795999059
     2.4414e+10     2.4414e+11             1.1959e-14       -16.904795999059
     9.7656e+10     9.7656e+11             2.6265e-15       -16.904795999059  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+10     and shift_s =   9.7656e+11
*****************************************************************************

  Execution time = 3.5279e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.332284
====================================================
  Execution time = 2.0247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3698e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336933363945
                                         uncertainty =       0.003754179935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336933363945
                                         uncertainty =       0.003754179935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410478380
  error estimate for blocks of size 2^( 2) =       0.000423267842
  error estimate for blocks of size 2^( 3) =       0.000436264354
  error estimate for blocks of size 2^( 4) =       0.000449083375
  error estimate for blocks of size 2^( 5) =       0.000460741933
  error estimate for blocks of size 2^( 6) =       0.000469155796
  error estimate for blocks of size 2^( 7) =       0.000471886583

      target function =                  N/A
              le_mean =     -16.907171678700
             les_mean =     286.189439004716
             stat err =       0.000462716922
             autocorr =       1.270720949507
              std dev =       0.580504091437
             le_variance =       0.336985000176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690717167870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907171678700       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907171678700       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907171678700       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907171678700       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907184102899       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907200705672       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907177913652       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907166310370       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907193694196       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907082857149       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907237515162       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907097182341       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906921475522       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906215614713       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907386669212       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907110018849       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906522533563       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906152585575       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906803249648       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907371131114       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908276402439       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.907264880143       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904201168191       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907339924996       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908279619182       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.911595546070       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903874053763       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906973043065       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906877129539       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906529568920       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908292186074       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.900994757667       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906239237936       residual = 1.17e-04           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 1.441678e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907171678700       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907171678700       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907171678700       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907171678700       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907171678700       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907204047993       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907175870910       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907185854135       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906962718866       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907466938120       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907346790713       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907244125744       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905142732076       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907079271443       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907076847694       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906907966733       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.912257584368       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905185293014       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906525656905       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908863612321       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906322815942       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906763539349       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909300030918       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906050025808       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.920273621765       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.927800189167       residual = 5.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.904571910157       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.912122833572       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909122191839       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.900845702455       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.916682168724       residual = 1.06e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.910839764657       residual = 2.21e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.915946978549       residual = 1.14e-02           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.22e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 3.532016e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907171678700       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907171678700       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907171678700       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907171678700       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906843069586       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906906570784       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906321086053       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.899778615342       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906537126474       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909185680845       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906011027235       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908878248193       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.914232391664       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.932570530345       residual = 8.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.882547103856       residual = 8.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.912128027982       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.935439309476       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907253421395       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.901203672839       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905447301700       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.886429955203       residual = 6.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.952443300541       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.979891654061       residual = 7.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.898313424601       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908127504457       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.901740032430       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.893204495321       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.890787854765       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.922626465423       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.919732045588       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.822372531929       residual = 9.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.947821604057       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.894924685111       residual = 3.23e-02           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 6.141084e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5887e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9477
    reference variance = 0.249349
====================================================
  Execution time = 1.9771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5131e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419112181
  error estimate for blocks of size 2^( 2) =       0.000432126127
  error estimate for blocks of size 2^( 3) =       0.000445364152
  error estimate for blocks of size 2^( 4) =       0.000458371011
  error estimate for blocks of size 2^( 5) =       0.000469051583
  error estimate for blocks of size 2^( 6) =       0.000476586991
  error estimate for blocks of size 2^( 7) =       0.000482363078

      target function =                  N/A
              le_mean =     -16.906171429636
             les_mean =     286.169942272511
             stat err =       0.000471593166
             autocorr =       1.266118747977
              std dev =       0.592714130019
             le_variance =       0.351310039924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419112181
  error estimate for blocks of size 2^( 2) =       0.000432126127
  error estimate for blocks of size 2^( 3) =       0.000445364152
  error estimate for blocks of size 2^( 4) =       0.000458371011
  error estimate for blocks of size 2^( 5) =       0.000469051583
  error estimate for blocks of size 2^( 6) =       0.000476586991
  error estimate for blocks of size 2^( 7) =       0.000482363078

      target function =                  N/A
              le_mean =     -16.906171429636
             les_mean =     286.169942272511
             stat err =       0.000471593166
             autocorr =       1.266118747972
              std dev =       0.592714130019
             le_variance =       0.351310039924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419112181
  error estimate for blocks of size 2^( 2) =       0.000432126127
  error estimate for blocks of size 2^( 3) =       0.000445364152
  error estimate for blocks of size 2^( 4) =       0.000458371011
  error estimate for blocks of size 2^( 5) =       0.000469051583
  error estimate for blocks of size 2^( 6) =       0.000476586991
  error estimate for blocks of size 2^( 7) =       0.000482363078

      target function =                  N/A
              le_mean =     -16.906171429636
             les_mean =     286.169942272511
             stat err =       0.000471593166
             autocorr =       1.266118747977
              std dev =       0.592714130019
             le_variance =       0.351310039924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351186132922
                                         uncertainty =       0.011011374673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419112181
  error estimate for blocks of size 2^( 2) =       0.000432126127
  error estimate for blocks of size 2^( 3) =       0.000445364152
  error estimate for blocks of size 2^( 4) =       0.000458371011
  error estimate for blocks of size 2^( 5) =       0.000469051583
  error estimate for blocks of size 2^( 6) =       0.000476586991
  error estimate for blocks of size 2^( 7) =       0.000482363078

      target function =                  N/A
              le_mean =     -16.906171429636
             les_mean =     286.169942272511
             stat err =       0.000471593166
             autocorr =       1.266118747977
              std dev =       0.592714130019
             le_variance =       0.351310039924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906171429636        initial  <--
     2.4414e+10     2.4414e+11             1.4417e-14       -16.906171429636
     9.7656e+10     9.7656e+11             3.5320e-15       -16.906171429636
     3.9062e+11     3.9062e+12             6.1411e-16       -16.906171429636

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2538
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8577
    reference variance = 0.178848
====================================================
  Execution time = 2.0270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4807e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348161010203
                                         uncertainty =       0.005557308801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348161010203
                                         uncertainty =       0.005557308801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417176321
  error estimate for blocks of size 2^( 2) =       0.000429930277
  error estimate for blocks of size 2^( 3) =       0.000442580204
  error estimate for blocks of size 2^( 4) =       0.000455208608
  error estimate for blocks of size 2^( 5) =       0.000466328812
  error estimate for blocks of size 2^( 6) =       0.000477518034
  error estimate for blocks of size 2^( 7) =       0.000482377813

      target function =                  N/A
              le_mean =     -16.905610173362
             les_mean =     286.147727325211
             stat err =       0.000470358317
             autocorr =       1.271213087587
              std dev =       0.589976411037
             le_variance =       0.348072165580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561017336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905610173362       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905610173362       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905610173362       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905549730198       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905616196213       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905681233529       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906513173377       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905792413259       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905281767932       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904925510220       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907394134372       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904716962758       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.902928309922       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.898978908722       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.912969657269       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909202016515       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.896362986706       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910930525138       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.901343892599       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905723300592       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.898827189931       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908962884733       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.923900051862       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904965524064       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.894170427600       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.895341097485       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.887283718084       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.858810018418       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.896870849475       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.892229589792       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.916399811490       residual = 1.39e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.897536655763       residual = 9.38e-03           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 1.034853e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905610173362       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905610173362       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905610173362       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905487126008       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628986041       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909274633900       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908142712373       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.901182236157       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903931393086       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903717813874       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.916652566194       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893945551538       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.881065435176       residual = 7.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.896989557391       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.889850758531       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.861768730240       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904555970060       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.969316902076       residual = 4.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.925069322952       residual = 5.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.928612442604       residual = 7.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.997626978565       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.038466631774       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.971858197123       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.938108086848       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.920682794764       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893463235972       residual = 5.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.944436566538       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.016840870541       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.903119729122       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.840083057152       residual = 5.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.922024682304       residual = 6.32e-02           smallest_sin_value = 9.97e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.838137828465       residual = 5.68e-01           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 6.031728e-17

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905610173362       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905610173362       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5817e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8644
    reference variance = 0.270826
====================================================
  Execution time = 1.9970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4690e-01
  Total weights = 2.0000e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416470448
  error estimate for blocks of size 2^( 2) =       0.000428619523
  error estimate for blocks of size 2^( 3) =       0.000441964109
  error estimate for blocks of size 2^( 4) =       0.000453328000
  error estimate for blocks of size 2^( 5) =       0.000464783655
  error estimate for blocks of size 2^( 6) =       0.000473050229
  error estimate for blocks of size 2^( 7) =       0.000477784792

      target function =                  N/A
              le_mean =     -16.905277607016
             les_mean =     286.135306064640
             stat err =       0.000467236669
             autocorr =       1.258651385360
              std dev =       0.588978155640
             le_variance =       0.346895267822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416470448
  error estimate for blocks of size 2^( 2) =       0.000428619523
  error estimate for blocks of size 2^( 3) =       0.000441964109
  error estimate for blocks of size 2^( 4) =       0.000453328000
  error estimate for blocks of size 2^( 5) =       0.000464783655
  error estimate for blocks of size 2^( 6) =       0.000473050229
  error estimate for blocks of size 2^( 7) =       0.000477784792

      target function =                  N/A
              le_mean =     -16.905277607016
             les_mean =     286.135306064640
             stat err =       0.000467236669
             autocorr =       1.258651385360
              std dev =       0.588978155640
             le_variance =       0.346895267822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416470448
  error estimate for blocks of size 2^( 2) =       0.000428619523
  error estimate for blocks of size 2^( 3) =       0.000441964109
  error estimate for blocks of size 2^( 4) =       0.000453328000
  error estimate for blocks of size 2^( 5) =       0.000464783655
  error estimate for blocks of size 2^( 6) =       0.000473050229
  error estimate for blocks of size 2^( 7) =       0.000477784792

      target function =                  N/A
              le_mean =     -16.905277607016
             les_mean =     286.135306064640
             stat err =       0.000467236669
             autocorr =       1.258651385360
              std dev =       0.588978155640
             le_variance =       0.346895267822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347015170285
                                         uncertainty =       0.010166491513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416470448
  error estimate for blocks of size 2^( 2) =       0.000428619523
  error estimate for blocks of size 2^( 3) =       0.000441964109
  error estimate for blocks of size 2^( 4) =       0.000453328000
  error estimate for blocks of size 2^( 5) =       0.000464783655
  error estimate for blocks of size 2^( 6) =       0.000473050229
  error estimate for blocks of size 2^( 7) =       0.000477784792

      target function =                  N/A
              le_mean =     -16.905277607016
             les_mean =     286.135306064640
             stat err =       0.000467236669
             autocorr =       1.258651385360
              std dev =       0.588978155640
             le_variance =       0.346895267822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905277607016        initial  <--
     2.4414e+11     2.4414e+12             1.0349e-15       -16.905277607016
     9.7656e+11     9.7656e+12             6.0317e-17       -16.905277607016
     3.9062e+12     3.9062e+13             0.0000e+00       -16.905277607016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4168
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.184754
====================================================
  Execution time = 2.0390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4212e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342118044586
                                         uncertainty =       0.006261541692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342118044586
                                         uncertainty =       0.006261541692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413596368
  error estimate for blocks of size 2^( 2) =       0.000425931355
  error estimate for blocks of size 2^( 3) =       0.000438578436
  error estimate for blocks of size 2^( 4) =       0.000450820937
  error estimate for blocks of size 2^( 5) =       0.000460091939
  error estimate for blocks of size 2^( 6) =       0.000466430669
  error estimate for blocks of size 2^( 7) =       0.000471183539

      target function =                  N/A
              le_mean =     -16.905348285681
             les_mean =     286.132924400041
             stat err =       0.000462131771
             autocorr =       1.248470316130
              std dev =       0.584913592693
             le_variance =       0.342123910917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534828568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905348285681       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905348285681       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905348285681       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905348285681       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903484717350       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.897018291085       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.898723478777       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.884745580508       residual = 5.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.923552841676       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.974315660777       residual = 6.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.936018301197       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.027472369747       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.814182890392       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.888044410657       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.108751935666       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.334368218117       residual = 2.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.874636697947       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.824236387406       residual = 9.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.245460667404       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.870864227512       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.112099875787       residual = 5.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903224034377       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.103910451297       residual = 5.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.193067309967       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.037867958921       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.868074282389       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.706742188937       residual = 5.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.255763666911       residual = 6.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.705972544410       residual = 6.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.404729716618       residual = 3.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.167115388062       residual = 1.05e+01           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.167943876538       residual = 8.95e+00           smallest_sin_value = 9.97e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.844556267816       residual = 6.76e-01           smallest_sin_value = 9.91e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.41e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 3.808205e-17

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905348285681       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905348285681       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905348285681       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905065530079       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087306974       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.931319653734       residual = 9.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.927404024178       residual = 6.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.922656450808       residual = 4.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.902809957735       residual = 6.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.901766667200       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.968377430524       residual = 4.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.877974671258       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.824375185862       residual = 8.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.029820069996       residual = 2.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.875412380116       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.735443718441       residual = 9.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.955069542344       residual = 5.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.754681351067       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.050871839053       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.154218723714       residual = 9.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.417841977964       residual = 3.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.160804211702       residual = 9.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.391588719021       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.500767535387       residual = 4.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.894409044601       residual = 5.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.840148676688       residual = 3.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.752310866578       residual = 6.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.251853918818       residual = 1.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907216095555       residual = 7.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -15.608695784379       residual = 2.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -15.492104535079       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -18.830367748774       residual = 5.48e+02           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.520924085856       residual = 1.90e+01           smallest_sin_value = 9.96e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 9.520511e-18

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905348285681       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905348285681       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905348285681       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904831519358       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905348285681       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.963046636892       residual = 5.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.242258706132       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911943023369       residual = 6.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.012907275136       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.134536757748       residual = 7.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.035345413332       residual = 1.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.345565962137       residual = 4.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -14.739980100407       residual = 5.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.701495270265       residual = 5.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -18.017898533422       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.755107219430       residual = 4.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.349504288156       residual = 2.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -15.311586283888       residual = 3.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -19.872755754119       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.689355977379       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -13.590033451537       residual = 1.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.946310392896       residual = 9.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.135454177249       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -18.419091054905       residual = 4.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.365964839837       residual = 1.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.096764567529       residual = 4.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.279999617726       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.235041353219       residual = 2.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -13.574610914934       residual = 1.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -15.007344332463       residual = 1.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.641914449956       residual = 2.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 2.380128e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5947e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.185556
====================================================
  Execution time = 2.0067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3504e-01
  Total weights = 2.0000e+06
  Execution time = 1.8743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409291982
  error estimate for blocks of size 2^( 2) =       0.000421815358
  error estimate for blocks of size 2^( 3) =       0.000434764186
  error estimate for blocks of size 2^( 4) =       0.000446760082
  error estimate for blocks of size 2^( 5) =       0.000456555244
  error estimate for blocks of size 2^( 6) =       0.000465469051
  error estimate for blocks of size 2^( 7) =       0.000469919307

      target function =                  N/A
              le_mean =     -16.905411593189
             les_mean =     286.127980820165
             stat err =       0.000459675921
             autocorr =       1.261354138276
              std dev =       0.578826271470
             le_variance =       0.335039852544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409291982
  error estimate for blocks of size 2^( 2) =       0.000421815358
  error estimate for blocks of size 2^( 3) =       0.000434764186
  error estimate for blocks of size 2^( 4) =       0.000446760082
  error estimate for blocks of size 2^( 5) =       0.000456555244
  error estimate for blocks of size 2^( 6) =       0.000465469051
  error estimate for blocks of size 2^( 7) =       0.000469919307

      target function =                  N/A
              le_mean =     -16.905411593189
             les_mean =     286.127980820165
             stat err =       0.000459675921
             autocorr =       1.261354138276
              std dev =       0.578826271470
             le_variance =       0.335039852544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409291982
  error estimate for blocks of size 2^( 2) =       0.000421815358
  error estimate for blocks of size 2^( 3) =       0.000434764186
  error estimate for blocks of size 2^( 4) =       0.000446760082
  error estimate for blocks of size 2^( 5) =       0.000456555244
  error estimate for blocks of size 2^( 6) =       0.000465469051
  error estimate for blocks of size 2^( 7) =       0.000469919307

      target function =                  N/A
              le_mean =     -16.905411593189
             les_mean =     286.127980820165
             stat err =       0.000459675921
             autocorr =       1.261354138276
              std dev =       0.578826271470
             le_variance =       0.335039852544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334914570001
                                         uncertainty =       0.003361821500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409291982
  error estimate for blocks of size 2^( 2) =       0.000421815358
  error estimate for blocks of size 2^( 3) =       0.000434764186
  error estimate for blocks of size 2^( 4) =       0.000446760082
  error estimate for blocks of size 2^( 5) =       0.000456555244
  error estimate for blocks of size 2^( 6) =       0.000465469051
  error estimate for blocks of size 2^( 7) =       0.000469919307

      target function =                  N/A
              le_mean =     -16.905411593189
             les_mean =     286.127980820165
             stat err =       0.000459675921
             autocorr =       1.261354138276
              std dev =       0.578826271470
             le_variance =       0.335039852544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905411593189        initial  <--
     2.4414e+12     2.4414e+13             3.8082e-17       -16.905411593189
     9.7656e+12     9.7656e+13             9.5205e-18       -16.905411593189
     3.9062e+13     3.9062e+14             2.3801e-18       -16.905411593189

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5329
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.634651
====================================================
  Execution time = 2.0266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333015304124
                                         uncertainty =       0.002959863629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333015304124
                                         uncertainty =       0.002959863629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408116114
  error estimate for blocks of size 2^( 2) =       0.000420816245
  error estimate for blocks of size 2^( 3) =       0.000434691716
  error estimate for blocks of size 2^( 4) =       0.000447611487
  error estimate for blocks of size 2^( 5) =       0.000459687665
  error estimate for blocks of size 2^( 6) =       0.000468367718
  error estimate for blocks of size 2^( 7) =       0.000472503201

      target function =                  N/A
              le_mean =     -16.905297402214
             les_mean =     286.122197615786
             stat err =       0.000462042518
             autocorr =       1.281729553719
              std dev =       0.577163343459
             le_variance =       0.333117525033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529740221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905297402214       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905297402214       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905297402214       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903813068498       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.934870910545       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.818269915016       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.665217375144       residual = 7.84e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.089332818215       residual = 4.41e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.069032120733       residual = 3.33e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.327669376214       residual = 2.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.947988293149       residual = 6.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.543481374095       residual = 1.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.319637589732       residual = 4.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.041828078886       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.034328628503       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.062067374292       residual = 3.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.347698481187       residual = 4.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.286937269692       residual = 4.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.010387724927       residual = 1.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.539012132522       residual = 2.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.358488165290       residual = 3.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.798740534680       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.834676300107       residual = 1.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -12.022672435419       residual = 3.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.836682776059       residual = 4.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.325404366328       residual = 2.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.889054290621       residual = 1.37e+02           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -14.874094859730       residual = 5.23e+02           smallest_sin_value = 9.94e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 3.791303e-18

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905297402214       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905297402214       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905297402214       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905297402210       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.390853582041       residual = 3.44e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.206685052999       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.957168546066       residual = 7.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.981637964556       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.849759824123       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.744761564574       residual = 9.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.404062488293       residual = 2.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -15.166472193781       residual = 4.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.330819651026       residual = 8.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -20.840018654315       residual = 1.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -20.972542003186       residual = 2.34e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.427239844994       residual = 3.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -12.700432132241       residual = 2.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -24.837318212230       residual = 7.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -12.002021612973       residual = 3.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   19 stopping due to too large eigenvalue change
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 9.478258e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905297402214       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905297402214       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905297402214       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.971877106329       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.648285058271       residual = 9.55e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.337173772158       residual = 2.84e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.388597743595       residual = 5.68e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -15.607123023269       residual = 1.93e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.733548986358       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -18.222661174450       residual = 2.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -15.218792479961       residual = 4.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -11.842358631536       residual = 3.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -13.416335182157       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -11.627773115341       residual = 3.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -20.754696640285       residual = 2.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =      -8.689745386916       residual = 9.35e+03           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+14 is 2.369564e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5920e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9179
    reference variance = 0.380384
====================================================
  Execution time = 1.9763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411965208
  error estimate for blocks of size 2^( 2) =       0.000424627606
  error estimate for blocks of size 2^( 3) =       0.000437911616
  error estimate for blocks of size 2^( 4) =       0.000451048296
  error estimate for blocks of size 2^( 5) =       0.000460418791
  error estimate for blocks of size 2^( 6) =       0.000466598291
  error estimate for blocks of size 2^( 7) =       0.000472997475

      target function =                  N/A
              le_mean =     -16.905785534493
             les_mean =     286.145015034127
             stat err =       0.000462765713
             autocorr =       1.261831219311
              std dev =       0.582606784680
             le_variance =       0.339430665555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411965208
  error estimate for blocks of size 2^( 2) =       0.000424627606
  error estimate for blocks of size 2^( 3) =       0.000437911616
  error estimate for blocks of size 2^( 4) =       0.000451048296
  error estimate for blocks of size 2^( 5) =       0.000460418791
  error estimate for blocks of size 2^( 6) =       0.000466598291
  error estimate for blocks of size 2^( 7) =       0.000472997475

      target function =                  N/A
              le_mean =     -16.905785534493
             les_mean =     286.145015034127
             stat err =       0.000462765713
             autocorr =       1.261831219311
              std dev =       0.582606784680
             le_variance =       0.339430665555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411965208
  error estimate for blocks of size 2^( 2) =       0.000424627606
  error estimate for blocks of size 2^( 3) =       0.000437911616
  error estimate for blocks of size 2^( 4) =       0.000451048296
  error estimate for blocks of size 2^( 5) =       0.000460418791
  error estimate for blocks of size 2^( 6) =       0.000466598291
  error estimate for blocks of size 2^( 7) =       0.000472997475

      target function =                  N/A
              le_mean =     -16.905785534493
             les_mean =     286.145015034127
             stat err =       0.000462765713
             autocorr =       1.261831219311
              std dev =       0.582606784680
             le_variance =       0.339430665555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339335881009
                                         uncertainty =       0.005980606567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411965208
  error estimate for blocks of size 2^( 2) =       0.000424627606
  error estimate for blocks of size 2^( 3) =       0.000437911616
  error estimate for blocks of size 2^( 4) =       0.000451048296
  error estimate for blocks of size 2^( 5) =       0.000460418791
  error estimate for blocks of size 2^( 6) =       0.000466598291
  error estimate for blocks of size 2^( 7) =       0.000472997475

      target function =                  N/A
              le_mean =     -16.905785534493
             les_mean =     286.145015034127
             stat err =       0.000462765713
             autocorr =       1.261831219311
              std dev =       0.582606784680
             le_variance =       0.339430665555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905785534493        initial  <--
     2.4414e+13     2.4414e+14             3.7913e-18       -16.905785534493
     9.7656e+13     9.7656e+14             9.4783e-19       -16.905785534493
     3.9062e+14     3.9062e+15             2.3696e-19       -16.905785534493

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1959
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8754
    reference variance = 0.181404
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4543e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345503766889
                                         uncertainty =       0.004306847732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345503766889
                                         uncertainty =       0.004306847732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415589132
  error estimate for blocks of size 2^( 2) =       0.000428167952
  error estimate for blocks of size 2^( 3) =       0.000441274318
  error estimate for blocks of size 2^( 4) =       0.000453886374
  error estimate for blocks of size 2^( 5) =       0.000465712111
  error estimate for blocks of size 2^( 6) =       0.000473906189
  error estimate for blocks of size 2^( 7) =       0.000479419299

      target function =                  N/A
              le_mean =     -16.905452769753
             les_mean =     286.139761830732
             stat err =       0.000468230993
             autocorr =       1.269380875693
              std dev =       0.587731786706
             le_variance =       0.345428653104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545276975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905452769753       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905452769753       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905452769753       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905452769753       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905452769753       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905452769753       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.421495154608       residual = 3.16e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.706176827835       residual = 4.93e+00           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 9.136455e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905452769753       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905452769753       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5841e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9227
    reference variance = 0.212863
====================================================
  Execution time = 2.0071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3784e-01
  Total weights = 2.0000e+06
  Execution time = 2.4551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410998772
  error estimate for blocks of size 2^( 2) =       0.000423989319
  error estimate for blocks of size 2^( 3) =       0.000437351515
  error estimate for blocks of size 2^( 4) =       0.000449391859
  error estimate for blocks of size 2^( 5) =       0.000459597079
  error estimate for blocks of size 2^( 6) =       0.000468419023
  error estimate for blocks of size 2^( 7) =       0.000470947900

      target function =                  N/A
              le_mean =     -16.906695561522
             les_mean =     286.174194621692
             stat err =       0.000462088965
             autocorr =       1.264067155585
              std dev =       0.581240037021
             le_variance =       0.337839980636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410998772
  error estimate for blocks of size 2^( 2) =       0.000423989319
  error estimate for blocks of size 2^( 3) =       0.000437351515
  error estimate for blocks of size 2^( 4) =       0.000449391859
  error estimate for blocks of size 2^( 5) =       0.000459597079
  error estimate for blocks of size 2^( 6) =       0.000468419023
  error estimate for blocks of size 2^( 7) =       0.000470947900

      target function =                  N/A
              le_mean =     -16.906695561522
             les_mean =     286.174194621692
             stat err =       0.000462088965
             autocorr =       1.264067155585
              std dev =       0.581240037021
             le_variance =       0.337839980636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410998772
  error estimate for blocks of size 2^( 2) =       0.000423989319
  error estimate for blocks of size 2^( 3) =       0.000437351515
  error estimate for blocks of size 2^( 4) =       0.000449391859
  error estimate for blocks of size 2^( 5) =       0.000459597079
  error estimate for blocks of size 2^( 6) =       0.000468419023
  error estimate for blocks of size 2^( 7) =       0.000470947900

      target function =                  N/A
              le_mean =     -16.906695561522
             les_mean =     286.174194621692
             stat err =       0.000462088965
             autocorr =       1.264067155585
              std dev =       0.581240037021
             le_variance =       0.337839980636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337867554449
                                         uncertainty =       0.002717743798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410998772
  error estimate for blocks of size 2^( 2) =       0.000423989319
  error estimate for blocks of size 2^( 3) =       0.000437351515
  error estimate for blocks of size 2^( 4) =       0.000449391859
  error estimate for blocks of size 2^( 5) =       0.000459597079
  error estimate for blocks of size 2^( 6) =       0.000468419023
  error estimate for blocks of size 2^( 7) =       0.000470947900

      target function =                  N/A
              le_mean =     -16.906695561522
             les_mean =     286.174194621692
             stat err =       0.000462088965
             autocorr =       1.264067155585
              std dev =       0.581240037021
             le_variance =       0.337839980636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906695561522        initial  <--
     2.4414e+14     2.4414e+15             0.0000e+00       -16.906695561522
     9.7656e+14     9.7656e+15             9.1365e-20       -16.906695561522
     3.9062e+15     3.9062e+16             0.0000e+00       -16.906695561522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2808
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.160564
====================================================
  Execution time = 2.1822e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337780632691
                                         uncertainty =       0.004566576308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337780632691
                                         uncertainty =       0.004566576308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410924059
  error estimate for blocks of size 2^( 2) =       0.000423826820
  error estimate for blocks of size 2^( 3) =       0.000436850986
  error estimate for blocks of size 2^( 4) =       0.000449168453
  error estimate for blocks of size 2^( 5) =       0.000460366391
  error estimate for blocks of size 2^( 6) =       0.000469338489
  error estimate for blocks of size 2^( 7) =       0.000476666120

      target function =                  N/A
              le_mean =     -16.906282190676
             les_mean =     286.160094506897
             stat err =       0.000463884863
             autocorr =       1.274375060090
              std dev =       0.581134377734
             le_variance =       0.337717164985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628219068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282190676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282190676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282190676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282190676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282190676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282190676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7536e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9512
    reference variance = 0.217109
====================================================
  Execution time = 1.9734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3453e-01
  Total weights = 2.0000e+06
  Execution time = 1.8732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408979739
  error estimate for blocks of size 2^( 2) =       0.000421460231
  error estimate for blocks of size 2^( 3) =       0.000434265009
  error estimate for blocks of size 2^( 4) =       0.000446985893
  error estimate for blocks of size 2^( 5) =       0.000457731232
  error estimate for blocks of size 2^( 6) =       0.000466849953
  error estimate for blocks of size 2^( 7) =       0.000471722450

      target function =                  N/A
              le_mean =     -16.905809708008
             les_mean =     286.140930570511
             stat err =       0.000460822382
             autocorr =       1.269590141862
              std dev =       0.578384694138
             le_variance =       0.334528854413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408979739
  error estimate for blocks of size 2^( 2) =       0.000421460231
  error estimate for blocks of size 2^( 3) =       0.000434265009
  error estimate for blocks of size 2^( 4) =       0.000446985893
  error estimate for blocks of size 2^( 5) =       0.000457731232
  error estimate for blocks of size 2^( 6) =       0.000466849953
  error estimate for blocks of size 2^( 7) =       0.000471722450

      target function =                  N/A
              le_mean =     -16.905809708008
             les_mean =     286.140930570511
             stat err =       0.000460822382
             autocorr =       1.269590141862
              std dev =       0.578384694138
             le_variance =       0.334528854413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408979739
  error estimate for blocks of size 2^( 2) =       0.000421460231
  error estimate for blocks of size 2^( 3) =       0.000434265009
  error estimate for blocks of size 2^( 4) =       0.000446985893
  error estimate for blocks of size 2^( 5) =       0.000457731232
  error estimate for blocks of size 2^( 6) =       0.000466849953
  error estimate for blocks of size 2^( 7) =       0.000471722450

      target function =                  N/A
              le_mean =     -16.905809708008
             les_mean =     286.140930570511
             stat err =       0.000460822382
             autocorr =       1.269590141862
              std dev =       0.578384694138
             le_variance =       0.334528854413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334551984109
                                         uncertainty =       0.003811499031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408979739
  error estimate for blocks of size 2^( 2) =       0.000421460231
  error estimate for blocks of size 2^( 3) =       0.000434265009
  error estimate for blocks of size 2^( 4) =       0.000446985893
  error estimate for blocks of size 2^( 5) =       0.000457731232
  error estimate for blocks of size 2^( 6) =       0.000466849953
  error estimate for blocks of size 2^( 7) =       0.000471722450

      target function =                  N/A
              le_mean =     -16.905809708008
             les_mean =     286.140930570511
             stat err =       0.000460822382
             autocorr =       1.269590141862
              std dev =       0.578384694138
             le_variance =       0.334528854413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905809708008        initial  <--
     2.4414e+15     2.4414e+16             0.0000e+00       -16.905809708008
     9.7656e+15     9.7656e+16             0.0000e+00       -16.905809708008
     3.9062e+16     3.9062e+17             0.0000e+00       -16.905809708008

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1569
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.215696
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3250e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332597144175
                                         uncertainty =       0.002556067468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332597144175
                                         uncertainty =       0.002556067468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407738759
  error estimate for blocks of size 2^( 2) =       0.000420345834
  error estimate for blocks of size 2^( 3) =       0.000433339711
  error estimate for blocks of size 2^( 4) =       0.000445692275
  error estimate for blocks of size 2^( 5) =       0.000456589397
  error estimate for blocks of size 2^( 6) =       0.000464413329
  error estimate for blocks of size 2^( 7) =       0.000469216738

      target function =                  N/A
              le_mean =     -16.905800855157
             les_mean =     286.138604179888
             stat err =       0.000458977935
             autocorr =       1.267125468798
              std dev =       0.576629683505
             le_variance =       0.332501791899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580085516e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800855157       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800855157       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800855157       residual = 5.08e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800855157       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 5.166497e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800855157       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800855157       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800855157       residual = 5.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 1.291624e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800855157       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800855157       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800855157       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+17 is 3.229061e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5827e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8284
    reference variance = 0.189556
====================================================
  Execution time = 1.9643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3681e-01
  Total weights = 2.0000e+06
  Execution time = 1.8688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410374245
  error estimate for blocks of size 2^( 2) =       0.000422884458
  error estimate for blocks of size 2^( 3) =       0.000435781984
  error estimate for blocks of size 2^( 4) =       0.000447825638
  error estimate for blocks of size 2^( 5) =       0.000457827917
  error estimate for blocks of size 2^( 6) =       0.000466154836
  error estimate for blocks of size 2^( 7) =       0.000470124481

      target function =                  N/A
              le_mean =     -16.905167181006
             les_mean =     286.121491290842
             stat err =       0.000460483218
             autocorr =       1.259120867897
              std dev =       0.580356822542
             le_variance =       0.336814041471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410374245
  error estimate for blocks of size 2^( 2) =       0.000422884458
  error estimate for blocks of size 2^( 3) =       0.000435781984
  error estimate for blocks of size 2^( 4) =       0.000447825638
  error estimate for blocks of size 2^( 5) =       0.000457827917
  error estimate for blocks of size 2^( 6) =       0.000466154836
  error estimate for blocks of size 2^( 7) =       0.000470124481

      target function =                  N/A
              le_mean =     -16.905167181006
             les_mean =     286.121491290842
             stat err =       0.000460483218
             autocorr =       1.259120867897
              std dev =       0.580356822542
             le_variance =       0.336814041471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410374245
  error estimate for blocks of size 2^( 2) =       0.000422884458
  error estimate for blocks of size 2^( 3) =       0.000435781984
  error estimate for blocks of size 2^( 4) =       0.000447825638
  error estimate for blocks of size 2^( 5) =       0.000457827917
  error estimate for blocks of size 2^( 6) =       0.000466154836
  error estimate for blocks of size 2^( 7) =       0.000470124481

      target function =                  N/A
              le_mean =     -16.905167181006
             les_mean =     286.121491290842
             stat err =       0.000460483218
             autocorr =       1.259120867897
              std dev =       0.580356822542
             le_variance =       0.336814041471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863643648
                                         uncertainty =       0.007186299707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410374245
  error estimate for blocks of size 2^( 2) =       0.000422884458
  error estimate for blocks of size 2^( 3) =       0.000435781984
  error estimate for blocks of size 2^( 4) =       0.000447825638
  error estimate for blocks of size 2^( 5) =       0.000457827917
  error estimate for blocks of size 2^( 6) =       0.000466154836
  error estimate for blocks of size 2^( 7) =       0.000470124481

      target function =                  N/A
              le_mean =     -16.905167181006
             les_mean =     286.121491290842
             stat err =       0.000460483218
             autocorr =       1.259120867897
              std dev =       0.580356822542
             le_variance =       0.336814041471


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905167181006        initial  <--
     2.4414e+16     2.4414e+17             5.1665e-21       -16.905167181006
     9.7656e+16     9.7656e+17             1.2916e-21       -16.905167181006
     3.9062e+17     3.9062e+18             3.2291e-22       -16.905167181006

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0865
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4919e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9726
    reference variance = 0.365369
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3740e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337490941949
                                         uncertainty =       0.003285857442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337490941949
                                         uncertainty =       0.003285857442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410734010
  error estimate for blocks of size 2^( 2) =       0.000423045134
  error estimate for blocks of size 2^( 3) =       0.000435605660
  error estimate for blocks of size 2^( 4) =       0.000446321384
  error estimate for blocks of size 2^( 5) =       0.000455629615
  error estimate for blocks of size 2^( 6) =       0.000464668166
  error estimate for blocks of size 2^( 7) =       0.000468143519

      target function =                  N/A
              le_mean =     -16.906349521265
             les_mean =     286.162058820571
             stat err =       0.000458690671
             autocorr =       1.247149406741
              std dev =       0.580865607608
             le_variance =       0.337404854101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634952126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349521265       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349521265       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349521265       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 3.899408e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349521265       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349521265       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349521265       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 9.748521e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349521265       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349521265       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349521265       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+18 is 2.437130e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5800e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8924
    reference variance = 0.221851
====================================================
  Execution time = 1.9737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3688e-01
  Total weights = 2.0000e+06
  Execution time = 1.8659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416340
  error estimate for blocks of size 2^( 2) =       0.000423380149
  error estimate for blocks of size 2^( 3) =       0.000436703613
  error estimate for blocks of size 2^( 4) =       0.000448574565
  error estimate for blocks of size 2^( 5) =       0.000459663835
  error estimate for blocks of size 2^( 6) =       0.000468429334
  error estimate for blocks of size 2^( 7) =       0.000474432552

      target function =                  N/A
              le_mean =     -16.905822658323
             les_mean =     286.143722731073
             stat err =       0.000462775072
             autocorr =       1.271424648201
              std dev =       0.580416354729
             le_variance =       0.336883144837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416340
  error estimate for blocks of size 2^( 2) =       0.000423380149
  error estimate for blocks of size 2^( 3) =       0.000436703613
  error estimate for blocks of size 2^( 4) =       0.000448574565
  error estimate for blocks of size 2^( 5) =       0.000459663835
  error estimate for blocks of size 2^( 6) =       0.000468429334
  error estimate for blocks of size 2^( 7) =       0.000474432552

      target function =                  N/A
              le_mean =     -16.905822658323
             les_mean =     286.143722731073
             stat err =       0.000462775072
             autocorr =       1.271424648201
              std dev =       0.580416354729
             le_variance =       0.336883144837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416340
  error estimate for blocks of size 2^( 2) =       0.000423380149
  error estimate for blocks of size 2^( 3) =       0.000436703613
  error estimate for blocks of size 2^( 4) =       0.000448574565
  error estimate for blocks of size 2^( 5) =       0.000459663835
  error estimate for blocks of size 2^( 6) =       0.000468429334
  error estimate for blocks of size 2^( 7) =       0.000474432552

      target function =                  N/A
              le_mean =     -16.905822658323
             les_mean =     286.143722731073
             stat err =       0.000462775072
             autocorr =       1.271424648201
              std dev =       0.580416354729
             le_variance =       0.336883144837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336841176124
                                         uncertainty =       0.006317524010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416340
  error estimate for blocks of size 2^( 2) =       0.000423380149
  error estimate for blocks of size 2^( 3) =       0.000436703613
  error estimate for blocks of size 2^( 4) =       0.000448574565
  error estimate for blocks of size 2^( 5) =       0.000459663835
  error estimate for blocks of size 2^( 6) =       0.000468429334
  error estimate for blocks of size 2^( 7) =       0.000474432552

      target function =                  N/A
              le_mean =     -16.905822658323
             les_mean =     286.143722731073
             stat err =       0.000462775072
             autocorr =       1.271424648201
              std dev =       0.580416354729
             le_variance =       0.336883144837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905822658323        initial  <--
     2.4414e+17     2.4414e+18             3.8994e-22       -16.905822658323
     9.7656e+17     9.7656e+18             9.7485e-23       -16.905822658323
     3.9062e+18     3.9062e+19             2.4371e-23       -16.905822658323

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1297
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8251
    reference variance = 0.285606
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3709e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337079007675
                                         uncertainty =       0.003557237375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337079007675
                                         uncertainty =       0.003557237375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410544022
  error estimate for blocks of size 2^( 2) =       0.000422864561
  error estimate for blocks of size 2^( 3) =       0.000436079454
  error estimate for blocks of size 2^( 4) =       0.000448711862
  error estimate for blocks of size 2^( 5) =       0.000460080997
  error estimate for blocks of size 2^( 6) =       0.000467220163
  error estimate for blocks of size 2^( 7) =       0.000472507090

      target function =                  N/A
              le_mean =     -16.905747668615
             les_mean =     286.141396853971
             stat err =       0.000462130028
             autocorr =       1.267094228468
              std dev =       0.580596923536
             le_variance =       0.337092787619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574766862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747668615       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747668615       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747668615       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 4.031426e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747668615       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747668615       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747668615       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 1.007857e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905747668615       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747668615       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747668615       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+19 is 2.519641e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6004e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8682
    reference variance = 0.220571
====================================================
  Execution time = 1.9909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4969e-01
  Total weights = 2.0000e+06
  Execution time = 1.8674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418144290
  error estimate for blocks of size 2^( 2) =       0.000430923722
  error estimate for blocks of size 2^( 3) =       0.000443956950
  error estimate for blocks of size 2^( 4) =       0.000456319940
  error estimate for blocks of size 2^( 5) =       0.000467892562
  error estimate for blocks of size 2^( 6) =       0.000477916240
  error estimate for blocks of size 2^( 7) =       0.000483910705

      target function =                  N/A
              le_mean =     -16.906011201920
             les_mean =     286.162903879389
             stat err =       0.000471509862
             autocorr =       1.271537636782
              std dev =       0.591345326181
             le_variance =       0.349689294796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418144290
  error estimate for blocks of size 2^( 2) =       0.000430923722
  error estimate for blocks of size 2^( 3) =       0.000443956950
  error estimate for blocks of size 2^( 4) =       0.000456319940
  error estimate for blocks of size 2^( 5) =       0.000467892562
  error estimate for blocks of size 2^( 6) =       0.000477916240
  error estimate for blocks of size 2^( 7) =       0.000483910705

      target function =                  N/A
              le_mean =     -16.906011201920
             les_mean =     286.162903879389
             stat err =       0.000471509862
             autocorr =       1.271537636782
              std dev =       0.591345326181
             le_variance =       0.349689294796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418144290
  error estimate for blocks of size 2^( 2) =       0.000430923722
  error estimate for blocks of size 2^( 3) =       0.000443956950
  error estimate for blocks of size 2^( 4) =       0.000456319940
  error estimate for blocks of size 2^( 5) =       0.000467892562
  error estimate for blocks of size 2^( 6) =       0.000477916240
  error estimate for blocks of size 2^( 7) =       0.000483910705

      target function =                  N/A
              le_mean =     -16.906011201920
             les_mean =     286.162903879389
             stat err =       0.000471509862
             autocorr =       1.271537636782
              std dev =       0.591345326181
             le_variance =       0.349689294796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349570473090
                                         uncertainty =       0.007553726898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418144290
  error estimate for blocks of size 2^( 2) =       0.000430923722
  error estimate for blocks of size 2^( 3) =       0.000443956950
  error estimate for blocks of size 2^( 4) =       0.000456319940
  error estimate for blocks of size 2^( 5) =       0.000467892562
  error estimate for blocks of size 2^( 6) =       0.000477916240
  error estimate for blocks of size 2^( 7) =       0.000483910705

      target function =                  N/A
              le_mean =     -16.906011201920
             les_mean =     286.162903879389
             stat err =       0.000471509862
             autocorr =       1.271537636782
              std dev =       0.591345326181
             le_variance =       0.349689294796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906011201920        initial  <--
     2.4414e+18     2.4414e+19             4.0314e-23       -16.906011201920
     9.7656e+18     9.7656e+19             1.0079e-23       -16.906011201920
     3.9062e+19     3.9062e+20             2.5196e-24       -16.906011201920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3032
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9825
    reference variance = 0.266892
====================================================
  Execution time = 2.0022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3362e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699643092
                                         uncertainty =       0.003150321751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699643092
                                         uncertainty =       0.003150321751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408425670
  error estimate for blocks of size 2^( 2) =       0.000421805671
  error estimate for blocks of size 2^( 3) =       0.000434934274
  error estimate for blocks of size 2^( 4) =       0.000446756917
  error estimate for blocks of size 2^( 5) =       0.000456376712
  error estimate for blocks of size 2^( 6) =       0.000462775090
  error estimate for blocks of size 2^( 7) =       0.000467478170

      target function =                  N/A
              le_mean =     -16.905394366626
             les_mean =     286.125981579770
             stat err =       0.000458346722
             autocorr =       1.259395682796
              std dev =       0.577601121400
             le_variance =       0.333623055443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539436663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905394366626       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905394366626       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905394366626       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905394366626       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905394366626       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905394366626       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5521e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.150606
====================================================
  Execution time = 1.9700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.0000e+06
  Execution time = 1.8694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409065857
  error estimate for blocks of size 2^( 2) =       0.000421390799
  error estimate for blocks of size 2^( 3) =       0.000434926421
  error estimate for blocks of size 2^( 4) =       0.000447740583
  error estimate for blocks of size 2^( 5) =       0.000458386132
  error estimate for blocks of size 2^( 6) =       0.000467337512
  error estimate for blocks of size 2^( 7) =       0.000472617517

      target function =                  N/A
              le_mean =     -16.905622151313
             les_mean =     286.134729906456
             stat err =       0.000461520436
             autocorr =       1.272903286788
              std dev =       0.578506482960
             le_variance =       0.334669750827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409065857
  error estimate for blocks of size 2^( 2) =       0.000421390799
  error estimate for blocks of size 2^( 3) =       0.000434926421
  error estimate for blocks of size 2^( 4) =       0.000447740583
  error estimate for blocks of size 2^( 5) =       0.000458386132
  error estimate for blocks of size 2^( 6) =       0.000467337512
  error estimate for blocks of size 2^( 7) =       0.000472617517

      target function =                  N/A
              le_mean =     -16.905622151313
             les_mean =     286.134729906456
             stat err =       0.000461520436
             autocorr =       1.272903286788
              std dev =       0.578506482960
             le_variance =       0.334669750827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409065857
  error estimate for blocks of size 2^( 2) =       0.000421390799
  error estimate for blocks of size 2^( 3) =       0.000434926421
  error estimate for blocks of size 2^( 4) =       0.000447740583
  error estimate for blocks of size 2^( 5) =       0.000458386132
  error estimate for blocks of size 2^( 6) =       0.000467337512
  error estimate for blocks of size 2^( 7) =       0.000472617517

      target function =                  N/A
              le_mean =     -16.905622151313
             les_mean =     286.134729906456
             stat err =       0.000461520436
             autocorr =       1.272903286788
              std dev =       0.578506482960
             le_variance =       0.334669750827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334664970148
                                         uncertainty =       0.003024757411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409065857
  error estimate for blocks of size 2^( 2) =       0.000421390799
  error estimate for blocks of size 2^( 3) =       0.000434926421
  error estimate for blocks of size 2^( 4) =       0.000447740583
  error estimate for blocks of size 2^( 5) =       0.000458386132
  error estimate for blocks of size 2^( 6) =       0.000467337512
  error estimate for blocks of size 2^( 7) =       0.000472617517

      target function =                  N/A
              le_mean =     -16.905622151313
             les_mean =     286.134729906456
             stat err =       0.000461520436
             autocorr =       1.272903286788
              std dev =       0.578506482960
             le_variance =       0.334669750827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905622151313        initial  <--
     2.4414e+19     2.4414e+20             0.0000e+00       -16.905622151313
     9.7656e+19     9.7656e+20             0.0000e+00       -16.905622151313
     3.9062e+20     3.9062e+21             0.0000e+00       -16.905622151313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1026
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8957
    reference variance = 0.172856
====================================================
  Execution time = 2.2502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3550e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335523763009
                                         uncertainty =       0.003372215427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335523763009
                                         uncertainty =       0.003372215427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409575937
  error estimate for blocks of size 2^( 2) =       0.000422691130
  error estimate for blocks of size 2^( 3) =       0.000435755723
  error estimate for blocks of size 2^( 4) =       0.000448637595
  error estimate for blocks of size 2^( 5) =       0.000459937304
  error estimate for blocks of size 2^( 6) =       0.000468893688
  error estimate for blocks of size 2^( 7) =       0.000475337127

      target function =                  N/A
              le_mean =     -16.906061981741
             les_mean =     286.150436459444
             stat err =       0.000463201428
             autocorr =       1.279001083731
              std dev =       0.579227845270
             le_variance =       0.335504896736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606198174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061981741       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061981741       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061981741       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061981741       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061981741       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061981741       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8148e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9617
    reference variance = 0.366586
====================================================
  Execution time = 2.2336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3522e-01
  Total weights = 2.0000e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409402611
  error estimate for blocks of size 2^( 2) =       0.000422501350
  error estimate for blocks of size 2^( 3) =       0.000435479246
  error estimate for blocks of size 2^( 4) =       0.000447469791
  error estimate for blocks of size 2^( 5) =       0.000457850240
  error estimate for blocks of size 2^( 6) =       0.000465578658
  error estimate for blocks of size 2^( 7) =       0.000470716220

      target function =                  N/A
              le_mean =     -16.905876316918
             les_mean =     286.143874871042
             stat err =       0.000460403727
             autocorr =       1.264667754962
              std dev =       0.578982724898
             le_variance =       0.335220995730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409402611
  error estimate for blocks of size 2^( 2) =       0.000422501350
  error estimate for blocks of size 2^( 3) =       0.000435479246
  error estimate for blocks of size 2^( 4) =       0.000447469791
  error estimate for blocks of size 2^( 5) =       0.000457850240
  error estimate for blocks of size 2^( 6) =       0.000465578658
  error estimate for blocks of size 2^( 7) =       0.000470716220

      target function =                  N/A
              le_mean =     -16.905876316918
             les_mean =     286.143874871042
             stat err =       0.000460403727
             autocorr =       1.264667754962
              std dev =       0.578982724898
             le_variance =       0.335220995730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409402611
  error estimate for blocks of size 2^( 2) =       0.000422501350
  error estimate for blocks of size 2^( 3) =       0.000435479246
  error estimate for blocks of size 2^( 4) =       0.000447469791
  error estimate for blocks of size 2^( 5) =       0.000457850240
  error estimate for blocks of size 2^( 6) =       0.000465578658
  error estimate for blocks of size 2^( 7) =       0.000470716220

      target function =                  N/A
              le_mean =     -16.905876316918
             les_mean =     286.143874871042
             stat err =       0.000460403727
             autocorr =       1.264667754962
              std dev =       0.578982724898
             le_variance =       0.335220995730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335278388267
                                         uncertainty =       0.004361794635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409402611
  error estimate for blocks of size 2^( 2) =       0.000422501350
  error estimate for blocks of size 2^( 3) =       0.000435479246
  error estimate for blocks of size 2^( 4) =       0.000447469791
  error estimate for blocks of size 2^( 5) =       0.000457850240
  error estimate for blocks of size 2^( 6) =       0.000465578658
  error estimate for blocks of size 2^( 7) =       0.000470716220

      target function =                  N/A
              le_mean =     -16.905876316918
             les_mean =     286.143874871042
             stat err =       0.000460403727
             autocorr =       1.264667754962
              std dev =       0.578982724898
             le_variance =       0.335220995730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905876316918        initial  <--
     2.4414e+20     2.4414e+21             0.0000e+00       -16.905876316918
     9.7656e+20     9.7656e+21             0.0000e+00       -16.905876316918
     3.9062e+21     3.9062e+22             0.0000e+00       -16.905876316918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9410
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8984
    reference variance = 0.18289
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3969e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339772327594
                                         uncertainty =       0.007426956613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339772327594
                                         uncertainty =       0.007426956613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412124857
  error estimate for blocks of size 2^( 2) =       0.000425254825
  error estimate for blocks of size 2^( 3) =       0.000438775675
  error estimate for blocks of size 2^( 4) =       0.000451224569
  error estimate for blocks of size 2^( 5) =       0.000462253623
  error estimate for blocks of size 2^( 6) =       0.000472752894
  error estimate for blocks of size 2^( 7) =       0.000477690672

      target function =                  N/A
              le_mean =     -16.906033481774
             les_mean =     286.153661712989
             stat err =       0.000465980440
             autocorr =       1.278432356483
              std dev =       0.582832562542
             le_variance =       0.339693795959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603348177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033481774       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033481774       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033481774       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033481774       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033481774       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033481774       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.579077
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3706e-01
  Total weights = 2.0000e+06
  Execution time = 1.8993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410523800
  error estimate for blocks of size 2^( 2) =       0.000423433927
  error estimate for blocks of size 2^( 3) =       0.000436205539
  error estimate for blocks of size 2^( 4) =       0.000448257612
  error estimate for blocks of size 2^( 5) =       0.000458630875
  error estimate for blocks of size 2^( 6) =       0.000467449188
  error estimate for blocks of size 2^( 7) =       0.000474267140

      target function =                  N/A
              le_mean =     -16.905749448857
             les_mean =     286.141423839086
             stat err =       0.000462151204
             autocorr =       1.267335200847
              std dev =       0.580568325087
             le_variance =       0.337059580094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410523800
  error estimate for blocks of size 2^( 2) =       0.000423433927
  error estimate for blocks of size 2^( 3) =       0.000436205539
  error estimate for blocks of size 2^( 4) =       0.000448257612
  error estimate for blocks of size 2^( 5) =       0.000458630875
  error estimate for blocks of size 2^( 6) =       0.000467449188
  error estimate for blocks of size 2^( 7) =       0.000474267140

      target function =                  N/A
              le_mean =     -16.905749448857
             les_mean =     286.141423839086
             stat err =       0.000462151204
             autocorr =       1.267335200847
              std dev =       0.580568325087
             le_variance =       0.337059580094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410523800
  error estimate for blocks of size 2^( 2) =       0.000423433927
  error estimate for blocks of size 2^( 3) =       0.000436205539
  error estimate for blocks of size 2^( 4) =       0.000448257612
  error estimate for blocks of size 2^( 5) =       0.000458630875
  error estimate for blocks of size 2^( 6) =       0.000467449188
  error estimate for blocks of size 2^( 7) =       0.000474267140

      target function =                  N/A
              le_mean =     -16.905749448857
             les_mean =     286.141423839086
             stat err =       0.000462151204
             autocorr =       1.267335200847
              std dev =       0.580568325087
             le_variance =       0.337059580094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085706845
                                         uncertainty =       0.002602053780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410523800
  error estimate for blocks of size 2^( 2) =       0.000423433927
  error estimate for blocks of size 2^( 3) =       0.000436205539
  error estimate for blocks of size 2^( 4) =       0.000448257612
  error estimate for blocks of size 2^( 5) =       0.000458630875
  error estimate for blocks of size 2^( 6) =       0.000467449188
  error estimate for blocks of size 2^( 7) =       0.000474267140

      target function =                  N/A
              le_mean =     -16.905749448857
             les_mean =     286.141423839086
             stat err =       0.000462151204
             autocorr =       1.267335200847
              std dev =       0.580568325087
             le_variance =       0.337059580094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905749448857        initial  <--
     2.4414e+21     2.4414e+22             0.0000e+00       -16.905749448857
     9.7656e+21     9.7656e+22             0.0000e+00       -16.905749448857
     3.9062e+22     3.9062e+23             0.0000e+00       -16.905749448857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8040
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.249551
====================================================
  Execution time = 2.0162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338120555915
                                         uncertainty =       0.003687721855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338120555915
                                         uncertainty =       0.003687721855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411093821
  error estimate for blocks of size 2^( 2) =       0.000423818578
  error estimate for blocks of size 2^( 3) =       0.000437093824
  error estimate for blocks of size 2^( 4) =       0.000448329357
  error estimate for blocks of size 2^( 5) =       0.000459496150
  error estimate for blocks of size 2^( 6) =       0.000467840080
  error estimate for blocks of size 2^( 7) =       0.000473706086

      target function =                  N/A
              le_mean =     -16.905329884444
             les_mean =     286.128174591589
             stat err =       0.000462342918
             autocorr =       1.264871834851
              std dev =       0.581374456533
             le_variance =       0.337996258709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690532988444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905329884444       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905329884444       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905329884444       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905329884444       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905329884444       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905329884444       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5736e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0159
    reference variance = 0.433413
====================================================
  Execution time = 2.0046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4132e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413112575
  error estimate for blocks of size 2^( 2) =       0.000425730493
  error estimate for blocks of size 2^( 3) =       0.000438291539
  error estimate for blocks of size 2^( 4) =       0.000449953504
  error estimate for blocks of size 2^( 5) =       0.000460351973
  error estimate for blocks of size 2^( 6) =       0.000466831714
  error estimate for blocks of size 2^( 7) =       0.000470505991

      target function =                  N/A
              le_mean =     -16.906583630974
             les_mean =     286.173893899378
             stat err =       0.000461910796
             autocorr =       1.250199716329
              std dev =       0.584229406064
             le_variance =       0.341323998910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413112575
  error estimate for blocks of size 2^( 2) =       0.000425730493
  error estimate for blocks of size 2^( 3) =       0.000438291539
  error estimate for blocks of size 2^( 4) =       0.000449953504
  error estimate for blocks of size 2^( 5) =       0.000460351973
  error estimate for blocks of size 2^( 6) =       0.000466831714
  error estimate for blocks of size 2^( 7) =       0.000470505991

      target function =                  N/A
              le_mean =     -16.906583630974
             les_mean =     286.173893899378
             stat err =       0.000461910796
             autocorr =       1.250199716329
              std dev =       0.584229406064
             le_variance =       0.341323998910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413112575
  error estimate for blocks of size 2^( 2) =       0.000425730493
  error estimate for blocks of size 2^( 3) =       0.000438291539
  error estimate for blocks of size 2^( 4) =       0.000449953504
  error estimate for blocks of size 2^( 5) =       0.000460351973
  error estimate for blocks of size 2^( 6) =       0.000466831714
  error estimate for blocks of size 2^( 7) =       0.000470505991

      target function =                  N/A
              le_mean =     -16.906583630974
             les_mean =     286.173893899378
             stat err =       0.000461910796
             autocorr =       1.250199716329
              std dev =       0.584229406064
             le_variance =       0.341323998910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341270105767
                                         uncertainty =       0.003886982308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413112575
  error estimate for blocks of size 2^( 2) =       0.000425730493
  error estimate for blocks of size 2^( 3) =       0.000438291539
  error estimate for blocks of size 2^( 4) =       0.000449953504
  error estimate for blocks of size 2^( 5) =       0.000460351973
  error estimate for blocks of size 2^( 6) =       0.000466831714
  error estimate for blocks of size 2^( 7) =       0.000470505991

      target function =                  N/A
              le_mean =     -16.906583630974
             les_mean =     286.173893899378
             stat err =       0.000461910796
             autocorr =       1.250199716329
              std dev =       0.584229406064
             le_variance =       0.341323998910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906583630974        initial  <--
     2.4414e+22     2.4414e+23             0.0000e+00       -16.906583630974
     9.7656e+22     9.7656e+23             0.0000e+00       -16.906583630974
     3.9062e+23     3.9062e+24             0.0000e+00       -16.906583630974

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5143
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8523
    reference variance = 0.195252
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347652174693
                                         uncertainty =       0.006426472372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347652174693
                                         uncertainty =       0.006426472372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416896648
  error estimate for blocks of size 2^( 2) =       0.000429436884
  error estimate for blocks of size 2^( 3) =       0.000442619062
  error estimate for blocks of size 2^( 4) =       0.000454611324
  error estimate for blocks of size 2^( 5) =       0.000464589841
  error estimate for blocks of size 2^( 6) =       0.000473822254
  error estimate for blocks of size 2^( 7) =       0.000477797313

      target function =                  N/A
              le_mean =     -16.906457443231
             les_mean =     286.175908735637
             stat err =       0.000467705183
             autocorr =       1.258599513011
              std dev =       0.589580893216
             le_variance =       0.347605629645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645744323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906457443231       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906457443231       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906457443231       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906457443231       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906457443231       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906457443231       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5651e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.868
    reference variance = 0.24376
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4350e-01
  Total weights = 2.0000e+06
  Execution time = 1.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414425967
  error estimate for blocks of size 2^( 2) =       0.000427265586
  error estimate for blocks of size 2^( 3) =       0.000439796522
  error estimate for blocks of size 2^( 4) =       0.000452399280
  error estimate for blocks of size 2^( 5) =       0.000464259209
  error estimate for blocks of size 2^( 6) =       0.000469528060
  error estimate for blocks of size 2^( 7) =       0.000473941459

      target function =                  N/A
              le_mean =     -16.906471551556
             les_mean =     286.172277916798
             stat err =       0.000465032002
             autocorr =       1.259133450379
              std dev =       0.586086823748
             le_variance =       0.343497764971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414425967
  error estimate for blocks of size 2^( 2) =       0.000427265586
  error estimate for blocks of size 2^( 3) =       0.000439796522
  error estimate for blocks of size 2^( 4) =       0.000452399280
  error estimate for blocks of size 2^( 5) =       0.000464259209
  error estimate for blocks of size 2^( 6) =       0.000469528060
  error estimate for blocks of size 2^( 7) =       0.000473941459

      target function =                  N/A
              le_mean =     -16.906471551556
             les_mean =     286.172277916798
             stat err =       0.000465032002
             autocorr =       1.259133450379
              std dev =       0.586086823748
             le_variance =       0.343497764971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414425967
  error estimate for blocks of size 2^( 2) =       0.000427265586
  error estimate for blocks of size 2^( 3) =       0.000439796522
  error estimate for blocks of size 2^( 4) =       0.000452399280
  error estimate for blocks of size 2^( 5) =       0.000464259209
  error estimate for blocks of size 2^( 6) =       0.000469528060
  error estimate for blocks of size 2^( 7) =       0.000473941459

      target function =                  N/A
              le_mean =     -16.906471551556
             les_mean =     286.172277916798
             stat err =       0.000465032002
             autocorr =       1.259133450379
              std dev =       0.586086823748
             le_variance =       0.343497764971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343304162068
                                         uncertainty =       0.005330592673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414425967
  error estimate for blocks of size 2^( 2) =       0.000427265586
  error estimate for blocks of size 2^( 3) =       0.000439796522
  error estimate for blocks of size 2^( 4) =       0.000452399280
  error estimate for blocks of size 2^( 5) =       0.000464259209
  error estimate for blocks of size 2^( 6) =       0.000469528060
  error estimate for blocks of size 2^( 7) =       0.000473941459

      target function =                  N/A
              le_mean =     -16.906471551556
             les_mean =     286.172277916798
             stat err =       0.000465032002
             autocorr =       1.259133450379
              std dev =       0.586086823748
             le_variance =       0.343497764971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906471551556        initial  <--
     2.4414e+23     2.4414e+24             0.0000e+00       -16.906471551556
     9.7656e+23     9.7656e+24             0.0000e+00       -16.906471551556
     3.9062e+24     3.9062e+25             0.0000e+00       -16.906471551556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7281
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5387e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8982
    reference variance = 0.337078
====================================================
  Execution time = 2.0488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3502e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334960247256
                                         uncertainty =       0.002825248343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334960247256
                                         uncertainty =       0.002825248343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409281395
  error estimate for blocks of size 2^( 2) =       0.000421752664
  error estimate for blocks of size 2^( 3) =       0.000434267098
  error estimate for blocks of size 2^( 4) =       0.000445323896
  error estimate for blocks of size 2^( 5) =       0.000456158124
  error estimate for blocks of size 2^( 6) =       0.000463429665
  error estimate for blocks of size 2^( 7) =       0.000467200357

      target function =                  N/A
              le_mean =     -16.905894195701
             les_mean =     286.144280909125
             stat err =       0.000458028010
             autocorr =       1.252391379077
              std dev =       0.578811299470
             le_variance =       0.335022520395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589419570e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905894195701       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894195701       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905894195701       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894195701       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905894195701       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894195701       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6058e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.855
    reference variance = 0.201796
====================================================
  Execution time = 2.0051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411272701
  error estimate for blocks of size 2^( 2) =       0.000424348738
  error estimate for blocks of size 2^( 3) =       0.000437737911
  error estimate for blocks of size 2^( 4) =       0.000450534569
  error estimate for blocks of size 2^( 5) =       0.000463522039
  error estimate for blocks of size 2^( 6) =       0.000473011853
  error estimate for blocks of size 2^( 7) =       0.000479891647

      target function =                  N/A
              le_mean =     -16.905671368033
             les_mean =     286.140014704100
             stat err =       0.000466740027
             autocorr =       1.287924269906
              std dev =       0.581627431715
             le_variance =       0.338290469323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411272701
  error estimate for blocks of size 2^( 2) =       0.000424348738
  error estimate for blocks of size 2^( 3) =       0.000437737911
  error estimate for blocks of size 2^( 4) =       0.000450534569
  error estimate for blocks of size 2^( 5) =       0.000463522039
  error estimate for blocks of size 2^( 6) =       0.000473011853
  error estimate for blocks of size 2^( 7) =       0.000479891647

      target function =                  N/A
              le_mean =     -16.905671368033
             les_mean =     286.140014704100
             stat err =       0.000466740027
             autocorr =       1.287924269906
              std dev =       0.581627431715
             le_variance =       0.338290469323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411272701
  error estimate for blocks of size 2^( 2) =       0.000424348738
  error estimate for blocks of size 2^( 3) =       0.000437737911
  error estimate for blocks of size 2^( 4) =       0.000450534569
  error estimate for blocks of size 2^( 5) =       0.000463522039
  error estimate for blocks of size 2^( 6) =       0.000473011853
  error estimate for blocks of size 2^( 7) =       0.000479891647

      target function =                  N/A
              le_mean =     -16.905671368033
             les_mean =     286.140014704100
             stat err =       0.000466740027
             autocorr =       1.287924269906
              std dev =       0.581627431715
             le_variance =       0.338290469323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338273670525
                                         uncertainty =       0.003914400206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411272701
  error estimate for blocks of size 2^( 2) =       0.000424348738
  error estimate for blocks of size 2^( 3) =       0.000437737911
  error estimate for blocks of size 2^( 4) =       0.000450534569
  error estimate for blocks of size 2^( 5) =       0.000463522039
  error estimate for blocks of size 2^( 6) =       0.000473011853
  error estimate for blocks of size 2^( 7) =       0.000479891647

      target function =                  N/A
              le_mean =     -16.905671368033
             les_mean =     286.140014704100
             stat err =       0.000466740027
             autocorr =       1.287924269906
              std dev =       0.581627431715
             le_variance =       0.338290469323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905671368033        initial  <--
     2.4414e+24     2.4414e+25             0.0000e+00       -16.905671368033
     9.7656e+24     9.7656e+25             0.0000e+00       -16.905671368033
     3.9062e+25     3.9062e+26             0.0000e+00       -16.905671368033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4819
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5546e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.321081
====================================================
  Execution time = 2.0176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3896e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338960578113
                                         uncertainty =       0.003735994346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338960578113
                                         uncertainty =       0.003735994346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411677068
  error estimate for blocks of size 2^( 2) =       0.000424531658
  error estimate for blocks of size 2^( 3) =       0.000437412133
  error estimate for blocks of size 2^( 4) =       0.000449104393
  error estimate for blocks of size 2^( 5) =       0.000459864751
  error estimate for blocks of size 2^( 6) =       0.000469615209
  error estimate for blocks of size 2^( 7) =       0.000476831454

      target function =                  N/A
              le_mean =     -16.905637561209
             les_mean =     286.139537197647
             stat err =       0.000463853952
             autocorr =       1.269548133197
              std dev =       0.582199292479
             le_variance =       0.338956016163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563756121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905637561209       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905637561209       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905637561209       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905637561209       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905637561209       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905637561209       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5666e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9187
    reference variance = 1.52458
====================================================
  Execution time = 2.2121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3584e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780681
  error estimate for blocks of size 2^( 2) =       0.000422244361
  error estimate for blocks of size 2^( 3) =       0.000435096448
  error estimate for blocks of size 2^( 4) =       0.000447346211
  error estimate for blocks of size 2^( 5) =       0.000457767889
  error estimate for blocks of size 2^( 6) =       0.000466308846
  error estimate for blocks of size 2^( 7) =       0.000469839047

      target function =                  N/A
              le_mean =     -16.906419275190
             les_mean =     286.162852953413
             stat err =       0.000460315498
             autocorr =       1.261851461920
              std dev =       0.579517396469
             le_variance =       0.335840412810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780681
  error estimate for blocks of size 2^( 2) =       0.000422244361
  error estimate for blocks of size 2^( 3) =       0.000435096448
  error estimate for blocks of size 2^( 4) =       0.000447346211
  error estimate for blocks of size 2^( 5) =       0.000457767889
  error estimate for blocks of size 2^( 6) =       0.000466308846
  error estimate for blocks of size 2^( 7) =       0.000469839047

      target function =                  N/A
              le_mean =     -16.906419275190
             les_mean =     286.162852953413
             stat err =       0.000460315498
             autocorr =       1.261851461920
              std dev =       0.579517396469
             le_variance =       0.335840412810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780681
  error estimate for blocks of size 2^( 2) =       0.000422244361
  error estimate for blocks of size 2^( 3) =       0.000435096448
  error estimate for blocks of size 2^( 4) =       0.000447346211
  error estimate for blocks of size 2^( 5) =       0.000457767889
  error estimate for blocks of size 2^( 6) =       0.000466308846
  error estimate for blocks of size 2^( 7) =       0.000469839047

      target function =                  N/A
              le_mean =     -16.906419275190
             les_mean =     286.162852953413
             stat err =       0.000460315498
             autocorr =       1.261851461920
              std dev =       0.579517396469
             le_variance =       0.335840412810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335729742246
                                         uncertainty =       0.002873452188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780681
  error estimate for blocks of size 2^( 2) =       0.000422244361
  error estimate for blocks of size 2^( 3) =       0.000435096448
  error estimate for blocks of size 2^( 4) =       0.000447346211
  error estimate for blocks of size 2^( 5) =       0.000457767889
  error estimate for blocks of size 2^( 6) =       0.000466308846
  error estimate for blocks of size 2^( 7) =       0.000469839047

      target function =                  N/A
              le_mean =     -16.906419275190
             les_mean =     286.162852953413
             stat err =       0.000460315498
             autocorr =       1.261851461920
              std dev =       0.579517396469
             le_variance =       0.335840412810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906419275190        initial  <--
     2.4414e+25     2.4414e+26             0.0000e+00       -16.906419275190
     9.7656e+25     9.7656e+26             0.0000e+00       -16.906419275190
     3.9062e+26     3.9062e+27             0.0000e+00       -16.906419275190

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5566
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8291
    reference variance = 0.300351
====================================================
  Execution time = 2.2301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3906e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339141208714
                                         uncertainty =       0.003363892904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339141208714
                                         uncertainty =       0.003363892904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411737318
  error estimate for blocks of size 2^( 2) =       0.000423814029
  error estimate for blocks of size 2^( 3) =       0.000436409825
  error estimate for blocks of size 2^( 4) =       0.000447849560
  error estimate for blocks of size 2^( 5) =       0.000457876984
  error estimate for blocks of size 2^( 6) =       0.000463503593
  error estimate for blocks of size 2^( 7) =       0.000466686170

      target function =                  N/A
              le_mean =     -16.906534205637
             les_mean =     286.169953914175
             stat err =       0.000458979076
             autocorr =       1.242639955827
              std dev =       0.582284498627
             le_variance =       0.339055237341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653420564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534205637       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534205637       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534205642       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 3.966266e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534205637       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534205637       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906976331895       residual = 1.05e+09           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534205191       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 9.915666e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534205637       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534205637       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534205656       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+27 is 2.478916e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7816e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8889
    reference variance = 0.266596
====================================================
  Execution time = 2.0094e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4043e-01
  Total weights = 2.0000e+06
  Execution time = 1.8744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570676
  error estimate for blocks of size 2^( 2) =       0.000424731814
  error estimate for blocks of size 2^( 3) =       0.000437216353
  error estimate for blocks of size 2^( 4) =       0.000448138675
  error estimate for blocks of size 2^( 5) =       0.000458694543
  error estimate for blocks of size 2^( 6) =       0.000466818063
  error estimate for blocks of size 2^( 7) =       0.000469263394

      target function =                  N/A
              le_mean =     -16.905698196606
             les_mean =     286.143060469105
             stat err =       0.000460728669
             autocorr =       1.247078414296
              std dev =       0.583463044764
             le_variance =       0.340429124605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570676
  error estimate for blocks of size 2^( 2) =       0.000424731814
  error estimate for blocks of size 2^( 3) =       0.000437216353
  error estimate for blocks of size 2^( 4) =       0.000448138675
  error estimate for blocks of size 2^( 5) =       0.000458694543
  error estimate for blocks of size 2^( 6) =       0.000466818063
  error estimate for blocks of size 2^( 7) =       0.000469263394

      target function =                  N/A
              le_mean =     -16.905698196606
             les_mean =     286.143060469105
             stat err =       0.000460728669
             autocorr =       1.247078414296
              std dev =       0.583463044764
             le_variance =       0.340429124605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570676
  error estimate for blocks of size 2^( 2) =       0.000424731814
  error estimate for blocks of size 2^( 3) =       0.000437216353
  error estimate for blocks of size 2^( 4) =       0.000448138675
  error estimate for blocks of size 2^( 5) =       0.000458694543
  error estimate for blocks of size 2^( 6) =       0.000466818063
  error estimate for blocks of size 2^( 7) =       0.000469263394

      target function =                  N/A
              le_mean =     -16.905698196606
             les_mean =     286.143060469105
             stat err =       0.000460728669
             autocorr =       1.247078414296
              std dev =       0.583463044764
             le_variance =       0.340429124605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340404139782
                                         uncertainty =       0.005057026528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570676
  error estimate for blocks of size 2^( 2) =       0.000424731814
  error estimate for blocks of size 2^( 3) =       0.000437216353
  error estimate for blocks of size 2^( 4) =       0.000448138675
  error estimate for blocks of size 2^( 5) =       0.000458694543
  error estimate for blocks of size 2^( 6) =       0.000466818063
  error estimate for blocks of size 2^( 7) =       0.000469263394

      target function =                  N/A
              le_mean =     -16.905698196606
             les_mean =     286.143060469105
             stat err =       0.000460728669
             autocorr =       1.247078414296
              std dev =       0.583463044764
             le_variance =       0.340429124605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905698196606        initial  <--
     2.4414e+26     2.4414e+27             3.9663e-31       -16.905698196606
     9.7656e+26     9.7656e+27             9.9157e-32       -16.905698196606
     3.9062e+27     3.9062e+28             2.4789e-32       -16.905698196606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5289
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9793
    reference variance = 0.192898
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4213e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341265021003
                                         uncertainty =       0.004054714033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341265021003
                                         uncertainty =       0.004054714033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413602803
  error estimate for blocks of size 2^( 2) =       0.000426825811
  error estimate for blocks of size 2^( 3) =       0.000439483690
  error estimate for blocks of size 2^( 4) =       0.000451649601
  error estimate for blocks of size 2^( 5) =       0.000461144468
  error estimate for blocks of size 2^( 6) =       0.000468133790
  error estimate for blocks of size 2^( 7) =       0.000474467160

      target function =                  N/A
              le_mean =     -16.906330942425
             les_mean =     286.166160321808
             stat err =       0.000463848755
             autocorr =       1.257725430506
              std dev =       0.584922694106
             le_variance =       0.342134558080


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633094242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330942425       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330942425       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330942425       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330942425       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330942425       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330942425       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6030e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.253643
====================================================
  Execution time = 2.0013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3230e-01
  Total weights = 2.0000e+06
  Execution time = 1.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407617048
  error estimate for blocks of size 2^( 2) =       0.000420386681
  error estimate for blocks of size 2^( 3) =       0.000434014145
  error estimate for blocks of size 2^( 4) =       0.000446518446
  error estimate for blocks of size 2^( 5) =       0.000456893363
  error estimate for blocks of size 2^( 6) =       0.000464945156
  error estimate for blocks of size 2^( 7) =       0.000467566590

      target function =                  N/A
              le_mean =     -16.905836509847
             les_mean =     286.139611246727
             stat err =       0.000458980889
             autocorr =       1.267898612056
              std dev =       0.576457557145
             le_variance =       0.332303315190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407617048
  error estimate for blocks of size 2^( 2) =       0.000420386681
  error estimate for blocks of size 2^( 3) =       0.000434014145
  error estimate for blocks of size 2^( 4) =       0.000446518446
  error estimate for blocks of size 2^( 5) =       0.000456893363
  error estimate for blocks of size 2^( 6) =       0.000464945156
  error estimate for blocks of size 2^( 7) =       0.000467566590

      target function =                  N/A
              le_mean =     -16.905836509847
             les_mean =     286.139611246727
             stat err =       0.000458980889
             autocorr =       1.267898612056
              std dev =       0.576457557145
             le_variance =       0.332303315190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407617048
  error estimate for blocks of size 2^( 2) =       0.000420386681
  error estimate for blocks of size 2^( 3) =       0.000434014145
  error estimate for blocks of size 2^( 4) =       0.000446518446
  error estimate for blocks of size 2^( 5) =       0.000456893363
  error estimate for blocks of size 2^( 6) =       0.000464945156
  error estimate for blocks of size 2^( 7) =       0.000467566590

      target function =                  N/A
              le_mean =     -16.905836509847
             les_mean =     286.139611246727
             stat err =       0.000458980889
             autocorr =       1.267898612056
              std dev =       0.576457557145
             le_variance =       0.332303315190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332415666849
                                         uncertainty =       0.002739240998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407617048
  error estimate for blocks of size 2^( 2) =       0.000420386681
  error estimate for blocks of size 2^( 3) =       0.000434014145
  error estimate for blocks of size 2^( 4) =       0.000446518446
  error estimate for blocks of size 2^( 5) =       0.000456893363
  error estimate for blocks of size 2^( 6) =       0.000464945156
  error estimate for blocks of size 2^( 7) =       0.000467566590

      target function =                  N/A
              le_mean =     -16.905836509847
             les_mean =     286.139611246727
             stat err =       0.000458980889
             autocorr =       1.267898612056
              std dev =       0.576457557145
             le_variance =       0.332303315190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905836509847        initial  <--
     2.4414e+27     2.4414e+28             0.0000e+00       -16.905836509847
     9.7656e+27     9.7656e+28             0.0000e+00       -16.905836509847
     3.9062e+28     3.9062e+29             0.0000e+00       -16.905836509847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4888
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5524e+01 secs
  Total Execution time = 2.2485e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
