Rank =    0  Free Memory = 72469 MB
Rank =   32  Free Memory = 72088 MB
Rank =   33  Free Memory = 72088 MB
Rank =   34  Free Memory = 72088 MB
Rank =   35  Free Memory = 72088 MB
Rank =   36  Free Memory = 72088 MB
Rank =   37  Free Memory = 72088 MB
Rank =   38  Free Memory = 72088 MB
Rank =   39  Free Memory = 72088 MB
Rank =   40  Free Memory = 72088 MB
Rank =   31  Free Memory = 72453 MB
Rank =    1  Free Memory = 72468 MB
Rank =    2  Free Memory = 72468 MB
Rank =    3  Free Memory = 72468 MB
Rank =    4  Free Memory = 72468 MB
Rank =    5  Free Memory = 72468 MB
Rank =    6  Free Memory = 72467 MB
Rank =    7  Free Memory = 72467 MB
Rank =    8  Free Memory = 72467 MB
Rank =    9  Free Memory = 72467 MB
Rank =   10  Free Memory = 72467 MB
Rank =   11  Free Memory = 72466 MB
Rank =   12  Free Memory = 72465 MB
Rank =   13  Free Memory = 72465 MB
Rank =   14  Free Memory = 72465 MB
Rank =   15  Free Memory = 72453 MB
Rank =   16  Free Memory = 72453 MB
Rank =   17  Free Memory = 72453 MB
Rank =   18  Free Memory = 72453 MB
Rank =   19  Free Memory = 72453 MB
Rank =   20  Free Memory = 72453 MB
Rank =   21  Free Memory = 72453 MB
Rank =   22  Free Memory = 72453 MB
Rank =   23  Free Memory = 72453 MB
Rank =   24  Free Memory = 72453 MB
Rank =   25  Free Memory = 72453 MB
Rank =   26  Free Memory = 72453 MB
Rank =   27  Free Memory = 72453 MB
Rank =   28  Free Memory = 72453 MB
Rank =   29  Free Memory = 72453 MB
Rank =   30  Free Memory = 72453 MB
Rank =   41  Free Memory = 72088 MB
Rank =   42  Free Memory = 72088 MB
Rank =   43  Free Memory = 72088 MB
Rank =   44  Free Memory = 72088 MB
Rank =   45  Free Memory = 72088 MB
Rank =   46  Free Memory = 72088 MB
Rank =   47  Free Memory = 72088 MB
Rank =   48  Free Memory = 72088 MB
Rank =   49  Free Memory = 72088 MB
Rank =   50  Free Memory = 72088 MB
Rank =   51  Free Memory = 72088 MB
Rank =   52  Free Memory = 72088 MB
Rank =   53  Free Memory = 72088 MB
Rank =   54  Free Memory = 72088 MB
Rank =   55  Free Memory = 72088 MB
Rank =   56  Free Memory = 72088 MB
Rank =   57  Free Memory = 72088 MB
Rank =   58  Free Memory = 72088 MB
Rank =   59  Free Memory = 72088 MB
Rank =   60  Free Memory = 72088 MB
Rank =   61  Free Memory = 72088 MB
Rank =   62  Free Memory = 72088 MB
Rank =   63  Free Memory = 72088 MB
Rank =   64  Free Memory = 65975 MB
Rank =   65  Free Memory = 65975 MB
Rank =   66  Free Memory = 65975 MB
Rank =   67  Free Memory = 65975 MB
Rank =   68  Free Memory = 65975 MB
Rank =   69  Free Memory = 65975 MB
Rank =   70  Free Memory = 65975 MB
Rank =   71  Free Memory = 65975 MB
Rank =   72  Free Memory = 65975 MB
Rank =   73  Free Memory = 65975 MB
Rank =   74  Free Memory = 65975 MB
Rank =   75  Free Memory = 65975 MB
Rank =   76  Free Memory = 65975 MB
Rank =   77  Free Memory = 65975 MB
Rank =   78  Free Memory = 65975 MB
Rank =   79  Free Memory = 65975 MB
Rank =   80  Free Memory = 65975 MB
Rank =   81  Free Memory = 65975 MB
Rank =   82  Free Memory = 65975 MB
Rank =   83  Free Memory = 65975 MB
Rank =   84  Free Memory = 65975 MB
Rank =   85  Free Memory = 65975 MB
Rank =   86  Free Memory = 65975 MB
Rank =   87  Free Memory = 65975 MB
Rank =   88  Free Memory = 65975 MB
Rank =   89  Free Memory = 65975 MB
Rank =   90  Free Memory = 65975 MB
Rank =   91  Free Memory = 65975 MB
Rank =   92  Free Memory = 65975 MB
Rank =   93  Free Memory = 65975 MB
Rank =   94  Free Memory = 65975 MB
Rank =   95  Free Memory = 65975 MB
Rank =   96  Free Memory = 80625 MB
Rank =   97  Free Memory = 80625 MB
Rank =   98  Free Memory = 80625 MB
Rank =   99  Free Memory = 80625 MB
Rank =  100  Free Memory = 80625 MB
Rank =  101  Free Memory = 80625 MB
Rank =  102  Free Memory = 80625 MB
Rank =  103  Free Memory = 80625 MB
Rank =  104  Free Memory = 80625 MB
Rank =  105  Free Memory = 80625 MB
Rank =  106  Free Memory = 80625 MB
Rank =  107  Free Memory = 80625 MB
Rank =  108  Free Memory = 80625 MB
Rank =  109  Free Memory = 80625 MB
Rank =  110  Free Memory = 80625 MB
Rank =  111  Free Memory = 80625 MB
Rank =  112  Free Memory = 80625 MB
Rank =  113  Free Memory = 80625 MB
Rank =  114  Free Memory = 80625 MB
Rank =  115  Free Memory = 80625 MB
Rank =  116  Free Memory = 80625 MB
Rank =  117  Free Memory = 80625 MB
Rank =  118  Free Memory = 80625 MB
Rank =  119  Free Memory = 80625 MB
Rank =  120  Free Memory = 80625 MB
Rank =  121  Free Memory = 80625 MB
Rank =  122  Free Memory = 80625 MB
Rank =  123  Free Memory = 80625 MB
Rank =  124  Free Memory = 80625 MB
Rank =  125  Free Memory = 80625 MB
Rank =  126  Free Memory = 80625 MB
Rank =  127  Free Memory = 80625 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001p.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001p.xml

  Project = H2O
  date    = 2023-04-17 10:09:37 PDT
  host    = n0059.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 337

  Range of prime numbers to use as seeds over processors and threads = 2281-3319


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.097779e-01    1         1  ON     0
     uu_1                 1.429008e-01    1         1  ON     1
     uu_2                 4.129106e-02    1         1  ON     2
     uu_3                -2.137689e-02    1         1  ON     3
     uu_4                -6.692727e-02    1         1  ON     4
     uu_5                -1.016714e-01    1         1  ON     5
     uu_6                -1.290944e-01    1         1  ON     6
     uu_7                -1.422658e-01    1         1  ON     7
     uu_8                -1.344241e-01    1         1  ON     8
     uu_9                -1.057365e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.496483e-01    1         1  ON     0
     ud_1                 1.837425e-01    1         1  ON     1
     ud_2                 6.324588e-02    1         1  ON     2
     ud_3                -8.120934e-03    1         1  ON     3
     ud_4                -6.563152e-02    1         1  ON     4
     ud_5                -1.075742e-01    1         1  ON     5
     ud_6                -1.356855e-01    1         1  ON     6
     ud_7                -1.524652e-01    1         1  ON     7
     ud_8                -1.529177e-01    1         1  ON     8
     ud_9                -1.434486e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.601517e-01    1         1  ON     0
     eO_1                -4.389333e-01    1         1  ON     1
     eO_2                -2.158219e-02    1         1  ON     2
     eO_3                 2.986033e-01    1         1  ON     3
     eO_4                 5.262940e-01    1         1  ON     4
     eO_5                 4.881205e-01    1         1  ON     5
     eO_6                 2.606447e-01    1         1  ON     6
     eO_7                -4.047704e-02    1         1  ON     7
     eO_8                -2.226013e-01    1         1  ON     8
     eO_9                -8.822433e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.487031e-01    1         1  ON     0
     eH1_1                -1.468865e-01    1         1  ON     1
     eH1_2                -9.890365e-02    1         1  ON     2
     eH1_3                -4.438922e-02    1         1  ON     3
     eH1_4                 3.841960e-03    1         1  ON     4
     eH1_5                 3.777663e-02    1         1  ON     5
     eH1_6                 9.678769e-02    1         1  ON     6
     eH1_7                 1.546459e-01    1         1  ON     7
     eH1_8                 1.791224e-01    1         1  ON     8
     eH1_9                 7.044155e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.468691e-01    1         1  ON     0
     eH2_1                -1.443698e-01    1         1  ON     1
     eH2_2                -9.645268e-02    1         1  ON     2
     eH2_3                -4.215406e-02    1         1  ON     3
     eH2_4                 6.354578e-03    1         1  ON     4
     eH2_5                 4.030376e-02    1         1  ON     5
     eH2_6                 9.913490e-02    1         1  ON     6
     eH2_7                 1.555124e-01    1         1  ON     7
     eH2_8                 1.843471e-01    1         1  ON     8
     eH2_9                 6.044747e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.276713e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6278e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9933
    reference variance = 0.391852
====================================================
  Execution time = 2.1117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4135e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341233987332
                                         uncertainty =       0.004962306995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341233987332
                                         uncertainty =       0.004962306995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413127009
  error estimate for blocks of size 2^( 2) =       0.000425327152
  error estimate for blocks of size 2^( 3) =       0.000438084882
  error estimate for blocks of size 2^( 4) =       0.000449094053
  error estimate for blocks of size 2^( 5) =       0.000458462458
  error estimate for blocks of size 2^( 6) =       0.000465956146
  error estimate for blocks of size 2^( 7) =       0.000467647228

      target function =                  N/A
              le_mean =     -16.906709953974
             les_mean =     286.178189147874
             stat err =       0.000460289971
             autocorr =       1.241354572997
              std dev =       0.584249818779
             le_variance =       0.341347850743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690670995397e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906709953974       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906714335030       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906714067512       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906713732185       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906714537855       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906714554902       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906713836727       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906713980121       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906714093203       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906714534532       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.731349e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906709953974       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711549644       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711371822       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711282527       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711330368       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711390264       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711281211       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711282017       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.866027e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906709953974       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906710404332       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906710349745       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906710325481       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906710302486       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906710322569       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906710309893       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906710301890       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 7.476863e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6869e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.098364e-01                 1 1 ON  0
uu_1  1.429841e-01                 1 1 ON  1
uu_2  4.133687e-02                 1 1 ON  2
uu_3  -2.132854e-02                1 1 ON  3
uu_4  -6.686178e-02                1 1 ON  4
uu_5  -1.017053e-01                1 1 ON  5
uu_6  -1.291033e-01                1 1 ON  6
uu_7  -1.424227e-01                1 1 ON  7
uu_8  -1.345571e-01                1 1 ON  8
uu_9  -1.058094e-01                1 1 ON  9
ud_0  4.497254e-01                 1 1 ON  10
ud_1  1.838475e-01                 1 1 ON  11
ud_2  6.331794e-02                 1 1 ON  12
ud_3  -8.105758e-03                1 1 ON  13
ud_4  -6.560469e-02                1 1 ON  14
ud_5  -1.076050e-01                1 1 ON  15
ud_6  -1.355783e-01                1 1 ON  16
ud_7  -1.523932e-01                1 1 ON  17
ud_8  -1.530643e-01                1 1 ON  18
ud_9  -1.436156e-01                1 1 ON  19
eO_0  -7.600848e-01                1 1 ON  20
eO_1  -4.387750e-01                1 1 ON  21
eO_2  -2.153272e-02                1 1 ON  22
eO_3  2.985016e-01                 1 1 ON  23
eO_4  5.262608e-01                 1 1 ON  24
eO_5  4.882617e-01                 1 1 ON  25
eO_6  2.607041e-01                 1 1 ON  26
eO_7  -4.049980e-02                1 1 ON  27
eO_8  -2.227452e-01                1 1 ON  28
eO_9  -8.837051e-02                1 1 ON  29
eH1_0 -2.489897e-01                1 1 ON  30
eH1_1 -1.468909e-01                1 1 ON  31
eH1_2 -9.890055e-02                1 1 ON  32
eH1_3 -4.443861e-02                1 1 ON  33
eH1_4 3.806845e-03                 1 1 ON  34
eH1_5 3.775656e-02                 1 1 ON  35
eH1_6 9.684890e-02                 1 1 ON  36
eH1_7 1.546267e-01                 1 1 ON  37
eH1_8 1.792611e-01                 1 1 ON  38
eH1_9 7.064104e-02                 1 1 ON  39
eH2_0 -2.469837e-01                1 1 ON  40
eH2_1 -1.444508e-01                1 1 ON  41
eH2_2 -9.649672e-02                1 1 ON  42
eH2_3 -4.222978e-02                1 1 ON  43
eH2_4 6.352150e-03                 1 1 ON  44
eH2_5 4.032243e-02                 1 1 ON  45
eH2_6 9.915466e-02                 1 1 ON  46
eH2_7 1.555383e-01                 1 1 ON  47
eH2_8 1.844394e-01                 1 1 ON  48
eH2_9 6.062154e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9715
    reference variance = 0.601601
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3680e-01
  Total weights = 2.0000e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336712774904
                                         uncertainty =       0.002708153029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336712774904
                                         uncertainty =       0.002708153029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410365327
  error estimate for blocks of size 2^( 2) =       0.000423440650
  error estimate for blocks of size 2^( 3) =       0.000436744138
  error estimate for blocks of size 2^( 4) =       0.000448954085
  error estimate for blocks of size 2^( 5) =       0.000460567869
  error estimate for blocks of size 2^( 6) =       0.000468763620
  error estimate for blocks of size 2^( 7) =       0.000475297522

      target function =                  N/A
              le_mean =     -16.905874646592
             les_mean =     286.145396801696
             stat err =       0.000463395774
             autocorr =       1.275154533640
              std dev =       0.580344211482
             le_variance =       0.336799403800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336719332014
                                         uncertainty =       0.002708479004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336719332014
                                         uncertainty =       0.002708479004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410369276
  error estimate for blocks of size 2^( 2) =       0.000423436181
  error estimate for blocks of size 2^( 3) =       0.000436731997
  error estimate for blocks of size 2^( 4) =       0.000448936877
  error estimate for blocks of size 2^( 5) =       0.000460554965
  error estimate for blocks of size 2^( 6) =       0.000468758856
  error estimate for blocks of size 2^( 7) =       0.000475294465

      target function =                  N/A
              le_mean =     -16.905877625817
             les_mean =     286.145504016806
             stat err =       0.000463386291
             autocorr =       1.275077803117
              std dev =       0.580349796337
             le_variance =       0.336805886108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336705389046
                                         uncertainty =       0.002708420807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336705389046
                                         uncertainty =       0.002708420807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410360787
  error estimate for blocks of size 2^( 2) =       0.000423431091
  error estimate for blocks of size 2^( 3) =       0.000436729915
  error estimate for blocks of size 2^( 4) =       0.000448937103
  error estimate for blocks of size 2^( 5) =       0.000460555275
  error estimate for blocks of size 2^( 6) =       0.000468756711
  error estimate for blocks of size 2^( 7) =       0.000475292906

      target function =                  N/A
              le_mean =     -16.905876434129
             les_mean =     286.145449789269
             stat err =       0.000463385499
             autocorr =       1.275126198512
              std dev =       0.580337790969
             le_variance =       0.336791951627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336708454468
                                         uncertainty =       0.002708177758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336708454468
                                         uncertainty =       0.002708177758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410362689
  error estimate for blocks of size 2^( 2) =       0.000423437410
  error estimate for blocks of size 2^( 3) =       0.000436740333
  error estimate for blocks of size 2^( 4) =       0.000448949996
  error estimate for blocks of size 2^( 5) =       0.000460564498
  error estimate for blocks of size 2^( 6) =       0.000468761102
  error estimate for blocks of size 2^( 7) =       0.000475295561

      target function =                  N/A
              le_mean =     -16.905874809737
             les_mean =     286.145397986688
             stat err =       0.000463392789
             autocorr =       1.275154503755
              std dev =       0.580340479885
             le_variance =       0.336795072594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905874646592        initial
     2.5000e-01     2.5000e+00             9.7313e-04       -16.905877625817  <--
     1.0000e+00     1.0000e+01             2.8660e-04       -16.905876434129
     4.0000e+00     4.0000e+01             7.4769e-05       -16.905874809737

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9710e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.100125e-01 1 1  ON 0
 uu_1                 1.431391e-01 1 1  ON 1
 uu_2                 4.147790e-02 1 1  ON 2
 uu_3                -2.117341e-02 1 1  ON 3
 uu_4                -6.674948e-02 1 1  ON 4
 uu_5                -1.017413e-01 1 1  ON 5
 uu_6                -1.291818e-01 1 1  ON 6
 uu_7                -1.427815e-01 1 1  ON 7
 uu_8                -1.349112e-01 1 1  ON 8
 uu_9                -1.060295e-01 1 1  ON 9
 ud_0                 4.499456e-01 1 1  ON 10
 ud_1                 1.840717e-01 1 1  ON 11
 ud_2                 6.348349e-02 1 1  ON 12
 ud_3                -7.992688e-03 1 1  ON 13
 ud_4                -6.553846e-02 1 1  ON 14
 ud_5                -1.075768e-01 1 1  ON 15
 ud_6                -1.354066e-01 1 1  ON 16
 ud_7                -1.521929e-01 1 1  ON 17
 ud_8                -1.533848e-01 1 1  ON 18
 ud_9                -1.440859e-01 1 1  ON 19
 eO_0                -7.598449e-01 1 1  ON 20
 eO_1                -4.384230e-01 1 1  ON 21
 eO_2                -2.136927e-02 1 1  ON 22
 eO_3                 2.982930e-01 1 1  ON 23
 eO_4                 5.261494e-01 1 1  ON 24
 eO_5                 4.886156e-01 1 1  ON 25
 eO_6                 2.608942e-01 1 1  ON 26
 eO_7                -4.053707e-02 1 1  ON 27
 eO_8                -2.231651e-01 1 1  ON 28
 eO_9                -8.880932e-02 1 1  ON 29
eH1_0                -2.496763e-01 1 1  ON 30
eH1_1                -1.469866e-01 1 1  ON 31
eH1_2                -9.898774e-02 1 1  ON 32
eH1_3                -4.457303e-02 1 1  ON 33
eH1_4                 3.694497e-03 1 1  ON 34
eH1_5                 3.770434e-02 1 1  ON 35
eH1_6                 9.700266e-02 1 1  ON 36
eH1_7                 1.545802e-01 1 1  ON 37
eH1_8                 1.796839e-01 1 1  ON 38
eH1_9                 7.124218e-02 1 1  ON 39
eH2_0                -2.473361e-01 1 1  ON 40
eH2_1                -1.446816e-01 1 1  ON 41
eH2_2                -9.663873e-02 1 1  ON 42
eH2_3                -4.240815e-02 1 1  ON 43
eH2_4                 6.291454e-03 1 1  ON 44
eH2_5                 4.037533e-02 1 1  ON 45
eH2_6                 9.921042e-02 1 1  ON 46
eH2_7                 1.556227e-01 1 1  ON 47
eH2_8                 1.847235e-01 1 1  ON 48
eH2_9                 6.114653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6982e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9244
    reference variance = 0.242434
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344603410588
                                         uncertainty =       0.004650018899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344603410588
                                         uncertainty =       0.004650018899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415123250
  error estimate for blocks of size 2^( 2) =       0.000427726978
  error estimate for blocks of size 2^( 3) =       0.000441030423
  error estimate for blocks of size 2^( 4) =       0.000452665058
  error estimate for blocks of size 2^( 5) =       0.000463682343
  error estimate for blocks of size 2^( 6) =       0.000470649750
  error estimate for blocks of size 2^( 7) =       0.000474965117

      target function =                  N/A
              le_mean =     -16.906352106064
             les_mean =     286.169395986903
             stat err =       0.000465490567
             autocorr =       1.257383202336
              std dev =       0.587072929881
             le_variance =       0.344654625000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635210606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906352106064       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906352474905       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906356254458       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906357859750       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906360173789       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906360393220       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361912731       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362310228       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906362714750       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906362583326       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906362156052       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906362426002       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906362097492       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906362178218       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.465143e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906352106064       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906352311393       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906354587014       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906355235277       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906356058422       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906355905060       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906356311256       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906356319977       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906356478225       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906356386256       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906356358395       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.553202e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906352106064       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906352180104       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906353110040       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906353263375       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906353450923       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906353315792       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906353419235       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906353450813       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906353482115       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.135484e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6216e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.103395e-01 1 1  ON 0
 uu_1                 1.432727e-01 1 1  ON 1
 uu_2                 4.135292e-02 1 1  ON 2
 uu_3                -2.102119e-02 1 1  ON 3
 uu_4                -6.677006e-02 1 1  ON 4
 uu_5                -1.019717e-01 1 1  ON 5
 uu_6                -1.295572e-01 1 1  ON 6
 uu_7                -1.431018e-01 1 1  ON 7
 uu_8                -1.351575e-01 1 1  ON 8
 uu_9                -1.060825e-01 1 1  ON 9
 ud_0                 4.504116e-01 1 1  ON 10
 ud_1                 1.843612e-01 1 1  ON 11
 ud_2                 6.351782e-02 1 1  ON 12
 ud_3                -7.940549e-03 1 1  ON 13
 ud_4                -6.564227e-02 1 1  ON 14
 ud_5                -1.075417e-01 1 1  ON 15
 ud_6                -1.354398e-01 1 1  ON 16
 ud_7                -1.521965e-01 1 1  ON 17
 ud_8                -1.535862e-01 1 1  ON 18
 ud_9                -1.444176e-01 1 1  ON 19
 eO_0                -7.598663e-01 1 1  ON 20
 eO_1                -4.379377e-01 1 1  ON 21
 eO_2                -2.110097e-02 1 1  ON 22
 eO_3                 2.980782e-01 1 1  ON 23
 eO_4                 5.258979e-01 1 1  ON 24
 eO_5                 4.888595e-01 1 1  ON 25
 eO_6                 2.613470e-01 1 1  ON 26
 eO_7                -4.046490e-02 1 1  ON 27
 eO_8                -2.236235e-01 1 1  ON 28
 eO_9                -8.929705e-02 1 1  ON 29
eH1_0                -2.501715e-01 1 1  ON 30
eH1_1                -1.472527e-01 1 1  ON 31
eH1_2                -9.916560e-02 1 1  ON 32
eH1_3                -4.464249e-02 1 1  ON 33
eH1_4                 3.807919e-03 1 1  ON 34
eH1_5                 3.766207e-02 1 1  ON 35
eH1_6                 9.657025e-02 1 1  ON 36
eH1_7                 1.544534e-01 1 1  ON 37
eH1_8                 1.802857e-01 1 1  ON 38
eH1_9                 7.205649e-02 1 1  ON 39
eH2_0                -2.480448e-01 1 1  ON 40
eH2_1                -1.453730e-01 1 1  ON 41
eH2_2                -9.704908e-02 1 1  ON 42
eH2_3                -4.256213e-02 1 1  ON 43
eH2_4                 6.427116e-03 1 1  ON 44
eH2_5                 4.074863e-02 1 1  ON 45
eH2_6                 9.933422e-02 1 1  ON 46
eH2_7                 1.556495e-01 1 1  ON 47
eH2_8                 1.850657e-01 1 1  ON 48
eH2_9                 6.200185e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.935
    reference variance = 0.314318
====================================================
  Execution time = 1.9828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3968e-01
  Total weights = 2.0000e+06
  Execution time = 1.8664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220124443
                                         uncertainty =       0.003688769399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220124443
                                         uncertainty =       0.003688769399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411846145
  error estimate for blocks of size 2^( 2) =       0.000424580776
  error estimate for blocks of size 2^( 3) =       0.000437384925
  error estimate for blocks of size 2^( 4) =       0.000449303060
  error estimate for blocks of size 2^( 5) =       0.000460016441
  error estimate for blocks of size 2^( 6) =       0.000467261168
  error estimate for blocks of size 2^( 7) =       0.000472408868

      target function =                  N/A
              le_mean =     -16.906728206290
             les_mean =     286.176692966471
             stat err =       0.000462247384
             autocorr =       1.259734180740
              std dev =       0.582438404224
             le_variance =       0.339234494714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339891116157
                                         uncertainty =       0.003696722468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339891116157
                                         uncertainty =       0.003696722468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412253215
  error estimate for blocks of size 2^( 2) =       0.000424956289
  error estimate for blocks of size 2^( 3) =       0.000437727447
  error estimate for blocks of size 2^( 4) =       0.000449620847
  error estimate for blocks of size 2^( 5) =       0.000460329601
  error estimate for blocks of size 2^( 6) =       0.000467569422
  error estimate for blocks of size 2^( 7) =       0.000472726573

      target function =                  N/A
              le_mean =     -16.906727070771
             les_mean =     286.177325501958
             stat err =       0.000462561611
             autocorr =       1.258957504461
              std dev =       0.583014087631
             le_variance =       0.339905426376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340111001871
                                         uncertainty =       0.003699115178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340111001871
                                         uncertainty =       0.003699115178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412386592
  error estimate for blocks of size 2^( 2) =       0.000425083524
  error estimate for blocks of size 2^( 3) =       0.000437851116
  error estimate for blocks of size 2^( 4) =       0.000449741192
  error estimate for blocks of size 2^( 5) =       0.000460448952
  error estimate for blocks of size 2^( 6) =       0.000467685108
  error estimate for blocks of size 2^( 7) =       0.000472836582

      target function =                  N/A
              le_mean =     -16.906730455616
             les_mean =     286.177659931184
             stat err =       0.000462677958
             autocorr =       1.258776272202
              std dev =       0.583202711227
             le_variance =       0.340125402383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339404311260
                                         uncertainty =       0.003690885342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339404311260
                                         uncertainty =       0.003690885342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411957946
  error estimate for blocks of size 2^( 2) =       0.000424684726
  error estimate for blocks of size 2^( 3) =       0.000437481584
  error estimate for blocks of size 2^( 4) =       0.000449393787
  error estimate for blocks of size 2^( 5) =       0.000460105586
  error estimate for blocks of size 2^( 6) =       0.000467348346
  error estimate for blocks of size 2^( 7) =       0.000472495682

      target function =                  N/A
              le_mean =     -16.906728452263
             les_mean =     286.176885488023
             stat err =       0.000462335850
             autocorr =       1.259532483550
              std dev =       0.582596514908
             le_variance =       0.339418699182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906728206290        initial
     6.2500e-02     6.2500e-01             3.4651e-03       -16.906727070771
     2.5000e-01     2.5000e+00             8.5532e-04       -16.906730455616  <--
     1.0000e+00     1.0000e+01             2.1355e-04       -16.906728452263

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9280e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.103395e-01 1 1  ON 0
 uu_1                 1.432727e-01 1 1  ON 1
 uu_2                 4.135292e-02 1 1  ON 2
 uu_3                -2.102119e-02 1 1  ON 3
 uu_4                -6.677006e-02 1 1  ON 4
 uu_5                -1.019717e-01 1 1  ON 5
 uu_6                -1.295572e-01 1 1  ON 6
 uu_7                -1.431018e-01 1 1  ON 7
 uu_8                -1.351575e-01 1 1  ON 8
 uu_9                -1.060825e-01 1 1  ON 9
 ud_0                 4.504116e-01 1 1  ON 10
 ud_1                 1.843612e-01 1 1  ON 11
 ud_2                 6.351782e-02 1 1  ON 12
 ud_3                -7.940549e-03 1 1  ON 13
 ud_4                -6.564227e-02 1 1  ON 14
 ud_5                -1.075417e-01 1 1  ON 15
 ud_6                -1.354398e-01 1 1  ON 16
 ud_7                -1.521965e-01 1 1  ON 17
 ud_8                -1.535862e-01 1 1  ON 18
 ud_9                -1.444176e-01 1 1  ON 19
 eO_0                -7.598663e-01 1 1  ON 20
 eO_1                -4.379377e-01 1 1  ON 21
 eO_2                -2.110097e-02 1 1  ON 22
 eO_3                 2.980782e-01 1 1  ON 23
 eO_4                 5.258979e-01 1 1  ON 24
 eO_5                 4.888595e-01 1 1  ON 25
 eO_6                 2.613470e-01 1 1  ON 26
 eO_7                -4.046490e-02 1 1  ON 27
 eO_8                -2.236235e-01 1 1  ON 28
 eO_9                -8.929705e-02 1 1  ON 29
eH1_0                -2.501715e-01 1 1  ON 30
eH1_1                -1.472527e-01 1 1  ON 31
eH1_2                -9.916560e-02 1 1  ON 32
eH1_3                -4.464249e-02 1 1  ON 33
eH1_4                 3.807919e-03 1 1  ON 34
eH1_5                 3.766207e-02 1 1  ON 35
eH1_6                 9.657025e-02 1 1  ON 36
eH1_7                 1.544534e-01 1 1  ON 37
eH1_8                 1.802857e-01 1 1  ON 38
eH1_9                 7.205649e-02 1 1  ON 39
eH2_0                -2.480448e-01 1 1  ON 40
eH2_1                -1.453730e-01 1 1  ON 41
eH2_2                -9.704908e-02 1 1  ON 42
eH2_3                -4.256213e-02 1 1  ON 43
eH2_4                 6.427116e-03 1 1  ON 44
eH2_5                 4.074863e-02 1 1  ON 45
eH2_6                 9.933422e-02 1 1  ON 46
eH2_7                 1.556495e-01 1 1  ON 47
eH2_8                 1.850657e-01 1 1  ON 48
eH2_9                 6.200185e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5504e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6956e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9271
    reference variance = 0.255846
====================================================
  Execution time = 2.0591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3040e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330355890240
                                         uncertainty =       0.002538872862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330355890240
                                         uncertainty =       0.002538872862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406448464
  error estimate for blocks of size 2^( 2) =       0.000419676563
  error estimate for blocks of size 2^( 3) =       0.000433129837
  error estimate for blocks of size 2^( 4) =       0.000445665766
  error estimate for blocks of size 2^( 5) =       0.000456810174
  error estimate for blocks of size 2^( 6) =       0.000465000591
  error estimate for blocks of size 2^( 7) =       0.000469874621

      target function =                  N/A
              le_mean =     -16.906243729169
             les_mean =     286.151477571950
             stat err =       0.000459337788
             autocorr =       1.277183730464
              std dev =       0.574804929586
             le_variance =       0.330400707076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624372917e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906243729169       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244431032       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906241808727       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906241737875       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906245082169       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906246523120       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906245366140       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906245109118       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906245849729       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906247066797       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906246129204       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906246273308       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906246592053       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.243625e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906243729169       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244152230       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906242357079       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906242000788       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906242446464       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906243809214       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906243565627       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906243402320       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906243532107       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906243691458       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.139718e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906243729169       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906243892581       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906243142302       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906242885603       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906242794649       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906243032497       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906243295314       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906243213055       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.993526e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7036e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.104082e-01 1 1  ON 0
 uu_1                 1.432369e-01 1 1  ON 1
 uu_2                 4.151393e-02 1 1  ON 2
 uu_3                -2.107555e-02 1 1  ON 3
 uu_4                -6.682210e-02 1 1  ON 4
 uu_5                -1.020884e-01 1 1  ON 5
 uu_6                -1.293721e-01 1 1  ON 6
 uu_7                -1.434924e-01 1 1  ON 7
 uu_8                -1.355630e-01 1 1  ON 8
 uu_9                -1.061635e-01 1 1  ON 9
 ud_0                 4.503589e-01 1 1  ON 10
 ud_1                 1.844259e-01 1 1  ON 11
 ud_2                 6.349956e-02 1 1  ON 12
 ud_3                -8.055135e-03 1 1  ON 13
 ud_4                -6.551012e-02 1 1  ON 14
 ud_5                -1.077097e-01 1 1  ON 15
 ud_6                -1.356626e-01 1 1  ON 16
 ud_7                -1.526784e-01 1 1  ON 17
 ud_8                -1.533434e-01 1 1  ON 18
 ud_9                -1.439528e-01 1 1  ON 19
 eO_0                -7.595048e-01 1 1  ON 20
 eO_1                -4.380093e-01 1 1  ON 21
 eO_2                -2.105664e-02 1 1  ON 22
 eO_3                 2.979877e-01 1 1  ON 23
 eO_4                 5.259966e-01 1 1  ON 24
 eO_5                 4.891044e-01 1 1  ON 25
 eO_6                 2.614844e-01 1 1  ON 26
 eO_7                -4.044483e-02 1 1  ON 27
 eO_8                -2.239304e-01 1 1  ON 28
 eO_9                -8.967733e-02 1 1  ON 29
eH1_0                -2.508352e-01 1 1  ON 30
eH1_1                -1.478514e-01 1 1  ON 31
eH1_2                -9.941447e-02 1 1  ON 32
eH1_3                -4.480415e-02 1 1  ON 33
eH1_4                 3.598430e-03 1 1  ON 34
eH1_5                 3.755224e-02 1 1  ON 35
eH1_6                 9.666618e-02 1 1  ON 36
eH1_7                 1.547140e-01 1 1  ON 37
eH1_8                 1.809272e-01 1 1  ON 38
eH1_9                 7.284664e-02 1 1  ON 39
eH2_0                -2.484263e-01 1 1  ON 40
eH2_1                -1.457024e-01 1 1  ON 41
eH2_2                -9.731109e-02 1 1  ON 42
eH2_3                -4.275306e-02 1 1  ON 43
eH2_4                 6.320356e-03 1 1  ON 44
eH2_5                 4.041693e-02 1 1  ON 45
eH2_6                 9.956390e-02 1 1  ON 46
eH2_7                 1.557656e-01 1 1  ON 47
eH2_8                 1.853895e-01 1 1  ON 48
eH2_9                 6.281582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9301
    reference variance = 0.160285
====================================================
  Execution time = 2.0076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4340e-01
  Total weights = 2.0000e+06
  Execution time = 1.8811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343529848236
                                         uncertainty =       0.006135155439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343529848236
                                         uncertainty =       0.006135155439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414450437
  error estimate for blocks of size 2^( 2) =       0.000427384657
  error estimate for blocks of size 2^( 3) =       0.000440776927
  error estimate for blocks of size 2^( 4) =       0.000453495725
  error estimate for blocks of size 2^( 5) =       0.000463953058
  error estimate for blocks of size 2^( 6) =       0.000471467984
  error estimate for blocks of size 2^( 7) =       0.000475719665

      target function =                  N/A
              le_mean =     -16.906080372727
             les_mean =     286.159091726423
             stat err =       0.000466159108
             autocorr =       1.265095014704
              std dev =       0.586121428629
             le_variance =       0.343538329098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343387861818
                                         uncertainty =       0.006132806005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343387861818
                                         uncertainty =       0.006132806005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414364814
  error estimate for blocks of size 2^( 2) =       0.000427305156
  error estimate for blocks of size 2^( 3) =       0.000440703002
  error estimate for blocks of size 2^( 4) =       0.000453425838
  error estimate for blocks of size 2^( 5) =       0.000463884080
  error estimate for blocks of size 2^( 6) =       0.000471399985
  error estimate for blocks of size 2^( 7) =       0.000475650702

      target function =                  N/A
              le_mean =     -16.906078069558
             les_mean =     286.158871920637
             stat err =       0.000466090151
             autocorr =       1.265243491585
              std dev =       0.586000339886
             le_variance =       0.343396398347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343259647539
                                         uncertainty =       0.006129078974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343259647539
                                         uncertainty =       0.006129078974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414287451
  error estimate for blocks of size 2^( 2) =       0.000427230272
  error estimate for blocks of size 2^( 3) =       0.000440631287
  error estimate for blocks of size 2^( 4) =       0.000453359996
  error estimate for blocks of size 2^( 5) =       0.000463824012
  error estimate for blocks of size 2^( 6) =       0.000471343094
  error estimate for blocks of size 2^( 7) =       0.000475599569

      target function =                  N/A
              le_mean =     -16.906077457045
             les_mean =     286.158722996055
             stat err =       0.000466031668
             autocorr =       1.265398457271
              std dev =       0.585890931915
             le_variance =       0.343268184101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343457074550
                                         uncertainty =       0.006133552594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343457074550
                                         uncertainty =       0.006133552594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414406547
  error estimate for blocks of size 2^( 2) =       0.000427342594
  error estimate for blocks of size 2^( 3) =       0.000440736618
  error estimate for blocks of size 2^( 4) =       0.000453457791
  error estimate for blocks of size 2^( 5) =       0.000463917011
  error estimate for blocks of size 2^( 6) =       0.000471432906
  error estimate for blocks of size 2^( 7) =       0.000475686083

      target function =                  N/A
              le_mean =     -16.906079283180
             les_mean =     286.158982129674
             stat err =       0.000466123448
             autocorr =       1.265169415441
              std dev =       0.586059358967
             le_variance =       0.343465572233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906080372727        initial  <--
     6.2500e-02     6.2500e-01             3.2436e-03       -16.906078069558
     2.5000e-01     2.5000e+00             8.1397e-04       -16.906077457045
     1.0000e+00     1.0000e+01             1.9935e-04       -16.906079283180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5336
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.103395e-01 1 1  ON 0
 uu_1                 1.432727e-01 1 1  ON 1
 uu_2                 4.135292e-02 1 1  ON 2
 uu_3                -2.102119e-02 1 1  ON 3
 uu_4                -6.677006e-02 1 1  ON 4
 uu_5                -1.019717e-01 1 1  ON 5
 uu_6                -1.295572e-01 1 1  ON 6
 uu_7                -1.431018e-01 1 1  ON 7
 uu_8                -1.351575e-01 1 1  ON 8
 uu_9                -1.060825e-01 1 1  ON 9
 ud_0                 4.504116e-01 1 1  ON 10
 ud_1                 1.843612e-01 1 1  ON 11
 ud_2                 6.351782e-02 1 1  ON 12
 ud_3                -7.940549e-03 1 1  ON 13
 ud_4                -6.564227e-02 1 1  ON 14
 ud_5                -1.075417e-01 1 1  ON 15
 ud_6                -1.354398e-01 1 1  ON 16
 ud_7                -1.521965e-01 1 1  ON 17
 ud_8                -1.535862e-01 1 1  ON 18
 ud_9                -1.444176e-01 1 1  ON 19
 eO_0                -7.598663e-01 1 1  ON 20
 eO_1                -4.379377e-01 1 1  ON 21
 eO_2                -2.110097e-02 1 1  ON 22
 eO_3                 2.980782e-01 1 1  ON 23
 eO_4                 5.258979e-01 1 1  ON 24
 eO_5                 4.888595e-01 1 1  ON 25
 eO_6                 2.613470e-01 1 1  ON 26
 eO_7                -4.046490e-02 1 1  ON 27
 eO_8                -2.236235e-01 1 1  ON 28
 eO_9                -8.929705e-02 1 1  ON 29
eH1_0                -2.501715e-01 1 1  ON 30
eH1_1                -1.472527e-01 1 1  ON 31
eH1_2                -9.916560e-02 1 1  ON 32
eH1_3                -4.464249e-02 1 1  ON 33
eH1_4                 3.807919e-03 1 1  ON 34
eH1_5                 3.766207e-02 1 1  ON 35
eH1_6                 9.657025e-02 1 1  ON 36
eH1_7                 1.544534e-01 1 1  ON 37
eH1_8                 1.802857e-01 1 1  ON 38
eH1_9                 7.205649e-02 1 1  ON 39
eH2_0                -2.480448e-01 1 1  ON 40
eH2_1                -1.453730e-01 1 1  ON 41
eH2_2                -9.704908e-02 1 1  ON 42
eH2_3                -4.256213e-02 1 1  ON 43
eH2_4                 6.427116e-03 1 1  ON 44
eH2_5                 4.074863e-02 1 1  ON 45
eH2_6                 9.933422e-02 1 1  ON 46
eH2_7                 1.556495e-01 1 1  ON 47
eH2_8                 1.850657e-01 1 1  ON 48
eH2_9                 6.200185e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6947e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 0.250176
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486885140
                                         uncertainty =       0.003431132728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486885140
                                         uncertainty =       0.003431132728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410238628
  error estimate for blocks of size 2^( 2) =       0.000422579997
  error estimate for blocks of size 2^( 3) =       0.000435852634
  error estimate for blocks of size 2^( 4) =       0.000447673997
  error estimate for blocks of size 2^( 5) =       0.000457600981
  error estimate for blocks of size 2^( 6) =       0.000466254538
  error estimate for blocks of size 2^( 7) =       0.000470115644

      target function =                  N/A
              le_mean =     -16.906530211300
             les_mean =     286.167355081271
             stat err =       0.000460411290
             autocorr =       1.259559903144
              std dev =       0.580165031672
             le_variance =       0.336591463975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653021130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530211300       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530492246       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906530333727       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530252360       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529526425       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529524641       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529762572       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906530016982       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906529979824       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.319740e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530211300       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530296065       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906530244366       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530238110       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906530024698       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906530043911       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906530108976       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906530151602       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.247828e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530211300       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530233647       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906530219752       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530219483       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906530165384       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906530173832       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906530188558       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906530196956       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.075343e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6083e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.103866e-01 1 1  ON 0
 uu_1                 1.432675e-01 1 1  ON 1
 uu_2                 4.139678e-02 1 1  ON 2
 uu_3                -2.104686e-02 1 1  ON 3
 uu_4                -6.677576e-02 1 1  ON 4
 uu_5                -1.019208e-01 1 1  ON 5
 uu_6                -1.295900e-01 1 1  ON 6
 uu_7                -1.431427e-01 1 1  ON 7
 uu_8                -1.351737e-01 1 1  ON 8
 uu_9                -1.061235e-01 1 1  ON 9
 ud_0                 4.504025e-01 1 1  ON 10
 ud_1                 1.843719e-01 1 1  ON 11
 ud_2                 6.352870e-02 1 1  ON 12
 ud_3                -7.944383e-03 1 1  ON 13
 ud_4                -6.561394e-02 1 1  ON 14
 ud_5                -1.075176e-01 1 1  ON 15
 ud_6                -1.354112e-01 1 1  ON 16
 ud_7                -1.521947e-01 1 1  ON 17
 ud_8                -1.535997e-01 1 1  ON 18
 ud_9                -1.444437e-01 1 1  ON 19
 eO_0                -7.598122e-01 1 1  ON 20
 eO_1                -4.379602e-01 1 1  ON 21
 eO_2                -2.107751e-02 1 1  ON 22
 eO_3                 2.980828e-01 1 1  ON 23
 eO_4                 5.259081e-01 1 1  ON 24
 eO_5                 4.888583e-01 1 1  ON 25
 eO_6                 2.613762e-01 1 1  ON 26
 eO_7                -4.044464e-02 1 1  ON 27
 eO_8                -2.236650e-01 1 1  ON 28
 eO_9                -8.935929e-02 1 1  ON 29
eH1_0                -2.502150e-01 1 1  ON 30
eH1_1                -1.472869e-01 1 1  ON 31
eH1_2                -9.919710e-02 1 1  ON 32
eH1_3                -4.468385e-02 1 1  ON 33
eH1_4                 3.808177e-03 1 1  ON 34
eH1_5                 3.770663e-02 1 1  ON 35
eH1_6                 9.655448e-02 1 1  ON 36
eH1_7                 1.544369e-01 1 1  ON 37
eH1_8                 1.803545e-01 1 1  ON 38
eH1_9                 7.213013e-02 1 1  ON 39
eH2_0                -2.481002e-01 1 1  ON 40
eH2_1                -1.453595e-01 1 1  ON 41
eH2_2                -9.710541e-02 1 1  ON 42
eH2_3                -4.252253e-02 1 1  ON 43
eH2_4                 6.355239e-03 1 1  ON 44
eH2_5                 4.073036e-02 1 1  ON 45
eH2_6                 9.938062e-02 1 1  ON 46
eH2_7                 1.556456e-01 1 1  ON 47
eH2_8                 1.850876e-01 1 1  ON 48
eH2_9                 6.208432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.892
    reference variance = 0.345098
====================================================
  Execution time = 2.0698e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3865e-01
  Total weights = 2.0000e+06
  Execution time = 1.8748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338693029370
                                         uncertainty =       0.003268642409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338693029370
                                         uncertainty =       0.003268642409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411503520
  error estimate for blocks of size 2^( 2) =       0.000424681239
  error estimate for blocks of size 2^( 3) =       0.000438314780
  error estimate for blocks of size 2^( 4) =       0.000451489975
  error estimate for blocks of size 2^( 5) =       0.000462275709
  error estimate for blocks of size 2^( 6) =       0.000471779539
  error estimate for blocks of size 2^( 7) =       0.000477146637

      target function =                  N/A
              le_mean =     -16.904683293249
             les_mean =     286.106987369377
             stat err =       0.000465672965
             autocorr =       1.280604258514
              std dev =       0.581953858691
             le_variance =       0.338670293645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652005453
                                         uncertainty =       0.003267996915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652005453
                                         uncertainty =       0.003267996915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411478605
  error estimate for blocks of size 2^( 2) =       0.000424656178
  error estimate for blocks of size 2^( 3) =       0.000438288393
  error estimate for blocks of size 2^( 4) =       0.000451461775
  error estimate for blocks of size 2^( 5) =       0.000462246768
  error estimate for blocks of size 2^( 6) =       0.000471753573
  error estimate for blocks of size 2^( 7) =       0.000477119216

      target function =                  N/A
              le_mean =     -16.904683256371
             les_mean =     286.106945114317
             stat err =       0.000465645333
             autocorr =       1.280607351546
              std dev =       0.581918624374
             le_variance =       0.338629285394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338655851901
                                         uncertainty =       0.003268143347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338655851901
                                         uncertainty =       0.003268143347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411480939
  error estimate for blocks of size 2^( 2) =       0.000424658972
  error estimate for blocks of size 2^( 3) =       0.000438292101
  error estimate for blocks of size 2^( 4) =       0.000451466579
  error estimate for blocks of size 2^( 5) =       0.000462251856
  error estimate for blocks of size 2^( 6) =       0.000471758139
  error estimate for blocks of size 2^( 7) =       0.000477124083

      target function =                  N/A
              le_mean =     -16.904683287656
             les_mean =     286.106950012696
             stat err =       0.000465650164
             autocorr =       1.280619400132
              std dev =       0.581921924375
             le_variance =       0.338633126068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338687408585
                                         uncertainty =       0.003268570623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338687408585
                                         uncertainty =       0.003268570623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500106
  error estimate for blocks of size 2^( 2) =       0.000424677881
  error estimate for blocks of size 2^( 3) =       0.000438311384
  error estimate for blocks of size 2^( 4) =       0.000451486500
  error estimate for blocks of size 2^( 5) =       0.000462272169
  error estimate for blocks of size 2^( 6) =       0.000471776354
  error estimate for blocks of size 2^( 7) =       0.000477143284

      target function =                  N/A
              le_mean =     -16.904683286434
             les_mean =     286.106981519378
             stat err =       0.000465669577
             autocorr =       1.280606873674
              std dev =       0.581949030465
             le_variance =       0.338664674059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904683293249        initial  <--
     6.2500e-01     6.2500e+00             3.3197e-04       -16.904683256371
     2.5000e+00     2.5000e+01             8.2478e-05       -16.904683287656
     1.0000e+01     1.0000e+02             2.0753e-05       -16.904683286434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1410
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.103395e-01 1 1  ON 0
 uu_1                 1.432727e-01 1 1  ON 1
 uu_2                 4.135292e-02 1 1  ON 2
 uu_3                -2.102119e-02 1 1  ON 3
 uu_4                -6.677006e-02 1 1  ON 4
 uu_5                -1.019717e-01 1 1  ON 5
 uu_6                -1.295572e-01 1 1  ON 6
 uu_7                -1.431018e-01 1 1  ON 7
 uu_8                -1.351575e-01 1 1  ON 8
 uu_9                -1.060825e-01 1 1  ON 9
 ud_0                 4.504116e-01 1 1  ON 10
 ud_1                 1.843612e-01 1 1  ON 11
 ud_2                 6.351782e-02 1 1  ON 12
 ud_3                -7.940549e-03 1 1  ON 13
 ud_4                -6.564227e-02 1 1  ON 14
 ud_5                -1.075417e-01 1 1  ON 15
 ud_6                -1.354398e-01 1 1  ON 16
 ud_7                -1.521965e-01 1 1  ON 17
 ud_8                -1.535862e-01 1 1  ON 18
 ud_9                -1.444176e-01 1 1  ON 19
 eO_0                -7.598663e-01 1 1  ON 20
 eO_1                -4.379377e-01 1 1  ON 21
 eO_2                -2.110097e-02 1 1  ON 22
 eO_3                 2.980782e-01 1 1  ON 23
 eO_4                 5.258979e-01 1 1  ON 24
 eO_5                 4.888595e-01 1 1  ON 25
 eO_6                 2.613470e-01 1 1  ON 26
 eO_7                -4.046490e-02 1 1  ON 27
 eO_8                -2.236235e-01 1 1  ON 28
 eO_9                -8.929705e-02 1 1  ON 29
eH1_0                -2.501715e-01 1 1  ON 30
eH1_1                -1.472527e-01 1 1  ON 31
eH1_2                -9.916560e-02 1 1  ON 32
eH1_3                -4.464249e-02 1 1  ON 33
eH1_4                 3.807919e-03 1 1  ON 34
eH1_5                 3.766207e-02 1 1  ON 35
eH1_6                 9.657025e-02 1 1  ON 36
eH1_7                 1.544534e-01 1 1  ON 37
eH1_8                 1.802857e-01 1 1  ON 38
eH1_9                 7.205649e-02 1 1  ON 39
eH2_0                -2.480448e-01 1 1  ON 40
eH2_1                -1.453730e-01 1 1  ON 41
eH2_2                -9.704908e-02 1 1  ON 42
eH2_3                -4.256213e-02 1 1  ON 43
eH2_4                 6.427116e-03 1 1  ON 44
eH2_5                 4.074863e-02 1 1  ON 45
eH2_6                 9.933422e-02 1 1  ON 46
eH2_7                 1.556495e-01 1 1  ON 47
eH2_8                 1.850657e-01 1 1  ON 48
eH2_9                 6.200185e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6291e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8901
    reference variance = 0.210256
====================================================
  Execution time = 2.0418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3177e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331792077912
                                         uncertainty =       0.003300088513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331792077912
                                         uncertainty =       0.003300088513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407286867
  error estimate for blocks of size 2^( 2) =       0.000420087234
  error estimate for blocks of size 2^( 3) =       0.000432985487
  error estimate for blocks of size 2^( 4) =       0.000445226295
  error estimate for blocks of size 2^( 5) =       0.000456257317
  error estimate for blocks of size 2^( 6) =       0.000465506588
  error estimate for blocks of size 2^( 7) =       0.000470923831

      target function =                  N/A
              le_mean =     -16.906158725599
             les_mean =     286.149967872573
             stat err =       0.000459478508
             autocorr =       1.272710396042
              std dev =       0.575990610439
             le_variance =       0.331765183314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615872560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906158725599       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158789688       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158809656       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158843217       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158838038       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158850800       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158878711       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158880305       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.907601e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906158725599       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158742035       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158747630       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158756320       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158755109       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158758341       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158765711       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158766195       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.785151e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906158725599       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158729735       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158731175       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158733367       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158733071       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158733882       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158735752       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158735881       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.447359e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6067e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.103423e-01 1 1  ON 0
 uu_1                 1.432695e-01 1 1  ON 1
 uu_2                 4.135989e-02 1 1  ON 2
 uu_3                -2.102293e-02 1 1  ON 3
 uu_4                -6.676895e-02 1 1  ON 4
 uu_5                -1.019703e-01 1 1  ON 5
 uu_6                -1.295600e-01 1 1  ON 6
 uu_7                -1.431072e-01 1 1  ON 7
 uu_8                -1.351611e-01 1 1  ON 8
 uu_9                -1.060834e-01 1 1  ON 9
 ud_0                 4.504103e-01 1 1  ON 10
 ud_1                 1.843590e-01 1 1  ON 11
 ud_2                 6.352510e-02 1 1  ON 12
 ud_3                -7.944512e-03 1 1  ON 13
 ud_4                -6.564009e-02 1 1  ON 14
 ud_5                -1.075408e-01 1 1  ON 15
 ud_6                -1.354401e-01 1 1  ON 16
 ud_7                -1.521955e-01 1 1  ON 17
 ud_8                -1.535877e-01 1 1  ON 18
 ud_9                -1.444180e-01 1 1  ON 19
 eO_0                -7.598574e-01 1 1  ON 20
 eO_1                -4.379409e-01 1 1  ON 21
 eO_2                -2.110122e-02 1 1  ON 22
 eO_3                 2.980766e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888624e-01 1 1  ON 25
 eO_6                 2.613485e-01 1 1  ON 26
 eO_7                -4.046410e-02 1 1  ON 27
 eO_8                -2.236275e-01 1 1  ON 28
 eO_9                -8.930195e-02 1 1  ON 29
eH1_0                -2.501805e-01 1 1  ON 30
eH1_1                -1.472563e-01 1 1  ON 31
eH1_2                -9.916658e-02 1 1  ON 32
eH1_3                -4.464256e-02 1 1  ON 33
eH1_4                 3.805980e-03 1 1  ON 34
eH1_5                 3.766080e-02 1 1  ON 35
eH1_6                 9.657327e-02 1 1  ON 36
eH1_7                 1.544557e-01 1 1  ON 37
eH1_8                 1.802917e-01 1 1  ON 38
eH1_9                 7.206236e-02 1 1  ON 39
eH2_0                -2.480492e-01 1 1  ON 40
eH2_1                -1.453758e-01 1 1  ON 41
eH2_2                -9.705442e-02 1 1  ON 42
eH2_3                -4.256377e-02 1 1  ON 43
eH2_4                 6.423254e-03 1 1  ON 44
eH2_5                 4.074963e-02 1 1  ON 45
eH2_6                 9.933724e-02 1 1  ON 46
eH2_7                 1.556484e-01 1 1  ON 47
eH2_8                 1.850690e-01 1 1  ON 48
eH2_9                 6.201163e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9654
    reference variance = 0.739616
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4145e-01
  Total weights = 2.0000e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341522034060
                                         uncertainty =       0.003668075727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341522034060
                                         uncertainty =       0.003668075727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413193891
  error estimate for blocks of size 2^( 2) =       0.000425589794
  error estimate for blocks of size 2^( 3) =       0.000438980759
  error estimate for blocks of size 2^( 4) =       0.000451245392
  error estimate for blocks of size 2^( 5) =       0.000461383841
  error estimate for blocks of size 2^( 6) =       0.000468571757
  error estimate for blocks of size 2^( 7) =       0.000473015730

      target function =                  N/A
              le_mean =     -16.906523075371
             les_mean =     286.171980711250
             stat err =       0.000463554180
             autocorr =       1.258615913145
              std dev =       0.584344405220
             le_variance =       0.341458383912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341493116169
                                         uncertainty =       0.003667588888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341493116169
                                         uncertainty =       0.003667588888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413176392
  error estimate for blocks of size 2^( 2) =       0.000425573343
  error estimate for blocks of size 2^( 3) =       0.000438965012
  error estimate for blocks of size 2^( 4) =       0.000451230052
  error estimate for blocks of size 2^( 5) =       0.000461369583
  error estimate for blocks of size 2^( 6) =       0.000468557733
  error estimate for blocks of size 2^( 7) =       0.000473002684

      target function =                  N/A
              le_mean =     -16.906523159324
             les_mean =     286.171954627155
             stat err =       0.000463540013
             autocorr =       1.258645594221
              std dev =       0.584319656631
             le_variance =       0.341429461125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341506784452
                                         uncertainty =       0.003667817045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341506784452
                                         uncertainty =       0.003667817045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413184663
  error estimate for blocks of size 2^( 2) =       0.000425581124
  error estimate for blocks of size 2^( 3) =       0.000438972463
  error estimate for blocks of size 2^( 4) =       0.000451237317
  error estimate for blocks of size 2^( 5) =       0.000461376348
  error estimate for blocks of size 2^( 6) =       0.000468564385
  error estimate for blocks of size 2^( 7) =       0.000473008876

      target function =                  N/A
              le_mean =     -16.906523121898
             les_mean =     286.171967032215
             stat err =       0.000463546732
             autocorr =       1.258631687842
              std dev =       0.584331354353
             le_variance =       0.341443131679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341520099364
                                         uncertainty =       0.003668042867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341520099364
                                         uncertainty =       0.003668042867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413192721
  error estimate for blocks of size 2^( 2) =       0.000425588694
  error estimate for blocks of size 2^( 3) =       0.000438979707
  error estimate for blocks of size 2^( 4) =       0.000451244368
  error estimate for blocks of size 2^( 5) =       0.000461382891
  error estimate for blocks of size 2^( 6) =       0.000468570822
  error estimate for blocks of size 2^( 7) =       0.000473014861

      target function =                  N/A
              le_mean =     -16.906523081191
             les_mean =     286.171978972991
             stat err =       0.000463553236
             autocorr =       1.258617917447
              std dev =       0.584342749491
             le_variance =       0.341456448882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906523075371        initial
     6.2500e+00     6.2500e+01             3.9076e-05       -16.906523159324  <--
     2.5000e+01     2.5000e+02             9.7852e-06       -16.906523121898
     1.0000e+02     1.0000e+03             2.4474e-06       -16.906523081191

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9617e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.103504e-01 1 1  ON 0
 uu_1                 1.432611e-01 1 1  ON 1
 uu_2                 4.137930e-02 1 1  ON 2
 uu_3                -2.102720e-02 1 1  ON 3
 uu_4                -6.676593e-02 1 1  ON 4
 uu_5                -1.019662e-01 1 1  ON 5
 uu_6                -1.295685e-01 1 1  ON 6
 uu_7                -1.431236e-01 1 1  ON 7
 uu_8                -1.351718e-01 1 1  ON 8
 uu_9                -1.060861e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843534e-01 1 1  ON 11
 ud_2                 6.354504e-02 1 1  ON 12
 ud_3                -7.954873e-03 1 1  ON 13
 ud_4                -6.563431e-02 1 1  ON 14
 ud_5                -1.075378e-01 1 1  ON 15
 ud_6                -1.354409e-01 1 1  ON 16
 ud_7                -1.521926e-01 1 1  ON 17
 ud_8                -1.535922e-01 1 1  ON 18
 ud_9                -1.444191e-01 1 1  ON 19
 eO_0                -7.598316e-01 1 1  ON 20
 eO_1                -4.379496e-01 1 1  ON 21
 eO_2                -2.110144e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258987e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613531e-01 1 1  ON 26
 eO_7                -4.046172e-02 1 1  ON 27
 eO_8                -2.236395e-01 1 1  ON 28
 eO_9                -8.931661e-02 1 1  ON 29
eH1_0                -2.502074e-01 1 1  ON 30
eH1_1                -1.472668e-01 1 1  ON 31
eH1_2                -9.916989e-02 1 1  ON 32
eH1_3                -4.464276e-02 1 1  ON 33
eH1_4                 3.800176e-03 1 1  ON 34
eH1_5                 3.765697e-02 1 1  ON 35
eH1_6                 9.658227e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803096e-01 1 1  ON 38
eH1_9                 7.207993e-02 1 1  ON 39
eH2_0                -2.480625e-01 1 1  ON 40
eH2_1                -1.453840e-01 1 1  ON 41
eH2_2                -9.707032e-02 1 1  ON 42
eH2_3                -4.256870e-02 1 1  ON 43
eH2_4                 6.411675e-03 1 1  ON 44
eH2_5                 4.075260e-02 1 1  ON 45
eH2_6                 9.934628e-02 1 1  ON 46
eH2_7                 1.556453e-01 1 1  ON 47
eH2_8                 1.850787e-01 1 1  ON 48
eH2_9                 6.204092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.202946
====================================================
  Execution time = 2.0663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3990e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340018805665
                                         uncertainty =       0.005588627888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340018805665
                                         uncertainty =       0.005588627888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412247232
  error estimate for blocks of size 2^( 2) =       0.000424747361
  error estimate for blocks of size 2^( 3) =       0.000437871770
  error estimate for blocks of size 2^( 4) =       0.000449369098
  error estimate for blocks of size 2^( 5) =       0.000459042229
  error estimate for blocks of size 2^( 6) =       0.000465105454
  error estimate for blocks of size 2^( 7) =       0.000469655122

      target function =                  N/A
              le_mean =     -16.906200045316
             les_mean =     286.159495363153
             stat err =       0.000460792976
             autocorr =       1.249384757386
              std dev =       0.583005626779
             le_variance =       0.339895560856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620004532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200045316       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200214799       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200080142       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906199883888       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200432117       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200437655       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200479305       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200480534       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.219059e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200045316       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200091699       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200052193       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906199999539       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200159583       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200147973       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200161032       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200161641       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.075860e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200045316       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200057193       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200046884       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200033467       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200074634       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200071201       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200075115       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200074964       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 7.710350e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6221e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.103504e-01 1 1  ON 0
 uu_1                 1.432550e-01 1 1  ON 1
 uu_2                 4.139264e-02 1 1  ON 2
 uu_3                -2.103559e-02 1 1  ON 3
 uu_4                -6.676246e-02 1 1  ON 4
 uu_5                -1.019512e-01 1 1  ON 5
 uu_6                -1.295676e-01 1 1  ON 6
 uu_7                -1.431394e-01 1 1  ON 7
 uu_8                -1.351943e-01 1 1  ON 8
 uu_9                -1.060953e-01 1 1  ON 9
 ud_0                 4.504125e-01 1 1  ON 10
 ud_1                 1.843653e-01 1 1  ON 11
 ud_2                 6.355748e-02 1 1  ON 12
 ud_3                -7.956252e-03 1 1  ON 13
 ud_4                -6.563382e-02 1 1  ON 14
 ud_5                -1.075390e-01 1 1  ON 15
 ud_6                -1.354289e-01 1 1  ON 16
 ud_7                -1.522034e-01 1 1  ON 17
 ud_8                -1.536024e-01 1 1  ON 18
 ud_9                -1.444285e-01 1 1  ON 19
 eO_0                -7.598089e-01 1 1  ON 20
 eO_1                -4.379629e-01 1 1  ON 21
 eO_2                -2.109515e-02 1 1  ON 22
 eO_3                 2.980679e-01 1 1  ON 23
 eO_4                 5.259123e-01 1 1  ON 24
 eO_5                 4.888881e-01 1 1  ON 25
 eO_6                 2.613584e-01 1 1  ON 26
 eO_7                -4.046225e-02 1 1  ON 27
 eO_8                -2.236589e-01 1 1  ON 28
 eO_9                -8.934116e-02 1 1  ON 29
eH1_0                -2.502178e-01 1 1  ON 30
eH1_1                -1.472952e-01 1 1  ON 31
eH1_2                -9.918064e-02 1 1  ON 32
eH1_3                -4.465278e-02 1 1  ON 33
eH1_4                 3.812626e-03 1 1  ON 34
eH1_5                 3.766080e-02 1 1  ON 35
eH1_6                 9.657786e-02 1 1  ON 36
eH1_7                 1.544624e-01 1 1  ON 37
eH1_8                 1.803259e-01 1 1  ON 38
eH1_9                 7.210836e-02 1 1  ON 39
eH2_0                -2.480912e-01 1 1  ON 40
eH2_1                -1.454089e-01 1 1  ON 41
eH2_2                -9.707418e-02 1 1  ON 42
eH2_3                -4.257676e-02 1 1  ON 43
eH2_4                 6.417267e-03 1 1  ON 44
eH2_5                 4.076045e-02 1 1  ON 45
eH2_6                 9.934785e-02 1 1  ON 46
eH2_7                 1.556433e-01 1 1  ON 47
eH2_8                 1.850975e-01 1 1  ON 48
eH2_9                 6.207168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.882
    reference variance = 0.238701
====================================================
  Execution time = 2.0042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4315e-01
  Total weights = 2.0000e+06
  Execution time = 1.8763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343109184982
                                         uncertainty =       0.003580777019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343109184982
                                         uncertainty =       0.003580777019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414223678
  error estimate for blocks of size 2^( 2) =       0.000426853143
  error estimate for blocks of size 2^( 3) =       0.000439623497
  error estimate for blocks of size 2^( 4) =       0.000451179414
  error estimate for blocks of size 2^( 5) =       0.000461145605
  error estimate for blocks of size 2^( 6) =       0.000469433613
  error estimate for blocks of size 2^( 7) =       0.000474009562

      target function =                  N/A
              le_mean =     -16.905954457718
             les_mean =     286.154458464871
             stat err =       0.000463942048
             autocorr =       1.254462349337
              std dev =       0.585800742589
             le_variance =       0.343162510017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343064905769
                                         uncertainty =       0.003580208167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343064905769
                                         uncertainty =       0.003580208167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414196968
  error estimate for blocks of size 2^( 2) =       0.000426827071
  error estimate for blocks of size 2^( 3) =       0.000439597865
  error estimate for blocks of size 2^( 4) =       0.000451153608
  error estimate for blocks of size 2^( 5) =       0.000461120874
  error estimate for blocks of size 2^( 6) =       0.000469410091
  error estimate for blocks of size 2^( 7) =       0.000473985341

      target function =                  N/A
              le_mean =     -16.905953852070
             les_mean =     286.154393733650
             stat err =       0.000463917478
             autocorr =       1.254491257595
              std dev =       0.585762969874
             le_variance =       0.343118256875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343081069670
                                         uncertainty =       0.003580449115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343081069670
                                         uncertainty =       0.003580449115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414206717
  error estimate for blocks of size 2^( 2) =       0.000426836665
  error estimate for blocks of size 2^( 3) =       0.000439607430
  error estimate for blocks of size 2^( 4) =       0.000451163315
  error estimate for blocks of size 2^( 5) =       0.000461130229
  error estimate for blocks of size 2^( 6) =       0.000469418996
  error estimate for blocks of size 2^( 7) =       0.000473994478

      target function =                  N/A
              le_mean =     -16.905954127571
             les_mean =     286.154419200867
             stat err =       0.000463926755
             autocorr =       1.254482372548
              std dev =       0.585776756872
             le_variance =       0.343134408891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343105423585
                                         uncertainty =       0.003580734285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343105423585
                                         uncertainty =       0.003580734285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414221408
  error estimate for blocks of size 2^( 2) =       0.000426850941
  error estimate for blocks of size 2^( 3) =       0.000439621354
  error estimate for blocks of size 2^( 4) =       0.000451177269
  error estimate for blocks of size 2^( 5) =       0.000461143558
  error estimate for blocks of size 2^( 6) =       0.000469431668
  error estimate for blocks of size 2^( 7) =       0.000474007552

      target function =                  N/A
              le_mean =     -16.905954414418
             les_mean =     286.154453241235
             stat err =       0.000463940012
             autocorr =       1.254465078561
              std dev =       0.585797533658
             le_variance =       0.343158750440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905954457718        initial  <--
     1.5625e+00     1.5625e+01             1.2191e-04       -16.905953852070
     6.2500e+00     6.2500e+01             3.0759e-05       -16.905954127571
     2.5000e+01     2.5000e+02             7.7103e-06       -16.905954414418

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5216
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.103504e-01 1 1  ON 0
 uu_1                 1.432611e-01 1 1  ON 1
 uu_2                 4.137930e-02 1 1  ON 2
 uu_3                -2.102720e-02 1 1  ON 3
 uu_4                -6.676593e-02 1 1  ON 4
 uu_5                -1.019662e-01 1 1  ON 5
 uu_6                -1.295685e-01 1 1  ON 6
 uu_7                -1.431236e-01 1 1  ON 7
 uu_8                -1.351718e-01 1 1  ON 8
 uu_9                -1.060861e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843534e-01 1 1  ON 11
 ud_2                 6.354504e-02 1 1  ON 12
 ud_3                -7.954873e-03 1 1  ON 13
 ud_4                -6.563431e-02 1 1  ON 14
 ud_5                -1.075378e-01 1 1  ON 15
 ud_6                -1.354409e-01 1 1  ON 16
 ud_7                -1.521926e-01 1 1  ON 17
 ud_8                -1.535922e-01 1 1  ON 18
 ud_9                -1.444191e-01 1 1  ON 19
 eO_0                -7.598316e-01 1 1  ON 20
 eO_1                -4.379496e-01 1 1  ON 21
 eO_2                -2.110144e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258987e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613531e-01 1 1  ON 26
 eO_7                -4.046172e-02 1 1  ON 27
 eO_8                -2.236395e-01 1 1  ON 28
 eO_9                -8.931661e-02 1 1  ON 29
eH1_0                -2.502074e-01 1 1  ON 30
eH1_1                -1.472668e-01 1 1  ON 31
eH1_2                -9.916989e-02 1 1  ON 32
eH1_3                -4.464276e-02 1 1  ON 33
eH1_4                 3.800176e-03 1 1  ON 34
eH1_5                 3.765697e-02 1 1  ON 35
eH1_6                 9.658227e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803096e-01 1 1  ON 38
eH1_9                 7.207993e-02 1 1  ON 39
eH2_0                -2.480625e-01 1 1  ON 40
eH2_1                -1.453840e-01 1 1  ON 41
eH2_2                -9.707032e-02 1 1  ON 42
eH2_3                -4.256870e-02 1 1  ON 43
eH2_4                 6.411675e-03 1 1  ON 44
eH2_5                 4.075260e-02 1 1  ON 45
eH2_6                 9.934628e-02 1 1  ON 46
eH2_7                 1.556453e-01 1 1  ON 47
eH2_8                 1.850787e-01 1 1  ON 48
eH2_9                 6.204092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8614
    reference variance = 0.263477
====================================================
  Execution time = 2.0361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338160622255
                                         uncertainty =       0.004085495305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338160622255
                                         uncertainty =       0.004085495305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411404745
  error estimate for blocks of size 2^( 2) =       0.000423556927
  error estimate for blocks of size 2^( 3) =       0.000435989458
  error estimate for blocks of size 2^( 4) =       0.000447168972
  error estimate for blocks of size 2^( 5) =       0.000456507552
  error estimate for blocks of size 2^( 6) =       0.000461554173
  error estimate for blocks of size 2^( 7) =       0.000468207991

      target function =                  N/A
              le_mean =     -16.906824809692
             les_mean =     286.179232704651
             stat err =       0.000458359672
             autocorr =       1.241292716285
              std dev =       0.581814169880
             le_variance =       0.338507728273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682480969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906824809692       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906824814939       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906824806691       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906824846835       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906824834380       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906824834717       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906824839760       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906824841107       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.287728e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906824809692       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906824811017       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906824808833       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906824818988       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906824815956       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906824815985       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906824817213       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906824817517       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.253205e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906824809692       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906824810024       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906824809471       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906824812017       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906824811264       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906824811268       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906824811573       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906824811647       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.162576e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5916e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.103498e-01 1 1  ON 0
 uu_1                 1.432619e-01 1 1  ON 1
 uu_2                 4.137986e-02 1 1  ON 2
 uu_3                -2.102697e-02 1 1  ON 3
 uu_4                -6.676619e-02 1 1  ON 4
 uu_5                -1.019645e-01 1 1  ON 5
 uu_6                -1.295686e-01 1 1  ON 6
 uu_7                -1.431238e-01 1 1  ON 7
 uu_8                -1.351744e-01 1 1  ON 8
 uu_9                -1.060879e-01 1 1  ON 9
 ud_0                 4.504097e-01 1 1  ON 10
 ud_1                 1.843533e-01 1 1  ON 11
 ud_2                 6.354694e-02 1 1  ON 12
 ud_3                -7.955534e-03 1 1  ON 13
 ud_4                -6.563237e-02 1 1  ON 14
 ud_5                -1.075392e-01 1 1  ON 15
 ud_6                -1.354393e-01 1 1  ON 16
 ud_7                -1.521940e-01 1 1  ON 17
 ud_8                -1.535949e-01 1 1  ON 18
 ud_9                -1.444202e-01 1 1  ON 19
 eO_0                -7.598299e-01 1 1  ON 20
 eO_1                -4.379479e-01 1 1  ON 21
 eO_2                -2.110078e-02 1 1  ON 22
 eO_3                 2.980706e-01 1 1  ON 23
 eO_4                 5.258983e-01 1 1  ON 24
 eO_5                 4.888717e-01 1 1  ON 25
 eO_6                 2.613551e-01 1 1  ON 26
 eO_7                -4.046188e-02 1 1  ON 27
 eO_8                -2.236422e-01 1 1  ON 28
 eO_9                -8.931877e-02 1 1  ON 29
eH1_0                -2.502098e-01 1 1  ON 30
eH1_1                -1.472692e-01 1 1  ON 31
eH1_2                -9.917055e-02 1 1  ON 32
eH1_3                -4.464439e-02 1 1  ON 33
eH1_4                 3.799955e-03 1 1  ON 34
eH1_5                 3.765923e-02 1 1  ON 35
eH1_6                 9.658132e-02 1 1  ON 36
eH1_7                 1.544631e-01 1 1  ON 37
eH1_8                 1.803126e-01 1 1  ON 38
eH1_9                 7.208254e-02 1 1  ON 39
eH2_0                -2.480658e-01 1 1  ON 40
eH2_1                -1.453835e-01 1 1  ON 41
eH2_2                -9.707226e-02 1 1  ON 42
eH2_3                -4.256833e-02 1 1  ON 43
eH2_4                 6.411391e-03 1 1  ON 44
eH2_5                 4.075455e-02 1 1  ON 45
eH2_6                 9.934786e-02 1 1  ON 46
eH2_7                 1.556444e-01 1 1  ON 47
eH2_8                 1.850788e-01 1 1  ON 48
eH2_9                 6.204276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9076
    reference variance = 0.224945
====================================================
  Execution time = 2.0224e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3711e-01
  Total weights = 2.0000e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337036206853
                                         uncertainty =       0.003155506225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337036206853
                                         uncertainty =       0.003155506225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410555806
  error estimate for blocks of size 2^( 2) =       0.000422824127
  error estimate for blocks of size 2^( 3) =       0.000435591444
  error estimate for blocks of size 2^( 4) =       0.000447201568
  error estimate for blocks of size 2^( 5) =       0.000455269663
  error estimate for blocks of size 2^( 6) =       0.000462280510
  error estimate for blocks of size 2^( 7) =       0.000466286203

      target function =                  N/A
              le_mean =     -16.905523210537
             les_mean =     286.133826993771
             stat err =       0.000457759486
             autocorr =       1.243169391498
              std dev =       0.580613589507
             le_variance =       0.337112140320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337041699255
                                         uncertainty =       0.003155535778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337041699255
                                         uncertainty =       0.003155535778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410559155
  error estimate for blocks of size 2^( 2) =       0.000422827176
  error estimate for blocks of size 2^( 3) =       0.000435594266
  error estimate for blocks of size 2^( 4) =       0.000447204036
  error estimate for blocks of size 2^( 5) =       0.000455271821
  error estimate for blocks of size 2^( 6) =       0.000462282467
  error estimate for blocks of size 2^( 7) =       0.000466288065

      target function =                  N/A
              le_mean =     -16.905523137384
             les_mean =     286.133830019666
             stat err =       0.000457761597
             autocorr =       1.243160577866
              std dev =       0.580618325248
             le_variance =       0.337117639613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337039005422
                                         uncertainty =       0.003155521304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337039005422
                                         uncertainty =       0.003155521304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410557513
  error estimate for blocks of size 2^( 2) =       0.000422825682
  error estimate for blocks of size 2^( 3) =       0.000435592884
  error estimate for blocks of size 2^( 4) =       0.000447202828
  error estimate for blocks of size 2^( 5) =       0.000455270764
  error estimate for blocks of size 2^( 6) =       0.000462281509
  error estimate for blocks of size 2^( 7) =       0.000466287153

      target function =                  N/A
              le_mean =     -16.905523173131
             les_mean =     286.133828531147
             stat err =       0.000457760563
             autocorr =       1.243164909118
              std dev =       0.580616002580
             le_variance =       0.337114942452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337036558211
                                         uncertainty =       0.003155508119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337036558211
                                         uncertainty =       0.003155508119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410556021
  error estimate for blocks of size 2^( 2) =       0.000422824323
  error estimate for blocks of size 2^( 3) =       0.000435591625
  error estimate for blocks of size 2^( 4) =       0.000447201727
  error estimate for blocks of size 2^( 5) =       0.000455269801
  error estimate for blocks of size 2^( 6) =       0.000462280636
  error estimate for blocks of size 2^( 7) =       0.000466286322

      target function =                  N/A
              le_mean =     -16.905523205823
             les_mean =     286.133827186207
             stat err =       0.000457759621
             autocorr =       1.243168828839
              std dev =       0.580613892468
             le_variance =       0.337112492127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905523210537        initial  <--
     1.5625e+01     1.5625e+02             1.2877e-05       -16.905523137384
     6.2500e+01     6.2500e+02             3.2532e-06       -16.905523173131
     2.5000e+02     2.5000e+03             8.1626e-07       -16.905523205823

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7409
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.103504e-01 1 1  ON 0
 uu_1                 1.432611e-01 1 1  ON 1
 uu_2                 4.137930e-02 1 1  ON 2
 uu_3                -2.102720e-02 1 1  ON 3
 uu_4                -6.676593e-02 1 1  ON 4
 uu_5                -1.019662e-01 1 1  ON 5
 uu_6                -1.295685e-01 1 1  ON 6
 uu_7                -1.431236e-01 1 1  ON 7
 uu_8                -1.351718e-01 1 1  ON 8
 uu_9                -1.060861e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843534e-01 1 1  ON 11
 ud_2                 6.354504e-02 1 1  ON 12
 ud_3                -7.954873e-03 1 1  ON 13
 ud_4                -6.563431e-02 1 1  ON 14
 ud_5                -1.075378e-01 1 1  ON 15
 ud_6                -1.354409e-01 1 1  ON 16
 ud_7                -1.521926e-01 1 1  ON 17
 ud_8                -1.535922e-01 1 1  ON 18
 ud_9                -1.444191e-01 1 1  ON 19
 eO_0                -7.598316e-01 1 1  ON 20
 eO_1                -4.379496e-01 1 1  ON 21
 eO_2                -2.110144e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258987e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613531e-01 1 1  ON 26
 eO_7                -4.046172e-02 1 1  ON 27
 eO_8                -2.236395e-01 1 1  ON 28
 eO_9                -8.931661e-02 1 1  ON 29
eH1_0                -2.502074e-01 1 1  ON 30
eH1_1                -1.472668e-01 1 1  ON 31
eH1_2                -9.916989e-02 1 1  ON 32
eH1_3                -4.464276e-02 1 1  ON 33
eH1_4                 3.800176e-03 1 1  ON 34
eH1_5                 3.765697e-02 1 1  ON 35
eH1_6                 9.658227e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803096e-01 1 1  ON 38
eH1_9                 7.207993e-02 1 1  ON 39
eH2_0                -2.480625e-01 1 1  ON 40
eH2_1                -1.453840e-01 1 1  ON 41
eH2_2                -9.707032e-02 1 1  ON 42
eH2_3                -4.256870e-02 1 1  ON 43
eH2_4                 6.411675e-03 1 1  ON 44
eH2_5                 4.075260e-02 1 1  ON 45
eH2_6                 9.934628e-02 1 1  ON 46
eH2_7                 1.556453e-01 1 1  ON 47
eH2_8                 1.850787e-01 1 1  ON 48
eH2_9                 6.204092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.204183
====================================================
  Execution time = 2.0772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3673e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336757134244
                                         uncertainty =       0.003686279872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336757134244
                                         uncertainty =       0.003686279872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410324106
  error estimate for blocks of size 2^( 2) =       0.000422775495
  error estimate for blocks of size 2^( 3) =       0.000435610094
  error estimate for blocks of size 2^( 4) =       0.000447046567
  error estimate for blocks of size 2^( 5) =       0.000457710082
  error estimate for blocks of size 2^( 6) =       0.000464534979
  error estimate for blocks of size 2^( 7) =       0.000471431917

      target function =                  N/A
              le_mean =     -16.906536878141
             les_mean =     286.167720787342
             stat err =       0.000460180886
             autocorr =       1.257775376028
              std dev =       0.580285915544
             le_variance =       0.336731743779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653687814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906536878141       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906536877750       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906536880071       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906536880875       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906536880509       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906536880467       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906536880210       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.389048e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906536878141       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906536878043       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906536878623       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906536878825       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906536878734       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906536878723       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906536878658       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.473225e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906536878141       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906536878116       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906536878261       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906536878312       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906536878289       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906536878286       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906536878271       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 8.683440e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248851 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6334e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.103503e-01 1 1  ON 0
 uu_1                 1.432611e-01 1 1  ON 1
 uu_2                 4.137943e-02 1 1  ON 2
 uu_3                -2.102728e-02 1 1  ON 3
 uu_4                -6.676597e-02 1 1  ON 4
 uu_5                -1.019661e-01 1 1  ON 5
 uu_6                -1.295687e-01 1 1  ON 6
 uu_7                -1.431237e-01 1 1  ON 7
 uu_8                -1.351718e-01 1 1  ON 8
 uu_9                -1.060860e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843535e-01 1 1  ON 11
 ud_2                 6.354508e-02 1 1  ON 12
 ud_3                -7.954913e-03 1 1  ON 13
 ud_4                -6.563430e-02 1 1  ON 14
 ud_5                -1.075377e-01 1 1  ON 15
 ud_6                -1.354408e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535922e-01 1 1  ON 18
 ud_9                -1.444190e-01 1 1  ON 19
 eO_0                -7.598312e-01 1 1  ON 20
 eO_1                -4.379497e-01 1 1  ON 21
 eO_2                -2.110146e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258986e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613532e-01 1 1  ON 26
 eO_7                -4.046163e-02 1 1  ON 27
 eO_8                -2.236397e-01 1 1  ON 28
 eO_9                -8.931679e-02 1 1  ON 29
eH1_0                -2.502076e-01 1 1  ON 30
eH1_1                -1.472668e-01 1 1  ON 31
eH1_2                -9.916999e-02 1 1  ON 32
eH1_3                -4.464276e-02 1 1  ON 33
eH1_4                 3.800095e-03 1 1  ON 34
eH1_5                 3.765687e-02 1 1  ON 35
eH1_6                 9.658232e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803097e-01 1 1  ON 38
eH1_9                 7.208017e-02 1 1  ON 39
eH2_0                -2.480628e-01 1 1  ON 40
eH2_1                -1.453842e-01 1 1  ON 41
eH2_2                -9.707040e-02 1 1  ON 42
eH2_3                -4.256868e-02 1 1  ON 43
eH2_4                 6.411638e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934616e-02 1 1  ON 46
eH2_7                 1.556452e-01 1 1  ON 47
eH2_8                 1.850789e-01 1 1  ON 48
eH2_9                 6.204127e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8761
    reference variance = 0.296803
====================================================
  Execution time = 2.2294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3247e-01
  Total weights = 2.0000e+06
  Execution time = 1.8764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590246422
                                         uncertainty =       0.002605137011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590246422
                                         uncertainty =       0.002605137011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407720293
  error estimate for blocks of size 2^( 2) =       0.000420204732
  error estimate for blocks of size 2^( 3) =       0.000433525782
  error estimate for blocks of size 2^( 4) =       0.000445097501
  error estimate for blocks of size 2^( 5) =       0.000456187455
  error estimate for blocks of size 2^( 6) =       0.000463841385
  error estimate for blocks of size 2^( 7) =       0.000467865560

      target function =                  N/A
              le_mean =     -16.906694630334
             les_mean =     286.168794831599
             stat err =       0.000458247975
             autocorr =       1.263212616461
              std dev =       0.576603567850
             le_variance =       0.332471674458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332589779522
                                         uncertainty =       0.002605133245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332589779522
                                         uncertainty =       0.002605133245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407720007
  error estimate for blocks of size 2^( 2) =       0.000420204454
  error estimate for blocks of size 2^( 3) =       0.000433525510
  error estimate for blocks of size 2^( 4) =       0.000445097242
  error estimate for blocks of size 2^( 5) =       0.000456187198
  error estimate for blocks of size 2^( 6) =       0.000463841123
  error estimate for blocks of size 2^( 7) =       0.000467865304

      target function =                  N/A
              le_mean =     -16.906694632198
             les_mean =     286.168794427768
             stat err =       0.000458247717
             autocorr =       1.263212963311
              std dev =       0.576603163032
             le_variance =       0.332471207619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590012512
                                         uncertainty =       0.002605135125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590012512
                                         uncertainty =       0.002605135125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407720149
  error estimate for blocks of size 2^( 2) =       0.000420204593
  error estimate for blocks of size 2^( 3) =       0.000433525646
  error estimate for blocks of size 2^( 4) =       0.000445097371
  error estimate for blocks of size 2^( 5) =       0.000456187326
  error estimate for blocks of size 2^( 6) =       0.000463841254
  error estimate for blocks of size 2^( 7) =       0.000467865431

      target function =                  N/A
              le_mean =     -16.906694631267
             les_mean =     286.168794629259
             stat err =       0.000458247846
             autocorr =       1.263212790297
              std dev =       0.576603365042
             le_variance =       0.332471440578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590217169
                                         uncertainty =       0.002605136775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590217169
                                         uncertainty =       0.002605136775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407720275
  error estimate for blocks of size 2^( 2) =       0.000420204714
  error estimate for blocks of size 2^( 3) =       0.000433525765
  error estimate for blocks of size 2^( 4) =       0.000445097485
  error estimate for blocks of size 2^( 5) =       0.000456187439
  error estimate for blocks of size 2^( 6) =       0.000463841369
  error estimate for blocks of size 2^( 7) =       0.000467865544

      target function =                  N/A
              le_mean =     -16.906694630451
             les_mean =     286.168794806290
             stat err =       0.000458247959
             autocorr =       1.263212638205
              std dev =       0.576603542486
             le_variance =       0.332471645208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906694630334        initial
     1.5625e+02     1.5625e+03             1.3890e-06       -16.906694632198  <--
     6.2500e+02     6.2500e+03             3.4732e-07       -16.906694631267
     2.5000e+03     2.5000e+04             8.6834e-08       -16.906694630451

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 3.1814e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.103502e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137985e-02 1 1  ON 2
 uu_3                -2.102752e-02 1 1  ON 3
 uu_4                -6.676609e-02 1 1  ON 4
 uu_5                -1.019658e-01 1 1  ON 5
 uu_6                -1.295693e-01 1 1  ON 6
 uu_7                -1.431243e-01 1 1  ON 7
 uu_8                -1.351719e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843535e-01 1 1  ON 11
 ud_2                 6.354518e-02 1 1  ON 12
 ud_3                -7.955031e-03 1 1  ON 13
 ud_4                -6.563426e-02 1 1  ON 14
 ud_5                -1.075374e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521924e-01 1 1  ON 17
 ud_8                -1.535925e-01 1 1  ON 18
 ud_9                -1.444190e-01 1 1  ON 19
 eO_0                -7.598303e-01 1 1  ON 20
 eO_1                -4.379498e-01 1 1  ON 21
 eO_2                -2.110153e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613536e-01 1 1  ON 26
 eO_7                -4.046138e-02 1 1  ON 27
 eO_8                -2.236401e-01 1 1  ON 28
 eO_9                -8.931733e-02 1 1  ON 29
eH1_0                -2.502080e-01 1 1  ON 30
eH1_1                -1.472669e-01 1 1  ON 31
eH1_2                -9.917030e-02 1 1  ON 32
eH1_3                -4.464277e-02 1 1  ON 33
eH1_4                 3.799852e-03 1 1  ON 34
eH1_5                 3.765659e-02 1 1  ON 35
eH1_6                 9.658246e-02 1 1  ON 36
eH1_7                 1.544626e-01 1 1  ON 37
eH1_8                 1.803101e-01 1 1  ON 38
eH1_9                 7.208088e-02 1 1  ON 39
eH2_0                -2.480635e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707062e-02 1 1  ON 42
eH2_3                -4.256862e-02 1 1  ON 43
eH2_4                 6.411528e-03 1 1  ON 44
eH2_5                 4.075273e-02 1 1  ON 45
eH2_6                 9.934580e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850797e-01 1 1  ON 48
eH2_9                 6.204231e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8882
    reference variance = 0.1911
====================================================
  Execution time = 2.0746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3717e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337266046585
                                         uncertainty =       0.003041972720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337266046585
                                         uncertainty =       0.003041972720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410590708
  error estimate for blocks of size 2^( 2) =       0.000423653245
  error estimate for blocks of size 2^( 3) =       0.000437192532
  error estimate for blocks of size 2^( 4) =       0.000449500832
  error estimate for blocks of size 2^( 5) =       0.000457658629
  error estimate for blocks of size 2^( 6) =       0.000466513907
  error estimate for blocks of size 2^( 7) =       0.000472425394

      target function =                  N/A
              le_mean =     -16.907065739261
             les_mean =     286.186041201862
             stat err =       0.000461524691
             autocorr =       1.263489527696
              std dev =       0.580662947619
             le_variance =       0.337169458737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690706573926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907065739261       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907065752407       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907065776494       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907065780386       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907065795285       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907065799228       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907065805026       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907065805106       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.663441e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907065739261       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907065742559       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907065748619       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907065749601       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907065753361       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907065754344       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907065755800       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907065755835       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.416779e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907065739261       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907065740086       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907065741604       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907065741850       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907065742792       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907065743038       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907065743402       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907065743416       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.542519e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6389e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.103512e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.138097e-02 1 1  ON 2
 uu_3                -2.102781e-02 1 1  ON 3
 uu_4                -6.676638e-02 1 1  ON 4
 uu_5                -1.019658e-01 1 1  ON 5
 uu_6                -1.295699e-01 1 1  ON 6
 uu_7                -1.431257e-01 1 1  ON 7
 uu_8                -1.351725e-01 1 1  ON 8
 uu_9                -1.060860e-01 1 1  ON 9
 ud_0                 4.504053e-01 1 1  ON 10
 ud_1                 1.843539e-01 1 1  ON 11
 ud_2                 6.354547e-02 1 1  ON 12
 ud_3                -7.955338e-03 1 1  ON 13
 ud_4                -6.563340e-02 1 1  ON 14
 ud_5                -1.075377e-01 1 1  ON 15
 ud_6                -1.354403e-01 1 1  ON 16
 ud_7                -1.521919e-01 1 1  ON 17
 ud_8                -1.535925e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598292e-01 1 1  ON 20
 eO_1                -4.379500e-01 1 1  ON 21
 eO_2                -2.110176e-02 1 1  ON 22
 eO_3                 2.980715e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888716e-01 1 1  ON 25
 eO_6                 2.613539e-01 1 1  ON 26
 eO_7                -4.046123e-02 1 1  ON 27
 eO_8                -2.236406e-01 1 1  ON 28
 eO_9                -8.931815e-02 1 1  ON 29
eH1_0                -2.502087e-01 1 1  ON 30
eH1_1                -1.472677e-01 1 1  ON 31
eH1_2                -9.917073e-02 1 1  ON 32
eH1_3                -4.464295e-02 1 1  ON 33
eH1_4                 3.799629e-03 1 1  ON 34
eH1_5                 3.765654e-02 1 1  ON 35
eH1_6                 9.658203e-02 1 1  ON 36
eH1_7                 1.544631e-01 1 1  ON 37
eH1_8                 1.803110e-01 1 1  ON 38
eH1_9                 7.208201e-02 1 1  ON 39
eH2_0                -2.480645e-01 1 1  ON 40
eH2_1                -1.453850e-01 1 1  ON 41
eH2_2                -9.707124e-02 1 1  ON 42
eH2_3                -4.256788e-02 1 1  ON 43
eH2_4                 6.411463e-03 1 1  ON 44
eH2_5                 4.075265e-02 1 1  ON 45
eH2_6                 9.934551e-02 1 1  ON 46
eH2_7                 1.556453e-01 1 1  ON 47
eH2_8                 1.850803e-01 1 1  ON 48
eH2_9                 6.204337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0103
    reference variance = 0.579214
====================================================
  Execution time = 2.0381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3418e-01
  Total weights = 2.0000e+06
  Execution time = 1.8641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334260206611
                                         uncertainty =       0.003698844012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334260206611
                                         uncertainty =       0.003698844012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408765246
  error estimate for blocks of size 2^( 2) =       0.000421681842
  error estimate for blocks of size 2^( 3) =       0.000435444772
  error estimate for blocks of size 2^( 4) =       0.000448049896
  error estimate for blocks of size 2^( 5) =       0.000460280033
  error estimate for blocks of size 2^( 6) =       0.000468910616
  error estimate for blocks of size 2^( 7) =       0.000473419019

      target function =                  N/A
              le_mean =     -16.906568083080
             les_mean =     286.166222232628
             stat err =       0.000462664891
             autocorr =       1.281106283986
              std dev =       0.578081354051
             le_variance =       0.334178051902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334255181231
                                         uncertainty =       0.003698813023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334255181231
                                         uncertainty =       0.003698813023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408762172
  error estimate for blocks of size 2^( 2) =       0.000421678888
  error estimate for blocks of size 2^( 3) =       0.000435441902
  error estimate for blocks of size 2^( 4) =       0.000448047161
  error estimate for blocks of size 2^( 5) =       0.000460277373
  error estimate for blocks of size 2^( 6) =       0.000468908139
  error estimate for blocks of size 2^( 7) =       0.000473416540

      target function =                  N/A
              le_mean =     -16.906568075360
             les_mean =     286.166216946241
             stat err =       0.000462662303
             autocorr =       1.281111219405
              std dev =       0.578077007443
             le_variance =       0.334173026534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334257667609
                                         uncertainty =       0.003698828391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334257667609
                                         uncertainty =       0.003698828391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408763693
  error estimate for blocks of size 2^( 2) =       0.000421680350
  error estimate for blocks of size 2^( 3) =       0.000435443322
  error estimate for blocks of size 2^( 4) =       0.000448048515
  error estimate for blocks of size 2^( 5) =       0.000460278689
  error estimate for blocks of size 2^( 6) =       0.000468909365
  error estimate for blocks of size 2^( 7) =       0.000473417767

      target function =                  N/A
              le_mean =     -16.906568079171
             les_mean =     286.166219561479
             stat err =       0.000462663584
             autocorr =       1.281108780540
              std dev =       0.578079157994
             le_variance =       0.334175512907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334259888378
                                         uncertainty =       0.003698842056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334259888378
                                         uncertainty =       0.003698842056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408765051
  error estimate for blocks of size 2^( 2) =       0.000421681655
  error estimate for blocks of size 2^( 3) =       0.000435444590
  error estimate for blocks of size 2^( 4) =       0.000448049723
  error estimate for blocks of size 2^( 5) =       0.000460279864
  error estimate for blocks of size 2^( 6) =       0.000468910459
  error estimate for blocks of size 2^( 7) =       0.000473418862

      target function =                  N/A
              le_mean =     -16.906568082587
             les_mean =     286.166221897740
             stat err =       0.000462664727
             autocorr =       1.281106596971
              std dev =       0.578081078803
             le_variance =       0.334177733670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906568083080        initial  <--
     3.9062e+01     3.9062e+02             5.6634e-06       -16.906568075360
     1.5625e+02     1.5625e+03             1.4168e-06       -16.906568079171
     6.2500e+02     6.2500e+03             3.5425e-07       -16.906568082587

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8327
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.103502e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137985e-02 1 1  ON 2
 uu_3                -2.102752e-02 1 1  ON 3
 uu_4                -6.676609e-02 1 1  ON 4
 uu_5                -1.019658e-01 1 1  ON 5
 uu_6                -1.295693e-01 1 1  ON 6
 uu_7                -1.431243e-01 1 1  ON 7
 uu_8                -1.351719e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843535e-01 1 1  ON 11
 ud_2                 6.354518e-02 1 1  ON 12
 ud_3                -7.955031e-03 1 1  ON 13
 ud_4                -6.563426e-02 1 1  ON 14
 ud_5                -1.075374e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521924e-01 1 1  ON 17
 ud_8                -1.535925e-01 1 1  ON 18
 ud_9                -1.444190e-01 1 1  ON 19
 eO_0                -7.598303e-01 1 1  ON 20
 eO_1                -4.379498e-01 1 1  ON 21
 eO_2                -2.110153e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613536e-01 1 1  ON 26
 eO_7                -4.046138e-02 1 1  ON 27
 eO_8                -2.236401e-01 1 1  ON 28
 eO_9                -8.931733e-02 1 1  ON 29
eH1_0                -2.502080e-01 1 1  ON 30
eH1_1                -1.472669e-01 1 1  ON 31
eH1_2                -9.917030e-02 1 1  ON 32
eH1_3                -4.464277e-02 1 1  ON 33
eH1_4                 3.799852e-03 1 1  ON 34
eH1_5                 3.765659e-02 1 1  ON 35
eH1_6                 9.658246e-02 1 1  ON 36
eH1_7                 1.544626e-01 1 1  ON 37
eH1_8                 1.803101e-01 1 1  ON 38
eH1_9                 7.208088e-02 1 1  ON 39
eH2_0                -2.480635e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707062e-02 1 1  ON 42
eH2_3                -4.256862e-02 1 1  ON 43
eH2_4                 6.411528e-03 1 1  ON 44
eH2_5                 4.075273e-02 1 1  ON 45
eH2_6                 9.934580e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850797e-01 1 1  ON 48
eH2_9                 6.204231e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9328
    reference variance = 0.287562
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342694602814
                                         uncertainty =       0.005973512599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342694602814
                                         uncertainty =       0.005973512599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413895474
  error estimate for blocks of size 2^( 2) =       0.000426576961
  error estimate for blocks of size 2^( 3) =       0.000440178214
  error estimate for blocks of size 2^( 4) =       0.000452297349
  error estimate for blocks of size 2^( 5) =       0.000463632319
  error estimate for blocks of size 2^( 6) =       0.000472411863
  error estimate for blocks of size 2^( 7) =       0.000478814286

      target function =                  N/A
              le_mean =     -16.905654593477
             les_mean =     286.143775989873
             stat err =       0.000466788954
             autocorr =       1.271919968614
              std dev =       0.585336593110
             le_variance =       0.342618927233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565459348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905654593477       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905654594190       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905654595994       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905654596294       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905654596298       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905654596893       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654596712       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654596408       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.878223e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905654593477       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905654593655       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905654594107       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905654594182       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905654594183       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905654594331       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654594287       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654594209       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.719603e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905654593477       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905654593522       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905654593634       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905654593653       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905654593655       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905654593696       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654593681       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654593659       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.299038e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.103503e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137986e-02 1 1  ON 2
 uu_3                -2.102761e-02 1 1  ON 3
 uu_4                -6.676608e-02 1 1  ON 4
 uu_5                -1.019658e-01 1 1  ON 5
 uu_6                -1.295693e-01 1 1  ON 6
 uu_7                -1.431243e-01 1 1  ON 7
 uu_8                -1.351719e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504064e-01 1 1  ON 10
 ud_1                 1.843536e-01 1 1  ON 11
 ud_2                 6.354522e-02 1 1  ON 12
 ud_3                -7.955036e-03 1 1  ON 13
 ud_4                -6.563419e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521924e-01 1 1  ON 17
 ud_8                -1.535925e-01 1 1  ON 18
 ud_9                -1.444190e-01 1 1  ON 19
 eO_0                -7.598302e-01 1 1  ON 20
 eO_1                -4.379498e-01 1 1  ON 21
 eO_2                -2.110151e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613537e-01 1 1  ON 26
 eO_7                -4.046138e-02 1 1  ON 27
 eO_8                -2.236401e-01 1 1  ON 28
 eO_9                -8.931741e-02 1 1  ON 29
eH1_0                -2.502081e-01 1 1  ON 30
eH1_1                -1.472670e-01 1 1  ON 31
eH1_2                -9.917033e-02 1 1  ON 32
eH1_3                -4.464275e-02 1 1  ON 33
eH1_4                 3.799892e-03 1 1  ON 34
eH1_5                 3.765667e-02 1 1  ON 35
eH1_6                 9.658249e-02 1 1  ON 36
eH1_7                 1.544626e-01 1 1  ON 37
eH1_8                 1.803102e-01 1 1  ON 38
eH1_9                 7.208098e-02 1 1  ON 39
eH2_0                -2.480636e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707069e-02 1 1  ON 42
eH2_3                -4.256866e-02 1 1  ON 43
eH2_4                 6.411472e-03 1 1  ON 44
eH2_5                 4.075271e-02 1 1  ON 45
eH2_6                 9.934582e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850798e-01 1 1  ON 48
eH2_9                 6.204248e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9158
    reference variance = 0.459986
====================================================
  Execution time = 1.9989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3498e-01
  Total weights = 2.0000e+06
  Execution time = 1.8571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040111212
                                         uncertainty =       0.002528048036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040111212
                                         uncertainty =       0.002528048036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409253224
  error estimate for blocks of size 2^( 2) =       0.000422197771
  error estimate for blocks of size 2^( 3) =       0.000435032232
  error estimate for blocks of size 2^( 4) =       0.000446734621
  error estimate for blocks of size 2^( 5) =       0.000456764834
  error estimate for blocks of size 2^( 6) =       0.000464528547
  error estimate for blocks of size 2^( 7) =       0.000468060545

      target function =                  N/A
              le_mean =     -16.906322294224
             les_mean =     286.158709751226
             stat err =       0.000459022137
             autocorr =       1.258006954125
              std dev =       0.578771459688
             le_variance =       0.334976402550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335039953601
                                         uncertainty =       0.002528048115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335039953601
                                         uncertainty =       0.002528048115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409253128
  error estimate for blocks of size 2^( 2) =       0.000422197677
  error estimate for blocks of size 2^( 3) =       0.000435032143
  error estimate for blocks of size 2^( 4) =       0.000446734531
  error estimate for blocks of size 2^( 5) =       0.000456764752
  error estimate for blocks of size 2^( 6) =       0.000464528472
  error estimate for blocks of size 2^( 7) =       0.000468060474

      target function =                  N/A
              le_mean =     -16.906322296476
             les_mean =     286.158709669683
             stat err =       0.000459022057
             autocorr =       1.258007109973
              std dev =       0.578771323460
             le_variance =       0.334976244860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040032290
                                         uncertainty =       0.002528048075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040032290
                                         uncertainty =       0.002528048075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409253176
  error estimate for blocks of size 2^( 2) =       0.000422197724
  error estimate for blocks of size 2^( 3) =       0.000435032188
  error estimate for blocks of size 2^( 4) =       0.000446734576
  error estimate for blocks of size 2^( 5) =       0.000456764793
  error estimate for blocks of size 2^( 6) =       0.000464528510
  error estimate for blocks of size 2^( 7) =       0.000468060509

      target function =                  N/A
              le_mean =     -16.906322295351
             les_mean =     286.158709710373
             stat err =       0.000459022097
             autocorr =       1.258007032153
              std dev =       0.578771391473
             le_variance =       0.334976323588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040101343
                                         uncertainty =       0.002528048041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040101343
                                         uncertainty =       0.002528048041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409253218
  error estimate for blocks of size 2^( 2) =       0.000422197765
  error estimate for blocks of size 2^( 3) =       0.000435032226
  error estimate for blocks of size 2^( 4) =       0.000446734615
  error estimate for blocks of size 2^( 5) =       0.000456764829
  error estimate for blocks of size 2^( 6) =       0.000464528542
  error estimate for blocks of size 2^( 7) =       0.000468060540

      target function =                  N/A
              le_mean =     -16.906322294365
             les_mean =     286.158709746116
             stat err =       0.000459022132
             autocorr =       1.258006963881
              std dev =       0.578771451158
             le_variance =       0.334976392676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906322294224        initial
     3.9062e+02     3.9062e+03             6.8782e-07       -16.906322296476  <--
     1.5625e+03     1.5625e+04             1.7196e-07       -16.906322295351
     6.2500e+03     6.2500e+04             4.2990e-08       -16.906322294365

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9404e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137991e-02 1 1  ON 2
 uu_3                -2.102787e-02 1 1  ON 3
 uu_4                -6.676603e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955051e-03 1 1  ON 13
 ud_4                -6.563400e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110142e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931765e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464272e-02 1 1  ON 33
eH1_4                 3.800014e-03 1 1  ON 34
eH1_5                 3.765689e-02 1 1  ON 35
eH1_6                 9.658256e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208127e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256878e-02 1 1  ON 43
eH2_4                 6.411302e-03 1 1  ON 44
eH2_5                 4.075264e-02 1 1  ON 45
eH2_6                 9.934588e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.404732
====================================================
  Execution time = 2.0540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4353e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343590327677
                                         uncertainty =       0.004949932413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343590327677
                                         uncertainty =       0.004949932413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414444801
  error estimate for blocks of size 2^( 2) =       0.000427013685
  error estimate for blocks of size 2^( 3) =       0.000439866792
  error estimate for blocks of size 2^( 4) =       0.000450974168
  error estimate for blocks of size 2^( 5) =       0.000461315895
  error estimate for blocks of size 2^( 6) =       0.000469519494
  error estimate for blocks of size 2^( 7) =       0.000472977039

      target function =                  N/A
              le_mean =     -16.906148895387
             les_mean =     286.161399288047
             stat err =       0.000463696649
             autocorr =       1.251798775955
              std dev =       0.586113459000
             le_variance =       0.343528986821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614889539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906148895387       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906148896616       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906148899403       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906148895569       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906148896772       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906148898448       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906148898034       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906148898808       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.495322e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906148895387       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906148895695       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906148896395       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906148895440       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906148895747       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906148896166       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906148896058       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906148896250       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.241326e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906148895387       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906148895464       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906148895639       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906148895401       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906148895477       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906148895583       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906148895555       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906148895603       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.560521e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6103e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.138022e-02 1 1  ON 2
 uu_3                -2.102791e-02 1 1  ON 3
 uu_4                -6.676614e-02 1 1  ON 4
 uu_5                -1.019658e-01 1 1  ON 5
 uu_6                -1.295695e-01 1 1  ON 6
 uu_7                -1.431247e-01 1 1  ON 7
 uu_8                -1.351722e-01 1 1  ON 8
 uu_9                -1.060860e-01 1 1  ON 9
 ud_0                 4.504060e-01 1 1  ON 10
 ud_1                 1.843539e-01 1 1  ON 11
 ud_2                 6.354547e-02 1 1  ON 12
 ud_3                -7.954917e-03 1 1  ON 13
 ud_4                -6.563362e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354403e-01 1 1  ON 16
 ud_7                -1.521926e-01 1 1  ON 17
 ud_8                -1.535928e-01 1 1  ON 18
 ud_9                -1.444193e-01 1 1  ON 19
 eO_0                -7.598301e-01 1 1  ON 20
 eO_1                -4.379495e-01 1 1  ON 21
 eO_2                -2.110134e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258981e-01 1 1  ON 24
 eO_5                 4.888717e-01 1 1  ON 25
 eO_6                 2.613539e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236405e-01 1 1  ON 28
 eO_9                -8.931799e-02 1 1  ON 29
eH1_0                -2.502090e-01 1 1  ON 30
eH1_1                -1.472678e-01 1 1  ON 31
eH1_2                -9.917057e-02 1 1  ON 32
eH1_3                -4.464255e-02 1 1  ON 33
eH1_4                 3.800140e-03 1 1  ON 34
eH1_5                 3.765712e-02 1 1  ON 35
eH1_6                 9.658249e-02 1 1  ON 36
eH1_7                 1.544624e-01 1 1  ON 37
eH1_8                 1.803106e-01 1 1  ON 38
eH1_9                 7.208165e-02 1 1  ON 39
eH2_0                -2.480647e-01 1 1  ON 40
eH2_1                -1.453847e-01 1 1  ON 41
eH2_2                -9.707099e-02 1 1  ON 42
eH2_3                -4.256874e-02 1 1  ON 43
eH2_4                 6.411140e-03 1 1  ON 44
eH2_5                 4.075270e-02 1 1  ON 45
eH2_6                 9.934605e-02 1 1  ON 46
eH2_7                 1.556453e-01 1 1  ON 47
eH2_8                 1.850804e-01 1 1  ON 48
eH2_9                 6.204338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.839149
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3644e-01
  Total weights = 2.0000e+06
  Execution time = 1.8757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336418937397
                                         uncertainty =       0.004264159725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336418937397
                                         uncertainty =       0.004264159725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410149069
  error estimate for blocks of size 2^( 2) =       0.000423188378
  error estimate for blocks of size 2^( 3) =       0.000436771318
  error estimate for blocks of size 2^( 4) =       0.000449271342
  error estimate for blocks of size 2^( 5) =       0.000459954366
  error estimate for blocks of size 2^( 6) =       0.000468927776
  error estimate for blocks of size 2^( 7) =       0.000473606840

      target function =                  N/A
              le_mean =     -16.905735414891
             les_mean =     286.140334266861
             stat err =       0.000462940081
             autocorr =       1.273990258558
              std dev =       0.580038375268
             le_variance =       0.336444516783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336417058754
                                         uncertainty =       0.004264126436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336417058754
                                         uncertainty =       0.004264126436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410147923
  error estimate for blocks of size 2^( 2) =       0.000423187281
  error estimate for blocks of size 2^( 3) =       0.000436770271
  error estimate for blocks of size 2^( 4) =       0.000449270349
  error estimate for blocks of size 2^( 5) =       0.000459953423
  error estimate for blocks of size 2^( 6) =       0.000468926823
  error estimate for blocks of size 2^( 7) =       0.000473605848

      target function =                  N/A
              le_mean =     -16.905735406876
             les_mean =     286.140332115927
             stat err =       0.000462939111
             autocorr =       1.273992038291
              std dev =       0.580036754729
             le_variance =       0.336442636836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336417994568
                                         uncertainty =       0.004264143006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336417994568
                                         uncertainty =       0.004264143006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410148493
  error estimate for blocks of size 2^( 2) =       0.000423187827
  error estimate for blocks of size 2^( 3) =       0.000436770793
  error estimate for blocks of size 2^( 4) =       0.000449270844
  error estimate for blocks of size 2^( 5) =       0.000459953893
  error estimate for blocks of size 2^( 6) =       0.000468927297
  error estimate for blocks of size 2^( 7) =       0.000473606342

      target function =                  N/A
              le_mean =     -16.905735410861
             les_mean =     286.140333187101
             stat err =       0.000462939594
             autocorr =       1.273991151756
              std dev =       0.580037561974
             le_variance =       0.336443573300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336418819430
                                         uncertainty =       0.004264157633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336418819430
                                         uncertainty =       0.004264157633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410148997
  error estimate for blocks of size 2^( 2) =       0.000423188309
  error estimate for blocks of size 2^( 3) =       0.000436771253
  error estimate for blocks of size 2^( 4) =       0.000449271280
  error estimate for blocks of size 2^( 5) =       0.000459954307
  error estimate for blocks of size 2^( 6) =       0.000468927716
  error estimate for blocks of size 2^( 7) =       0.000473606777

      target function =                  N/A
              le_mean =     -16.905735414386
             les_mean =     286.140334131741
             stat err =       0.000462940020
             autocorr =       1.273990370316
              std dev =       0.580038273509
             le_variance =       0.336444398735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905735414891        initial  <--
     9.7656e+01     9.7656e+02             2.4953e-06       -16.905735406876
     3.9062e+02     3.9062e+03             6.2413e-07       -16.905735410861
     1.5625e+03     1.5625e+04             1.5605e-07       -16.905735414386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6778
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137991e-02 1 1  ON 2
 uu_3                -2.102787e-02 1 1  ON 3
 uu_4                -6.676603e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955051e-03 1 1  ON 13
 ud_4                -6.563400e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110142e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931765e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464272e-02 1 1  ON 33
eH1_4                 3.800014e-03 1 1  ON 34
eH1_5                 3.765689e-02 1 1  ON 35
eH1_6                 9.658256e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208127e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256878e-02 1 1  ON 43
eH2_4                 6.411302e-03 1 1  ON 44
eH2_5                 4.075264e-02 1 1  ON 45
eH2_6                 9.934588e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9555
    reference variance = 0.357059
====================================================
  Execution time = 2.0468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3364e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333418002520
                                         uncertainty =       0.002730558754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333418002520
                                         uncertainty =       0.002730558754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408433600
  error estimate for blocks of size 2^( 2) =       0.000421035367
  error estimate for blocks of size 2^( 3) =       0.000433985538
  error estimate for blocks of size 2^( 4) =       0.000445267158
  error estimate for blocks of size 2^( 5) =       0.000455446448
  error estimate for blocks of size 2^( 6) =       0.000463239253
  error estimate for blocks of size 2^( 7) =       0.000469595026

      target function =                  N/A
              le_mean =     -16.905810210471
             les_mean =     286.140054716643
             stat err =       0.000458386971
             autocorr =       1.259567962431
              std dev =       0.577612336242
             le_variance =       0.333636010979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581021047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905810210471       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810210756       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810211064       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810211113       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810210943       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810210914       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810210985       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810210839       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.572725e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905810210471       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810210543       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810210620       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810210632       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810210586       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810210583       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810210594       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810210565       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 6.431808e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905810210471       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810210489       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810210509       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810210511       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810210501       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810210498       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810210503       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810210499       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.607952e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259222 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6135e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102789e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060859e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354534e-02 1 1  ON 12
 ud_3                -7.955078e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110139e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888714e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046135e-02 1 1  ON 27
 eO_8                -2.236403e-01 1 1  ON 28
 eO_9                -8.931768e-02 1 1  ON 29
eH1_0                -2.502086e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917044e-02 1 1  ON 32
eH1_3                -4.464272e-02 1 1  ON 33
eH1_4                 3.800026e-03 1 1  ON 34
eH1_5                 3.765692e-02 1 1  ON 35
eH1_6                 9.658254e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208133e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453846e-01 1 1  ON 41
eH2_2                -9.707094e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411293e-03 1 1  ON 44
eH2_5                 4.075265e-02 1 1  ON 45
eH2_6                 9.934590e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9767
    reference variance = 0.234024
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4723e-01
  Total weights = 2.0000e+06
  Execution time = 1.8692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216816448
                                         uncertainty =       0.005891088049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216816448
                                         uncertainty =       0.005891088049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416670071
  error estimate for blocks of size 2^( 2) =       0.000429539965
  error estimate for blocks of size 2^( 3) =       0.000442336812
  error estimate for blocks of size 2^( 4) =       0.000455038987
  error estimate for blocks of size 2^( 5) =       0.000466214731
  error estimate for blocks of size 2^( 6) =       0.000476200863
  error estimate for blocks of size 2^( 7) =       0.000480569902

      target function =                  N/A
              le_mean =     -16.906227870788
             les_mean =     286.167768540849
             stat err =       0.000469506121
             autocorr =       1.269690602036
              std dev =       0.589260464854
             le_variance =       0.347227895440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216814824
                                         uncertainty =       0.005891089898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216814824
                                         uncertainty =       0.005891089898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416670070
  error estimate for blocks of size 2^( 2) =       0.000429539964
  error estimate for blocks of size 2^( 3) =       0.000442336810
  error estimate for blocks of size 2^( 4) =       0.000455038984
  error estimate for blocks of size 2^( 5) =       0.000466214725
  error estimate for blocks of size 2^( 6) =       0.000476200854
  error estimate for blocks of size 2^( 7) =       0.000480569894

      target function =                  N/A
              le_mean =     -16.906227869911
             les_mean =     286.167768509571
             stat err =       0.000469506114
             autocorr =       1.269690570235
              std dev =       0.589260463481
             le_variance =       0.347227893822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216815625
                                         uncertainty =       0.005891088974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216815625
                                         uncertainty =       0.005891088974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416670070
  error estimate for blocks of size 2^( 2) =       0.000429539964
  error estimate for blocks of size 2^( 3) =       0.000442336811
  error estimate for blocks of size 2^( 4) =       0.000455038986
  error estimate for blocks of size 2^( 5) =       0.000466214728
  error estimate for blocks of size 2^( 6) =       0.000476200859
  error estimate for blocks of size 2^( 7) =       0.000480569898

      target function =                  N/A
              le_mean =     -16.906227870350
             les_mean =     286.167768525190
             stat err =       0.000469506118
             autocorr =       1.269690586136
              std dev =       0.589260464159
             le_variance =       0.347227894621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216816344
                                         uncertainty =       0.005891088165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347216816344
                                         uncertainty =       0.005891088165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416670071
  error estimate for blocks of size 2^( 2) =       0.000429539965
  error estimate for blocks of size 2^( 3) =       0.000442336812
  error estimate for blocks of size 2^( 4) =       0.000455038987
  error estimate for blocks of size 2^( 5) =       0.000466214731
  error estimate for blocks of size 2^( 6) =       0.000476200863
  error estimate for blocks of size 2^( 7) =       0.000480569902

      target function =                  N/A
              le_mean =     -16.906227870734
             les_mean =     286.167768538891
             stat err =       0.000469506121
             autocorr =       1.269690600055
              std dev =       0.589260464766
             le_variance =       0.347227895337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906227870788        initial  <--
     9.7656e+02     9.7656e+03             2.5727e-07       -16.906227869911
     3.9062e+03     3.9062e+04             6.4318e-08       -16.906227870350
     1.5625e+04     1.5625e+05             1.6080e-08       -16.906227870734

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7670
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137991e-02 1 1  ON 2
 uu_3                -2.102787e-02 1 1  ON 3
 uu_4                -6.676603e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955051e-03 1 1  ON 13
 ud_4                -6.563400e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110142e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931765e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464272e-02 1 1  ON 33
eH1_4                 3.800014e-03 1 1  ON 34
eH1_5                 3.765689e-02 1 1  ON 35
eH1_6                 9.658256e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208127e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256878e-02 1 1  ON 43
eH2_4                 6.411302e-03 1 1  ON 44
eH2_5                 4.075264e-02 1 1  ON 45
eH2_6                 9.934588e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.382303
====================================================
  Execution time = 2.0526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344683526694
                                         uncertainty =       0.005512732308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344683526694
                                         uncertainty =       0.005512732308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415099572
  error estimate for blocks of size 2^( 2) =       0.000427844399
  error estimate for blocks of size 2^( 3) =       0.000441506296
  error estimate for blocks of size 2^( 4) =       0.000454042228
  error estimate for blocks of size 2^( 5) =       0.000464451972
  error estimate for blocks of size 2^( 6) =       0.000473074905
  error estimate for blocks of size 2^( 7) =       0.000476557787

      target function =                  N/A
              le_mean =     -16.906934939401
             les_mean =     286.189064182072
             stat err =       0.000467031723
             autocorr =       1.265867327442
              std dev =       0.587039444371
             le_variance =       0.344615309248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690693493940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906934939401       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906934939434       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906934939421       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906934939440       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906934939451       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906934939458       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906934939470       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.442387e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906934939401       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906934939409       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906934939406       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906934939413       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906934939400       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906934939406       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906934939429       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.106007e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906934939401       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906934939403       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906934939402       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906934939233       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906934939327       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906934939372       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906934939408       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.526504e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6090e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137991e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955051e-03 1 1  ON 13
 ud_4                -6.563400e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110142e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931765e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464272e-02 1 1  ON 33
eH1_4                 3.800017e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658256e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208127e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256878e-02 1 1  ON 43
eH2_4                 6.411300e-03 1 1  ON 44
eH2_5                 4.075264e-02 1 1  ON 45
eH2_6                 9.934588e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9425
    reference variance = 0.330132
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3486e-01
  Total weights = 2.0000e+06
  Execution time = 1.8664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792534778
                                         uncertainty =       0.002785871954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792534778
                                         uncertainty =       0.002785871954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182674
  error estimate for blocks of size 2^( 2) =       0.000421659564
  error estimate for blocks of size 2^( 3) =       0.000434676699
  error estimate for blocks of size 2^( 4) =       0.000446739165
  error estimate for blocks of size 2^( 5) =       0.000456895605
  error estimate for blocks of size 2^( 6) =       0.000465756363
  error estimate for blocks of size 2^( 7) =       0.000467727785

      target function =                  N/A
              le_mean =     -16.906047345495
             les_mean =     286.149297602406
             stat err =       0.000459279730
             autocorr =       1.259853606616
              std dev =       0.578671687333
             le_variance =       0.334860921721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792535260
                                         uncertainty =       0.002785871959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792535260
                                         uncertainty =       0.002785871959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182674
  error estimate for blocks of size 2^( 2) =       0.000421659565
  error estimate for blocks of size 2^( 3) =       0.000434676699
  error estimate for blocks of size 2^( 4) =       0.000446739165
  error estimate for blocks of size 2^( 5) =       0.000456895606
  error estimate for blocks of size 2^( 6) =       0.000465756363
  error estimate for blocks of size 2^( 7) =       0.000467727785

      target function =                  N/A
              le_mean =     -16.906047345637
             les_mean =     286.149297607697
             stat err =       0.000459279730
             autocorr =       1.259853605811
              std dev =       0.578671687740
             le_variance =       0.334860922192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792535019
                                         uncertainty =       0.002785871957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792535019
                                         uncertainty =       0.002785871957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182674
  error estimate for blocks of size 2^( 2) =       0.000421659564
  error estimate for blocks of size 2^( 3) =       0.000434676699
  error estimate for blocks of size 2^( 4) =       0.000446739165
  error estimate for blocks of size 2^( 5) =       0.000456895606
  error estimate for blocks of size 2^( 6) =       0.000465756363
  error estimate for blocks of size 2^( 7) =       0.000467727785

      target function =                  N/A
              le_mean =     -16.906047345566
             les_mean =     286.149297605051
             stat err =       0.000459279730
             autocorr =       1.259853606206
              std dev =       0.578671687537
             le_variance =       0.334860921957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792534809
                                         uncertainty =       0.002785871954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792534809
                                         uncertainty =       0.002785871954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409182674
  error estimate for blocks of size 2^( 2) =       0.000421659564
  error estimate for blocks of size 2^( 3) =       0.000434676699
  error estimate for blocks of size 2^( 4) =       0.000446739165
  error estimate for blocks of size 2^( 5) =       0.000456895605
  error estimate for blocks of size 2^( 6) =       0.000465756363
  error estimate for blocks of size 2^( 7) =       0.000467727785

      target function =                  N/A
              le_mean =     -16.906047345504
             les_mean =     286.149297602736
             stat err =       0.000459279730
             autocorr =       1.259853606561
              std dev =       0.578671687358
             le_variance =       0.334860921750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906047345495        initial
     9.7656e+03     9.7656e+04             2.4424e-08       -16.906047345637  <--
     3.9062e+04     3.9062e+05             6.1060e-09       -16.906047345566
     1.5625e+05     1.5625e+06             1.5265e-09       -16.906047345504

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.9552e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955053e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800024e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208128e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8298
    reference variance = 0.612245
====================================================
  Execution time = 2.2551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347847335795
                                         uncertainty =       0.006082345245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347847335795
                                         uncertainty =       0.006082345245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417109809
  error estimate for blocks of size 2^( 2) =       0.000429717969
  error estimate for blocks of size 2^( 3) =       0.000442738543
  error estimate for blocks of size 2^( 4) =       0.000456428100
  error estimate for blocks of size 2^( 5) =       0.000467842694
  error estimate for blocks of size 2^( 6) =       0.000477974849
  error estimate for blocks of size 2^( 7) =       0.000486386353

      target function =                  N/A
              le_mean =     -16.906763685179
             les_mean =     286.186619318810
             stat err =       0.000472157999
             autocorr =       1.281368065131
              std dev =       0.589882349556
             le_variance =       0.347961186318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690676368518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906763685179       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763685531       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906763685821       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906763686088       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906763685842       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906763685871       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906763685876       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906763685889       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 8.713613e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906763685179       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763685267       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906763685339       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906763685407       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906763685344       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906763685346       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906763685352       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906763685356       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.178443e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906763685179       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763685201       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906763685219       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906763685235       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906763685220       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906763685224       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906763685196       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906763685226       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.446133e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8149e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137993e-02 1 1  ON 2
 uu_3                -2.102789e-02 1 1  ON 3
 uu_4                -6.676605e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955057e-03 1 1  ON 13
 ud_4                -6.563400e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521926e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110144e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888714e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236403e-01 1 1  ON 28
 eO_9                -8.931767e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917043e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800029e-03 1 1  ON 34
eH1_5                 3.765691e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208130e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707091e-02 1 1  ON 42
eH2_3                -4.256876e-02 1 1  ON 43
eH2_4                 6.411302e-03 1 1  ON 44
eH2_5                 4.075262e-02 1 1  ON 45
eH2_6                 9.934588e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9509
    reference variance = 0.172914
====================================================
  Execution time = 2.0038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865192613
                                         uncertainty =       0.003733722345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865192613
                                         uncertainty =       0.003733722345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755093
  error estimate for blocks of size 2^( 2) =       0.000422651687
  error estimate for blocks of size 2^( 3) =       0.000436175994
  error estimate for blocks of size 2^( 4) =       0.000448715604
  error estimate for blocks of size 2^( 5) =       0.000460398336
  error estimate for blocks of size 2^( 6) =       0.000472051255
  error estimate for blocks of size 2^( 7) =       0.000478589932

      target function =                  N/A
              le_mean =     -16.907046533930
             les_mean =     286.184020805022
             stat err =       0.000464938782
             autocorr =       1.287486922693
              std dev =       0.579481209739
             le_variance =       0.335798472441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865146296
                                         uncertainty =       0.003733721502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865146296
                                         uncertainty =       0.003733721502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755065
  error estimate for blocks of size 2^( 2) =       0.000422651660
  error estimate for blocks of size 2^( 3) =       0.000436175968
  error estimate for blocks of size 2^( 4) =       0.000448715579
  error estimate for blocks of size 2^( 5) =       0.000460398310
  error estimate for blocks of size 2^( 6) =       0.000472051229
  error estimate for blocks of size 2^( 7) =       0.000478589908

      target function =                  N/A
              le_mean =     -16.907046533487
             les_mean =     286.184020743718
             stat err =       0.000464938756
             autocorr =       1.287486958138
              std dev =       0.579481169787
             le_variance =       0.335798426138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865169451
                                         uncertainty =       0.003733721923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865169451
                                         uncertainty =       0.003733721923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755079
  error estimate for blocks of size 2^( 2) =       0.000422651674
  error estimate for blocks of size 2^( 3) =       0.000436175981
  error estimate for blocks of size 2^( 4) =       0.000448715592
  error estimate for blocks of size 2^( 5) =       0.000460398323
  error estimate for blocks of size 2^( 6) =       0.000472051242
  error estimate for blocks of size 2^( 7) =       0.000478589920

      target function =                  N/A
              le_mean =     -16.907046533708
             les_mean =     286.184020774365
             stat err =       0.000464938769
             autocorr =       1.287486940424
              std dev =       0.579481189760
             le_variance =       0.335798449285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865189717
                                         uncertainty =       0.003733722292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335865189717
                                         uncertainty =       0.003733722292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755091
  error estimate for blocks of size 2^( 2) =       0.000422651686
  error estimate for blocks of size 2^( 3) =       0.000436175993
  error estimate for blocks of size 2^( 4) =       0.000448715603
  error estimate for blocks of size 2^( 5) =       0.000460398335
  error estimate for blocks of size 2^( 6) =       0.000472051253
  error estimate for blocks of size 2^( 7) =       0.000478589931

      target function =                  N/A
              le_mean =     -16.907046533902
             les_mean =     286.184020801189
             stat err =       0.000464938780
             autocorr =       1.287486924900
              std dev =       0.579481207242
             le_variance =       0.335798469546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907046533930        initial  <--
     2.4414e+03     2.4414e+04             8.7136e-08       -16.907046533487
     9.7656e+03     9.7656e+04             2.1784e-08       -16.907046533708
     3.9062e+04     3.9062e+05             5.4461e-09       -16.907046533902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5392
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955053e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800024e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208128e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9386
    reference variance = 0.327738
====================================================
  Execution time = 2.0496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3933e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339412100501
                                         uncertainty =       0.004102440629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339412100501
                                         uncertainty =       0.004102440629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411902571
  error estimate for blocks of size 2^( 2) =       0.000424549712
  error estimate for blocks of size 2^( 3) =       0.000438180417
  error estimate for blocks of size 2^( 4) =       0.000450583837
  error estimate for blocks of size 2^( 5) =       0.000462279849
  error estimate for blocks of size 2^( 6) =       0.000472344456
  error estimate for blocks of size 2^( 7) =       0.000477389649

      target function =                  N/A
              le_mean =     -16.905285981449
             les_mean =     286.128021401435
             stat err =       0.000465649448
             autocorr =       1.277995070286
              std dev =       0.582518202730
             le_variance =       0.339327456512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528598145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905285981449       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905285981464       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905285981502       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905285981517       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905285981506       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905285981518       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905285981532       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905285981524       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 9.781876e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905285981449       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905285981453       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905285981462       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905285981462       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905285981556       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905285981467       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905285981369       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905285981357       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.445477e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905285981449       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905285981450       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905285981453       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905285981453       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905285981453       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905285981883       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905285981314       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905285981419       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 6.113694e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955053e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8056
    reference variance = 0.268977
====================================================
  Execution time = 1.9990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3890e-01
  Total weights = 2.0000e+06
  Execution time = 1.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007610192
                                         uncertainty =       0.005076124808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007610192
                                         uncertainty =       0.005076124808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411640734
  error estimate for blocks of size 2^( 2) =       0.000424269805
  error estimate for blocks of size 2^( 3) =       0.000437086313
  error estimate for blocks of size 2^( 4) =       0.000448690845
  error estimate for blocks of size 2^( 5) =       0.000459123628
  error estimate for blocks of size 2^( 6) =       0.000465750693
  error estimate for blocks of size 2^( 7) =       0.000470234434

      target function =                  N/A
              le_mean =     -16.906203188837
             les_mean =     286.158602280482
             stat err =       0.000460949900
             autocorr =       1.253922693875
              std dev =       0.582147908780
             le_variance =       0.338896187696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007608729
                                         uncertainty =       0.005076124706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007608729
                                         uncertainty =       0.005076124706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411640733
  error estimate for blocks of size 2^( 2) =       0.000424269804
  error estimate for blocks of size 2^( 3) =       0.000437086313
  error estimate for blocks of size 2^( 4) =       0.000448690844
  error estimate for blocks of size 2^( 5) =       0.000459123627
  error estimate for blocks of size 2^( 6) =       0.000465750692
  error estimate for blocks of size 2^( 7) =       0.000470234433

      target function =                  N/A
              le_mean =     -16.906203188820
             les_mean =     286.158602278441
             stat err =       0.000460949899
             autocorr =       1.253922694892
              std dev =       0.582147907523
             le_variance =       0.338896186233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007609460
                                         uncertainty =       0.005076124757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007609460
                                         uncertainty =       0.005076124757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411640734
  error estimate for blocks of size 2^( 2) =       0.000424269805
  error estimate for blocks of size 2^( 3) =       0.000437086313
  error estimate for blocks of size 2^( 4) =       0.000448690844
  error estimate for blocks of size 2^( 5) =       0.000459123628
  error estimate for blocks of size 2^( 6) =       0.000465750693
  error estimate for blocks of size 2^( 7) =       0.000470234433

      target function =                  N/A
              le_mean =     -16.906203188828
             les_mean =     286.158602279461
             stat err =       0.000460949900
             autocorr =       1.253922694381
              std dev =       0.582147908151
             le_variance =       0.338896186965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007610101
                                         uncertainty =       0.005076124802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007610101
                                         uncertainty =       0.005076124802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411640734
  error estimate for blocks of size 2^( 2) =       0.000424269805
  error estimate for blocks of size 2^( 3) =       0.000437086313
  error estimate for blocks of size 2^( 4) =       0.000448690844
  error estimate for blocks of size 2^( 5) =       0.000459123628
  error estimate for blocks of size 2^( 6) =       0.000465750693
  error estimate for blocks of size 2^( 7) =       0.000470234434

      target function =                  N/A
              le_mean =     -16.906203188836
             les_mean =     286.158602280354
             stat err =       0.000460949900
             autocorr =       1.253922693945
              std dev =       0.582147908701
             le_variance =       0.338896187605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906203188837        initial  <--
     2.4414e+04     2.4414e+05             9.7819e-09       -16.906203188820
     9.7656e+04     9.7656e+05             2.4455e-09       -16.906203188828
     3.9062e+05     3.9062e+06             6.1137e-10       -16.906203188836

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5480
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955053e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800024e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208128e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9679
    reference variance = 0.158806
====================================================
  Execution time = 2.0597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330695869365
                                         uncertainty =       0.002715348639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330695869365
                                         uncertainty =       0.002715348639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406553509
  error estimate for blocks of size 2^( 2) =       0.000419669932
  error estimate for blocks of size 2^( 3) =       0.000432812328
  error estimate for blocks of size 2^( 4) =       0.000444750204
  error estimate for blocks of size 2^( 5) =       0.000454700395
  error estimate for blocks of size 2^( 6) =       0.000461552201
  error estimate for blocks of size 2^( 7) =       0.000465112293

      target function =                  N/A
              le_mean =     -16.906071863468
             les_mean =     286.145837198804
             stat err =       0.000456528773
             autocorr =       1.260958756283
              std dev =       0.574953486234
             le_variance =       0.330571511333


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607186347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906071863468       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071863467       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071863469       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906071863468       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906071863311       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906071863351       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906071863710       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906071863588       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.133830e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906071863468       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071863468       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071863469       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906071863366       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906071863469       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906071863424       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906071863356       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906071864250       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.283458e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906071863468       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906071863468       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906071863468       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906071863468       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906071863942       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906071863206       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906071863162       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906071862922       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 5.708644e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6220e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955053e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800024e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208128e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.262237
====================================================
  Execution time = 2.0328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5378e-01
  Total weights = 2.0000e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991412
                                         uncertainty =       0.014109185944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991412
                                         uncertainty =       0.014109185944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420584598
  error estimate for blocks of size 2^( 2) =       0.000432904886
  error estimate for blocks of size 2^( 3) =       0.000445111288
  error estimate for blocks of size 2^( 4) =       0.000456955936
  error estimate for blocks of size 2^( 5) =       0.000467841515
  error estimate for blocks of size 2^( 6) =       0.000475706894
  error estimate for blocks of size 2^( 7) =       0.000483485811

      target function =                  N/A
              le_mean =     -16.906311448499
             les_mean =     286.177149425697
             stat err =       0.000470997539
             autocorr =       1.254095315096
              std dev =       0.594796443282
             le_variance =       0.353782808941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991216
                                         uncertainty =       0.014109185921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991216
                                         uncertainty =       0.014109185921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420584598
  error estimate for blocks of size 2^( 2) =       0.000432904886
  error estimate for blocks of size 2^( 3) =       0.000445111287
  error estimate for blocks of size 2^( 4) =       0.000456955936
  error estimate for blocks of size 2^( 5) =       0.000467841515
  error estimate for blocks of size 2^( 6) =       0.000475706894
  error estimate for blocks of size 2^( 7) =       0.000483485810

      target function =                  N/A
              le_mean =     -16.906311448502
             les_mean =     286.177149425594
             stat err =       0.000470997539
             autocorr =       1.254095315175
              std dev =       0.594796443117
             le_variance =       0.353782808745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991314
                                         uncertainty =       0.014109185932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991314
                                         uncertainty =       0.014109185932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420584598
  error estimate for blocks of size 2^( 2) =       0.000432904886
  error estimate for blocks of size 2^( 3) =       0.000445111288
  error estimate for blocks of size 2^( 4) =       0.000456955936
  error estimate for blocks of size 2^( 5) =       0.000467841515
  error estimate for blocks of size 2^( 6) =       0.000475706894
  error estimate for blocks of size 2^( 7) =       0.000483485810

      target function =                  N/A
              le_mean =     -16.906311448500
             les_mean =     286.177149425646
             stat err =       0.000470997539
             autocorr =       1.254095315138
              std dev =       0.594796443200
             le_variance =       0.353782808843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991400
                                         uncertainty =       0.014109185943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353774991400
                                         uncertainty =       0.014109185943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420584598
  error estimate for blocks of size 2^( 2) =       0.000432904886
  error estimate for blocks of size 2^( 3) =       0.000445111288
  error estimate for blocks of size 2^( 4) =       0.000456955936
  error estimate for blocks of size 2^( 5) =       0.000467841515
  error estimate for blocks of size 2^( 6) =       0.000475706894
  error estimate for blocks of size 2^( 7) =       0.000483485811

      target function =                  N/A
              le_mean =     -16.906311448499
             les_mean =     286.177149425690
             stat err =       0.000470997539
             autocorr =       1.254095315101
              std dev =       0.594796443272
             le_variance =       0.353782808929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906311448499        initial
     2.4414e+05     2.4414e+06             9.1338e-10       -16.906311448502  <--
     9.7656e+05     9.7656e+06             2.2835e-10       -16.906311448500
     3.9062e+06     3.9062e+07             5.7086e-11       -16.906311448499

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 2.9797e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6038e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.199795
====================================================
  Execution time = 2.0481e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3613e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336160887285
                                         uncertainty =       0.003050794140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336160887285
                                         uncertainty =       0.003050794140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409954953
  error estimate for blocks of size 2^( 2) =       0.000422360137
  error estimate for blocks of size 2^( 3) =       0.000435325290
  error estimate for blocks of size 2^( 4) =       0.000446693386
  error estimate for blocks of size 2^( 5) =       0.000456762409
  error estimate for blocks of size 2^( 6) =       0.000464987414
  error estimate for blocks of size 2^( 7) =       0.000471447156

      target function =                  N/A
              le_mean =     -16.907294348736
             les_mean =     286.192728153326
             stat err =       0.000459972591
             autocorr =       1.258901155943
              std dev =       0.579763854148
             le_variance =       0.336126126576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690729434874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907294348736       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907294348759       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907294348766       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907294348764       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907294348774       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907294348770       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907294348751       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907294348767       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.172874e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907294348736       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907294348742       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907294348744       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907294348743       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907294348747       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907294348819       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907294348436       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907294349113       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.043219e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907294348736       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907294348738       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907294348738       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907294348738       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907294348672       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907294348739       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907294348147       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907294348980       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.608047e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6014e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955053e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.641027
====================================================
  Execution time = 2.0204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3604e-01
  Total weights = 2.0000e+06
  Execution time = 1.8696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048800070
                                         uncertainty =       0.003629660263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048800070
                                         uncertainty =       0.003629660263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409904986
  error estimate for blocks of size 2^( 2) =       0.000422492382
  error estimate for blocks of size 2^( 3) =       0.000435038768
  error estimate for blocks of size 2^( 4) =       0.000447081306
  error estimate for blocks of size 2^( 5) =       0.000456932019
  error estimate for blocks of size 2^( 6) =       0.000464091665
  error estimate for blocks of size 2^( 7) =       0.000468028718

      target function =                  N/A
              le_mean =     -16.906622670201
             les_mean =     286.169934139724
             stat err =       0.000459033427
             autocorr =       1.254071280143
              std dev =       0.579693190562
             le_variance =       0.336044195184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048798819
                                         uncertainty =       0.003629660241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048798819
                                         uncertainty =       0.003629660241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409904985
  error estimate for blocks of size 2^( 2) =       0.000422492381
  error estimate for blocks of size 2^( 3) =       0.000435038768
  error estimate for blocks of size 2^( 4) =       0.000447081306
  error estimate for blocks of size 2^( 5) =       0.000456932018
  error estimate for blocks of size 2^( 6) =       0.000464091664
  error estimate for blocks of size 2^( 7) =       0.000468028717

      target function =                  N/A
              le_mean =     -16.906622670188
             les_mean =     286.169934138040
             stat err =       0.000459033426
             autocorr =       1.254071280339
              std dev =       0.579693189484
             le_variance =       0.336044193934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048799444
                                         uncertainty =       0.003629660252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048799444
                                         uncertainty =       0.003629660252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409904986
  error estimate for blocks of size 2^( 2) =       0.000422492381
  error estimate for blocks of size 2^( 3) =       0.000435038768
  error estimate for blocks of size 2^( 4) =       0.000447081306
  error estimate for blocks of size 2^( 5) =       0.000456932018
  error estimate for blocks of size 2^( 6) =       0.000464091664
  error estimate for blocks of size 2^( 7) =       0.000468028718

      target function =                  N/A
              le_mean =     -16.906622670195
             les_mean =     286.169934138882
             stat err =       0.000459033427
             autocorr =       1.254071280245
              std dev =       0.579693190023
             le_variance =       0.336044194559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048799992
                                         uncertainty =       0.003629660262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336048799992
                                         uncertainty =       0.003629660262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409904986
  error estimate for blocks of size 2^( 2) =       0.000422492382
  error estimate for blocks of size 2^( 3) =       0.000435038768
  error estimate for blocks of size 2^( 4) =       0.000447081306
  error estimate for blocks of size 2^( 5) =       0.000456932019
  error estimate for blocks of size 2^( 6) =       0.000464091664
  error estimate for blocks of size 2^( 7) =       0.000468028718

      target function =                  N/A
              le_mean =     -16.906622670200
             les_mean =     286.169934139619
             stat err =       0.000459033427
             autocorr =       1.254071280152
              std dev =       0.579693190495
             le_variance =       0.336044195106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906622670201        initial  <--
     6.1035e+04     6.1035e+05             4.1729e-09       -16.906622670188
     2.4414e+05     2.4414e+06             1.0432e-09       -16.906622670195
     9.7656e+05     9.7656e+06             2.6080e-10       -16.906622670200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6897
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.18783
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4059e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340591780370
                                         uncertainty =       0.004144902874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340591780370
                                         uncertainty =       0.004144902874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412667237
  error estimate for blocks of size 2^( 2) =       0.000425258817
  error estimate for blocks of size 2^( 3) =       0.000438176842
  error estimate for blocks of size 2^( 4) =       0.000449968103
  error estimate for blocks of size 2^( 5) =       0.000460251034
  error estimate for blocks of size 2^( 6) =       0.000466765748
  error estimate for blocks of size 2^( 7) =       0.000473017807

      target function =                  N/A
              le_mean =     -16.906800256866
             les_mean =     286.180483252361
             stat err =       0.000462500673
             autocorr =       1.256101568738
              std dev =       0.583599603407
             le_variance =       0.340588497096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680025687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800256866       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800256867       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800256866       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800256991       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800256596       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906800256187       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906800256785       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906800256960       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 2.830319e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800256866       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800256866       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800256866       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800259483       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800256939       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906800257278       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906800257757       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906800256012       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 7.075759e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800256866       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800256866       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800256866       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800256589       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800251121       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906800250718       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906800256981       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906800258410       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.768960e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5915e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.181626
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190550
                                         uncertainty =       0.003904460463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190550
                                         uncertainty =       0.003904460463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721219
  error estimate for blocks of size 2^( 2) =       0.000424932995
  error estimate for blocks of size 2^( 3) =       0.000438633499
  error estimate for blocks of size 2^( 4) =       0.000450968587
  error estimate for blocks of size 2^( 5) =       0.000461739746
  error estimate for blocks of size 2^( 6) =       0.000471844571
  error estimate for blocks of size 2^( 7) =       0.000477542178

      target function =                  N/A
              le_mean =     -16.906583188506
             les_mean =     286.171583665075
             stat err =       0.000465523770
             autocorr =       1.278430793998
              std dev =       0.582261732134
             le_variance =       0.339028724707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190574
                                         uncertainty =       0.003904460464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190574
                                         uncertainty =       0.003904460464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721219
  error estimate for blocks of size 2^( 2) =       0.000424932995
  error estimate for blocks of size 2^( 3) =       0.000438633499
  error estimate for blocks of size 2^( 4) =       0.000450968587
  error estimate for blocks of size 2^( 5) =       0.000461739746
  error estimate for blocks of size 2^( 6) =       0.000471844571
  error estimate for blocks of size 2^( 7) =       0.000477542178

      target function =                  N/A
              le_mean =     -16.906583188505
             les_mean =     286.171583665058
             stat err =       0.000465523770
             autocorr =       1.278430793970
              std dev =       0.582261732154
             le_variance =       0.339028724731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190562
                                         uncertainty =       0.003904460464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190562
                                         uncertainty =       0.003904460464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721219
  error estimate for blocks of size 2^( 2) =       0.000424932995
  error estimate for blocks of size 2^( 3) =       0.000438633499
  error estimate for blocks of size 2^( 4) =       0.000450968587
  error estimate for blocks of size 2^( 5) =       0.000461739746
  error estimate for blocks of size 2^( 6) =       0.000471844571
  error estimate for blocks of size 2^( 7) =       0.000477542178

      target function =                  N/A
              le_mean =     -16.906583188506
             les_mean =     286.171583665067
             stat err =       0.000465523770
             autocorr =       1.278430793986
              std dev =       0.582261732144
             le_variance =       0.339028724719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190551
                                         uncertainty =       0.003904460463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339064190551
                                         uncertainty =       0.003904460463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721219
  error estimate for blocks of size 2^( 2) =       0.000424932995
  error estimate for blocks of size 2^( 3) =       0.000438633499
  error estimate for blocks of size 2^( 4) =       0.000450968587
  error estimate for blocks of size 2^( 5) =       0.000461739746
  error estimate for blocks of size 2^( 6) =       0.000471844571
  error estimate for blocks of size 2^( 7) =       0.000477542178

      target function =                  N/A
              le_mean =     -16.906583188506
             les_mean =     286.171583665074
             stat err =       0.000465523770
             autocorr =       1.278430794000
              std dev =       0.582261732135
             le_variance =       0.339028724709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906583188506        initial  <--
     6.1035e+05     6.1035e+06             2.8303e-10       -16.906583188505
     2.4414e+06     2.4414e+07             7.0758e-11       -16.906583188506
     9.7656e+06     9.7656e+07             1.7690e-11       -16.906583188506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9088
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.245803
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895783202
                                         uncertainty =       0.005541839551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895783202
                                         uncertainty =       0.005541839551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410974460
  error estimate for blocks of size 2^( 2) =       0.000423879849
  error estimate for blocks of size 2^( 3) =       0.000436750878
  error estimate for blocks of size 2^( 4) =       0.000449154915
  error estimate for blocks of size 2^( 5) =       0.000460090466
  error estimate for blocks of size 2^( 6) =       0.000469070282
  error estimate for blocks of size 2^( 7) =       0.000473902185

      target function =                  N/A
              le_mean =     -16.905567350625
             les_mean =     286.136007290651
             stat err =       0.000463054462
             autocorr =       1.269505190843
              std dev =       0.581205654691
             le_variance =       0.337800013045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556735062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905567350625       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567350625       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567350625       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905567356522       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905567351573       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905567349634       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905567347862       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905567353333       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 5.375601e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905567350625       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567350625       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567350625       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905567350625       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905567350676       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905567350625       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905567342982       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905567353948       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.343896e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905567350625       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567350625       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905567350625       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905567350625       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905567333979       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905567365028       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905567362176       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905567421528       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 3.359805e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6433e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.283791
====================================================
  Execution time = 2.0111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3687e-01
  Total weights = 2.0000e+06
  Execution time = 1.8688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864849
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864849
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410411159
  error estimate for blocks of size 2^( 2) =       0.000423055392
  error estimate for blocks of size 2^( 3) =       0.000436042319
  error estimate for blocks of size 2^( 4) =       0.000447430796
  error estimate for blocks of size 2^( 5) =       0.000458035511
  error estimate for blocks of size 2^( 6) =       0.000466192124
  error estimate for blocks of size 2^( 7) =       0.000472447611

      target function =                  N/A
              le_mean =     -16.906136862350
             les_mean =     286.154338078975
             stat err =       0.000461026510
             autocorr =       1.261866693423
              std dev =       0.580409027240
             le_variance =       0.336874638901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864866
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864866
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410411159
  error estimate for blocks of size 2^( 2) =       0.000423055392
  error estimate for blocks of size 2^( 3) =       0.000436042319
  error estimate for blocks of size 2^( 4) =       0.000447430796
  error estimate for blocks of size 2^( 5) =       0.000458035511
  error estimate for blocks of size 2^( 6) =       0.000466192124
  error estimate for blocks of size 2^( 7) =       0.000472447611

      target function =                  N/A
              le_mean =     -16.906136862350
             les_mean =     286.154338078985
             stat err =       0.000461026510
             autocorr =       1.261866693400
              std dev =       0.580409027255
             le_variance =       0.336874638919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864857
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864857
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410411159
  error estimate for blocks of size 2^( 2) =       0.000423055392
  error estimate for blocks of size 2^( 3) =       0.000436042319
  error estimate for blocks of size 2^( 4) =       0.000447430796
  error estimate for blocks of size 2^( 5) =       0.000458035511
  error estimate for blocks of size 2^( 6) =       0.000466192124
  error estimate for blocks of size 2^( 7) =       0.000472447611

      target function =                  N/A
              le_mean =     -16.906136862350
             les_mean =     286.154338078980
             stat err =       0.000461026510
             autocorr =       1.261866693415
              std dev =       0.580409027247
             le_variance =       0.336874638910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864850
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781864850
                                         uncertainty =       0.004326797627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410411159
  error estimate for blocks of size 2^( 2) =       0.000423055392
  error estimate for blocks of size 2^( 3) =       0.000436042319
  error estimate for blocks of size 2^( 4) =       0.000447430796
  error estimate for blocks of size 2^( 5) =       0.000458035511
  error estimate for blocks of size 2^( 6) =       0.000466192124
  error estimate for blocks of size 2^( 7) =       0.000472447611

      target function =                  N/A
              le_mean =     -16.906136862350
             les_mean =     286.154338078976
             stat err =       0.000461026510
             autocorr =       1.261866693425
              std dev =       0.580409027241
             le_variance =       0.336874638902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906136862350        initial  <--
     6.1035e+06     6.1035e+07             5.3756e-11       -16.906136862350
     2.4414e+07     2.4414e+08             1.3439e-11       -16.906136862350
     9.7656e+07     9.7656e+08             3.3598e-12       -16.906136862350

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6343
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6082e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9631
    reference variance = 0.385647
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852094645
                                         uncertainty =       0.002943758618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852094645
                                         uncertainty =       0.002943758618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410973434
  error estimate for blocks of size 2^( 2) =       0.000423863429
  error estimate for blocks of size 2^( 3) =       0.000436422885
  error estimate for blocks of size 2^( 4) =       0.000448249588
  error estimate for blocks of size 2^( 5) =       0.000457147136
  error estimate for blocks of size 2^( 6) =       0.000465066181
  error estimate for blocks of size 2^( 7) =       0.000468874418

      target function =                  N/A
              le_mean =     -16.906758036628
             les_mean =     286.176265467216
             stat err =       0.000459834331
             autocorr =       1.251916276145
              std dev =       0.581204204251
             le_variance =       0.337798327038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690675803663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906758036628       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906758036628       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906758036628       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906758036628       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906758036628       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906758006429       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906758055061       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906758038435       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.555072e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906758036628       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906758036628       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906758036628       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906758055763       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906758036628       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906757951675       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906757937155       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906757958345       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 8.888280e-13

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906758036628       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906758036628       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906758036628       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906757965118       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906757799629       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906758147616       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906757779783       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906758226760       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 2.222132e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5977e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9413
    reference variance = 0.315927
====================================================
  Execution time = 2.0057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4395e-01
  Total weights = 2.0000e+06
  Execution time = 1.8709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061619
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061619
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414695967
  error estimate for blocks of size 2^( 2) =       0.000427302464
  error estimate for blocks of size 2^( 3) =       0.000440083458
  error estimate for blocks of size 2^( 4) =       0.000453235350
  error estimate for blocks of size 2^( 5) =       0.000465567646
  error estimate for blocks of size 2^( 6) =       0.000475195544
  error estimate for blocks of size 2^( 7) =       0.000483726659

      target function =                  N/A
              le_mean =     -16.905547156057
             les_mean =     286.141469963875
             stat err =       0.000469431300
             autocorr =       1.281399241472
              std dev =       0.586468660876
             le_variance =       0.343945490190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061618
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061618
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414695967
  error estimate for blocks of size 2^( 2) =       0.000427302464
  error estimate for blocks of size 2^( 3) =       0.000440083458
  error estimate for blocks of size 2^( 4) =       0.000453235350
  error estimate for blocks of size 2^( 5) =       0.000465567646
  error estimate for blocks of size 2^( 6) =       0.000475195544
  error estimate for blocks of size 2^( 7) =       0.000483726659

      target function =                  N/A
              le_mean =     -16.905547156057
             les_mean =     286.141469963874
             stat err =       0.000469431300
             autocorr =       1.281399241474
              std dev =       0.586468660875
             le_variance =       0.343945490189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061618
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061618
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414695967
  error estimate for blocks of size 2^( 2) =       0.000427302464
  error estimate for blocks of size 2^( 3) =       0.000440083458
  error estimate for blocks of size 2^( 4) =       0.000453235350
  error estimate for blocks of size 2^( 5) =       0.000465567646
  error estimate for blocks of size 2^( 6) =       0.000475195544
  error estimate for blocks of size 2^( 7) =       0.000483726659

      target function =                  N/A
              le_mean =     -16.905547156057
             les_mean =     286.141469963874
             stat err =       0.000469431300
             autocorr =       1.281399241470
              std dev =       0.586468660876
             le_variance =       0.343945490189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061619
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343971061619
                                         uncertainty =       0.005088423320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414695967
  error estimate for blocks of size 2^( 2) =       0.000427302464
  error estimate for blocks of size 2^( 3) =       0.000440083458
  error estimate for blocks of size 2^( 4) =       0.000453235350
  error estimate for blocks of size 2^( 5) =       0.000465567646
  error estimate for blocks of size 2^( 6) =       0.000475195544
  error estimate for blocks of size 2^( 7) =       0.000483726659

      target function =                  N/A
              le_mean =     -16.905547156057
             les_mean =     286.141469963875
             stat err =       0.000469431300
             autocorr =       1.281399241476
              std dev =       0.586468660876
             le_variance =       0.343945490190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905547156057        initial  <--
     6.1035e+07     6.1035e+08             3.5551e-12       -16.905547156057
     2.4414e+08     2.4414e+09             8.8883e-13       -16.905547156057
     9.7656e+08     9.7656e+09             2.2221e-13       -16.905547156057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5460
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8776
    reference variance = 0.2279
====================================================
  Execution time = 2.0689e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3727e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337347417089
                                         uncertainty =       0.003656285116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337347417089
                                         uncertainty =       0.003656285116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410650437
  error estimate for blocks of size 2^( 2) =       0.000423050501
  error estimate for blocks of size 2^( 3) =       0.000436338366
  error estimate for blocks of size 2^( 4) =       0.000448460825
  error estimate for blocks of size 2^( 5) =       0.000459533586
  error estimate for blocks of size 2^( 6) =       0.000468145003
  error estimate for blocks of size 2^( 7) =       0.000475112425

      target function =                  N/A
              le_mean =     -16.905912730483
             les_mean =     286.147152645135
             stat err =       0.000462812960
             autocorr =       1.270183433817
              std dev =       0.580747417604
             le_variance =       0.337267563054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591273048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912730483       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912730483       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912730483       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912730483       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905912532740       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912345471       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905912337466       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 3.897047e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912730483       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912730483       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912730483       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912730483       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905913644829       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905912055831       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905914102299       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 9.746963e-14

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905912730483       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905912730483       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905912730483       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905912730483       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909925284       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905913259557       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918314629       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905904371668       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905907454168       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 2.464504e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6302e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.301339
====================================================
  Execution time = 2.0147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3726e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647794
  error estimate for blocks of size 2^( 2) =       0.000423520534
  error estimate for blocks of size 2^( 3) =       0.000436353094
  error estimate for blocks of size 2^( 4) =       0.000448876523
  error estimate for blocks of size 2^( 5) =       0.000460290375
  error estimate for blocks of size 2^( 6) =       0.000468610928
  error estimate for blocks of size 2^( 7) =       0.000474471619

      target function =                  N/A
              le_mean =     -16.906434083788
             les_mean =     286.164776481598
             stat err =       0.000463062361
             autocorr =       1.271569131814
              std dev =       0.580743679063
             le_variance =       0.337263220772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647794
  error estimate for blocks of size 2^( 2) =       0.000423520534
  error estimate for blocks of size 2^( 3) =       0.000436353094
  error estimate for blocks of size 2^( 4) =       0.000448876523
  error estimate for blocks of size 2^( 5) =       0.000460290375
  error estimate for blocks of size 2^( 6) =       0.000468610928
  error estimate for blocks of size 2^( 7) =       0.000474471619

      target function =                  N/A
              le_mean =     -16.906434083788
             les_mean =     286.164776481598
             stat err =       0.000463062361
             autocorr =       1.271569131815
              std dev =       0.580743679063
             le_variance =       0.337263220772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647794
  error estimate for blocks of size 2^( 2) =       0.000423520534
  error estimate for blocks of size 2^( 3) =       0.000436353094
  error estimate for blocks of size 2^( 4) =       0.000448876523
  error estimate for blocks of size 2^( 5) =       0.000460290375
  error estimate for blocks of size 2^( 6) =       0.000468610928
  error estimate for blocks of size 2^( 7) =       0.000474471619

      target function =                  N/A
              le_mean =     -16.906434083788
             les_mean =     286.164776481598
             stat err =       0.000463062361
             autocorr =       1.271569131818
              std dev =       0.580743679063
             le_variance =       0.337263220772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337238921606
                                         uncertainty =       0.004210502112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647794
  error estimate for blocks of size 2^( 2) =       0.000423520534
  error estimate for blocks of size 2^( 3) =       0.000436353094
  error estimate for blocks of size 2^( 4) =       0.000448876523
  error estimate for blocks of size 2^( 5) =       0.000460290375
  error estimate for blocks of size 2^( 6) =       0.000468610928
  error estimate for blocks of size 2^( 7) =       0.000474471619

      target function =                  N/A
              le_mean =     -16.906434083788
             les_mean =     286.164776481598
             stat err =       0.000463062361
             autocorr =       1.271569131814
              std dev =       0.580743679063
             le_variance =       0.337263220772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906434083788        initial  <--
     6.1035e+08     6.1035e+09             3.8970e-13       -16.906434083788
     2.4414e+09     2.4414e+10             9.7470e-14       -16.906434083788
     9.7656e+09     9.7656e+10             2.4645e-14       -16.906434083788

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6613
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.91
    reference variance = 0.300228
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3317e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333171677077
                                         uncertainty =       0.003272326020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333171677077
                                         uncertainty =       0.003272326020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408149059
  error estimate for blocks of size 2^( 2) =       0.000421492534
  error estimate for blocks of size 2^( 3) =       0.000435345221
  error estimate for blocks of size 2^( 4) =       0.000448503452
  error estimate for blocks of size 2^( 5) =       0.000461059455
  error estimate for blocks of size 2^( 6) =       0.000472927332
  error estimate for blocks of size 2^( 7) =       0.000482162608

      target function =                  N/A
              le_mean =     -16.905577017609
             les_mean =     286.131705440648
             stat err =       0.000466163211
             autocorr =       1.304482912180
              std dev =       0.577209934870
             le_variance =       0.333171308913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557701761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577017609       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577017609       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905577017609       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905577017609       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905577614747       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580136042       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905573078862       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 4.326051e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577017609       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577017609       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905577017609       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905577017609       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905559724627       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577100581       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905564931038       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905591354637       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905468277517       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905581263219       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905536013621       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905568981326       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905568919142       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905667347418       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905568850135       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905743558042       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906030835552       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905812612972       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905043724461       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905673827511       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906225791097       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905346156403       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906282845638       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905329633820       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903894829408       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.903626394346       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906550453513       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904937818442       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904660919491       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.901883497311       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911981946385       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.904259353986       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.902907438967       residual = 9.04e-04           smallest_sin_value = 9.98e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 1.017806e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577017609       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577017609       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905577017609       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905564674287       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905613776499       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577017609       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905581104651       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905576755390       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905334656392       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904895909706       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905476194835       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904572422298       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906948320132       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905310049888       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907535831245       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908533930722       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904993306023       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903393918963       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909119334185       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893179235792       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903176473901       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904879565539       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.900526290544       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.912993670128       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.907661380925       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.910186044878       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905932114445       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.912246839225       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907702201277       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.912294974778       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.895333821801       residual = 1.33e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.890079744053       residual = 3.47e-02           smallest_sin_value = 9.97e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.900567626653       residual = 3.12e-03           smallest_sin_value = 9.96e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.46e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 2.720943e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6204e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8549
    reference variance = 0.186975
====================================================
  Execution time = 2.0145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3771e-01
  Total weights = 2.0000e+06
  Execution time = 1.8650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410917244
  error estimate for blocks of size 2^( 2) =       0.000423881736
  error estimate for blocks of size 2^( 3) =       0.000436789999
  error estimate for blocks of size 2^( 4) =       0.000450336457
  error estimate for blocks of size 2^( 5) =       0.000461927102
  error estimate for blocks of size 2^( 6) =       0.000468902694
  error estimate for blocks of size 2^( 7) =       0.000472625892

      target function =                  N/A
              le_mean =     -16.906644810666
             les_mean =     286.172344547907
             stat err =       0.000463448036
             autocorr =       1.272018299242
              std dev =       0.581124739397
             le_variance =       0.337705962739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410917244
  error estimate for blocks of size 2^( 2) =       0.000423881736
  error estimate for blocks of size 2^( 3) =       0.000436789999
  error estimate for blocks of size 2^( 4) =       0.000450336457
  error estimate for blocks of size 2^( 5) =       0.000461927102
  error estimate for blocks of size 2^( 6) =       0.000468902694
  error estimate for blocks of size 2^( 7) =       0.000472625892

      target function =                  N/A
              le_mean =     -16.906644810666
             les_mean =     286.172344547907
             stat err =       0.000463448036
             autocorr =       1.272018299239
              std dev =       0.581124739397
             le_variance =       0.337705962739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410917244
  error estimate for blocks of size 2^( 2) =       0.000423881736
  error estimate for blocks of size 2^( 3) =       0.000436789999
  error estimate for blocks of size 2^( 4) =       0.000450336457
  error estimate for blocks of size 2^( 5) =       0.000461927102
  error estimate for blocks of size 2^( 6) =       0.000468902694
  error estimate for blocks of size 2^( 7) =       0.000472625892

      target function =                  N/A
              le_mean =     -16.906644810666
             les_mean =     286.172344547907
             stat err =       0.000463448036
             autocorr =       1.272018299237
              std dev =       0.581124739397
             le_variance =       0.337705962739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337782769085
                                         uncertainty =       0.003100720980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410917244
  error estimate for blocks of size 2^( 2) =       0.000423881736
  error estimate for blocks of size 2^( 3) =       0.000436789999
  error estimate for blocks of size 2^( 4) =       0.000450336457
  error estimate for blocks of size 2^( 5) =       0.000461927102
  error estimate for blocks of size 2^( 6) =       0.000468902694
  error estimate for blocks of size 2^( 7) =       0.000472625892

      target function =                  N/A
              le_mean =     -16.906644810666
             les_mean =     286.172344547907
             stat err =       0.000463448036
             autocorr =       1.272018299243
              std dev =       0.581124739397
             le_variance =       0.337705962739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906644810666        initial  <--
     6.1035e+09     6.1035e+10             4.3261e-14       -16.906644810666
     2.4414e+10     2.4414e+11             1.0178e-14       -16.906644810666
     9.7656e+10     9.7656e+11             2.7209e-15       -16.906644810666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6055
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9922
    reference variance = 0.507871
====================================================
  Execution time = 2.0639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3881e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338797786286
                                         uncertainty =       0.003762890236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338797786286
                                         uncertainty =       0.003762890236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411589555
  error estimate for blocks of size 2^( 2) =       0.000424273605
  error estimate for blocks of size 2^( 3) =       0.000437314105
  error estimate for blocks of size 2^( 4) =       0.000449337864
  error estimate for blocks of size 2^( 5) =       0.000458813793
  error estimate for blocks of size 2^( 6) =       0.000467364166
  error estimate for blocks of size 2^( 7) =       0.000471445144

      target function =                  N/A
              le_mean =     -16.905916346592
             les_mean =     286.148819271431
             stat err =       0.000461740242
             autocorr =       1.258539244235
              std dev =       0.582075530224
             le_variance =       0.338811922886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591634659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916346592       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916346592       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916346592       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916346592       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911076372       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905910989666       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905919788989       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905900273744       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905954121790       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905905107610       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905943545877       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905732371962       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906809087798       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905289755837       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905601759944       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905292620969       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906433999304       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907722057359       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907171396659       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909297798618       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905091562579       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.907647428354       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.902525407224       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908733550128       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904458888076       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902496964598       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903970909695       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906091458196       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908873314453       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.897055955524       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.903848164596       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.903090741882       residual = 9.91e-04           smallest_sin_value = 9.98e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 3.742105e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916346592       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916346592       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916346592       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916346592       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905935670928       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905913038834       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905923079692       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905892236584       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905982945286       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906277106905       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.902261342502       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904327840827       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905541840458       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904725677555       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905144904192       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.916280338636       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906268360583       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.897194339763       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893356500513       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.901032914926       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.911133092586       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.898183651994       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906510090651       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.902417354817       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.885736606436       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893741765291       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.923282038990       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.930145191547       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.929140882867       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.846980678172       residual = 4.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.916656017849       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.934272392370       residual = 9.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.901593140131       residual = 4.67e-03           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.894783527970       residual = 2.29e-02           smallest_sin_value = 9.91e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.46e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 9.158911e-16

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916346592       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916346592       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905916346592       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905916346592       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905492754242       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905230610385       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908584420165       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911125528121       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910069087420       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907411678900       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.889910589655       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905767948435       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.886485708904       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.912936186188       residual = 7.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904912779391       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.895559345086       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.896946624872       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909896816547       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.876358587058       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.802162982274       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.863982569326       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.804628611289       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.908662726205       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.880774571683       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.921271717705       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.880243144484       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.879135495644       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.010736894651       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.890972172928       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.046039973627       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.919070041514       residual = 7.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.823524017842       residual = 7.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.644106374738       residual = 9.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.135871645459       residual = 6.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.918620359020       residual = 4.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.993340486877       residual = 8.68e-01           smallest_sin_value = 9.98e-01
davidson iteration   36:   krylov dim =  37   energy =     -17.068091075942       residual = 3.80e+00           smallest_sin_value = 9.91e-01
davidson iteration   37 stopping due to small subspace S singular value of 8.73e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 1.599590e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6216e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8722
    reference variance = 0.217379
====================================================
  Execution time = 2.0143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3114e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406905666
  error estimate for blocks of size 2^( 2) =       0.000419914864
  error estimate for blocks of size 2^( 3) =       0.000433063443
  error estimate for blocks of size 2^( 4) =       0.000444982984
  error estimate for blocks of size 2^( 5) =       0.000454213323
  error estimate for blocks of size 2^( 6) =       0.000461730274
  error estimate for blocks of size 2^( 7) =       0.000465981333

      target function =                  N/A
              le_mean =     -16.906703979237
             les_mean =     286.167783717626
             stat err =       0.000456726978
             autocorr =       1.259870355001
              std dev =       0.575451511133
             le_variance =       0.331144441665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406905666
  error estimate for blocks of size 2^( 2) =       0.000419914864
  error estimate for blocks of size 2^( 3) =       0.000433063443
  error estimate for blocks of size 2^( 4) =       0.000444982984
  error estimate for blocks of size 2^( 5) =       0.000454213323
  error estimate for blocks of size 2^( 6) =       0.000461730274
  error estimate for blocks of size 2^( 7) =       0.000465981333

      target function =                  N/A
              le_mean =     -16.906703979237
             les_mean =     286.167783717626
             stat err =       0.000456726978
             autocorr =       1.259870355002
              std dev =       0.575451511133
             le_variance =       0.331144441665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406905666
  error estimate for blocks of size 2^( 2) =       0.000419914864
  error estimate for blocks of size 2^( 3) =       0.000433063443
  error estimate for blocks of size 2^( 4) =       0.000444982984
  error estimate for blocks of size 2^( 5) =       0.000454213323
  error estimate for blocks of size 2^( 6) =       0.000461730274
  error estimate for blocks of size 2^( 7) =       0.000465981333

      target function =                  N/A
              le_mean =     -16.906703979237
             les_mean =     286.167783717626
             stat err =       0.000456726978
             autocorr =       1.259870355002
              std dev =       0.575451511133
             le_variance =       0.331144441665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331243207986
                                         uncertainty =       0.002395385788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406905666
  error estimate for blocks of size 2^( 2) =       0.000419914864
  error estimate for blocks of size 2^( 3) =       0.000433063443
  error estimate for blocks of size 2^( 4) =       0.000444982984
  error estimate for blocks of size 2^( 5) =       0.000454213323
  error estimate for blocks of size 2^( 6) =       0.000461730274
  error estimate for blocks of size 2^( 7) =       0.000465981333

      target function =                  N/A
              le_mean =     -16.906703979237
             les_mean =     286.167783717626
             stat err =       0.000456726978
             autocorr =       1.259870355002
              std dev =       0.575451511133
             le_variance =       0.331144441665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906703979237        initial  <--
     6.1035e+10     6.1035e+11             3.7421e-15       -16.906703979237
     2.4414e+11     2.4414e+12             9.1589e-16       -16.906703979237
     9.7656e+11     9.7656e+12             1.5996e-16       -16.906703979237

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6315
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9384
    reference variance = 0.345494
====================================================
  Execution time = 2.0382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335175651612
                                         uncertainty =       0.003410888804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335175651612
                                         uncertainty =       0.003410888804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409370286
  error estimate for blocks of size 2^( 2) =       0.000422199376
  error estimate for blocks of size 2^( 3) =       0.000436157756
  error estimate for blocks of size 2^( 4) =       0.000449227973
  error estimate for blocks of size 2^( 5) =       0.000461593616
  error estimate for blocks of size 2^( 6) =       0.000471601225
  error estimate for blocks of size 2^( 7) =       0.000478621319

      target function =                  N/A
              le_mean =     -16.905964735062
             les_mean =     286.146811517431
             stat err =       0.000465261033
             autocorr =       1.291697233212
              std dev =       0.578937010262
             le_variance =       0.335168061851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596473506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905964735062       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905964735062       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964735062       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905964735062       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906135587644       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905946628169       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926255425       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906282580266       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.899943812911       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908818243122       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.892913056589       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.902423878718       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906713032853       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907411350287       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896524485010       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.913319913914       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.896264109170       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903708846084       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.822770994245       residual = 9.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.931206570844       residual = 8.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907741550500       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.866375894923       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.952336024757       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.974643964008       residual = 5.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.936019359501       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.847240809754       residual = 4.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.005814308820       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.881861136381       residual = 8.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.886379635843       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.869933742837       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.843259660003       residual = 5.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.921268088245       residual = 7.26e-02           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.801511490971       residual = 1.35e+00           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.791921424886       residual = 1.60e+00           smallest_sin_value = 9.96e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 2.965578e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905964735062       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905964735062       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964735062       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906395320142       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906035795094       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016851804       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.901472273469       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903980993828       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911801233934       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.899393423997       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.890510648090       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.987218862341       residual = 9.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.969179497729       residual = 5.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.857000483470       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.839538581396       residual = 5.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.848022621777       residual = 4.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.068994914702       residual = 3.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.928044389275       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.701089484622       residual = 5.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.367195916885       residual = 2.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.815387007568       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.764529700399       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.621435057834       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.838761154906       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.719554596128       residual = 4.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.571755953107       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.880894535785       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.830587709126       residual = 9.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.811383937890       residual = 1.29e+00           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.107881891802       residual = 5.64e+00           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 3.832821e-17

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905964735062       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905964735062       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964735062       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033840928       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.888908048645       residual = 4.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.917995068970       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.934187729114       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.897206975887       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.950967801402       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.817300428100       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.817665458599       residual = 9.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.897360935710       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.029618227748       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.943067344776       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.583999455935       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.353331838892       residual = 2.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.033149827758       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.310177500921       residual = 2.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.962442978824       residual = 5.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.413374754130       residual = 3.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.302637466397       residual = 1.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.419489386294       residual = 3.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.425003917756       residual = 3.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.164904898263       residual = 8.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.266434655941       residual = 5.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.925379521267       residual = 1.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -19.017237342081       residual = 5.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.083990720084       residual = 5.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.090784505935       residual = 4.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.501084313023       residual = 2.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -15.402614728374       residual = 3.07e+02           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.187709128908       residual = 1.25e+01           smallest_sin_value = 9.92e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 6.861181e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5926e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.927
    reference variance = 0.209041
====================================================
  Execution time = 2.2216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4473e-01
  Total weights = 2.0000e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170617
  error estimate for blocks of size 2^( 2) =       0.000427311625
  error estimate for blocks of size 2^( 3) =       0.000439563614
  error estimate for blocks of size 2^( 4) =       0.000450708266
  error estimate for blocks of size 2^( 5) =       0.000461646179
  error estimate for blocks of size 2^( 6) =       0.000466896634
  error estimate for blocks of size 2^( 7) =       0.000471429454

      target function =                  N/A
              le_mean =     -16.906420498816
             les_mean =     286.171787192311
             stat err =       0.000462670133
             autocorr =       1.241908822312
              std dev =       0.587139916790
             le_variance =       0.344733281888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170617
  error estimate for blocks of size 2^( 2) =       0.000427311625
  error estimate for blocks of size 2^( 3) =       0.000439563614
  error estimate for blocks of size 2^( 4) =       0.000450708266
  error estimate for blocks of size 2^( 5) =       0.000461646179
  error estimate for blocks of size 2^( 6) =       0.000466896634
  error estimate for blocks of size 2^( 7) =       0.000471429454

      target function =                  N/A
              le_mean =     -16.906420498816
             les_mean =     286.171787192311
             stat err =       0.000462670133
             autocorr =       1.241908822309
              std dev =       0.587139916790
             le_variance =       0.344733281888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170617
  error estimate for blocks of size 2^( 2) =       0.000427311625
  error estimate for blocks of size 2^( 3) =       0.000439563614
  error estimate for blocks of size 2^( 4) =       0.000450708266
  error estimate for blocks of size 2^( 5) =       0.000461646179
  error estimate for blocks of size 2^( 6) =       0.000466896634
  error estimate for blocks of size 2^( 7) =       0.000471429454

      target function =                  N/A
              le_mean =     -16.906420498816
             les_mean =     286.171787192311
             stat err =       0.000462670133
             autocorr =       1.241908822312
              std dev =       0.587139916790
             le_variance =       0.344733281888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344821934974
                                         uncertainty =       0.004339575239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415170617
  error estimate for blocks of size 2^( 2) =       0.000427311625
  error estimate for blocks of size 2^( 3) =       0.000439563614
  error estimate for blocks of size 2^( 4) =       0.000450708266
  error estimate for blocks of size 2^( 5) =       0.000461646179
  error estimate for blocks of size 2^( 6) =       0.000466896634
  error estimate for blocks of size 2^( 7) =       0.000471429454

      target function =                  N/A
              le_mean =     -16.906420498816
             les_mean =     286.171787192311
             stat err =       0.000462670133
             autocorr =       1.241908822312
              std dev =       0.587139916790
             le_variance =       0.344733281888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906420498816        initial  <--
     6.1035e+11     6.1035e+12             2.9656e-16       -16.906420498816
     2.4414e+12     2.4414e+13             3.8328e-17       -16.906420498816
     9.7656e+12     9.7656e+13             6.8612e-18       -16.906420498816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7285
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9156
    reference variance = 0.282992
====================================================
  Execution time = 2.0336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3988e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339954710129
                                         uncertainty =       0.003456514955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339954710129
                                         uncertainty =       0.003456514955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412236087
  error estimate for blocks of size 2^( 2) =       0.000424516644
  error estimate for blocks of size 2^( 3) =       0.000436837325
  error estimate for blocks of size 2^( 4) =       0.000448138091
  error estimate for blocks of size 2^( 5) =       0.000457258543
  error estimate for blocks of size 2^( 6) =       0.000464629534
  error estimate for blocks of size 2^( 7) =       0.000470605769

      target function =                  N/A
              le_mean =     -16.906918364002
             les_mean =     286.183765580501
             stat err =       0.000460157984
             autocorr =       1.246011092652
              std dev =       0.582989865608
             le_variance =       0.339877183402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690691836400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906918364002       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906918364002       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906918364002       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906918364002       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907363625512       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906814713415       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903077920549       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908057394179       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.913120692787       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.872064299545       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.899139640594       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.751722163967       residual = 3.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215211755809       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.917245277537       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.192735465096       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.926124925415       residual = 7.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.970344880655       residual = 5.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.703538952430       residual = 5.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.133159673399       residual = 6.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.902570764299       residual = 8.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.981124425721       residual = 8.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.940451108969       residual = 7.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.625497767361       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.435348890080       residual = 3.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.454990943196       residual = 4.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.422161006568       residual = 3.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.727193067057       residual = 3.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.246674849686       residual = 2.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.959839260933       residual = 4.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.633660267042       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.937688225776       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.143876315460       residual = 8.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.637046489353       residual = 1.29e+01           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -18.375216564595       residual = 2.77e+02           smallest_sin_value = 9.98e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.938403229068       residual = 3.59e+00           smallest_sin_value = 9.97e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 2.288590e-17

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906918364002       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906918364002       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906918364002       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905673482334       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907506879164       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.933715979763       residual = 7.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.888354755440       residual = 5.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.899302701169       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.828768458173       residual = 8.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.816755983368       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.985239625260       residual = 9.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.875595081198       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.827407334030       residual = 8.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.727193982729       residual = 5.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -14.487112944475       residual = 7.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.175473164140       residual = 7.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.208818380246       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.393473128154       residual = 3.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.157393745881       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.089542227353       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -18.006958475159       residual = 1.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.019954200958       residual = 8.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.161483300255       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -15.696972553680       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.671828265675       residual = 5.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.906003568457       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -20.212033519786       residual = 1.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -15.720897651197       residual = 1.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.383206646938       residual = 2.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -18.343335673338       residual = 2.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.640184208649       residual = 2.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -20.106484191079       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -12.801624608415       residual = 2.00e+03           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -20.094661066257       residual = 1.46e+03           smallest_sin_value = 9.95e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 2.123982e-18

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906918364002       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906918364002       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906918364002       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906918364002       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.918269472577       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.755102022489       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.952183489198       residual = 2.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210491361329       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.558774420528       residual = 5.56e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.355282063026       residual = 3.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.271769693314       residual = 1.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.695457115652       residual = 6.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.728040067118       residual = 5.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.138641428795       residual = 1.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -15.812699899344       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -15.735470453227       residual = 1.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.139365460598       residual = 8.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -11.535333096498       residual = 3.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 5.309954e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.467607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5921e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9353
    reference variance = 0.226117
====================================================
  Execution time = 1.9920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409053439
  error estimate for blocks of size 2^( 2) =       0.000421505122
  error estimate for blocks of size 2^( 3) =       0.000434327846
  error estimate for blocks of size 2^( 4) =       0.000445821027
  error estimate for blocks of size 2^( 5) =       0.000455360536
  error estimate for blocks of size 2^( 6) =       0.000461072965
  error estimate for blocks of size 2^( 7) =       0.000465380495

      target function =                  N/A
              le_mean =     -16.906522739285
             les_mean =     286.165160398087
             stat err =       0.000456908756
             autocorr =       1.247667506709
              std dev =       0.578488920753
             le_variance =       0.334649431434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409053439
  error estimate for blocks of size 2^( 2) =       0.000421505122
  error estimate for blocks of size 2^( 3) =       0.000434327846
  error estimate for blocks of size 2^( 4) =       0.000445821027
  error estimate for blocks of size 2^( 5) =       0.000455360536
  error estimate for blocks of size 2^( 6) =       0.000461072965
  error estimate for blocks of size 2^( 7) =       0.000465380495

      target function =                  N/A
              le_mean =     -16.906522739285
             les_mean =     286.165160398087
             stat err =       0.000456908756
             autocorr =       1.247667506712
              std dev =       0.578488920753
             le_variance =       0.334649431434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409053439
  error estimate for blocks of size 2^( 2) =       0.000421505122
  error estimate for blocks of size 2^( 3) =       0.000434327846
  error estimate for blocks of size 2^( 4) =       0.000445821027
  error estimate for blocks of size 2^( 5) =       0.000455360536
  error estimate for blocks of size 2^( 6) =       0.000461072965
  error estimate for blocks of size 2^( 7) =       0.000465380495

      target function =                  N/A
              le_mean =     -16.906522739285
             les_mean =     286.165160398087
             stat err =       0.000456908756
             autocorr =       1.247667506709
              std dev =       0.578488920753
             le_variance =       0.334649431434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334709331880
                                         uncertainty =       0.003585104041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409053439
  error estimate for blocks of size 2^( 2) =       0.000421505122
  error estimate for blocks of size 2^( 3) =       0.000434327846
  error estimate for blocks of size 2^( 4) =       0.000445821027
  error estimate for blocks of size 2^( 5) =       0.000455360536
  error estimate for blocks of size 2^( 6) =       0.000461072965
  error estimate for blocks of size 2^( 7) =       0.000465380495

      target function =                  N/A
              le_mean =     -16.906522739285
             les_mean =     286.165160398087
             stat err =       0.000456908756
             autocorr =       1.247667506709
              std dev =       0.578488920753
             le_variance =       0.334649431434


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906522739285        initial  <--
     6.1035e+12     6.1035e+13             2.2886e-17       -16.906522739285
     2.4414e+13     2.4414e+14             2.1240e-18       -16.906522739285
     9.7656e+13     9.7656e+14             5.3100e-19       -16.906522739285

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4129
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9101
    reference variance = 0.252471
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4172e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341722585832
                                         uncertainty =       0.004773862509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341722585832
                                         uncertainty =       0.004773862509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413352747
  error estimate for blocks of size 2^( 2) =       0.000426162341
  error estimate for blocks of size 2^( 3) =       0.000438691750
  error estimate for blocks of size 2^( 4) =       0.000451305762
  error estimate for blocks of size 2^( 5) =       0.000462756270
  error estimate for blocks of size 2^( 6) =       0.000470975005
  error estimate for blocks of size 2^( 7) =       0.000475250179

      target function =                  N/A
              le_mean =     -16.906244350351
             les_mean =     286.162818849701
             stat err =       0.000465071804
             autocorr =       1.265896981990
              std dev =       0.584569060738
             le_variance =       0.341720986773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624435035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244350351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244350351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244350351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244350351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244350351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244350351       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6149e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.372413
====================================================
  Execution time = 1.9843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3560e-01
  Total weights = 2.0000e+06
  Execution time = 1.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634970
  error estimate for blocks of size 2^( 2) =       0.000422667833
  error estimate for blocks of size 2^( 3) =       0.000436723119
  error estimate for blocks of size 2^( 4) =       0.000449475983
  error estimate for blocks of size 2^( 5) =       0.000461669918
  error estimate for blocks of size 2^( 6) =       0.000471552989
  error estimate for blocks of size 2^( 7) =       0.000480665857

      target function =                  N/A
              le_mean =     -16.905609490185
             les_mean =     286.135233684077
             stat err =       0.000465841187
             autocorr =       1.293247708931
              std dev =       0.579311330146
             le_variance =       0.335601617236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634970
  error estimate for blocks of size 2^( 2) =       0.000422667833
  error estimate for blocks of size 2^( 3) =       0.000436723119
  error estimate for blocks of size 2^( 4) =       0.000449475983
  error estimate for blocks of size 2^( 5) =       0.000461669918
  error estimate for blocks of size 2^( 6) =       0.000471552989
  error estimate for blocks of size 2^( 7) =       0.000480665857

      target function =                  N/A
              le_mean =     -16.905609490185
             les_mean =     286.135233684077
             stat err =       0.000465841187
             autocorr =       1.293247708931
              std dev =       0.579311330146
             le_variance =       0.335601617236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634970
  error estimate for blocks of size 2^( 2) =       0.000422667833
  error estimate for blocks of size 2^( 3) =       0.000436723119
  error estimate for blocks of size 2^( 4) =       0.000449475983
  error estimate for blocks of size 2^( 5) =       0.000461669918
  error estimate for blocks of size 2^( 6) =       0.000471552989
  error estimate for blocks of size 2^( 7) =       0.000480665857

      target function =                  N/A
              le_mean =     -16.905609490185
             les_mean =     286.135233684077
             stat err =       0.000465841187
             autocorr =       1.293247708931
              std dev =       0.579311330146
             le_variance =       0.335601617236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335630861530
                                         uncertainty =       0.004080492083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634970
  error estimate for blocks of size 2^( 2) =       0.000422667833
  error estimate for blocks of size 2^( 3) =       0.000436723119
  error estimate for blocks of size 2^( 4) =       0.000449475983
  error estimate for blocks of size 2^( 5) =       0.000461669918
  error estimate for blocks of size 2^( 6) =       0.000471552989
  error estimate for blocks of size 2^( 7) =       0.000480665857

      target function =                  N/A
              le_mean =     -16.905609490185
             les_mean =     286.135233684077
             stat err =       0.000465841187
             autocorr =       1.293247708931
              std dev =       0.579311330146
             le_variance =       0.335601617236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905609490185        initial  <--
     6.1035e+13     6.1035e+14             0.0000e+00       -16.905609490185
     2.4414e+14     2.4414e+15             0.0000e+00       -16.905609490185
     9.7656e+14     9.7656e+15             0.0000e+00       -16.905609490185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3600
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.353574
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335032890371
                                         uncertainty =       0.002806863142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335032890371
                                         uncertainty =       0.002806863142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409312246
  error estimate for blocks of size 2^( 2) =       0.000422126060
  error estimate for blocks of size 2^( 3) =       0.000435005754
  error estimate for blocks of size 2^( 4) =       0.000447601432
  error estimate for blocks of size 2^( 5) =       0.000458467312
  error estimate for blocks of size 2^( 6) =       0.000466755579
  error estimate for blocks of size 2^( 7) =       0.000471425792

      target function =                  N/A
              le_mean =     -16.906287836207
             les_mean =     286.157641262810
             stat err =       0.000461062529
             autocorr =       1.268849692502
              std dev =       0.578854929738
             le_variance =       0.335073029682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628783621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287836207       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287836207       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287836207       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.415917214808       residual = 4.56e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912431313607       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -11.502870169192       residual = 3.59e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -18.040023564665       residual = 1.64e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -12.223770505057       residual = 2.79e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -19.935426216839       residual = 1.23e+03           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 9.341900e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287836207       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287836207       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287836206       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287836200       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.010664326278       residual = 1.10e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.130849672802       residual = 6.70e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -15.076266830749       residual = 3.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 2.335475e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287836207       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287836207       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.471179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5833e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9428
    reference variance = 0.535395
====================================================
  Execution time = 2.0152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3901e-01
  Total weights = 2.0000e+06
  Execution time = 1.8604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411707661
  error estimate for blocks of size 2^( 2) =       0.000424297763
  error estimate for blocks of size 2^( 3) =       0.000437214640
  error estimate for blocks of size 2^( 4) =       0.000449676012
  error estimate for blocks of size 2^( 5) =       0.000459759619
  error estimate for blocks of size 2^( 6) =       0.000467353455
  error estimate for blocks of size 2^( 7) =       0.000473510735

      target function =                  N/A
              le_mean =     -16.906098790065
             les_mean =     286.155182525604
             stat err =       0.000462574955
             autocorr =       1.262369040050
              std dev =       0.582242557417
             le_variance =       0.339006395667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411707661
  error estimate for blocks of size 2^( 2) =       0.000424297763
  error estimate for blocks of size 2^( 3) =       0.000437214640
  error estimate for blocks of size 2^( 4) =       0.000449676012
  error estimate for blocks of size 2^( 5) =       0.000459759619
  error estimate for blocks of size 2^( 6) =       0.000467353455
  error estimate for blocks of size 2^( 7) =       0.000473510735

      target function =                  N/A
              le_mean =     -16.906098790065
             les_mean =     286.155182525604
             stat err =       0.000462574955
             autocorr =       1.262369040050
              std dev =       0.582242557417
             le_variance =       0.339006395667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411707661
  error estimate for blocks of size 2^( 2) =       0.000424297763
  error estimate for blocks of size 2^( 3) =       0.000437214640
  error estimate for blocks of size 2^( 4) =       0.000449676012
  error estimate for blocks of size 2^( 5) =       0.000459759619
  error estimate for blocks of size 2^( 6) =       0.000467353455
  error estimate for blocks of size 2^( 7) =       0.000473510735

      target function =                  N/A
              le_mean =     -16.906098790065
             les_mean =     286.155182525604
             stat err =       0.000462574955
             autocorr =       1.262369040050
              std dev =       0.582242557417
             le_variance =       0.339006395667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005438115
                                         uncertainty =       0.003497468493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411707661
  error estimate for blocks of size 2^( 2) =       0.000424297763
  error estimate for blocks of size 2^( 3) =       0.000437214640
  error estimate for blocks of size 2^( 4) =       0.000449676012
  error estimate for blocks of size 2^( 5) =       0.000459759619
  error estimate for blocks of size 2^( 6) =       0.000467353455
  error estimate for blocks of size 2^( 7) =       0.000473510735

      target function =                  N/A
              le_mean =     -16.906098790065
             les_mean =     286.155182525604
             stat err =       0.000462574955
             autocorr =       1.262369040050
              std dev =       0.582242557417
             le_variance =       0.339006395667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906098790065        initial  <--
     6.1035e+14     6.1035e+15             9.3419e-20       -16.906098790065
     2.4414e+15     2.4414e+16             2.3355e-20       -16.906098790065
     9.7656e+15     9.7656e+16             0.0000e+00       -16.906098790065

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5836
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.361553
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3154e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331550346466
                                         uncertainty =       0.003575779990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331550346466
                                         uncertainty =       0.003575779990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407148622
  error estimate for blocks of size 2^( 2) =       0.000419801174
  error estimate for blocks of size 2^( 3) =       0.000432555771
  error estimate for blocks of size 2^( 4) =       0.000444850537
  error estimate for blocks of size 2^( 5) =       0.000455385619
  error estimate for blocks of size 2^( 6) =       0.000464801561
  error estimate for blocks of size 2^( 7) =       0.000471804099

      target function =                  N/A
              le_mean =     -16.906795243644
             les_mean =     286.171265245178
             stat err =       0.000459210454
             autocorr =       1.272089285161
              std dev =       0.575795102839
             le_variance =       0.331540000454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679524364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906795243644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906795243644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906795243644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906795243644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906795243644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906795243644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.472237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5940e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.304737
====================================================
  Execution time = 2.0023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4376e-01
  Total weights = 2.0000e+06
  Execution time = 1.8635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414585594
  error estimate for blocks of size 2^( 2) =       0.000427090897
  error estimate for blocks of size 2^( 3) =       0.000440104803
  error estimate for blocks of size 2^( 4) =       0.000452569124
  error estimate for blocks of size 2^( 5) =       0.000463029677
  error estimate for blocks of size 2^( 6) =       0.000473447640
  error estimate for blocks of size 2^( 7) =       0.000478838102

      target function =                  N/A
              le_mean =     -16.906030147445
             les_mean =     286.157617604272
             stat err =       0.000466971136
             autocorr =       1.268678731646
              std dev =       0.586312570069
             le_variance =       0.343762429821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414585594
  error estimate for blocks of size 2^( 2) =       0.000427090897
  error estimate for blocks of size 2^( 3) =       0.000440104803
  error estimate for blocks of size 2^( 4) =       0.000452569124
  error estimate for blocks of size 2^( 5) =       0.000463029677
  error estimate for blocks of size 2^( 6) =       0.000473447640
  error estimate for blocks of size 2^( 7) =       0.000478838102

      target function =                  N/A
              le_mean =     -16.906030147445
             les_mean =     286.157617604272
             stat err =       0.000466971136
             autocorr =       1.268678731646
              std dev =       0.586312570069
             le_variance =       0.343762429821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414585594
  error estimate for blocks of size 2^( 2) =       0.000427090897
  error estimate for blocks of size 2^( 3) =       0.000440104803
  error estimate for blocks of size 2^( 4) =       0.000452569124
  error estimate for blocks of size 2^( 5) =       0.000463029677
  error estimate for blocks of size 2^( 6) =       0.000473447640
  error estimate for blocks of size 2^( 7) =       0.000478838102

      target function =                  N/A
              le_mean =     -16.906030147445
             les_mean =     286.157617604272
             stat err =       0.000466971136
             autocorr =       1.268678731646
              std dev =       0.586312570069
             le_variance =       0.343762429821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343778088354
                                         uncertainty =       0.005320177075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414585594
  error estimate for blocks of size 2^( 2) =       0.000427090897
  error estimate for blocks of size 2^( 3) =       0.000440104803
  error estimate for blocks of size 2^( 4) =       0.000452569124
  error estimate for blocks of size 2^( 5) =       0.000463029677
  error estimate for blocks of size 2^( 6) =       0.000473447640
  error estimate for blocks of size 2^( 7) =       0.000478838102

      target function =                  N/A
              le_mean =     -16.906030147445
             les_mean =     286.157617604272
             stat err =       0.000466971136
             autocorr =       1.268678731646
              std dev =       0.586312570069
             le_variance =       0.343762429821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906030147445        initial  <--
     6.1035e+15     6.1035e+16             0.0000e+00       -16.906030147445
     2.4414e+16     2.4414e+17             0.0000e+00       -16.906030147445
     9.7656e+16     9.7656e+17             0.0000e+00       -16.906030147445

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4690
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9763
    reference variance = 0.412292
====================================================
  Execution time = 2.0255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345236670120
                                         uncertainty =       0.006265213272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345236670120
                                         uncertainty =       0.006265213272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415433099
  error estimate for blocks of size 2^( 2) =       0.000428155847
  error estimate for blocks of size 2^( 3) =       0.000441026176
  error estimate for blocks of size 2^( 4) =       0.000452370903
  error estimate for blocks of size 2^( 5) =       0.000464219674
  error estimate for blocks of size 2^( 6) =       0.000471208047
  error estimate for blocks of size 2^( 7) =       0.000478521363

      target function =                  N/A
              le_mean =     -16.905422526400
             les_mean =     286.138479942448
             stat err =       0.000466579997
             autocorr =       1.261391910101
              std dev =       0.587511122388
             le_variance =       0.345169318930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690542252640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905422526400       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905422526400       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905422526400       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905422526400       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905422526400       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905422526400       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5819e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9911
    reference variance = 0.688614
====================================================
  Execution time = 1.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3700e-01
  Total weights = 2.0000e+06
  Execution time = 1.8687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410488294
  error estimate for blocks of size 2^( 2) =       0.000423121802
  error estimate for blocks of size 2^( 3) =       0.000435528005
  error estimate for blocks of size 2^( 4) =       0.000448363808
  error estimate for blocks of size 2^( 5) =       0.000458312550
  error estimate for blocks of size 2^( 6) =       0.000465716759
  error estimate for blocks of size 2^( 7) =       0.000472652547

      target function =                  N/A
              le_mean =     -16.905998795046
             les_mean =     286.149796368457
             stat err =       0.000461261416
             autocorr =       1.262678257367
              std dev =       0.580518112437
             le_variance =       0.337001278867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410488294
  error estimate for blocks of size 2^( 2) =       0.000423121802
  error estimate for blocks of size 2^( 3) =       0.000435528005
  error estimate for blocks of size 2^( 4) =       0.000448363808
  error estimate for blocks of size 2^( 5) =       0.000458312550
  error estimate for blocks of size 2^( 6) =       0.000465716759
  error estimate for blocks of size 2^( 7) =       0.000472652547

      target function =                  N/A
              le_mean =     -16.905998795046
             les_mean =     286.149796368457
             stat err =       0.000461261416
             autocorr =       1.262678257367
              std dev =       0.580518112437
             le_variance =       0.337001278867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410488294
  error estimate for blocks of size 2^( 2) =       0.000423121802
  error estimate for blocks of size 2^( 3) =       0.000435528005
  error estimate for blocks of size 2^( 4) =       0.000448363808
  error estimate for blocks of size 2^( 5) =       0.000458312550
  error estimate for blocks of size 2^( 6) =       0.000465716759
  error estimate for blocks of size 2^( 7) =       0.000472652547

      target function =                  N/A
              le_mean =     -16.905998795046
             les_mean =     286.149796368457
             stat err =       0.000461261416
             autocorr =       1.262678257367
              std dev =       0.580518112437
             le_variance =       0.337001278867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336784738077
                                         uncertainty =       0.003117358156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410488294
  error estimate for blocks of size 2^( 2) =       0.000423121802
  error estimate for blocks of size 2^( 3) =       0.000435528005
  error estimate for blocks of size 2^( 4) =       0.000448363808
  error estimate for blocks of size 2^( 5) =       0.000458312550
  error estimate for blocks of size 2^( 6) =       0.000465716759
  error estimate for blocks of size 2^( 7) =       0.000472652547

      target function =                  N/A
              le_mean =     -16.905998795046
             les_mean =     286.149796368457
             stat err =       0.000461261416
             autocorr =       1.262678257367
              std dev =       0.580518112437
             le_variance =       0.337001278867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905998795046        initial  <--
     6.1035e+16     6.1035e+17             0.0000e+00       -16.905998795046
     2.4414e+17     2.4414e+18             0.0000e+00       -16.905998795046
     9.7656e+17     9.7656e+18             0.0000e+00       -16.905998795046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4822
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9701
    reference variance = 0.380689
====================================================
  Execution time = 2.2836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337764144695
                                         uncertainty =       0.004162397705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337764144695
                                         uncertainty =       0.004162397705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410985191
  error estimate for blocks of size 2^( 2) =       0.000423437027
  error estimate for blocks of size 2^( 3) =       0.000436096633
  error estimate for blocks of size 2^( 4) =       0.000447672936
  error estimate for blocks of size 2^( 5) =       0.000457494231
  error estimate for blocks of size 2^( 6) =       0.000464064512
  error estimate for blocks of size 2^( 7) =       0.000467812394

      target function =                  N/A
              le_mean =     -16.905680217743
             les_mean =     286.139841109689
             stat err =       0.000459261018
             autocorr =       1.248725046625
              std dev =       0.581220830676
             le_variance =       0.337817654012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568021774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680217743       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680217743       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680217743       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680217743       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680217743       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680217743       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.474380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8343e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8609
    reference variance = 0.181235
====================================================
  Execution time = 2.0133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3893e-01
  Total weights = 2.0000e+06
  Execution time = 1.8642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411660201
  error estimate for blocks of size 2^( 2) =       0.000424140364
  error estimate for blocks of size 2^( 3) =       0.000437367241
  error estimate for blocks of size 2^( 4) =       0.000449347959
  error estimate for blocks of size 2^( 5) =       0.000459985783
  error estimate for blocks of size 2^( 6) =       0.000467509905
  error estimate for blocks of size 2^( 7) =       0.000473202766

      target function =                  N/A
              le_mean =     -16.906300126328
             les_mean =     286.161912034974
             stat err =       0.000462511603
             autocorr =       1.262314295255
              std dev =       0.582175440030
             le_variance =       0.338928242975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411660201
  error estimate for blocks of size 2^( 2) =       0.000424140364
  error estimate for blocks of size 2^( 3) =       0.000437367241
  error estimate for blocks of size 2^( 4) =       0.000449347959
  error estimate for blocks of size 2^( 5) =       0.000459985783
  error estimate for blocks of size 2^( 6) =       0.000467509905
  error estimate for blocks of size 2^( 7) =       0.000473202766

      target function =                  N/A
              le_mean =     -16.906300126328
             les_mean =     286.161912034974
             stat err =       0.000462511603
             autocorr =       1.262314295255
              std dev =       0.582175440030
             le_variance =       0.338928242975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411660201
  error estimate for blocks of size 2^( 2) =       0.000424140364
  error estimate for blocks of size 2^( 3) =       0.000437367241
  error estimate for blocks of size 2^( 4) =       0.000449347959
  error estimate for blocks of size 2^( 5) =       0.000459985783
  error estimate for blocks of size 2^( 6) =       0.000467509905
  error estimate for blocks of size 2^( 7) =       0.000473202766

      target function =                  N/A
              le_mean =     -16.906300126328
             les_mean =     286.161912034974
             stat err =       0.000462511603
             autocorr =       1.262314295255
              std dev =       0.582175440030
             le_variance =       0.338928242975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338977830067
                                         uncertainty =       0.004247777128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411660201
  error estimate for blocks of size 2^( 2) =       0.000424140364
  error estimate for blocks of size 2^( 3) =       0.000437367241
  error estimate for blocks of size 2^( 4) =       0.000449347959
  error estimate for blocks of size 2^( 5) =       0.000459985783
  error estimate for blocks of size 2^( 6) =       0.000467509905
  error estimate for blocks of size 2^( 7) =       0.000473202766

      target function =                  N/A
              le_mean =     -16.906300126328
             les_mean =     286.161912034974
             stat err =       0.000462511603
             autocorr =       1.262314295255
              std dev =       0.582175440030
             le_variance =       0.338928242975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906300126328        initial  <--
     6.1035e+17     6.1035e+18             0.0000e+00       -16.906300126328
     2.4414e+18     2.4414e+19             0.0000e+00       -16.906300126328
     9.7656e+18     9.7656e+19             0.0000e+00       -16.906300126328

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5965
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9578
    reference variance = 0.363166
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3355e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333598688386
                                         uncertainty =       0.002995846724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333598688386
                                         uncertainty =       0.002995846724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408383591
  error estimate for blocks of size 2^( 2) =       0.000421231895
  error estimate for blocks of size 2^( 3) =       0.000433783599
  error estimate for blocks of size 2^( 4) =       0.000445954948
  error estimate for blocks of size 2^( 5) =       0.000457653798
  error estimate for blocks of size 2^( 6) =       0.000464566829
  error estimate for blocks of size 2^( 7) =       0.000469226704

      target function =                  N/A
              le_mean =     -16.906490448591
             les_mean =     286.162973436751
             stat err =       0.000459350570
             autocorr =       1.265178931210
              std dev =       0.577541613424
             le_variance =       0.333554315236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649044859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906490448591       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906490448591       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906490448591       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 6.619459e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906490448591       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906490448591       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906490448591       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 1.654865e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906490448591       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906490448591       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906490448591       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 4.137162e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.475681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5885e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.251712
====================================================
  Execution time = 2.0479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.1841e-01
  Total weights = 2.0000e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457391618
  error estimate for blocks of size 2^( 2) =       0.000469196614
  error estimate for blocks of size 2^( 3) =       0.000481233063
  error estimate for blocks of size 2^( 4) =       0.000492583873
  error estimate for blocks of size 2^( 5) =       0.000503532848
  error estimate for blocks of size 2^( 6) =       0.000512325081
  error estimate for blocks of size 2^( 7) =       0.000517627988

      target function =                  N/A
              le_mean =     -16.905839498297
             les_mean =     286.225823118245
             stat err =       0.000506517448
             autocorr =       1.226344296589
              std dev =       0.646849430139
             le_variance =       0.418414185271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457391618
  error estimate for blocks of size 2^( 2) =       0.000469196614
  error estimate for blocks of size 2^( 3) =       0.000481233063
  error estimate for blocks of size 2^( 4) =       0.000492583873
  error estimate for blocks of size 2^( 5) =       0.000503532848
  error estimate for blocks of size 2^( 6) =       0.000512325081
  error estimate for blocks of size 2^( 7) =       0.000517627988

      target function =                  N/A
              le_mean =     -16.905839498297
             les_mean =     286.225823118245
             stat err =       0.000506517448
             autocorr =       1.226344296589
              std dev =       0.646849430139
             le_variance =       0.418414185271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457391618
  error estimate for blocks of size 2^( 2) =       0.000469196614
  error estimate for blocks of size 2^( 3) =       0.000481233063
  error estimate for blocks of size 2^( 4) =       0.000492583873
  error estimate for blocks of size 2^( 5) =       0.000503532848
  error estimate for blocks of size 2^( 6) =       0.000512325081
  error estimate for blocks of size 2^( 7) =       0.000517627988

      target function =                  N/A
              le_mean =     -16.905839498297
             les_mean =     286.225823118245
             stat err =       0.000506517448
             autocorr =       1.226344296589
              std dev =       0.646849430139
             le_variance =       0.418414185271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.418542123972
                                         uncertainty =       0.080064815371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457391618
  error estimate for blocks of size 2^( 2) =       0.000469196614
  error estimate for blocks of size 2^( 3) =       0.000481233063
  error estimate for blocks of size 2^( 4) =       0.000492583873
  error estimate for blocks of size 2^( 5) =       0.000503532848
  error estimate for blocks of size 2^( 6) =       0.000512325081
  error estimate for blocks of size 2^( 7) =       0.000517627988

      target function =                  N/A
              le_mean =     -16.905839498297
             les_mean =     286.225823118245
             stat err =       0.000506517448
             autocorr =       1.226344296589
              std dev =       0.646849430139
             le_variance =       0.418414185271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905839498297        initial  <--
     6.1035e+18     6.1035e+19             6.6195e-24       -16.905839498297
     2.4414e+19     2.4414e+20             1.6549e-24       -16.905839498297
     9.7656e+19     9.7656e+20             4.1372e-25       -16.905839498297

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9421
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 0.273553
====================================================
  Execution time = 2.0257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342285202243
                                         uncertainty =       0.003766277764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342285202243
                                         uncertainty =       0.003766277764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413669952
  error estimate for blocks of size 2^( 2) =       0.000426543088
  error estimate for blocks of size 2^( 3) =       0.000439390739
  error estimate for blocks of size 2^( 4) =       0.000452532496
  error estimate for blocks of size 2^( 5) =       0.000463305901
  error estimate for blocks of size 2^( 6) =       0.000470279516
  error estimate for blocks of size 2^( 7) =       0.000473104557

      target function =                  N/A
              le_mean =     -16.906656594409
             les_mean =     286.177282687860
             stat err =       0.000464805618
             autocorr =       1.262509880497
              std dev =       0.585017655885
             le_variance =       0.342245657698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665659441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656594409       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656594409       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656594409       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656594409       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656594409       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656594409       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.476734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5904e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.0102
    reference variance = 0.406831
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3228e-01
  Total weights = 2.0000e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407601948
  error estimate for blocks of size 2^( 2) =       0.000420837743
  error estimate for blocks of size 2^( 3) =       0.000434339832
  error estimate for blocks of size 2^( 4) =       0.000447217391
  error estimate for blocks of size 2^( 5) =       0.000458627946
  error estimate for blocks of size 2^( 6) =       0.000467548660
  error estimate for blocks of size 2^( 7) =       0.000474297357

      target function =                  N/A
              le_mean =     -16.906343518217
             les_mean =     286.156729686413
             stat err =       0.000461922839
             autocorr =       1.284299662310
              std dev =       0.576436203406
             le_variance =       0.332278696597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407601948
  error estimate for blocks of size 2^( 2) =       0.000420837743
  error estimate for blocks of size 2^( 3) =       0.000434339832
  error estimate for blocks of size 2^( 4) =       0.000447217391
  error estimate for blocks of size 2^( 5) =       0.000458627946
  error estimate for blocks of size 2^( 6) =       0.000467548660
  error estimate for blocks of size 2^( 7) =       0.000474297357

      target function =                  N/A
              le_mean =     -16.906343518217
             les_mean =     286.156729686413
             stat err =       0.000461922839
             autocorr =       1.284299662310
              std dev =       0.576436203406
             le_variance =       0.332278696597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407601948
  error estimate for blocks of size 2^( 2) =       0.000420837743
  error estimate for blocks of size 2^( 3) =       0.000434339832
  error estimate for blocks of size 2^( 4) =       0.000447217391
  error estimate for blocks of size 2^( 5) =       0.000458627946
  error estimate for blocks of size 2^( 6) =       0.000467548660
  error estimate for blocks of size 2^( 7) =       0.000474297357

      target function =                  N/A
              le_mean =     -16.906343518217
             les_mean =     286.156729686413
             stat err =       0.000461922839
             autocorr =       1.284299662310
              std dev =       0.576436203406
             le_variance =       0.332278696597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332356650257
                                         uncertainty =       0.002775211858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407601948
  error estimate for blocks of size 2^( 2) =       0.000420837743
  error estimate for blocks of size 2^( 3) =       0.000434339832
  error estimate for blocks of size 2^( 4) =       0.000447217391
  error estimate for blocks of size 2^( 5) =       0.000458627946
  error estimate for blocks of size 2^( 6) =       0.000467548660
  error estimate for blocks of size 2^( 7) =       0.000474297357

      target function =                  N/A
              le_mean =     -16.906343518217
             les_mean =     286.156729686413
             stat err =       0.000461922839
             autocorr =       1.284299662310
              std dev =       0.576436203406
             le_variance =       0.332278696597


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906343518217        initial  <--
     6.1035e+19     6.1035e+20             0.0000e+00       -16.906343518217
     2.4414e+20     2.4414e+21             0.0000e+00       -16.906343518217
     9.7656e+20     9.7656e+21             0.0000e+00       -16.906343518217

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7418
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5653e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9609
    reference variance = 0.423499
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339245928386
                                         uncertainty =       0.004022645294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339245928386
                                         uncertainty =       0.004022645294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411797384
  error estimate for blocks of size 2^( 2) =       0.000424839766
  error estimate for blocks of size 2^( 3) =       0.000438338971
  error estimate for blocks of size 2^( 4) =       0.000450476963
  error estimate for blocks of size 2^( 5) =       0.000461935028
  error estimate for blocks of size 2^( 6) =       0.000470441554
  error estimate for blocks of size 2^( 7) =       0.000475596188

      target function =                  N/A
              le_mean =     -16.905905014902
             les_mean =     286.148778373512
             stat err =       0.000464612433
             autocorr =       1.272959215776
              std dev =       0.582369444766
             le_variance =       0.339154170198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590501490e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905905014902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905905014902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905905014902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905905014902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905905014902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905905014902       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.477799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6279e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9549
    reference variance = 0.389759
====================================================
  Execution time = 2.0169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3679e-01
  Total weights = 2.0000e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410358337
  error estimate for blocks of size 2^( 2) =       0.000423303577
  error estimate for blocks of size 2^( 3) =       0.000436175865
  error estimate for blocks of size 2^( 4) =       0.000448474329
  error estimate for blocks of size 2^( 5) =       0.000461010782
  error estimate for blocks of size 2^( 6) =       0.000468412757
  error estimate for blocks of size 2^( 7) =       0.000473597292

      target function =                  N/A
              le_mean =     -16.906047767206
             les_mean =     286.151238867573
             stat err =       0.000462873790
             autocorr =       1.272326749158
              std dev =       0.580334325117
             le_variance =       0.336787928909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410358337
  error estimate for blocks of size 2^( 2) =       0.000423303577
  error estimate for blocks of size 2^( 3) =       0.000436175865
  error estimate for blocks of size 2^( 4) =       0.000448474329
  error estimate for blocks of size 2^( 5) =       0.000461010782
  error estimate for blocks of size 2^( 6) =       0.000468412757
  error estimate for blocks of size 2^( 7) =       0.000473597292

      target function =                  N/A
              le_mean =     -16.906047767206
             les_mean =     286.151238867573
             stat err =       0.000462873790
             autocorr =       1.272326749158
              std dev =       0.580334325117
             le_variance =       0.336787928909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410358337
  error estimate for blocks of size 2^( 2) =       0.000423303577
  error estimate for blocks of size 2^( 3) =       0.000436175865
  error estimate for blocks of size 2^( 4) =       0.000448474329
  error estimate for blocks of size 2^( 5) =       0.000461010782
  error estimate for blocks of size 2^( 6) =       0.000468412757
  error estimate for blocks of size 2^( 7) =       0.000473597292

      target function =                  N/A
              le_mean =     -16.906047767206
             les_mean =     286.151238867573
             stat err =       0.000462873790
             autocorr =       1.272326749158
              std dev =       0.580334325117
             le_variance =       0.336787928909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336781531693
                                         uncertainty =       0.003259477126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410358337
  error estimate for blocks of size 2^( 2) =       0.000423303577
  error estimate for blocks of size 2^( 3) =       0.000436175865
  error estimate for blocks of size 2^( 4) =       0.000448474329
  error estimate for blocks of size 2^( 5) =       0.000461010782
  error estimate for blocks of size 2^( 6) =       0.000468412757
  error estimate for blocks of size 2^( 7) =       0.000473597292

      target function =                  N/A
              le_mean =     -16.906047767206
             les_mean =     286.151238867573
             stat err =       0.000462873790
             autocorr =       1.272326749158
              std dev =       0.580334325117
             le_variance =       0.336787928909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906047767206        initial  <--
     6.1035e+20     6.1035e+21             0.0000e+00       -16.906047767206
     2.4414e+21     2.4414e+22             0.0000e+00       -16.906047767206
     9.7656e+21     9.7656e+22             0.0000e+00       -16.906047767206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6705
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5956e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.309764
====================================================
  Execution time = 2.0609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142162499
                                         uncertainty =       0.004196585555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142162499
                                         uncertainty =       0.004196585555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409287159
  error estimate for blocks of size 2^( 2) =       0.000421992237
  error estimate for blocks of size 2^( 3) =       0.000434688823
  error estimate for blocks of size 2^( 4) =       0.000446879158
  error estimate for blocks of size 2^( 5) =       0.000456228215
  error estimate for blocks of size 2^( 6) =       0.000463467329
  error estimate for blocks of size 2^( 7) =       0.000466271408

      target function =                  N/A
              le_mean =     -16.906838466347
             les_mean =     286.176218717204
             stat err =       0.000458211528
             autocorr =       1.253359862245
              std dev =       0.578819451610
             le_variance =       0.335031957562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683846635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906838466347       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906838466347       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906838466347       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906838466347       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906838466347       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906838466347       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.478873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6149e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.35845
====================================================
  Execution time = 2.0111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3754e-01
  Total weights = 2.0000e+06
  Execution time = 1.8675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410817229
  error estimate for blocks of size 2^( 2) =       0.000423595708
  error estimate for blocks of size 2^( 3) =       0.000436854014
  error estimate for blocks of size 2^( 4) =       0.000449312217
  error estimate for blocks of size 2^( 5) =       0.000460312805
  error estimate for blocks of size 2^( 6) =       0.000469412814
  error estimate for blocks of size 2^( 7) =       0.000476824670

      target function =                  N/A
              le_mean =     -16.906197585250
             les_mean =     286.157058213722
             stat err =       0.000463965627
             autocorr =       1.275481945787
              std dev =       0.580983296652
             le_variance =       0.337541590989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410817229
  error estimate for blocks of size 2^( 2) =       0.000423595708
  error estimate for blocks of size 2^( 3) =       0.000436854014
  error estimate for blocks of size 2^( 4) =       0.000449312217
  error estimate for blocks of size 2^( 5) =       0.000460312805
  error estimate for blocks of size 2^( 6) =       0.000469412814
  error estimate for blocks of size 2^( 7) =       0.000476824670

      target function =                  N/A
              le_mean =     -16.906197585250
             les_mean =     286.157058213722
             stat err =       0.000463965627
             autocorr =       1.275481945787
              std dev =       0.580983296652
             le_variance =       0.337541590989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410817229
  error estimate for blocks of size 2^( 2) =       0.000423595708
  error estimate for blocks of size 2^( 3) =       0.000436854014
  error estimate for blocks of size 2^( 4) =       0.000449312217
  error estimate for blocks of size 2^( 5) =       0.000460312805
  error estimate for blocks of size 2^( 6) =       0.000469412814
  error estimate for blocks of size 2^( 7) =       0.000476824670

      target function =                  N/A
              le_mean =     -16.906197585250
             les_mean =     286.157058213722
             stat err =       0.000463965627
             autocorr =       1.275481945787
              std dev =       0.580983296652
             le_variance =       0.337541590989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337659195796
                                         uncertainty =       0.003246226388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410817229
  error estimate for blocks of size 2^( 2) =       0.000423595708
  error estimate for blocks of size 2^( 3) =       0.000436854014
  error estimate for blocks of size 2^( 4) =       0.000449312217
  error estimate for blocks of size 2^( 5) =       0.000460312805
  error estimate for blocks of size 2^( 6) =       0.000469412814
  error estimate for blocks of size 2^( 7) =       0.000476824670

      target function =                  N/A
              le_mean =     -16.906197585250
             les_mean =     286.157058213722
             stat err =       0.000463965627
             autocorr =       1.275481945787
              std dev =       0.580983296652
             le_variance =       0.337541590989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906197585250        initial  <--
     6.1035e+21     6.1035e+22             0.0000e+00       -16.906197585250
     2.4414e+22     2.4414e+23             0.0000e+00       -16.906197585250
     9.7656e+22     9.7656e+23             0.0000e+00       -16.906197585250

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5831
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9664
    reference variance = 0.415229
====================================================
  Execution time = 2.0152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5283e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352892772616
                                         uncertainty =       0.008837323399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352892772616
                                         uncertainty =       0.008837323399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420019404
  error estimate for blocks of size 2^( 2) =       0.000432846069
  error estimate for blocks of size 2^( 3) =       0.000445803729
  error estimate for blocks of size 2^( 4) =       0.000458181906
  error estimate for blocks of size 2^( 5) =       0.000469779149
  error estimate for blocks of size 2^( 6) =       0.000479277662
  error estimate for blocks of size 2^( 7) =       0.000486226575

      target function =                  N/A
              le_mean =     -16.905577373334
             les_mean =     286.151378748928
             stat err =       0.000473366323
             autocorr =       1.270152904139
              std dev =       0.593997137681
             le_variance =       0.352832599573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557737333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577373334       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577373334       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577373334       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577373334       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905577373334       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905577373334       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.479937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9482e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.197995
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4185e-01
  Total weights = 2.0000e+06
  Execution time = 1.8763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413431286
  error estimate for blocks of size 2^( 2) =       0.000426269077
  error estimate for blocks of size 2^( 3) =       0.000438999691
  error estimate for blocks of size 2^( 4) =       0.000452033506
  error estimate for blocks of size 2^( 5) =       0.000461739909
  error estimate for blocks of size 2^( 6) =       0.000469781181
  error estimate for blocks of size 2^( 7) =       0.000476520002

      target function =                  N/A
              le_mean =     -16.906520464637
             les_mean =     286.172284907130
             stat err =       0.000465018650
             autocorr =       1.265126824945
              std dev =       0.584680132081
             le_variance =       0.341850856851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413431286
  error estimate for blocks of size 2^( 2) =       0.000426269077
  error estimate for blocks of size 2^( 3) =       0.000438999691
  error estimate for blocks of size 2^( 4) =       0.000452033506
  error estimate for blocks of size 2^( 5) =       0.000461739909
  error estimate for blocks of size 2^( 6) =       0.000469781181
  error estimate for blocks of size 2^( 7) =       0.000476520002

      target function =                  N/A
              le_mean =     -16.906520464637
             les_mean =     286.172284907130
             stat err =       0.000465018650
             autocorr =       1.265126824945
              std dev =       0.584680132081
             le_variance =       0.341850856851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413431286
  error estimate for blocks of size 2^( 2) =       0.000426269077
  error estimate for blocks of size 2^( 3) =       0.000438999691
  error estimate for blocks of size 2^( 4) =       0.000452033506
  error estimate for blocks of size 2^( 5) =       0.000461739909
  error estimate for blocks of size 2^( 6) =       0.000469781181
  error estimate for blocks of size 2^( 7) =       0.000476520002

      target function =                  N/A
              le_mean =     -16.906520464637
             les_mean =     286.172284907130
             stat err =       0.000465018650
             autocorr =       1.265126824945
              std dev =       0.584680132081
             le_variance =       0.341850856851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341923488299
                                         uncertainty =       0.004107097149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413431286
  error estimate for blocks of size 2^( 2) =       0.000426269077
  error estimate for blocks of size 2^( 3) =       0.000438999691
  error estimate for blocks of size 2^( 4) =       0.000452033506
  error estimate for blocks of size 2^( 5) =       0.000461739909
  error estimate for blocks of size 2^( 6) =       0.000469781181
  error estimate for blocks of size 2^( 7) =       0.000476520002

      target function =                  N/A
              le_mean =     -16.906520464637
             les_mean =     286.172284907130
             stat err =       0.000465018650
             autocorr =       1.265126824945
              std dev =       0.584680132081
             le_variance =       0.341850856851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906520464637        initial  <--
     6.1035e+22     6.1035e+23             0.0000e+00       -16.906520464637
     2.4414e+23     2.4414e+24             0.0000e+00       -16.906520464637
     9.7656e+23     9.7656e+24             0.0000e+00       -16.906520464637

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9733
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8821
    reference variance = 0.238861
====================================================
  Execution time = 2.0349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3859e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338626008156
                                         uncertainty =       0.004015903459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338626008156
                                         uncertainty =       0.004015903459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411453190
  error estimate for blocks of size 2^( 2) =       0.000424160691
  error estimate for blocks of size 2^( 3) =       0.000437591628
  error estimate for blocks of size 2^( 4) =       0.000449592434
  error estimate for blocks of size 2^( 5) =       0.000460354015
  error estimate for blocks of size 2^( 6) =       0.000469031725
  error estimate for blocks of size 2^( 7) =       0.000472287039

      target function =                  N/A
              le_mean =     -16.906180145355
             les_mean =     286.157514392410
             stat err =       0.000462816303
             autocorr =       1.265250249156
              std dev =       0.581882681059
             le_variance =       0.338587454517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618014535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180145355       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180145355       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180145355       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180145355       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180145355       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180145355       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.480985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5882e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.221768
====================================================
  Execution time = 2.0172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4884e-01
  Total weights = 2.0000e+06
  Execution time = 1.8802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417635468
  error estimate for blocks of size 2^( 2) =       0.000430180563
  error estimate for blocks of size 2^( 3) =       0.000443246530
  error estimate for blocks of size 2^( 4) =       0.000455188335
  error estimate for blocks of size 2^( 5) =       0.000465633933
  error estimate for blocks of size 2^( 6) =       0.000471882384
  error estimate for blocks of size 2^( 7) =       0.000476162674

      target function =                  N/A
              le_mean =     -16.906298784801
             les_mean =     286.171777195400
             stat err =       0.000467216831
             autocorr =       1.251532725748
              std dev =       0.590625743480
             le_variance =       0.348838768861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417635468
  error estimate for blocks of size 2^( 2) =       0.000430180563
  error estimate for blocks of size 2^( 3) =       0.000443246530
  error estimate for blocks of size 2^( 4) =       0.000455188335
  error estimate for blocks of size 2^( 5) =       0.000465633933
  error estimate for blocks of size 2^( 6) =       0.000471882384
  error estimate for blocks of size 2^( 7) =       0.000476162674

      target function =                  N/A
              le_mean =     -16.906298784801
             les_mean =     286.171777195400
             stat err =       0.000467216831
             autocorr =       1.251532725748
              std dev =       0.590625743480
             le_variance =       0.348838768861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417635468
  error estimate for blocks of size 2^( 2) =       0.000430180563
  error estimate for blocks of size 2^( 3) =       0.000443246530
  error estimate for blocks of size 2^( 4) =       0.000455188335
  error estimate for blocks of size 2^( 5) =       0.000465633933
  error estimate for blocks of size 2^( 6) =       0.000471882384
  error estimate for blocks of size 2^( 7) =       0.000476162674

      target function =                  N/A
              le_mean =     -16.906298784801
             les_mean =     286.171777195400
             stat err =       0.000467216831
             autocorr =       1.251532725748
              std dev =       0.590625743480
             le_variance =       0.348838768861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348905272644
                                         uncertainty =       0.008194710609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417635468
  error estimate for blocks of size 2^( 2) =       0.000430180563
  error estimate for blocks of size 2^( 3) =       0.000443246530
  error estimate for blocks of size 2^( 4) =       0.000455188335
  error estimate for blocks of size 2^( 5) =       0.000465633933
  error estimate for blocks of size 2^( 6) =       0.000471882384
  error estimate for blocks of size 2^( 7) =       0.000476162674

      target function =                  N/A
              le_mean =     -16.906298784801
             les_mean =     286.171777195400
             stat err =       0.000467216831
             autocorr =       1.251532725748
              std dev =       0.590625743480
             le_variance =       0.348838768861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906298784801        initial  <--
     6.1035e+23     6.1035e+24             0.0000e+00       -16.906298784801
     2.4414e+24     2.4414e+25             0.0000e+00       -16.906298784801
     9.7656e+24     9.7656e+25             0.0000e+00       -16.906298784801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7021
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5590e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.417186
====================================================
  Execution time = 2.0279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3129e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331298224918
                                         uncertainty =       0.002921240886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331298224918
                                         uncertainty =       0.002921240886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406997534
  error estimate for blocks of size 2^( 2) =       0.000419730523
  error estimate for blocks of size 2^( 3) =       0.000432273173
  error estimate for blocks of size 2^( 4) =       0.000443752860
  error estimate for blocks of size 2^( 5) =       0.000452717274
  error estimate for blocks of size 2^( 6) =       0.000460704340
  error estimate for blocks of size 2^( 7) =       0.000466098001

      target function =                  N/A
              le_mean =     -16.905913732417
             les_mean =     286.141212947026
             stat err =       0.000455818119
             autocorr =       1.254294775823
              std dev =       0.575581431909
             le_variance =       0.331293984759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591373242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905913732417       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905913732417       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905913732417       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+24 is 1.001435e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905913732417       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905913732417       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905913732418       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 2.503588e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905913732417       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905913732417       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905913732415       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 6.258970e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5814e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8534
    reference variance = 0.359276
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4545e-01
  Total weights = 2.0000e+06
  Execution time = 1.8735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415599700
  error estimate for blocks of size 2^( 2) =       0.000427946695
  error estimate for blocks of size 2^( 3) =       0.000440857173
  error estimate for blocks of size 2^( 4) =       0.000452237389
  error estimate for blocks of size 2^( 5) =       0.000461886789
  error estimate for blocks of size 2^( 6) =       0.000470003018
  error estimate for blocks of size 2^( 7) =       0.000476745680

      target function =                  N/A
              le_mean =     -16.906089802369
             les_mean =     286.161318454917
             stat err =       0.000465218219
             autocorr =       1.253034351818
              std dev =       0.587746732773
             le_variance =       0.345446221886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415599700
  error estimate for blocks of size 2^( 2) =       0.000427946695
  error estimate for blocks of size 2^( 3) =       0.000440857173
  error estimate for blocks of size 2^( 4) =       0.000452237389
  error estimate for blocks of size 2^( 5) =       0.000461886789
  error estimate for blocks of size 2^( 6) =       0.000470003018
  error estimate for blocks of size 2^( 7) =       0.000476745680

      target function =                  N/A
              le_mean =     -16.906089802369
             les_mean =     286.161318454917
             stat err =       0.000465218219
             autocorr =       1.253034351818
              std dev =       0.587746732773
             le_variance =       0.345446221886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415599700
  error estimate for blocks of size 2^( 2) =       0.000427946695
  error estimate for blocks of size 2^( 3) =       0.000440857173
  error estimate for blocks of size 2^( 4) =       0.000452237389
  error estimate for blocks of size 2^( 5) =       0.000461886789
  error estimate for blocks of size 2^( 6) =       0.000470003018
  error estimate for blocks of size 2^( 7) =       0.000476745680

      target function =                  N/A
              le_mean =     -16.906089802369
             les_mean =     286.161318454917
             stat err =       0.000465218219
             autocorr =       1.253034351818
              std dev =       0.587746732773
             le_variance =       0.345446221886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345537384619
                                         uncertainty =       0.007173083305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415599700
  error estimate for blocks of size 2^( 2) =       0.000427946695
  error estimate for blocks of size 2^( 3) =       0.000440857173
  error estimate for blocks of size 2^( 4) =       0.000452237389
  error estimate for blocks of size 2^( 5) =       0.000461886789
  error estimate for blocks of size 2^( 6) =       0.000470003018
  error estimate for blocks of size 2^( 7) =       0.000476745680

      target function =                  N/A
              le_mean =     -16.906089802369
             les_mean =     286.161318454917
             stat err =       0.000465218219
             autocorr =       1.253034351818
              std dev =       0.587746732773
             le_variance =       0.345446221886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906089802369        initial  <--
     6.1035e+24     6.1035e+25             1.0014e-29       -16.906089802369
     2.4414e+25     2.4414e+26             2.5036e-30       -16.906089802369
     9.7656e+25     9.7656e+26             6.2590e-31       -16.906089802369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6555
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.220913
====================================================
  Execution time = 2.0568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3924e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339209655303
                                         uncertainty =       0.003492119411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339209655303
                                         uncertainty =       0.003492119411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411850873
  error estimate for blocks of size 2^( 2) =       0.000424039942
  error estimate for blocks of size 2^( 3) =       0.000436407353
  error estimate for blocks of size 2^( 4) =       0.000447916801
  error estimate for blocks of size 2^( 5) =       0.000457722052
  error estimate for blocks of size 2^( 6) =       0.000463498431
  error estimate for blocks of size 2^( 7) =       0.000464434346

      target function =                  N/A
              le_mean =     -16.906956645287
             les_mean =     286.184425119614
             stat err =       0.000458392907
             autocorr =       1.238784595503
              std dev =       0.582445090653
             le_variance =       0.339242283625


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690695664529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906956645287       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906956645287       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906956645287       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906956645287       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906956645287       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906956645287       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.483331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.873
    reference variance = 0.350599
====================================================
  Execution time = 2.0239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3749e-01
  Total weights = 2.0000e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410783165
  error estimate for blocks of size 2^( 2) =       0.000423118690
  error estimate for blocks of size 2^( 3) =       0.000436313548
  error estimate for blocks of size 2^( 4) =       0.000449137475
  error estimate for blocks of size 2^( 5) =       0.000458908291
  error estimate for blocks of size 2^( 6) =       0.000468307405
  error estimate for blocks of size 2^( 7) =       0.000471465697

      target function =                  N/A
              le_mean =     -16.906504022672
             les_mean =     286.167363716479
             stat err =       0.000461954717
             autocorr =       1.264659292488
              std dev =       0.580935122526
             le_variance =       0.337485616584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410783165
  error estimate for blocks of size 2^( 2) =       0.000423118690
  error estimate for blocks of size 2^( 3) =       0.000436313548
  error estimate for blocks of size 2^( 4) =       0.000449137475
  error estimate for blocks of size 2^( 5) =       0.000458908291
  error estimate for blocks of size 2^( 6) =       0.000468307405
  error estimate for blocks of size 2^( 7) =       0.000471465697

      target function =                  N/A
              le_mean =     -16.906504022672
             les_mean =     286.167363716479
             stat err =       0.000461954717
             autocorr =       1.264659292488
              std dev =       0.580935122526
             le_variance =       0.337485616584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410783165
  error estimate for blocks of size 2^( 2) =       0.000423118690
  error estimate for blocks of size 2^( 3) =       0.000436313548
  error estimate for blocks of size 2^( 4) =       0.000449137475
  error estimate for blocks of size 2^( 5) =       0.000458908291
  error estimate for blocks of size 2^( 6) =       0.000468307405
  error estimate for blocks of size 2^( 7) =       0.000471465697

      target function =                  N/A
              le_mean =     -16.906504022672
             les_mean =     286.167363716479
             stat err =       0.000461954717
             autocorr =       1.264659292488
              std dev =       0.580935122526
             le_variance =       0.337485616584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337591892201
                                         uncertainty =       0.003116837981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410783165
  error estimate for blocks of size 2^( 2) =       0.000423118690
  error estimate for blocks of size 2^( 3) =       0.000436313548
  error estimate for blocks of size 2^( 4) =       0.000449137475
  error estimate for blocks of size 2^( 5) =       0.000458908291
  error estimate for blocks of size 2^( 6) =       0.000468307405
  error estimate for blocks of size 2^( 7) =       0.000471465697

      target function =                  N/A
              le_mean =     -16.906504022672
             les_mean =     286.167363716479
             stat err =       0.000461954717
             autocorr =       1.264659292488
              std dev =       0.580935122526
             le_variance =       0.337485616584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906504022672        initial  <--
     6.1035e+25     6.1035e+26             0.0000e+00       -16.906504022672
     2.4414e+26     2.4414e+27             0.0000e+00       -16.906504022672
     9.7656e+26     9.7656e+27             0.0000e+00       -16.906504022672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7231
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.251555
====================================================
  Execution time = 2.0439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3396e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334003282946
                                         uncertainty =       0.002771549201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334003282946
                                         uncertainty =       0.002771549201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408630328
  error estimate for blocks of size 2^( 2) =       0.000421506386
  error estimate for blocks of size 2^( 3) =       0.000434535176
  error estimate for blocks of size 2^( 4) =       0.000446513700
  error estimate for blocks of size 2^( 5) =       0.000456004507
  error estimate for blocks of size 2^( 6) =       0.000462679057
  error estimate for blocks of size 2^( 7) =       0.000464648225

      target function =                  N/A
              le_mean =     -16.905729537954
             les_mean =     286.137648532736
             stat err =       0.000457461372
             autocorr =       1.253278719720
              std dev =       0.577890551281
             le_variance =       0.333957489260


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572953795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905729537954       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729537954       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905729537954       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729537954       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905729537954       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905729537954       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5974e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.252488
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4409e-01
  Total weights = 2.0000e+06
  Execution time = 1.8673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414785145
  error estimate for blocks of size 2^( 2) =       0.000427183443
  error estimate for blocks of size 2^( 3) =       0.000439622424
  error estimate for blocks of size 2^( 4) =       0.000451411378
  error estimate for blocks of size 2^( 5) =       0.000461255239
  error estimate for blocks of size 2^( 6) =       0.000466550840
  error estimate for blocks of size 2^( 7) =       0.000469543470

      target function =                  N/A
              le_mean =     -16.906326494357
             les_mean =     286.167968794079
             stat err =       0.000462190232
             autocorr =       1.241638404485
              std dev =       0.586594776936
             le_variance =       0.344093432329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414785145
  error estimate for blocks of size 2^( 2) =       0.000427183443
  error estimate for blocks of size 2^( 3) =       0.000439622424
  error estimate for blocks of size 2^( 4) =       0.000451411378
  error estimate for blocks of size 2^( 5) =       0.000461255239
  error estimate for blocks of size 2^( 6) =       0.000466550840
  error estimate for blocks of size 2^( 7) =       0.000469543470

      target function =                  N/A
              le_mean =     -16.906326494357
             les_mean =     286.167968794079
             stat err =       0.000462190232
             autocorr =       1.241638404485
              std dev =       0.586594776936
             le_variance =       0.344093432329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414785145
  error estimate for blocks of size 2^( 2) =       0.000427183443
  error estimate for blocks of size 2^( 3) =       0.000439622424
  error estimate for blocks of size 2^( 4) =       0.000451411378
  error estimate for blocks of size 2^( 5) =       0.000461255239
  error estimate for blocks of size 2^( 6) =       0.000466550840
  error estimate for blocks of size 2^( 7) =       0.000469543470

      target function =                  N/A
              le_mean =     -16.906326494357
             les_mean =     286.167968794079
             stat err =       0.000462190232
             autocorr =       1.241638404485
              std dev =       0.586594776936
             le_variance =       0.344093432329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344050357550
                                         uncertainty =       0.006128549578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414785145
  error estimate for blocks of size 2^( 2) =       0.000427183443
  error estimate for blocks of size 2^( 3) =       0.000439622424
  error estimate for blocks of size 2^( 4) =       0.000451411378
  error estimate for blocks of size 2^( 5) =       0.000461255239
  error estimate for blocks of size 2^( 6) =       0.000466550840
  error estimate for blocks of size 2^( 7) =       0.000469543470

      target function =                  N/A
              le_mean =     -16.906326494357
             les_mean =     286.167968794079
             stat err =       0.000462190232
             autocorr =       1.241638404485
              std dev =       0.586594776936
             le_variance =       0.344093432329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906326494357        initial  <--
     6.1035e+26     6.1035e+27             0.0000e+00       -16.906326494357
     2.4414e+27     2.4414e+28             0.0000e+00       -16.906326494357
     9.7656e+27     9.7656e+28             0.0000e+00       -16.906326494357

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6035
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8416
    reference variance = 0.209279
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353489041852
                                         uncertainty =       0.011218816754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353489041852
                                         uncertainty =       0.011218816754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420336980
  error estimate for blocks of size 2^( 2) =       0.000432934582
  error estimate for blocks of size 2^( 3) =       0.000445959808
  error estimate for blocks of size 2^( 4) =       0.000458485218
  error estimate for blocks of size 2^( 5) =       0.000468884471
  error estimate for blocks of size 2^( 6) =       0.000479639555
  error estimate for blocks of size 2^( 7) =       0.000487790232

      target function =                  N/A
              le_mean =     -16.906192252408
             les_mean =     286.172702651416
             stat err =       0.000473699869
             autocorr =       1.270022253731
              std dev =       0.594446257222
             le_variance =       0.353366352726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619225241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906192252408       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906192252408       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906192252408       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906192252408       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906192252408       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906192252408       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.485454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5868e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8228
    reference variance = 0.281254
====================================================
  Execution time = 2.2344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4143e-01
  Total weights = 2.0000e+06
  Execution time = 1.8703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413177940
  error estimate for blocks of size 2^( 2) =       0.000426277176
  error estimate for blocks of size 2^( 3) =       0.000439795980
  error estimate for blocks of size 2^( 4) =       0.000452768517
  error estimate for blocks of size 2^( 5) =       0.000464299805
  error estimate for blocks of size 2^( 6) =       0.000472987588
  error estimate for blocks of size 2^( 7) =       0.000476387869

      target function =                  N/A
              le_mean =     -16.905564987921
             les_mean =     286.139559409479
             stat err =       0.000466610945
             autocorr =       1.275368221784
              std dev =       0.584321845717
             le_variance =       0.341432019382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413177940
  error estimate for blocks of size 2^( 2) =       0.000426277176
  error estimate for blocks of size 2^( 3) =       0.000439795980
  error estimate for blocks of size 2^( 4) =       0.000452768517
  error estimate for blocks of size 2^( 5) =       0.000464299805
  error estimate for blocks of size 2^( 6) =       0.000472987588
  error estimate for blocks of size 2^( 7) =       0.000476387869

      target function =                  N/A
              le_mean =     -16.905564987921
             les_mean =     286.139559409479
             stat err =       0.000466610945
             autocorr =       1.275368221784
              std dev =       0.584321845717
             le_variance =       0.341432019382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413177940
  error estimate for blocks of size 2^( 2) =       0.000426277176
  error estimate for blocks of size 2^( 3) =       0.000439795980
  error estimate for blocks of size 2^( 4) =       0.000452768517
  error estimate for blocks of size 2^( 5) =       0.000464299805
  error estimate for blocks of size 2^( 6) =       0.000472987588
  error estimate for blocks of size 2^( 7) =       0.000476387869

      target function =                  N/A
              le_mean =     -16.905564987921
             les_mean =     286.139559409479
             stat err =       0.000466610945
             autocorr =       1.275368221784
              std dev =       0.584321845717
             le_variance =       0.341432019382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341286980092
                                         uncertainty =       0.004366599226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413177940
  error estimate for blocks of size 2^( 2) =       0.000426277176
  error estimate for blocks of size 2^( 3) =       0.000439795980
  error estimate for blocks of size 2^( 4) =       0.000452768517
  error estimate for blocks of size 2^( 5) =       0.000464299805
  error estimate for blocks of size 2^( 6) =       0.000472987588
  error estimate for blocks of size 2^( 7) =       0.000476387869

      target function =                  N/A
              le_mean =     -16.905564987921
             les_mean =     286.139559409479
             stat err =       0.000466610945
             autocorr =       1.275368221784
              std dev =       0.584321845717
             le_variance =       0.341432019382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905564987921        initial  <--
     6.1035e+27     6.1035e+28             0.0000e+00       -16.905564987921
     2.4414e+28     2.4414e+29             0.0000e+00       -16.905564987921
     9.7656e+28     9.7656e+29             0.0000e+00       -16.905564987921

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7978
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.103505e-01 1 1  ON 0
 uu_1                 1.432609e-01 1 1  ON 1
 uu_2                 4.137992e-02 1 1  ON 2
 uu_3                -2.102788e-02 1 1  ON 3
 uu_4                -6.676604e-02 1 1  ON 4
 uu_5                -1.019659e-01 1 1  ON 5
 uu_6                -1.295694e-01 1 1  ON 6
 uu_7                -1.431245e-01 1 1  ON 7
 uu_8                -1.351720e-01 1 1  ON 8
 uu_9                -1.060858e-01 1 1  ON 9
 ud_0                 4.504063e-01 1 1  ON 10
 ud_1                 1.843537e-01 1 1  ON 11
 ud_2                 6.354533e-02 1 1  ON 12
 ud_3                -7.955052e-03 1 1  ON 13
 ud_4                -6.563399e-02 1 1  ON 14
 ud_5                -1.075375e-01 1 1  ON 15
 ud_6                -1.354407e-01 1 1  ON 16
 ud_7                -1.521925e-01 1 1  ON 17
 ud_8                -1.535926e-01 1 1  ON 18
 ud_9                -1.444189e-01 1 1  ON 19
 eO_0                -7.598300e-01 1 1  ON 20
 eO_1                -4.379499e-01 1 1  ON 21
 eO_2                -2.110143e-02 1 1  ON 22
 eO_3                 2.980713e-01 1 1  ON 23
 eO_4                 5.258982e-01 1 1  ON 24
 eO_5                 4.888713e-01 1 1  ON 25
 eO_6                 2.613538e-01 1 1  ON 26
 eO_7                -4.046136e-02 1 1  ON 27
 eO_8                -2.236402e-01 1 1  ON 28
 eO_9                -8.931766e-02 1 1  ON 29
eH1_0                -2.502085e-01 1 1  ON 30
eH1_1                -1.472675e-01 1 1  ON 31
eH1_2                -9.917042e-02 1 1  ON 32
eH1_3                -4.464273e-02 1 1  ON 33
eH1_4                 3.800025e-03 1 1  ON 34
eH1_5                 3.765690e-02 1 1  ON 35
eH1_6                 9.658255e-02 1 1  ON 36
eH1_7                 1.544625e-01 1 1  ON 37
eH1_8                 1.803104e-01 1 1  ON 38
eH1_9                 7.208129e-02 1 1  ON 39
eH2_0                -2.480641e-01 1 1  ON 40
eH2_1                -1.453845e-01 1 1  ON 41
eH2_2                -9.707090e-02 1 1  ON 42
eH2_3                -4.256877e-02 1 1  ON 43
eH2_4                 6.411296e-03 1 1  ON 44
eH2_5                 4.075263e-02 1 1  ON 45
eH2_6                 9.934589e-02 1 1  ON 46
eH2_7                 1.556450e-01 1 1  ON 47
eH2_8                 1.850802e-01 1 1  ON 48
eH2_9                 6.204301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7671e+01 secs
  Total Execution time = 2.2462e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
