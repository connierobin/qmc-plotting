--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0256.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 67407 MB
Rank =    1  Free Memory = 67403 MB
Rank =    2  Free Memory = 67403 MB
Rank =    3  Free Memory = 67403 MB
Rank =    4  Free Memory = 67403 MB
Rank =    5  Free Memory = 67403 MB
Rank =    6  Free Memory = 67402 MB
Rank =    7  Free Memory = 67402 MB
Rank =    8  Free Memory = 67402 MB
Rank =    9  Free Memory = 67402 MB
Rank =   10  Free Memory = 67402 MB
Rank =   11  Free Memory = 67402 MB
Rank =   12  Free Memory = 67402 MB
Rank =   13  Free Memory = 67402 MB
Rank =   14  Free Memory = 67402 MB
Rank =   15  Free Memory = 67402 MB
Rank =   16  Free Memory = 67402 MB
Rank =   17  Free Memory = 67402 MB
Rank =   18  Free Memory = 67402 MB
Rank =   19  Free Memory = 67402 MB
Rank =   20  Free Memory = 67402 MB
Rank =   21  Free Memory = 67402 MB
Rank =   22  Free Memory = 67402 MB
Rank =   23  Free Memory = 67402 MB
Rank =   24  Free Memory = 67402 MB
Rank =   25  Free Memory = 67402 MB
Rank =   26  Free Memory = 67402 MB
Rank =   27  Free Memory = 67402 MB
Rank =   28  Free Memory = 67402 MB
Rank =   29  Free Memory = 67402 MB
Rank =   30  Free Memory = 67402 MB
Rank =   31  Free Memory = 67402 MB
Rank =   32  Free Memory = 67402 MB
Rank =   33  Free Memory = 67402 MB
Rank =   34  Free Memory = 67402 MB
Rank =   35  Free Memory = 67401 MB
Rank =   36  Free Memory = 67401 MB
Rank =   37  Free Memory = 67401 MB
Rank =   38  Free Memory = 67401 MB
Rank =   39  Free Memory = 67401 MB
Rank =   40  Free Memory = 75134 MB
Rank =   41  Free Memory = 75134 MB
Rank =   42  Free Memory = 75134 MB
Rank =   43  Free Memory = 75134 MB
Rank =   44  Free Memory = 75133 MB
Rank =   45  Free Memory = 75133 MB
Rank =   46  Free Memory = 75133 MB
Rank =   47  Free Memory = 75133 MB
Rank =   48  Free Memory = 75133 MB
Rank =   49  Free Memory = 75133 MB
Rank =   50  Free Memory = 75133 MB
Rank =   51  Free Memory = 75133 MB
Rank =   52  Free Memory = 75133 MB
Rank =   53  Free Memory = 75133 MB
Rank =   54  Free Memory = 75133 MB
Rank =   55  Free Memory = 75133 MB
Rank =   56  Free Memory = 75133 MB
Rank =   57  Free Memory = 75133 MB
Rank =   58  Free Memory = 75133 MB
Rank =   59  Free Memory = 75133 MB
Rank =   60  Free Memory = 75133 MB
Rank =   61  Free Memory = 75133 MB
Rank =   62  Free Memory = 75133 MB
Rank =   63  Free Memory = 75133 MB
Rank =   64  Free Memory = 75133 MB
Rank =   65  Free Memory = 75133 MB
Rank =   66  Free Memory = 75133 MB
Rank =   67  Free Memory = 75132 MB
Rank =   68  Free Memory = 75132 MB
Rank =   69  Free Memory = 75132 MB
Rank =   70  Free Memory = 75132 MB
Rank =   71  Free Memory = 75132 MB
Rank =   72  Free Memory = 75132 MB
Rank =   73  Free Memory = 75132 MB
Rank =   74  Free Memory = 75132 MB
Rank =   75  Free Memory = 75132 MB
Rank =   76  Free Memory = 75132 MB
Rank =   77  Free Memory = 75132 MB
Rank =   78  Free Memory = 75132 MB
Rank =   79  Free Memory = 75132 MB
Rank =   80  Free Memory = 79054 MB
Rank =   81  Free Memory = 79054 MB
Rank =   82  Free Memory = 79053 MB
Rank =   83  Free Memory = 79053 MB
Rank =   84  Free Memory = 79053 MB
Rank =   85  Free Memory = 79053 MB
Rank =   86  Free Memory = 79053 MB
Rank =   87  Free Memory = 79053 MB
Rank =   88  Free Memory = 79053 MB
Rank =   89  Free Memory = 79053 MB
Rank =   90  Free Memory = 79053 MB
Rank =   91  Free Memory = 79053 MB
Rank =   92  Free Memory = 79053 MB
Rank =   93  Free Memory = 79053 MB
Rank =   94  Free Memory = 79053 MB
Rank =   95  Free Memory = 79053 MB
Rank =   96  Free Memory = 79053 MB
Rank =   97  Free Memory = 79053 MB
Rank =   98  Free Memory = 79053 MB
Rank =   99  Free Memory = 79053 MB
Rank =  100  Free Memory = 79053 MB
Rank =  101  Free Memory = 79053 MB
Rank =  102  Free Memory = 79053 MB
Rank =  103  Free Memory = 79053 MB
Rank =  104  Free Memory = 79053 MB
Rank =  105  Free Memory = 79053 MB
Rank =  106  Free Memory = 79053 MB
Rank =  107  Free Memory = 79053 MB
Rank =  108  Free Memory = 79053 MB
Rank =  109  Free Memory = 79053 MB
Rank =  110  Free Memory = 79053 MB
Rank =  111  Free Memory = 79053 MB
Rank =  112  Free Memory = 79053 MB
Rank =  113  Free Memory = 79053 MB
Rank =  114  Free Memory = 79053 MB
Rank =  115  Free Memory = 79053 MB
Rank =  116  Free Memory = 79053 MB
Rank =  117  Free Memory = 79053 MB
Rank =  118  Free Memory = 79053 MB
Rank =  119  Free Memory = 79053 MB
Rank =  120  Free Memory = 76354 MB
Rank =  121  Free Memory = 76354 MB
Rank =  122  Free Memory = 76354 MB
Rank =  123  Free Memory = 76354 MB
  Input file(s): opt_h2o_1b1_gvptt_run002v.xml 
Rank =  124  Free Memory = 76354 MB
Rank =  125  Free Memory = 76354 MB
Rank =  126  Free Memory = 76354 MB
Rank =  127  Free Memory = 76354 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002v.xml

  Project = H2O
  date    = 2023-04-24 17:04:18 PDT
  host    = n0254.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 258

  Range of prime numbers to use as seeds over processors and threads = 1657-2677


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.097502e-01    1         1  ON     0
     uu_1                 1.426996e-01    1         1  ON     1
     uu_2                 4.079387e-02    1         1  ON     2
     uu_3                -2.214843e-02    1         1  ON     3
     uu_4                -6.812016e-02    1         1  ON     4
     uu_5                -1.035966e-01    1         1  ON     5
     uu_6                -1.317581e-01    1         1  ON     6
     uu_7                -1.463457e-01    1         1  ON     7
     uu_8                -1.393100e-01    1         1  ON     8
     uu_9                -1.117279e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.546827e-01    1         1  ON     0
     ud_1                 1.882354e-01    1         1  ON     1
     ud_2                 6.679494e-02    1         1  ON     2
     ud_3                -5.361640e-03    1         1  ON     3
     ud_4                -6.302187e-02    1         1  ON     4
     ud_5                -1.052769e-01    1         1  ON     5
     ud_6                -1.337480e-01    1         1  ON     6
     ud_7                -1.515597e-01    1         1  ON     7
     ud_8                -1.530810e-01    1         1  ON     8
     ud_9                -1.456169e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.634071e-01    1         1  ON     0
     eO_1                -4.402779e-01    1         1  ON     1
     eO_2                -1.716441e-02    1         1  ON     2
     eO_3                 3.066821e-01    1         1  ON     3
     eO_4                 5.355703e-01    1         1  ON     4
     eO_5                 4.997885e-01    1         1  ON     5
     eO_6                 2.701624e-01    1         1  ON     6
     eO_7                -3.700354e-02    1         1  ON     7
     eO_8                -2.401805e-01    1         1  ON     8
     eO_9                -1.089637e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.559773e-01    1         1  ON     0
     eH1_1                -1.546504e-01    1         1  ON     1
     eH1_2                -1.072930e-01    1         1  ON     2
     eH1_3                -5.236784e-02    1         1  ON     3
     eH1_4                -3.356680e-03    1         1  ON     4
     eH1_5                 3.201046e-02    1         1  ON     5
     eH1_6                 9.327578e-02    1         1  ON     6
     eH1_7                 1.552542e-01    1         1  ON     7
     eH1_8                 1.953669e-01    1         1  ON     8
     eH1_9                 9.686386e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.533500e-01    1         1  ON     0
     eH2_1                -1.517687e-01    1         1  ON     1
     eH2_2                -1.044658e-01    1         1  ON     2
     eH2_3                -4.972251e-02    1         1  ON     3
     eH2_4                -1.007379e-03    1         1  ON     4
     eH2_5                 3.370077e-02    1         1  ON     5
     eH2_6                 9.498991e-02    1         1  ON     6
     eH2_7                 1.556279e-01    1         1  ON     7
     eH2_8                 1.983702e-01    1         1  ON     8
     eH2_9                 9.065662e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.357189e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.2068e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0254.savio3:187053] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0254.savio3:187053] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.19779
====================================================
  Execution time = 2.0755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3855e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338594270326
                                         uncertainty =       0.004906226487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338594270326
                                         uncertainty =       0.004906226487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411428094
  error estimate for blocks of size 2^( 2) =       0.000424446060
  error estimate for blocks of size 2^( 3) =       0.000437573905
  error estimate for blocks of size 2^( 4) =       0.000450577120
  error estimate for blocks of size 2^( 5) =       0.000461749556
  error estimate for blocks of size 2^( 6) =       0.000472287517
  error estimate for blocks of size 2^( 7) =       0.000478114427

      target function =                  N/A
              le_mean =     -16.905504631872
             les_mean =     286.134632842182
             stat err =       0.000465682155
             autocorr =       1.281124405147
              std dev =       0.581847190602
             le_variance =       0.338546153211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690550463187e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905504631872       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905505649051       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905506139453       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905507075008       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905505891698       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905506272584       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905505905659       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905505583208       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905506075910       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905506138572       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.527945e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905504631872       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905505019007       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905505062775       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905505786734       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905505380807       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905505141404       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905505074338       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905505047811       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.759702e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905504631872       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905504743194       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905504741538       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905504976974       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905504901081       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905504794010       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905504765164       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905504766083       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.034853e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6542e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.096306e-01                 1 1 ON  0
uu_1  1.427657e-01                 1 1 ON  1
uu_2  4.084659e-02                 1 1 ON  2
uu_3  -2.216581e-02                1 1 ON  3
uu_4  -6.806076e-02                1 1 ON  4
uu_5  -1.036190e-01                1 1 ON  5
uu_6  -1.316333e-01                1 1 ON  6
uu_7  -1.463965e-01                1 1 ON  7
uu_8  -1.394527e-01                1 1 ON  8
uu_9  -1.117973e-01                1 1 ON  9
ud_0  4.546082e-01                 1 1 ON  10
ud_1  1.883054e-01                 1 1 ON  11
ud_2  6.681683e-02                 1 1 ON  12
ud_3  -5.272259e-03                1 1 ON  13
ud_4  -6.296099e-02                1 1 ON  14
ud_5  -1.052492e-01                1 1 ON  15
ud_6  -1.337400e-01                1 1 ON  16
ud_7  -1.515949e-01                1 1 ON  17
ud_8  -1.530944e-01                1 1 ON  18
ud_9  -1.456642e-01                1 1 ON  19
eO_0  -7.633672e-01                1 1 ON  20
eO_1  -4.401019e-01                1 1 ON  21
eO_2  -1.722082e-02                1 1 ON  22
eO_3  3.066572e-01                 1 1 ON  23
eO_4  5.355701e-01                 1 1 ON  24
eO_5  4.998820e-01                 1 1 ON  25
eO_6  2.701857e-01                 1 1 ON  26
eO_7  -3.704228e-02                1 1 ON  27
eO_8  -2.402372e-01                1 1 ON  28
eO_9  -1.090983e-01                1 1 ON  29
eH1_0 -2.560032e-01                1 1 ON  30
eH1_1 -1.546981e-01                1 1 ON  31
eH1_2 -1.073804e-01                1 1 ON  32
eH1_3 -5.249281e-02                1 1 ON  33
eH1_4 -3.344409e-03                1 1 ON  34
eH1_5 3.198790e-02                 1 1 ON  35
eH1_6 9.328625e-02                 1 1 ON  36
eH1_7 1.552894e-01                 1 1 ON  37
eH1_8 1.954438e-01                 1 1 ON  38
eH1_9 9.699627e-02                 1 1 ON  39
eH2_0 -2.534671e-01                1 1 ON  40
eH2_1 -1.517916e-01                1 1 ON  41
eH2_2 -1.044699e-01                1 1 ON  42
eH2_3 -4.976784e-02                1 1 ON  43
eH2_4 -1.040721e-03                1 1 ON  44
eH2_5 3.367097e-02                 1 1 ON  45
eH2_6 9.498259e-02                 1 1 ON  46
eH2_7 1.557053e-01                 1 1 ON  47
eH2_8 1.984052e-01                 1 1 ON  48
eH2_9 9.078804e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.190427
====================================================
  Execution time = 1.9860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4121e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341365621307
                                         uncertainty =       0.004454568072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341365621307
                                         uncertainty =       0.004454568072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413114695
  error estimate for blocks of size 2^( 2) =       0.000426100313
  error estimate for blocks of size 2^( 3) =       0.000439230622
  error estimate for blocks of size 2^( 4) =       0.000451557631
  error estimate for blocks of size 2^( 5) =       0.000462074710
  error estimate for blocks of size 2^( 6) =       0.000470318959
  error estimate for blocks of size 2^( 7) =       0.000477022295

      target function =                  N/A
              le_mean =     -16.905776302038
             les_mean =     286.146599706495
             stat err =       0.000465243399
             autocorr =       1.268291704885
              std dev =       0.584232404618
             le_variance =       0.341327502606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341117325083
                                         uncertainty =       0.004452302816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341117325083
                                         uncertainty =       0.004452302816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412964382
  error estimate for blocks of size 2^( 2) =       0.000425952995
  error estimate for blocks of size 2^( 3) =       0.000439082657
  error estimate for blocks of size 2^( 4) =       0.000451412943
  error estimate for blocks of size 2^( 5) =       0.000461936910
  error estimate for blocks of size 2^( 6) =       0.000470183794
  error estimate for blocks of size 2^( 7) =       0.000476892363

      target function =                  N/A
              le_mean =     -16.905776431556
             les_mean =     286.146355745220
             stat err =       0.000465106502
             autocorr =       1.268468336332
              std dev =       0.584019830155
             le_variance =       0.341079162015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341123979562
                                         uncertainty =       0.004451921205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341123979562
                                         uncertainty =       0.004451921205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412968405
  error estimate for blocks of size 2^( 2) =       0.000425957616
  error estimate for blocks of size 2^( 3) =       0.000439087953
  error estimate for blocks of size 2^( 4) =       0.000451418532
  error estimate for blocks of size 2^( 5) =       0.000461941745
  error estimate for blocks of size 2^( 6) =       0.000470189442
  error estimate for blocks of size 2^( 7) =       0.000476898096

      target function =                  N/A
              le_mean =     -16.905776637121
             les_mean =     286.146369340667
             stat err =       0.000465111954
             autocorr =       1.268473357251
              std dev =       0.584025519122
             le_variance =       0.341085806986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341326185731
                                         uncertainty =       0.004454106255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341326185731
                                         uncertainty =       0.004454106255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413090824
  error estimate for blocks of size 2^( 2) =       0.000426076995
  error estimate for blocks of size 2^( 3) =       0.000439207312
  error estimate for blocks of size 2^( 4) =       0.000451534942
  error estimate for blocks of size 2^( 5) =       0.000462052990
  error estimate for blocks of size 2^( 6) =       0.000470297864
  error estimate for blocks of size 2^( 7) =       0.000477002043

      target function =                  N/A
              le_mean =     -16.905776287434
             les_mean =     286.146559768469
             stat err =       0.000465221960
             autocorr =       1.268321387056
              std dev =       0.584198646306
             le_variance =       0.341288058346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905776302038        initial
     2.5000e-01     2.5000e+00             5.5279e-04       -16.905776431556
     1.0000e+00     1.0000e+01             1.7597e-04       -16.905776637121  <--
     4.0000e+00     4.0000e+01             5.0349e-05       -16.905776287434

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.9457e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.096306e-01 1 1  ON 0
 uu_1                 1.427657e-01 1 1  ON 1
 uu_2                 4.084659e-02 1 1  ON 2
 uu_3                -2.216581e-02 1 1  ON 3
 uu_4                -6.806076e-02 1 1  ON 4
 uu_5                -1.036190e-01 1 1  ON 5
 uu_6                -1.316333e-01 1 1  ON 6
 uu_7                -1.463965e-01 1 1  ON 7
 uu_8                -1.394527e-01 1 1  ON 8
 uu_9                -1.117973e-01 1 1  ON 9
 ud_0                 4.546082e-01 1 1  ON 10
 ud_1                 1.883054e-01 1 1  ON 11
 ud_2                 6.681683e-02 1 1  ON 12
 ud_3                -5.272259e-03 1 1  ON 13
 ud_4                -6.296099e-02 1 1  ON 14
 ud_5                -1.052492e-01 1 1  ON 15
 ud_6                -1.337400e-01 1 1  ON 16
 ud_7                -1.515949e-01 1 1  ON 17
 ud_8                -1.530944e-01 1 1  ON 18
 ud_9                -1.456642e-01 1 1  ON 19
 eO_0                -7.633672e-01 1 1  ON 20
 eO_1                -4.401019e-01 1 1  ON 21
 eO_2                -1.722082e-02 1 1  ON 22
 eO_3                 3.066572e-01 1 1  ON 23
 eO_4                 5.355701e-01 1 1  ON 24
 eO_5                 4.998820e-01 1 1  ON 25
 eO_6                 2.701857e-01 1 1  ON 26
 eO_7                -3.704228e-02 1 1  ON 27
 eO_8                -2.402372e-01 1 1  ON 28
 eO_9                -1.090983e-01 1 1  ON 29
eH1_0                -2.560032e-01 1 1  ON 30
eH1_1                -1.546981e-01 1 1  ON 31
eH1_2                -1.073804e-01 1 1  ON 32
eH1_3                -5.249281e-02 1 1  ON 33
eH1_4                -3.344409e-03 1 1  ON 34
eH1_5                 3.198790e-02 1 1  ON 35
eH1_6                 9.328625e-02 1 1  ON 36
eH1_7                 1.552894e-01 1 1  ON 37
eH1_8                 1.954438e-01 1 1  ON 38
eH1_9                 9.699627e-02 1 1  ON 39
eH2_0                -2.534671e-01 1 1  ON 40
eH2_1                -1.517916e-01 1 1  ON 41
eH2_2                -1.044699e-01 1 1  ON 42
eH2_3                -4.976784e-02 1 1  ON 43
eH2_4                -1.040721e-03 1 1  ON 44
eH2_5                 3.367097e-02 1 1  ON 45
eH2_6                 9.498259e-02 1 1  ON 46
eH2_7                 1.557053e-01 1 1  ON 47
eH2_8                 1.984052e-01 1 1  ON 48
eH2_9                 9.078804e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6011e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.191827
====================================================
  Execution time = 2.0712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3627e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336342196668
                                         uncertainty =       0.003891136831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336342196668
                                         uncertainty =       0.003891136831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410041487
  error estimate for blocks of size 2^( 2) =       0.000422697184
  error estimate for blocks of size 2^( 3) =       0.000435660866
  error estimate for blocks of size 2^( 4) =       0.000447048834
  error estimate for blocks of size 2^( 5) =       0.000457287248
  error estimate for blocks of size 2^( 6) =       0.000466014635
  error estimate for blocks of size 2^( 7) =       0.000474338966

      target function =                  N/A
              le_mean =     -16.905860136161
             les_mean =     286.144374817972
             stat err =       0.000461172421
             autocorr =       1.264943286682
              std dev =       0.579886232533
             le_variance =       0.336268042682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586013616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905860136161       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860114290       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905861313575       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905861504733       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905862233579       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905863478858       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905862646814       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905861701575       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905861723713       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905861839937       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.050321e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905860136161       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860128049       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860509310       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905860624795       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905861233564       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905861282044       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905861129259       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860969083       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.991868e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905860136161       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860133854       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905860233885       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905860285094       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905860449465       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905860478139       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905860432361       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905860411009       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.213110e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6197e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.096498e-01 1 1  ON 0
 uu_1                 1.428105e-01 1 1  ON 1
 uu_2                 4.084448e-02 1 1  ON 2
 uu_3                -2.214348e-02 1 1  ON 3
 uu_4                -6.800998e-02 1 1  ON 4
 uu_5                -1.036931e-01 1 1  ON 5
 uu_6                -1.316827e-01 1 1  ON 6
 uu_7                -1.464177e-01 1 1  ON 7
 uu_8                -1.395269e-01 1 1  ON 8
 uu_9                -1.118280e-01 1 1  ON 9
 ud_0                 4.547093e-01 1 1  ON 10
 ud_1                 1.883293e-01 1 1  ON 11
 ud_2                 6.683301e-02 1 1  ON 12
 ud_3                -5.304217e-03 1 1  ON 13
 ud_4                -6.295863e-02 1 1  ON 14
 ud_5                -1.052767e-01 1 1  ON 15
 ud_6                -1.337144e-01 1 1  ON 16
 ud_7                -1.515513e-01 1 1  ON 17
 ud_8                -1.531430e-01 1 1  ON 18
 ud_9                -1.456798e-01 1 1  ON 19
 eO_0                -7.632933e-01 1 1  ON 20
 eO_1                -4.400656e-01 1 1  ON 21
 eO_2                -1.716785e-02 1 1  ON 22
 eO_3                 3.066159e-01 1 1  ON 23
 eO_4                 5.355920e-01 1 1  ON 24
 eO_5                 4.999306e-01 1 1  ON 25
 eO_6                 2.702587e-01 1 1  ON 26
 eO_7                -3.706699e-02 1 1  ON 27
 eO_8                -2.403277e-01 1 1  ON 28
 eO_9                -1.092190e-01 1 1  ON 29
eH1_0                -2.562024e-01 1 1  ON 30
eH1_1                -1.546685e-01 1 1  ON 31
eH1_2                -1.073647e-01 1 1  ON 32
eH1_3                -5.248750e-02 1 1  ON 33
eH1_4                -3.399007e-03 1 1  ON 34
eH1_5                 3.202881e-02 1 1  ON 35
eH1_6                 9.330199e-02 1 1  ON 36
eH1_7                 1.553196e-01 1 1  ON 37
eH1_8                 1.954615e-01 1 1  ON 38
eH1_9                 9.710088e-02 1 1  ON 39
eH2_0                -2.534808e-01 1 1  ON 40
eH2_1                -1.519113e-01 1 1  ON 41
eH2_2                -1.045655e-01 1 1  ON 42
eH2_3                -4.980612e-02 1 1  ON 43
eH2_4                -9.930432e-04 1 1  ON 44
eH2_5                 3.373269e-02 1 1  ON 45
eH2_6                 9.486222e-02 1 1  ON 46
eH2_7                 1.556720e-01 1 1  ON 47
eH2_8                 1.984726e-01 1 1  ON 48
eH2_9                 9.098644e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8214
    reference variance = 0.367363
====================================================
  Execution time = 1.9835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3918e-01
  Total weights = 2.0000e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339108771165
                                         uncertainty =       0.003104616546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339108771165
                                         uncertainty =       0.003104616546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411763245
  error estimate for blocks of size 2^( 2) =       0.000424461284
  error estimate for blocks of size 2^( 3) =       0.000437541317
  error estimate for blocks of size 2^( 4) =       0.000449485495
  error estimate for blocks of size 2^( 5) =       0.000458362038
  error estimate for blocks of size 2^( 6) =       0.000464515039
  error estimate for blocks of size 2^( 7) =       0.000469176676

      target function =                  N/A
              le_mean =     -16.905253457112
             les_mean =     286.126692220014
             stat err =       0.000460384812
             autocorr =       1.250105942990
              std dev =       0.582321166001
             le_variance =       0.339097940372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339268711432
                                         uncertainty =       0.003105944560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339268711432
                                         uncertainty =       0.003105944560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411860347
  error estimate for blocks of size 2^( 2) =       0.000424551600
  error estimate for blocks of size 2^( 3) =       0.000437624128
  error estimate for blocks of size 2^( 4) =       0.000449560340
  error estimate for blocks of size 2^( 5) =       0.000458432861
  error estimate for blocks of size 2^( 6) =       0.000464581384
  error estimate for blocks of size 2^( 7) =       0.000469241382

      target function =                  N/A
              le_mean =     -16.905251951782
             les_mean =     286.126801274134
             stat err =       0.000460453992
             autocorr =       1.249892100765
              std dev =       0.582458488249
             le_variance =       0.339257890534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339264112965
                                         uncertainty =       0.003106021412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339264112965
                                         uncertainty =       0.003106021412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411857562
  error estimate for blocks of size 2^( 2) =       0.000424549878
  error estimate for blocks of size 2^( 3) =       0.000437623367
  error estimate for blocks of size 2^( 4) =       0.000449560822
  error estimate for blocks of size 2^( 5) =       0.000458432799
  error estimate for blocks of size 2^( 6) =       0.000464583281
  error estimate for blocks of size 2^( 7) =       0.000469242974

      target function =                  N/A
              le_mean =     -16.905252024129
             les_mean =     286.126799132990
             stat err =       0.000460454969
             autocorr =       1.249914305324
              std dev =       0.582454550411
             le_variance =       0.339253303294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339133397136
                                         uncertainty =       0.003104844752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339133397136
                                         uncertainty =       0.003104844752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411778199
  error estimate for blocks of size 2^( 2) =       0.000424475366
  error estimate for blocks of size 2^( 3) =       0.000437554393
  error estimate for blocks of size 2^( 4) =       0.000449497554
  error estimate for blocks of size 2^( 5) =       0.000458373323
  error estimate for blocks of size 2^( 6) =       0.000464525975
  error estimate for blocks of size 2^( 7) =       0.000469187275

      target function =                  N/A
              le_mean =     -16.905253205958
             les_mean =     286.126708358435
             stat err =       0.000460396032
             autocorr =       1.250076077003
              std dev =       0.582342313809
             le_variance =       0.339122570452


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905253457112        initial  <--
     2.5000e-01     2.5000e+00             8.0503e-04       -16.905251951782
     1.0000e+00     1.0000e+01             1.9919e-04       -16.905252024129
     4.0000e+00     4.0000e+01             5.2131e-05       -16.905253205958

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4496
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.096306e-01 1 1  ON 0
 uu_1                 1.427657e-01 1 1  ON 1
 uu_2                 4.084659e-02 1 1  ON 2
 uu_3                -2.216581e-02 1 1  ON 3
 uu_4                -6.806076e-02 1 1  ON 4
 uu_5                -1.036190e-01 1 1  ON 5
 uu_6                -1.316333e-01 1 1  ON 6
 uu_7                -1.463965e-01 1 1  ON 7
 uu_8                -1.394527e-01 1 1  ON 8
 uu_9                -1.117973e-01 1 1  ON 9
 ud_0                 4.546082e-01 1 1  ON 10
 ud_1                 1.883054e-01 1 1  ON 11
 ud_2                 6.681683e-02 1 1  ON 12
 ud_3                -5.272259e-03 1 1  ON 13
 ud_4                -6.296099e-02 1 1  ON 14
 ud_5                -1.052492e-01 1 1  ON 15
 ud_6                -1.337400e-01 1 1  ON 16
 ud_7                -1.515949e-01 1 1  ON 17
 ud_8                -1.530944e-01 1 1  ON 18
 ud_9                -1.456642e-01 1 1  ON 19
 eO_0                -7.633672e-01 1 1  ON 20
 eO_1                -4.401019e-01 1 1  ON 21
 eO_2                -1.722082e-02 1 1  ON 22
 eO_3                 3.066572e-01 1 1  ON 23
 eO_4                 5.355701e-01 1 1  ON 24
 eO_5                 4.998820e-01 1 1  ON 25
 eO_6                 2.701857e-01 1 1  ON 26
 eO_7                -3.704228e-02 1 1  ON 27
 eO_8                -2.402372e-01 1 1  ON 28
 eO_9                -1.090983e-01 1 1  ON 29
eH1_0                -2.560032e-01 1 1  ON 30
eH1_1                -1.546981e-01 1 1  ON 31
eH1_2                -1.073804e-01 1 1  ON 32
eH1_3                -5.249281e-02 1 1  ON 33
eH1_4                -3.344409e-03 1 1  ON 34
eH1_5                 3.198790e-02 1 1  ON 35
eH1_6                 9.328625e-02 1 1  ON 36
eH1_7                 1.552894e-01 1 1  ON 37
eH1_8                 1.954438e-01 1 1  ON 38
eH1_9                 9.699627e-02 1 1  ON 39
eH2_0                -2.534671e-01 1 1  ON 40
eH2_1                -1.517916e-01 1 1  ON 41
eH2_2                -1.044699e-01 1 1  ON 42
eH2_3                -4.976784e-02 1 1  ON 43
eH2_4                -1.040721e-03 1 1  ON 44
eH2_5                 3.367097e-02 1 1  ON 45
eH2_6                 9.498259e-02 1 1  ON 46
eH2_7                 1.557053e-01 1 1  ON 47
eH2_8                 1.984052e-01 1 1  ON 48
eH2_9                 9.078804e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8999
    reference variance = 0.221553
====================================================
  Execution time = 2.2089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336887883811
                                         uncertainty =       0.003647951063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336887883811
                                         uncertainty =       0.003647951063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410527214
  error estimate for blocks of size 2^( 2) =       0.000423354339
  error estimate for blocks of size 2^( 3) =       0.000436892646
  error estimate for blocks of size 2^( 4) =       0.000449291645
  error estimate for blocks of size 2^( 5) =       0.000461674601
  error estimate for blocks of size 2^( 6) =       0.000469507084
  error estimate for blocks of size 2^( 7) =       0.000473192617

      target function =                  N/A
              le_mean =     -16.905905602170
             les_mean =     286.146709247200
             stat err =       0.000463416487
             autocorr =       1.274262955037
              std dev =       0.580573153229
             le_variance =       0.337065186251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590560217e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905905602170       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905905576261       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905905715853       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905905725908       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905905753473       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905905733572       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905905738053       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905905750506       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.318691e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905905602170       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905905595293       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905905633148       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905905635122       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905905641437       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905905636578       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905905641682       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905905642080       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.183833e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905905602170       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905905600424       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905905610094       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905905610557       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905905612091       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905905610866       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905905612417       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905905612387       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 5.531582e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7842e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.096364e-01 1 1  ON 0
 uu_1                 1.427605e-01 1 1  ON 1
 uu_2                 4.083494e-02 1 1  ON 2
 uu_3                -2.215974e-02 1 1  ON 3
 uu_4                -6.806787e-02 1 1  ON 4
 uu_5                -1.036179e-01 1 1  ON 5
 uu_6                -1.316384e-01 1 1  ON 6
 uu_7                -1.464143e-01 1 1  ON 7
 uu_8                -1.394451e-01 1 1  ON 8
 uu_9                -1.117906e-01 1 1  ON 9
 ud_0                 4.546207e-01 1 1  ON 10
 ud_1                 1.883082e-01 1 1  ON 11
 ud_2                 6.681964e-02 1 1  ON 12
 ud_3                -5.275937e-03 1 1  ON 13
 ud_4                -6.297112e-02 1 1  ON 14
 ud_5                -1.052520e-01 1 1  ON 15
 ud_6                -1.337447e-01 1 1  ON 16
 ud_7                -1.515969e-01 1 1  ON 17
 ud_8                -1.530894e-01 1 1  ON 18
 ud_9                -1.456574e-01 1 1  ON 19
 eO_0                -7.633549e-01 1 1  ON 20
 eO_1                -4.401018e-01 1 1  ON 21
 eO_2                -1.722345e-02 1 1  ON 22
 eO_3                 3.066594e-01 1 1  ON 23
 eO_4                 5.355755e-01 1 1  ON 24
 eO_5                 4.998799e-01 1 1  ON 25
 eO_6                 2.701897e-01 1 1  ON 26
 eO_7                -3.704677e-02 1 1  ON 27
 eO_8                -2.402403e-01 1 1  ON 28
 eO_9                -1.091073e-01 1 1  ON 29
eH1_0                -2.560103e-01 1 1  ON 30
eH1_1                -1.547040e-01 1 1  ON 31
eH1_2                -1.073835e-01 1 1  ON 32
eH1_3                -5.249388e-02 1 1  ON 33
eH1_4                -3.346874e-03 1 1  ON 34
eH1_5                 3.198890e-02 1 1  ON 35
eH1_6                 9.327493e-02 1 1  ON 36
eH1_7                 1.552893e-01 1 1  ON 37
eH1_8                 1.954517e-01 1 1  ON 38
eH1_9                 9.701636e-02 1 1  ON 39
eH2_0                -2.534751e-01 1 1  ON 40
eH2_1                -1.518135e-01 1 1  ON 41
eH2_2                -1.044667e-01 1 1  ON 42
eH2_3                -4.977368e-02 1 1  ON 43
eH2_4                -1.046100e-03 1 1  ON 44
eH2_5                 3.367829e-02 1 1  ON 45
eH2_6                 9.498791e-02 1 1  ON 46
eH2_7                 1.557053e-01 1 1  ON 47
eH2_8                 1.984093e-01 1 1  ON 48
eH2_9                 9.080539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9685
    reference variance = 0.258478
====================================================
  Execution time = 2.0025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4268e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776330440
                                         uncertainty =       0.003594817674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776330440
                                         uncertainty =       0.003594817674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413923845
  error estimate for blocks of size 2^( 2) =       0.000426343025
  error estimate for blocks of size 2^( 3) =       0.000440203008
  error estimate for blocks of size 2^( 4) =       0.000452733586
  error estimate for blocks of size 2^( 5) =       0.000463676197
  error estimate for blocks of size 2^( 6) =       0.000471391005
  error estimate for blocks of size 2^( 7) =       0.000476252094

      target function =                  N/A
              le_mean =     -16.906624883175
             les_mean =     286.176630667827
             stat err =       0.000466013221
             autocorr =       1.267522227832
              std dev =       0.585376715249
             le_variance =       0.342665898756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342812769744
                                         uncertainty =       0.003595313342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342812769744
                                         uncertainty =       0.003595313342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413945842
  error estimate for blocks of size 2^( 2) =       0.000426364550
  error estimate for blocks of size 2^( 3) =       0.000440223817
  error estimate for blocks of size 2^( 4) =       0.000452754037
  error estimate for blocks of size 2^( 5) =       0.000463696165
  error estimate for blocks of size 2^( 6) =       0.000471409933
  error estimate for blocks of size 2^( 7) =       0.000476270820

      target function =                  N/A
              le_mean =     -16.906625292973
             les_mean =     286.176680945633
             stat err =       0.000466032739
             autocorr =       1.267493686691
              std dev =       0.585407823639
             le_variance =       0.342702319978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342796578412
                                         uncertainty =       0.003595084927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342796578412
                                         uncertainty =       0.003595084927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413936067
  error estimate for blocks of size 2^( 2) =       0.000426354985
  error estimate for blocks of size 2^( 3) =       0.000440214575
  error estimate for blocks of size 2^( 4) =       0.000452744983
  error estimate for blocks of size 2^( 5) =       0.000463687333
  error estimate for blocks of size 2^( 6) =       0.000471401542
  error estimate for blocks of size 2^( 7) =       0.000476262583

      target function =                  N/A
              le_mean =     -16.906625105473
             les_mean =     286.176658421463
             stat err =       0.000466024110
             autocorr =       1.267506611036
              std dev =       0.585394000485
             le_variance =       0.342686135804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342778933678
                                         uncertainty =       0.003594851793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342778933678
                                         uncertainty =       0.003594851793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413925416
  error estimate for blocks of size 2^( 2) =       0.000426344563
  error estimate for blocks of size 2^( 3) =       0.000440204495
  error estimate for blocks of size 2^( 4) =       0.000452735052
  error estimate for blocks of size 2^( 5) =       0.000463677629
  error estimate for blocks of size 2^( 6) =       0.000471392359
  error estimate for blocks of size 2^( 7) =       0.000476253445

      target function =                  N/A
              le_mean =     -16.906624911130
             les_mean =     286.176634214865
             stat err =       0.000466014621
             autocorr =       1.267520223274
              std dev =       0.585378937577
             le_variance =       0.342668500558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906624883175        initial
     2.5000e+00     2.5000e+01             8.3187e-05       -16.906625292973  <--
     1.0000e+01     1.0000e+02             2.1838e-05       -16.906625105473
     4.0000e+01     4.0000e+02             5.5316e-06       -16.906624911130

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9604e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.096501e-01 1 1  ON 0
 uu_1                 1.427441e-01 1 1  ON 1
 uu_2                 4.080577e-02 1 1  ON 2
 uu_3                -2.214640e-02 1 1  ON 3
 uu_4                -6.808548e-02 1 1  ON 4
 uu_5                -1.036169e-01 1 1  ON 5
 uu_6                -1.316525e-01 1 1  ON 6
 uu_7                -1.464659e-01 1 1  ON 7
 uu_8                -1.394231e-01 1 1  ON 8
 uu_9                -1.117704e-01 1 1  ON 9
 ud_0                 4.546543e-01 1 1  ON 10
 ud_1                 1.883167e-01 1 1  ON 11
 ud_2                 6.682674e-02 1 1  ON 12
 ud_3                -5.285760e-03 1 1  ON 13
 ud_4                -6.299885e-02 1 1  ON 14
 ud_5                -1.052612e-01 1 1  ON 15
 ud_6                -1.337572e-01 1 1  ON 16
 ud_7                -1.516026e-01 1 1  ON 17
 ud_8                -1.530746e-01 1 1  ON 18
 ud_9                -1.456368e-01 1 1  ON 19
 eO_0                -7.633221e-01 1 1  ON 20
 eO_1                -4.400990e-01 1 1  ON 21
 eO_2                -1.723025e-02 1 1  ON 22
 eO_3                 3.066660e-01 1 1  ON 23
 eO_4                 5.355908e-01 1 1  ON 24
 eO_5                 4.998740e-01 1 1  ON 25
 eO_6                 2.702020e-01 1 1  ON 26
 eO_7                -3.706008e-02 1 1  ON 27
 eO_8                -2.402496e-01 1 1  ON 28
 eO_9                -1.091341e-01 1 1  ON 29
eH1_0                -2.560315e-01 1 1  ON 30
eH1_1                -1.547213e-01 1 1  ON 31
eH1_2                -1.073936e-01 1 1  ON 32
eH1_3                -5.249747e-02 1 1  ON 33
eH1_4                -3.353692e-03 1 1  ON 34
eH1_5                 3.199182e-02 1 1  ON 35
eH1_6                 9.324138e-02 1 1  ON 36
eH1_7                 1.552890e-01 1 1  ON 37
eH1_8                 1.954753e-01 1 1  ON 38
eH1_9                 9.707636e-02 1 1  ON 39
eH2_0                -2.535001e-01 1 1  ON 40
eH2_1                -1.518748e-01 1 1  ON 41
eH2_2                -1.044613e-01 1 1  ON 42
eH2_3                -4.979031e-02 1 1  ON 43
eH2_4                -1.061843e-03 1 1  ON 44
eH2_5                 3.369939e-02 1 1  ON 45
eH2_6                 9.500406e-02 1 1  ON 46
eH2_7                 1.557057e-01 1 1  ON 47
eH2_8                 1.984216e-01 1 1  ON 48
eH2_9                 9.085718e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8678
    reference variance = 0.444009
====================================================
  Execution time = 2.0315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348520835176
                                         uncertainty =       0.005808099210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348520835176
                                         uncertainty =       0.005808099210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417440758
  error estimate for blocks of size 2^( 2) =       0.000430244804
  error estimate for blocks of size 2^( 3) =       0.000443395734
  error estimate for blocks of size 2^( 4) =       0.000455367064
  error estimate for blocks of size 2^( 5) =       0.000466086756
  error estimate for blocks of size 2^( 6) =       0.000474148124
  error estimate for blocks of size 2^( 7) =       0.000482931020

      target function =                  N/A
              le_mean =     -16.905876748692
             les_mean =     286.157182041055
             stat err =       0.000469633241
             autocorr =       1.265691770598
              std dev =       0.590350381849
             le_variance =       0.348513573349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587674869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876748692       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905877724121       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905877176328       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905877033576       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876623232       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905876983737       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905877176464       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905877403397       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905877312749       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.487123e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876748692       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905877018271       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876914305       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876823234       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876674070       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905876772432       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905876791292       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905876840794       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.352713e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876748692       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876817912       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876794248       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876768408       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876726566       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905876749738       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905876751977       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905876763100       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.418267e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5892e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.096520e-01 1 1  ON 0
 uu_1                 1.427205e-01 1 1  ON 1
 uu_2                 4.080492e-02 1 1  ON 2
 uu_3                -2.216171e-02 1 1  ON 3
 uu_4                -6.809303e-02 1 1  ON 4
 uu_5                -1.036476e-01 1 1  ON 5
 uu_6                -1.316432e-01 1 1  ON 6
 uu_7                -1.464876e-01 1 1  ON 7
 uu_8                -1.394160e-01 1 1  ON 8
 uu_9                -1.117508e-01 1 1  ON 9
 ud_0                 4.546657e-01 1 1  ON 10
 ud_1                 1.882874e-01 1 1  ON 11
 ud_2                 6.681435e-02 1 1  ON 12
 ud_3                -5.299480e-03 1 1  ON 13
 ud_4                -6.301234e-02 1 1  ON 14
 ud_5                -1.052599e-01 1 1  ON 15
 ud_6                -1.337483e-01 1 1  ON 16
 ud_7                -1.515678e-01 1 1  ON 17
 ud_8                -1.530693e-01 1 1  ON 18
 ud_9                -1.456127e-01 1 1  ON 19
 eO_0                -7.633264e-01 1 1  ON 20
 eO_1                -4.400903e-01 1 1  ON 21
 eO_2                -1.718519e-02 1 1  ON 22
 eO_3                 3.066577e-01 1 1  ON 23
 eO_4                 5.355739e-01 1 1  ON 24
 eO_5                 4.998826e-01 1 1  ON 25
 eO_6                 2.702266e-01 1 1  ON 26
 eO_7                -3.705538e-02 1 1  ON 27
 eO_8                -2.402570e-01 1 1  ON 28
 eO_9                -1.091774e-01 1 1  ON 29
eH1_0                -2.560263e-01 1 1  ON 30
eH1_1                -1.548133e-01 1 1  ON 31
eH1_2                -1.073976e-01 1 1  ON 32
eH1_3                -5.249698e-02 1 1  ON 33
eH1_4                -3.406926e-03 1 1  ON 34
eH1_5                 3.195490e-02 1 1  ON 35
eH1_6                 9.326270e-02 1 1  ON 36
eH1_7                 1.553143e-01 1 1  ON 37
eH1_8                 1.955058e-01 1 1  ON 38
eH1_9                 9.716197e-02 1 1  ON 39
eH2_0                -2.535936e-01 1 1  ON 40
eH2_1                -1.518828e-01 1 1  ON 41
eH2_2                -1.044522e-01 1 1  ON 42
eH2_3                -4.980347e-02 1 1  ON 43
eH2_4                -1.062083e-03 1 1  ON 44
eH2_5                 3.368944e-02 1 1  ON 45
eH2_6                 9.497608e-02 1 1  ON 46
eH2_7                 1.557317e-01 1 1  ON 47
eH2_8                 1.984478e-01 1 1  ON 48
eH2_9                 9.093099e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8918
    reference variance = 0.209167
====================================================
  Execution time = 1.9990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3628e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336335623407
                                         uncertainty =       0.002316563046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336335623407
                                         uncertainty =       0.002316563046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410040731
  error estimate for blocks of size 2^( 2) =       0.000422245713
  error estimate for blocks of size 2^( 3) =       0.000434141979
  error estimate for blocks of size 2^( 4) =       0.000445151457
  error estimate for blocks of size 2^( 5) =       0.000453936043
  error estimate for blocks of size 2^( 6) =       0.000459800584
  error estimate for blocks of size 2^( 7) =       0.000463737270

      target function =                  N/A
              le_mean =     -16.906813199414
             les_mean =     286.176599194608
             stat err =       0.000455656339
             autocorr =       1.234868843180
              std dev =       0.579885163500
             le_variance =       0.336266802848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336358198546
                                         uncertainty =       0.002316881313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336358198546
                                         uncertainty =       0.002316881313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410054520
  error estimate for blocks of size 2^( 2) =       0.000422258763
  error estimate for blocks of size 2^( 3) =       0.000434156306
  error estimate for blocks of size 2^( 4) =       0.000445167478
  error estimate for blocks of size 2^( 5) =       0.000453952501
  error estimate for blocks of size 2^( 6) =       0.000459814795
  error estimate for blocks of size 2^( 7) =       0.000463749803

      target function =                  N/A
              le_mean =     -16.906813964155
             les_mean =     286.176647669215
             stat err =       0.000455671144
             autocorr =       1.234866040209
              std dev =       0.579904663542
             le_variance =       0.336289418798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359311804
                                         uncertainty =       0.002316813686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359311804
                                         uncertainty =       0.002316813686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410055193
  error estimate for blocks of size 2^( 2) =       0.000422259373
  error estimate for blocks of size 2^( 3) =       0.000434156156
  error estimate for blocks of size 2^( 4) =       0.000445166472
  error estimate for blocks of size 2^( 5) =       0.000453951185
  error estimate for blocks of size 2^( 6) =       0.000459814314
  error estimate for blocks of size 2^( 7) =       0.000463750070

      target function =                  N/A
              le_mean =     -16.906813706265
             les_mean =     286.176640052833
             stat err =       0.000455670510
             autocorr =       1.234858551825
              std dev =       0.579905615270
             le_variance =       0.336290522622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339126949
                                         uncertainty =       0.002316598853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339126949
                                         uncertainty =       0.002316598853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410042870
  error estimate for blocks of size 2^( 2) =       0.000422247731
  error estimate for blocks of size 2^( 3) =       0.000434144061
  error estimate for blocks of size 2^( 4) =       0.000445153650
  error estimate for blocks of size 2^( 5) =       0.000453938242
  error estimate for blocks of size 2^( 6) =       0.000459802579
  error estimate for blocks of size 2^( 7) =       0.000463739151

      target function =                  N/A
              le_mean =     -16.906813262930
             les_mean =     286.176604850405
             stat err =       0.000455658405
             autocorr =       1.234867162953
              std dev =       0.579888188321
             le_variance =       0.336270310954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906813199414        initial
     6.2500e-01     6.2500e+00             3.4871e-04       -16.906813964155  <--
     2.5000e+00     2.5000e+01             9.3527e-05       -16.906813706265
     1.0000e+01     1.0000e+02             2.4183e-05       -16.906813262930

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9573e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.096470e-01 1 1  ON 0
 uu_1                 1.426715e-01 1 1  ON 1
 uu_2                 4.078815e-02 1 1  ON 2
 uu_3                -2.220426e-02 1 1  ON 3
 uu_4                -6.812700e-02 1 1  ON 4
 uu_5                -1.037167e-01 1 1  ON 5
 uu_6                -1.316315e-01 1 1  ON 6
 uu_7                -1.465494e-01 1 1  ON 7
 uu_8                -1.393967e-01 1 1  ON 8
 uu_9                -1.116931e-01 1 1  ON 9
 ud_0                 4.546639e-01 1 1  ON 10
 ud_1                 1.882234e-01 1 1  ON 11
 ud_2                 6.678026e-02 1 1  ON 12
 ud_3                -5.332215e-03 1 1  ON 13
 ud_4                -6.303831e-02 1 1  ON 14
 ud_5                -1.052559e-01 1 1  ON 15
 ud_6                -1.337234e-01 1 1  ON 16
 ud_7                -1.514760e-01 1 1  ON 17
 ud_8                -1.530528e-01 1 1  ON 18
 ud_9                -1.455390e-01 1 1  ON 19
 eO_0                -7.633308e-01 1 1  ON 20
 eO_1                -4.400575e-01 1 1  ON 21
 eO_2                -1.708210e-02 1 1  ON 22
 eO_3                 3.066493e-01 1 1  ON 23
 eO_4                 5.355275e-01 1 1  ON 24
 eO_5                 4.999087e-01 1 1  ON 25
 eO_6                 2.703011e-01 1 1  ON 26
 eO_7                -3.704050e-02 1 1  ON 27
 eO_8                -2.402801e-01 1 1  ON 28
 eO_9                -1.093110e-01 1 1  ON 29
eH1_0                -2.560377e-01 1 1  ON 30
eH1_1                -1.550347e-01 1 1  ON 31
eH1_2                -1.074267e-01 1 1  ON 32
eH1_3                -5.251841e-02 1 1  ON 33
eH1_4                -3.548615e-03 1 1  ON 34
eH1_5                 3.183897e-02 1 1  ON 35
eH1_6                 9.331707e-02 1 1  ON 36
eH1_7                 1.553887e-01 1 1  ON 37
eH1_8                 1.956003e-01 1 1  ON 38
eH1_9                 9.742508e-02 1 1  ON 39
eH2_0                -2.538446e-01 1 1  ON 40
eH2_1                -1.519135e-01 1 1  ON 41
eH2_2                -1.044521e-01 1 1  ON 42
eH2_3                -4.984007e-02 1 1  ON 43
eH2_4                -1.080834e-03 1 1  ON 44
eH2_5                 3.366527e-02 1 1  ON 45
eH2_6                 9.489714e-02 1 1  ON 46
eH2_7                 1.558108e-01 1 1  ON 47
eH2_8                 1.985275e-01 1 1  ON 48
eH2_9                 9.115757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8701
    reference variance = 0.19589
====================================================
  Execution time = 2.0499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357133136295
                                         uncertainty =       0.014456073671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357133136295
                                         uncertainty =       0.014456073671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422502228
  error estimate for blocks of size 2^( 2) =       0.000435466545
  error estimate for blocks of size 2^( 3) =       0.000448438931
  error estimate for blocks of size 2^( 4) =       0.000460578969
  error estimate for blocks of size 2^( 5) =       0.000471793488
  error estimate for blocks of size 2^( 6) =       0.000479822367
  error estimate for blocks of size 2^( 7) =       0.000487585875

      target function =                  N/A
              le_mean =     -16.905885775621
             les_mean =     286.165989945675
             stat err =       0.000474945175
             autocorr =       1.263656255824
              std dev =       0.597508381394
             le_variance =       0.357016265837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588577562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905885775621       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905889062005       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905889549110       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890021814       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905889827516       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890690927       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890549147       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891231977       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905891286276       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905890941849       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905891034094       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.392447e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905885775621       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887062124       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887459934       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905887707718       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905887752660       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905887737868       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905887829724       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905887753700       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905887829953       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.515372e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905885775621       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905886150242       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905886341157       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886410034       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886468000       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886437338       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905886437206       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905886434647       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.601676e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.095720e-01 1 1  ON 0
 uu_1                 1.426501e-01 1 1  ON 1
 uu_2                 4.064960e-02 1 1  ON 2
 uu_3                -2.232156e-02 1 1  ON 3
 uu_4                -6.829198e-02 1 1  ON 4
 uu_5                -1.037241e-01 1 1  ON 5
 uu_6                -1.317866e-01 1 1  ON 6
 uu_7                -1.464709e-01 1 1  ON 7
 uu_8                -1.392882e-01 1 1  ON 8
 uu_9                -1.115278e-01 1 1  ON 9
 ud_0                 4.546245e-01 1 1  ON 10
 ud_1                 1.881350e-01 1 1  ON 11
 ud_2                 6.679492e-02 1 1  ON 12
 ud_3                -5.321488e-03 1 1  ON 13
 ud_4                -6.304475e-02 1 1  ON 14
 ud_5                -1.052286e-01 1 1  ON 15
 ud_6                -1.337616e-01 1 1  ON 16
 ud_7                -1.514571e-01 1 1  ON 17
 ud_8                -1.529578e-01 1 1  ON 18
 ud_9                -1.454812e-01 1 1  ON 19
 eO_0                -7.632187e-01 1 1  ON 20
 eO_1                -4.400256e-01 1 1  ON 21
 eO_2                -1.715337e-02 1 1  ON 22
 eO_3                 3.066860e-01 1 1  ON 23
 eO_4                 5.356023e-01 1 1  ON 24
 eO_5                 4.998663e-01 1 1  ON 25
 eO_6                 2.703828e-01 1 1  ON 26
 eO_7                -3.701189e-02 1 1  ON 27
 eO_8                -2.403152e-01 1 1  ON 28
 eO_9                -1.094966e-01 1 1  ON 29
eH1_0                -2.562937e-01 1 1  ON 30
eH1_1                -1.550840e-01 1 1  ON 31
eH1_2                -1.075210e-01 1 1  ON 32
eH1_3                -5.259823e-02 1 1  ON 33
eH1_4                -3.631130e-03 1 1  ON 34
eH1_5                 3.177725e-02 1 1  ON 35
eH1_6                 9.319239e-02 1 1  ON 36
eH1_7                 1.554914e-01 1 1  ON 37
eH1_8                 1.957696e-01 1 1  ON 38
eH1_9                 9.777661e-02 1 1  ON 39
eH2_0                -2.539352e-01 1 1  ON 40
eH2_1                -1.519647e-01 1 1  ON 41
eH2_2                -1.045723e-01 1 1  ON 42
eH2_3                -4.996005e-02 1 1  ON 43
eH2_4                -1.088550e-03 1 1  ON 44
eH2_5                 3.356527e-02 1 1  ON 45
eH2_6                 9.485519e-02 1 1  ON 46
eH2_7                 1.558259e-01 1 1  ON 47
eH2_8                 1.986543e-01 1 1  ON 48
eH2_9                 9.150194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9995
    reference variance = 0.485739
====================================================
  Execution time = 2.0134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4372e-01
  Total weights = 2.0000e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343363882658
                                         uncertainty =       0.006175971054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343363882658
                                         uncertainty =       0.006175971054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414552678
  error estimate for blocks of size 2^( 2) =       0.000427230840
  error estimate for blocks of size 2^( 3) =       0.000440200140
  error estimate for blocks of size 2^( 4) =       0.000452135065
  error estimate for blocks of size 2^( 5) =       0.000462816288
  error estimate for blocks of size 2^( 6) =       0.000471158118
  error estimate for blocks of size 2^( 7) =       0.000474544967

      target function =                  N/A
              le_mean =     -16.905720365610
             les_mean =     286.147088754420
             stat err =       0.000465163609
             autocorr =       1.259076195046
              std dev =       0.586266019878
             le_variance =       0.343707846064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343371818265
                                         uncertainty =       0.006179294451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343371818265
                                         uncertainty =       0.006179294451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414557852
  error estimate for blocks of size 2^( 2) =       0.000427239029
  error estimate for blocks of size 2^( 3) =       0.000440213580
  error estimate for blocks of size 2^( 4) =       0.000452154729
  error estimate for blocks of size 2^( 5) =       0.000462833889
  error estimate for blocks of size 2^( 6) =       0.000471165673
  error estimate for blocks of size 2^( 7) =       0.000474547762

      target function =                  N/A
              le_mean =     -16.905722452301
             les_mean =     286.147167887352
             stat err =       0.000465175513
             autocorr =       1.259109209610
              std dev =       0.586273336390
             le_variance =       0.343716424961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397579650
                                         uncertainty =       0.006179739422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343397579650
                                         uncertainty =       0.006179739422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414573379
  error estimate for blocks of size 2^( 2) =       0.000427252883
  error estimate for blocks of size 2^( 3) =       0.000440224923
  error estimate for blocks of size 2^( 4) =       0.000452164521
  error estimate for blocks of size 2^( 5) =       0.000462843480
  error estimate for blocks of size 2^( 6) =       0.000471177840
  error estimate for blocks of size 2^( 7) =       0.000474561997

      target function =                  N/A
              le_mean =     -16.905722257199
             les_mean =     286.147187039316
             stat err =       0.000465186959
             autocorr =       1.259076852785
              std dev =       0.586295295593
             le_variance =       0.343742173635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343377492764
                                         uncertainty =       0.006176650595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343377492764
                                         uncertainty =       0.006176650595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414560951
  error estimate for blocks of size 2^( 2) =       0.000427239031
  error estimate for blocks of size 2^( 3) =       0.000440208411
  error estimate for blocks of size 2^( 4) =       0.000452143879
  error estimate for blocks of size 2^( 5) =       0.000462824569
  error estimate for blocks of size 2^( 6) =       0.000471165285
  error estimate for blocks of size 2^( 7) =       0.000474551820

      target function =                  N/A
              le_mean =     -16.905720632880
             les_mean =     286.147111509431
             stat err =       0.000465171388
             autocorr =       1.259068053888
              std dev =       0.586277719447
             le_variance =       0.343721564320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905720365610        initial
     1.5625e-01     1.5625e+00             1.3924e-03       -16.905722452301  <--
     6.2500e-01     6.2500e+00             3.5154e-04       -16.905722257199
     2.5000e+00     2.5000e+01             8.6017e-05       -16.905720632880

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9709e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424409e-01 1 1  ON 1
 uu_2                 4.035073e-02 1 1  ON 2
 uu_3                -2.262853e-02 1 1  ON 3
 uu_4                -6.861463e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320303e-01 1 1  ON 6
 uu_7                -1.463940e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545299e-01 1 1  ON 10
 ud_1                 1.880334e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308366e-03 1 1  ON 13
 ud_4                -6.304030e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514808e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.630002e-01 1 1  ON 20
 eO_1                -4.398946e-01 1 1  ON 21
 eO_2                -1.719182e-02 1 1  ON 22
 eO_3                 3.067127e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404216e-01 1 1  ON 28
 eO_9                -1.100409e-01 1 1  ON 29
eH1_0                -2.568779e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285332e-02 1 1  ON 33
eH1_4                -3.899596e-03 1 1  ON 34
eH1_5                 3.156562e-02 1 1  ON 35
eH1_6                 9.284640e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962646e-01 1 1  ON 38
eH1_9                 9.881752e-02 1 1  ON 39
eH2_0                -2.541973e-01 1 1  ON 40
eH2_1                -1.521772e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021344e-02 1 1  ON 43
eH2_4                -1.229897e-03 1 1  ON 44
eH2_5                 3.330001e-02 1 1  ON 45
eH2_6                 9.473290e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990256e-01 1 1  ON 48
eH2_9                 9.252037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.985
    reference variance = 0.529042
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4488e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344930758873
                                         uncertainty =       0.004649502745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344930758873
                                         uncertainty =       0.004649502745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415258259
  error estimate for blocks of size 2^( 2) =       0.000427822321
  error estimate for blocks of size 2^( 3) =       0.000440431734
  error estimate for blocks of size 2^( 4) =       0.000451438319
  error estimate for blocks of size 2^( 5) =       0.000460558900
  error estimate for blocks of size 2^( 6) =       0.000467063353
  error estimate for blocks of size 2^( 7) =       0.000472370256

      target function =                  N/A
              le_mean =     -16.906219301258
             les_mean =     286.165129732727
             stat err =       0.000462857707
             autocorr =       1.242391416456
              std dev =       0.587263861422
             le_variance =       0.344878842933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621930126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906219301258       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222178003       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220319786       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906219666944       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906218069750       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219791830       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222895810       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222067590       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906223831211       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906224262204       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906225994953       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906225982135       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906224746433       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906224702594       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.204601e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906219301258       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221221947       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220549776       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906219166941       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906218849150       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219830376       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221154096       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220688827       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906221206459       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906221184925       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906221293844       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.056002e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906219301258       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220125815       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220307114       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906219971247       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906219114808       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219816256       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906219846990       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906219927707       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906219898482       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.659872e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6207e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.090530e-01 1 1  ON 0
 uu_1                 1.422179e-01 1 1  ON 1
 uu_2                 4.044839e-02 1 1  ON 2
 uu_3                -2.266728e-02 1 1  ON 3
 uu_4                -6.827154e-02 1 1  ON 4
 uu_5                -1.038022e-01 1 1  ON 5
 uu_6                -1.322293e-01 1 1  ON 6
 uu_7                -1.464478e-01 1 1  ON 7
 uu_8                -1.393703e-01 1 1  ON 8
 uu_9                -1.112389e-01 1 1  ON 9
 ud_0                 4.547386e-01 1 1  ON 10
 ud_1                 1.885377e-01 1 1  ON 11
 ud_2                 6.704942e-02 1 1  ON 12
 ud_3                -5.215968e-03 1 1  ON 13
 ud_4                -6.288672e-02 1 1  ON 14
 ud_5                -1.054069e-01 1 1  ON 15
 ud_6                -1.336393e-01 1 1  ON 16
 ud_7                -1.512695e-01 1 1  ON 17
 ud_8                -1.533388e-01 1 1  ON 18
 ud_9                -1.457640e-01 1 1  ON 19
 eO_0                -7.627798e-01 1 1  ON 20
 eO_1                -4.396506e-01 1 1  ON 21
 eO_2                -1.668434e-02 1 1  ON 22
 eO_3                 3.069298e-01 1 1  ON 23
 eO_4                 5.358327e-01 1 1  ON 24
 eO_5                 4.999544e-01 1 1  ON 25
 eO_6                 2.705578e-01 1 1  ON 26
 eO_7                -3.687378e-02 1 1  ON 27
 eO_8                -2.408400e-01 1 1  ON 28
 eO_9                -1.109370e-01 1 1  ON 29
eH1_0                -2.574257e-01 1 1  ON 30
eH1_1                -1.554629e-01 1 1  ON 31
eH1_2                -1.082126e-01 1 1  ON 32
eH1_3                -5.322717e-02 1 1  ON 33
eH1_4                -4.103602e-03 1 1  ON 34
eH1_5                 3.144036e-02 1 1  ON 35
eH1_6                 9.321893e-02 1 1  ON 36
eH1_7                 1.557906e-01 1 1  ON 37
eH1_8                 1.965611e-01 1 1  ON 38
eH1_9                 9.965320e-02 1 1  ON 39
eH2_0                -2.542288e-01 1 1  ON 40
eH2_1                -1.525888e-01 1 1  ON 41
eH2_2                -1.051920e-01 1 1  ON 42
eH2_3                -5.027200e-02 1 1  ON 43
eH2_4                -1.680403e-03 1 1  ON 44
eH2_5                 3.351871e-02 1 1  ON 45
eH2_6                 9.489013e-02 1 1  ON 46
eH2_7                 1.554874e-01 1 1  ON 47
eH2_8                 1.990691e-01 1 1  ON 48
eH2_9                 9.357637e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9229
    reference variance = 0.230766
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336908797791
                                         uncertainty =       0.003131187987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336908797791
                                         uncertainty =       0.003131187987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410483919
  error estimate for blocks of size 2^( 2) =       0.000423432137
  error estimate for blocks of size 2^( 3) =       0.000436353574
  error estimate for blocks of size 2^( 4) =       0.000448009559
  error estimate for blocks of size 2^( 5) =       0.000457891362
  error estimate for blocks of size 2^( 6) =       0.000464917201
  error estimate for blocks of size 2^( 7) =       0.000469599807

      target function =                  N/A
              le_mean =     -16.906216992078
             les_mean =     286.157166910716
             stat err =       0.000460104482
             autocorr =       1.256378892972
              std dev =       0.580511925790
             le_variance =       0.336994095984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336700753645
                                         uncertainty =       0.003127450418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336700753645
                                         uncertainty =       0.003127450418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356979
  error estimate for blocks of size 2^( 2) =       0.000423304838
  error estimate for blocks of size 2^( 3) =       0.000436218392
  error estimate for blocks of size 2^( 4) =       0.000447870427
  error estimate for blocks of size 2^( 5) =       0.000457757991
  error estimate for blocks of size 2^( 6) =       0.000464795865
  error estimate for blocks of size 2^( 7) =       0.000469485771

      target function =                  N/A
              le_mean =     -16.906212745791
             les_mean =     286.156814938447
             stat err =       0.000459977514
             autocorr =       1.256462566432
              std dev =       0.580332405513
             le_variance =       0.336785700888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336496842840
                                         uncertainty =       0.003124691348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336496842840
                                         uncertainty =       0.003124691348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410232615
  error estimate for blocks of size 2^( 2) =       0.000423187522
  error estimate for blocks of size 2^( 3) =       0.000436105836
  error estimate for blocks of size 2^( 4) =       0.000447761800
  error estimate for blocks of size 2^( 5) =       0.000457651871
  error estimate for blocks of size 2^( 6) =       0.000464697879
  error estimate for blocks of size 2^( 7) =       0.000469391734

      target function =                  N/A
              le_mean =     -16.906212838867
             les_mean =     286.156613982190
             stat err =       0.000459875821
             autocorr =       1.256668649491
              std dev =       0.580156528359
             le_variance =       0.336581597398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336778533685
                                         uncertainty =       0.003129347032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336778533685
                                         uncertainty =       0.003129347032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410404483
  error estimate for blocks of size 2^( 2) =       0.000423354964
  error estimate for blocks of size 2^( 3) =       0.000436276228
  error estimate for blocks of size 2^( 4) =       0.000447932726
  error estimate for blocks of size 2^( 5) =       0.000457816308
  error estimate for blocks of size 2^( 6) =       0.000464848099
  error estimate for blocks of size 2^( 7) =       0.000469533412

      target function =                  N/A
              le_mean =     -16.906215196473
             les_mean =     286.156975780379
             stat err =       0.000460032636
             autocorr =       1.256472805835
              std dev =       0.580399585934
             le_variance =       0.336863679353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906216992078        initial  <--
     3.9062e-02     3.9062e-01             4.2046e-03       -16.906212745791
     1.5625e-01     1.5625e+00             1.0560e-03       -16.906212838867
     6.2500e-01     6.2500e+00             2.6599e-04       -16.906215196473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7743
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424409e-01 1 1  ON 1
 uu_2                 4.035073e-02 1 1  ON 2
 uu_3                -2.262853e-02 1 1  ON 3
 uu_4                -6.861463e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320303e-01 1 1  ON 6
 uu_7                -1.463940e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545299e-01 1 1  ON 10
 ud_1                 1.880334e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308366e-03 1 1  ON 13
 ud_4                -6.304030e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514808e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.630002e-01 1 1  ON 20
 eO_1                -4.398946e-01 1 1  ON 21
 eO_2                -1.719182e-02 1 1  ON 22
 eO_3                 3.067127e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404216e-01 1 1  ON 28
 eO_9                -1.100409e-01 1 1  ON 29
eH1_0                -2.568779e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285332e-02 1 1  ON 33
eH1_4                -3.899596e-03 1 1  ON 34
eH1_5                 3.156562e-02 1 1  ON 35
eH1_6                 9.284640e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962646e-01 1 1  ON 38
eH1_9                 9.881752e-02 1 1  ON 39
eH2_0                -2.541973e-01 1 1  ON 40
eH2_1                -1.521772e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021344e-02 1 1  ON 43
eH2_4                -1.229897e-03 1 1  ON 44
eH2_5                 3.330001e-02 1 1  ON 45
eH2_6                 9.473290e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990256e-01 1 1  ON 48
eH2_9                 9.252037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9059
    reference variance = 0.315002
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4173e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341765407133
                                         uncertainty =       0.005584974191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341765407133
                                         uncertainty =       0.005584974191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413359480
  error estimate for blocks of size 2^( 2) =       0.000426167824
  error estimate for blocks of size 2^( 3) =       0.000438972185
  error estimate for blocks of size 2^( 4) =       0.000450954468
  error estimate for blocks of size 2^( 5) =       0.000462199795
  error estimate for blocks of size 2^( 6) =       0.000471771910
  error estimate for blocks of size 2^( 7) =       0.000481067092

      target function =                  N/A
              le_mean =     -16.905608805250
             les_mean =     286.141341023898
             stat err =       0.000466498316
             autocorr =       1.273633159119
              std dev =       0.584578582062
             le_variance =       0.341732118606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560880525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905608805250       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905607811237       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905607384926       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905607533360       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608324531       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608480548       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608543945       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905608410445       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905608382948       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.529540e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905608805250       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608465043       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905608294394       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608328186       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608586579       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608561200       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608563394       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905608537989       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.359080e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905608805250       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608711555       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905608661704       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608669591       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608739193       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608727221       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608724060       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905608716827       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.449065e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093302e-01 1 1  ON 0
 uu_1                 1.424098e-01 1 1  ON 1
 uu_2                 4.035409e-02 1 1  ON 2
 uu_3                -2.260611e-02 1 1  ON 3
 uu_4                -6.858425e-02 1 1  ON 4
 uu_5                -1.039398e-01 1 1  ON 5
 uu_6                -1.321417e-01 1 1  ON 6
 uu_7                -1.464441e-01 1 1  ON 7
 uu_8                -1.390066e-01 1 1  ON 8
 uu_9                -1.110004e-01 1 1  ON 9
 ud_0                 4.544672e-01 1 1  ON 10
 ud_1                 1.880619e-01 1 1  ON 11
 ud_2                 6.677451e-02 1 1  ON 12
 ud_3                -5.327676e-03 1 1  ON 13
 ud_4                -6.306324e-02 1 1  ON 14
 ud_5                -1.052408e-01 1 1  ON 15
 ud_6                -1.337458e-01 1 1  ON 16
 ud_7                -1.515230e-01 1 1  ON 17
 ud_8                -1.526936e-01 1 1  ON 18
 ud_9                -1.452236e-01 1 1  ON 19
 eO_0                -7.629790e-01 1 1  ON 20
 eO_1                -4.399012e-01 1 1  ON 21
 eO_2                -1.719534e-02 1 1  ON 22
 eO_3                 3.066726e-01 1 1  ON 23
 eO_4                 5.358501e-01 1 1  ON 24
 eO_5                 4.998388e-01 1 1  ON 25
 eO_6                 2.706442e-01 1 1  ON 26
 eO_7                -3.695927e-02 1 1  ON 27
 eO_8                -2.404261e-01 1 1  ON 28
 eO_9                -1.101150e-01 1 1  ON 29
eH1_0                -2.568860e-01 1 1  ON 30
eH1_1                -1.553925e-01 1 1  ON 31
eH1_2                -1.078410e-01 1 1  ON 32
eH1_3                -5.287115e-02 1 1  ON 33
eH1_4                -3.939664e-03 1 1  ON 34
eH1_5                 3.154479e-02 1 1  ON 35
eH1_6                 9.286044e-02 1 1  ON 36
eH1_7                 1.558516e-01 1 1  ON 37
eH1_8                 1.963104e-01 1 1  ON 38
eH1_9                 9.887329e-02 1 1  ON 39
eH2_0                -2.542099e-01 1 1  ON 40
eH2_1                -1.522226e-01 1 1  ON 41
eH2_2                -1.049420e-01 1 1  ON 42
eH2_3                -5.025408e-02 1 1  ON 43
eH2_4                -1.296105e-03 1 1  ON 44
eH2_5                 3.330660e-02 1 1  ON 45
eH2_6                 9.472886e-02 1 1  ON 46
eH2_7                 1.558844e-01 1 1  ON 47
eH2_8                 1.990682e-01 1 1  ON 48
eH2_9                 9.265628e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8601
    reference variance = 0.358687
====================================================
  Execution time = 1.9837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4393e-01
  Total weights = 2.0000e+06
  Execution time = 1.8943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343853642390
                                         uncertainty =       0.005118944277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343853642390
                                         uncertainty =       0.005118944277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414726906
  error estimate for blocks of size 2^( 2) =       0.000427093396
  error estimate for blocks of size 2^( 3) =       0.000439907654
  error estimate for blocks of size 2^( 4) =       0.000452499445
  error estimate for blocks of size 2^( 5) =       0.000463520153
  error estimate for blocks of size 2^( 6) =       0.000473529672
  error estimate for blocks of size 2^( 7) =       0.000480002922

      target function =                  N/A
              le_mean =     -16.905962483577
             les_mean =     286.155564137164
             stat err =       0.000467388048
             autocorr =       1.270079135753
              std dev =       0.586512415083
             le_variance =       0.343996813047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343710399767
                                         uncertainty =       0.005109517460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343710399767
                                         uncertainty =       0.005109517460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414640581
  error estimate for blocks of size 2^( 2) =       0.000427011453
  error estimate for blocks of size 2^( 3) =       0.000439828469
  error estimate for blocks of size 2^( 4) =       0.000452421704
  error estimate for blocks of size 2^( 5) =       0.000463438889
  error estimate for blocks of size 2^( 6) =       0.000473452183
  error estimate for blocks of size 2^( 7) =       0.000479924219

      target function =                  N/A
              le_mean =     -16.905961798086
             les_mean =     286.155397769348
             stat err =       0.000467309249
             autocorr =       1.270179630264
              std dev =       0.586390333263
             le_variance =       0.343853622944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343716209131
                                         uncertainty =       0.005111072905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343716209131
                                         uncertainty =       0.005111072905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414644074
  error estimate for blocks of size 2^( 2) =       0.000427014591
  error estimate for blocks of size 2^( 3) =       0.000439831771
  error estimate for blocks of size 2^( 4) =       0.000452425489
  error estimate for blocks of size 2^( 5) =       0.000463444301
  error estimate for blocks of size 2^( 6) =       0.000473457555
  error estimate for blocks of size 2^( 7) =       0.000479931529

      target function =                  N/A
              le_mean =     -16.905961845078
             les_mean =     286.155405151549
             stat err =       0.000467314718
             autocorr =       1.270187964413
              std dev =       0.586395273036
             le_variance =       0.343859416239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343832364898
                                         uncertainty =       0.005117744225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343832364898
                                         uncertainty =       0.005117744225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414714083
  error estimate for blocks of size 2^( 2) =       0.000427081169
  error estimate for blocks of size 2^( 3) =       0.000439895874
  error estimate for blocks of size 2^( 4) =       0.000452487977
  error estimate for blocks of size 2^( 5) =       0.000463508448
  error estimate for blocks of size 2^( 6) =       0.000473518555
  error estimate for blocks of size 2^( 7) =       0.000479991997

      target function =                  N/A
              le_mean =     -16.905962381464
             les_mean =     286.155539412348
             stat err =       0.000467376744
             autocorr =       1.270096243350
              std dev =       0.586494280338
             le_variance =       0.343975540869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905962483577        initial  <--
     3.9062e-01     3.9062e+00             5.5295e-04       -16.905961798086
     1.5625e+00     1.5625e+01             1.3591e-04       -16.905961845078
     6.2500e+00     6.2500e+01             3.4491e-05       -16.905962381464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4498
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424409e-01 1 1  ON 1
 uu_2                 4.035073e-02 1 1  ON 2
 uu_3                -2.262853e-02 1 1  ON 3
 uu_4                -6.861463e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320303e-01 1 1  ON 6
 uu_7                -1.463940e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545299e-01 1 1  ON 10
 ud_1                 1.880334e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308366e-03 1 1  ON 13
 ud_4                -6.304030e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514808e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.630002e-01 1 1  ON 20
 eO_1                -4.398946e-01 1 1  ON 21
 eO_2                -1.719182e-02 1 1  ON 22
 eO_3                 3.067127e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404216e-01 1 1  ON 28
 eO_9                -1.100409e-01 1 1  ON 29
eH1_0                -2.568779e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285332e-02 1 1  ON 33
eH1_4                -3.899596e-03 1 1  ON 34
eH1_5                 3.156562e-02 1 1  ON 35
eH1_6                 9.284640e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962646e-01 1 1  ON 38
eH1_9                 9.881752e-02 1 1  ON 39
eH2_0                -2.541973e-01 1 1  ON 40
eH2_1                -1.521772e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021344e-02 1 1  ON 43
eH2_4                -1.229897e-03 1 1  ON 44
eH2_5                 3.330001e-02 1 1  ON 45
eH2_6                 9.473290e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990256e-01 1 1  ON 48
eH2_9                 9.252037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8256
    reference variance = 0.673947
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3598e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336028368502
                                         uncertainty =       0.002991880206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336028368502
                                         uncertainty =       0.002991880206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409866004
  error estimate for blocks of size 2^( 2) =       0.000422849260
  error estimate for blocks of size 2^( 3) =       0.000436381514
  error estimate for blocks of size 2^( 4) =       0.000448582422
  error estimate for blocks of size 2^( 5) =       0.000458661575
  error estimate for blocks of size 2^( 6) =       0.000466230305
  error estimate for blocks of size 2^( 7) =       0.000469962020

      target function =                  N/A
              le_mean =     -16.906644377567
             les_mean =     286.170604224807
             stat err =       0.000460859081
             autocorr =       1.264306882680
              std dev =       0.579638062318
             le_variance =       0.335980283288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664437757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906644377567       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906644616188       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906644729488       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906644786455       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906644951583       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906644925925       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906644951644       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906644914972       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.717970e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906644377567       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906644438698       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906644467737       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906644483914       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906644528179       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906644522129       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906644528732       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906644519622       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.688226e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906644377567       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906644392945       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906644400253       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906644404428       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906644415694       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906644414214       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906644415886       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906644413619       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.226038e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5922e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.093237e-01 1 1  ON 0
 uu_1                 1.424388e-01 1 1  ON 1
 uu_2                 4.034929e-02 1 1  ON 2
 uu_3                -2.262640e-02 1 1  ON 3
 uu_4                -6.861328e-02 1 1  ON 4
 uu_5                -1.039016e-01 1 1  ON 5
 uu_6                -1.320253e-01 1 1  ON 6
 uu_7                -1.463892e-01 1 1  ON 7
 uu_8                -1.390426e-01 1 1  ON 8
 uu_9                -1.110410e-01 1 1  ON 9
 ud_0                 4.545302e-01 1 1  ON 10
 ud_1                 1.880448e-01 1 1  ON 11
 ud_2                 6.678510e-02 1 1  ON 12
 ud_3                -5.304985e-03 1 1  ON 13
 ud_4                -6.303700e-02 1 1  ON 14
 ud_5                -1.052218e-01 1 1  ON 15
 ud_6                -1.337815e-01 1 1  ON 16
 ud_7                -1.514869e-01 1 1  ON 17
 ud_8                -1.527678e-01 1 1  ON 18
 ud_9                -1.453086e-01 1 1  ON 19
 eO_0                -7.629960e-01 1 1  ON 20
 eO_1                -4.398857e-01 1 1  ON 21
 eO_2                -1.718867e-02 1 1  ON 22
 eO_3                 3.067132e-01 1 1  ON 23
 eO_4                 5.357785e-01 1 1  ON 24
 eO_5                 4.998081e-01 1 1  ON 25
 eO_6                 2.706145e-01 1 1  ON 26
 eO_7                -3.695388e-02 1 1  ON 27
 eO_8                -2.404283e-01 1 1  ON 28
 eO_9                -1.100511e-01 1 1  ON 29
eH1_0                -2.568797e-01 1 1  ON 30
eH1_1                -1.552950e-01 1 1  ON 31
eH1_2                -1.078413e-01 1 1  ON 32
eH1_3                -5.285718e-02 1 1  ON 33
eH1_4                -3.897799e-03 1 1  ON 34
eH1_5                 3.156538e-02 1 1  ON 35
eH1_6                 9.284727e-02 1 1  ON 36
eH1_7                 1.557756e-01 1 1  ON 37
eH1_8                 1.962661e-01 1 1  ON 38
eH1_9                 9.882377e-02 1 1  ON 39
eH2_0                -2.541985e-01 1 1  ON 40
eH2_1                -1.521862e-01 1 1  ON 41
eH2_2                -1.048841e-01 1 1  ON 42
eH2_3                -5.021496e-02 1 1  ON 43
eH2_4                -1.234070e-03 1 1  ON 44
eH2_5                 3.329574e-02 1 1  ON 45
eH2_6                 9.473035e-02 1 1  ON 46
eH2_7                 1.558665e-01 1 1  ON 47
eH2_8                 1.990316e-01 1 1  ON 48
eH2_9                 9.253725e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8339
    reference variance = 0.175379
====================================================
  Execution time = 2.2559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4115e-01
  Total weights = 2.0000e+06
  Execution time = 1.8967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340925202614
                                         uncertainty =       0.002760042451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340925202614
                                         uncertainty =       0.002760042451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413011524
  error estimate for blocks of size 2^( 2) =       0.000425713247
  error estimate for blocks of size 2^( 3) =       0.000439333545
  error estimate for blocks of size 2^( 4) =       0.000451890055
  error estimate for blocks of size 2^( 5) =       0.000462302239
  error estimate for blocks of size 2^( 6) =       0.000469693107
  error estimate for blocks of size 2^( 7) =       0.000474425450

      target function =                  N/A
              le_mean =     -16.904859933001
             les_mean =     286.115446222127
             stat err =       0.000464577713
             autocorr =       1.265296781928
              std dev =       0.584086498993
             le_variance =       0.341157038306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340902820771
                                         uncertainty =       0.002759817635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340902820771
                                         uncertainty =       0.002759817635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412997979
  error estimate for blocks of size 2^( 2) =       0.000425699983
  error estimate for blocks of size 2^( 3) =       0.000439320322
  error estimate for blocks of size 2^( 4) =       0.000451876905
  error estimate for blocks of size 2^( 5) =       0.000462289304
  error estimate for blocks of size 2^( 6) =       0.000469680631
  error estimate for blocks of size 2^( 7) =       0.000474413928

      target function =                  N/A
              le_mean =     -16.904859913059
             les_mean =     286.115423171497
             stat err =       0.000464565192
             autocorr =       1.265311571920
              std dev =       0.584067343634
             le_variance =       0.341134661900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340912647268
                                         uncertainty =       0.002759916862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340912647268
                                         uncertainty =       0.002759916862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413003926
  error estimate for blocks of size 2^( 2) =       0.000425705819
  error estimate for blocks of size 2^( 3) =       0.000439326162
  error estimate for blocks of size 2^( 4) =       0.000451882721
  error estimate for blocks of size 2^( 5) =       0.000462295034
  error estimate for blocks of size 2^( 6) =       0.000469686135
  error estimate for blocks of size 2^( 7) =       0.000474418981

      target function =                  N/A
              le_mean =     -16.904859926029
             les_mean =     286.115433433140
             stat err =       0.000464570718
             autocorr =       1.265305236128
              std dev =       0.584075752846
             le_variance =       0.341144485063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340923584830
                                         uncertainty =       0.002760026294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340923584830
                                         uncertainty =       0.002760026294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413010545
  error estimate for blocks of size 2^( 2) =       0.000425712290
  error estimate for blocks of size 2^( 3) =       0.000439332595
  error estimate for blocks of size 2^( 4) =       0.000451889111
  error estimate for blocks of size 2^( 5) =       0.000462301312
  error estimate for blocks of size 2^( 6) =       0.000469692210
  error estimate for blocks of size 2^( 7) =       0.000474424616

      target function =                  N/A
              le_mean =     -16.904859932125
             les_mean =     286.115444574946
             stat err =       0.000464576812
             autocorr =       1.265297875275
              std dev =       0.584085114313
             le_variance =       0.341155420763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904859933001        initial  <--
     3.9062e+00     3.9062e+01             6.7180e-05       -16.904859913059
     1.5625e+01     1.5625e+02             1.6882e-05       -16.904859926029
     6.2500e+01     6.2500e+02             4.2260e-06       -16.904859932125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1619
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424409e-01 1 1  ON 1
 uu_2                 4.035073e-02 1 1  ON 2
 uu_3                -2.262853e-02 1 1  ON 3
 uu_4                -6.861463e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320303e-01 1 1  ON 6
 uu_7                -1.463940e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545299e-01 1 1  ON 10
 ud_1                 1.880334e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308366e-03 1 1  ON 13
 ud_4                -6.304030e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514808e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.630002e-01 1 1  ON 20
 eO_1                -4.398946e-01 1 1  ON 21
 eO_2                -1.719182e-02 1 1  ON 22
 eO_3                 3.067127e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404216e-01 1 1  ON 28
 eO_9                -1.100409e-01 1 1  ON 29
eH1_0                -2.568779e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285332e-02 1 1  ON 33
eH1_4                -3.899596e-03 1 1  ON 34
eH1_5                 3.156562e-02 1 1  ON 35
eH1_6                 9.284640e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962646e-01 1 1  ON 38
eH1_9                 9.881752e-02 1 1  ON 39
eH2_0                -2.541973e-01 1 1  ON 40
eH2_1                -1.521772e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021344e-02 1 1  ON 43
eH2_4                -1.229897e-03 1 1  ON 44
eH2_5                 3.330001e-02 1 1  ON 45
eH2_6                 9.473290e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990256e-01 1 1  ON 48
eH2_9                 9.252037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8964
    reference variance = 0.257286
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345408980393
                                         uncertainty =       0.006015341844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345408980393
                                         uncertainty =       0.006015341844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415572625
  error estimate for blocks of size 2^( 2) =       0.000428097244
  error estimate for blocks of size 2^( 3) =       0.000441066702
  error estimate for blocks of size 2^( 4) =       0.000453311673
  error estimate for blocks of size 2^( 5) =       0.000462461066
  error estimate for blocks of size 2^( 6) =       0.000471418648
  error estimate for blocks of size 2^( 7) =       0.000474939599

      target function =                  N/A
              le_mean =     -16.906224905625
             les_mean =     286.165841600502
             stat err =       0.000465532747
             autocorr =       1.254892743930
              std dev =       0.587708442716
             le_variance =       0.345401213640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622490562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224905625       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224920191       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224907893       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224914664       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224914735       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224917144       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224916249       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.642392e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224905625       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224909278       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224906196       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224907894       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224907909       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224908513       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224908293       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.161680e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224905625       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224906539       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224905768       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224906192       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224906196       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224906347       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224906292       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.904872e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6225e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.093232e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035096e-02 1 1  ON 2
 uu_3                -2.262852e-02 1 1  ON 3
 uu_4                -6.861450e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320301e-01 1 1  ON 6
 uu_7                -1.463945e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545298e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677860e-02 1 1  ON 12
 ud_3                -5.308314e-03 1 1  ON 13
 ud_4                -6.304002e-02 1 1  ON 14
 ud_5                -1.052243e-01 1 1  ON 15
 ud_6                -1.337747e-01 1 1  ON 16
 ud_7                -1.514811e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453066e-01 1 1  ON 19
 eO_0                -7.629995e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719129e-02 1 1  ON 22
 eO_3                 3.067119e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998053e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695345e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100417e-01 1 1  ON 29
eH1_0                -2.568787e-01 1 1  ON 30
eH1_1                -1.552944e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285331e-02 1 1  ON 33
eH1_4                -3.899620e-03 1 1  ON 34
eH1_5                 3.156519e-02 1 1  ON 35
eH1_6                 9.284648e-02 1 1  ON 36
eH1_7                 1.557767e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881859e-02 1 1  ON 39
eH2_0                -2.541978e-01 1 1  ON 40
eH2_1                -1.521783e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021338e-02 1 1  ON 43
eH2_4                -1.230258e-03 1 1  ON 44
eH2_5                 3.330041e-02 1 1  ON 45
eH2_6                 9.473279e-02 1 1  ON 46
eH2_7                 1.558651e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252153e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.877
    reference variance = 0.249619
====================================================
  Execution time = 2.0141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3286e-01
  Total weights = 2.0000e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332931364556
                                         uncertainty =       0.002887524748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332931364556
                                         uncertainty =       0.002887524748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407960344
  error estimate for blocks of size 2^( 2) =       0.000420829681
  error estimate for blocks of size 2^( 3) =       0.000433963720
  error estimate for blocks of size 2^( 4) =       0.000446534998
  error estimate for blocks of size 2^( 5) =       0.000457343109
  error estimate for blocks of size 2^( 6) =       0.000465277143
  error estimate for blocks of size 2^( 7) =       0.000469468958

      target function =                  N/A
              le_mean =     -16.905511518838
             les_mean =     286.129182831136
             stat err =       0.000459656052
             autocorr =       1.269492289115
              std dev =       0.576943050908
             le_variance =       0.332863283991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332928994250
                                         uncertainty =       0.002887495506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332928994250
                                         uncertainty =       0.002887495506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407958893
  error estimate for blocks of size 2^( 2) =       0.000420828241
  error estimate for blocks of size 2^( 3) =       0.000433962259
  error estimate for blocks of size 2^( 4) =       0.000446533597
  error estimate for blocks of size 2^( 5) =       0.000457341709
  error estimate for blocks of size 2^( 6) =       0.000465275723
  error estimate for blocks of size 2^( 7) =       0.000469467483

      target function =                  N/A
              le_mean =     -16.905511512569
             les_mean =     286.129180251321
             stat err =       0.000459654628
             autocorr =       1.269493452985
              std dev =       0.576940998835
             le_variance =       0.332860916137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332930167914
                                         uncertainty =       0.002887509949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332930167914
                                         uncertainty =       0.002887509949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407959611
  error estimate for blocks of size 2^( 2) =       0.000420828954
  error estimate for blocks of size 2^( 3) =       0.000433962982
  error estimate for blocks of size 2^( 4) =       0.000446534291
  error estimate for blocks of size 2^( 5) =       0.000457342402
  error estimate for blocks of size 2^( 6) =       0.000465276426
  error estimate for blocks of size 2^( 7) =       0.000469468213

      target function =                  N/A
              le_mean =     -16.905511515560
             les_mean =     286.129181524871
             stat err =       0.000459655333
             autocorr =       1.269492876121
              std dev =       0.576942014926
             le_variance =       0.332862088587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332931214600
                                         uncertainty =       0.002887522893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332931214600
                                         uncertainty =       0.002887522893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407960252
  error estimate for blocks of size 2^( 2) =       0.000420829590
  error estimate for blocks of size 2^( 3) =       0.000433963627
  error estimate for blocks of size 2^( 4) =       0.000446534909
  error estimate for blocks of size 2^( 5) =       0.000457343020
  error estimate for blocks of size 2^( 6) =       0.000465277053
  error estimate for blocks of size 2^( 7) =       0.000469468865

      target function =                  N/A
              le_mean =     -16.905511518423
             les_mean =     286.129182667278
             stat err =       0.000459655962
             autocorr =       1.269492362649
              std dev =       0.576942921085
             le_variance =       0.332863134190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905511518838        initial  <--
     3.9062e+01     3.9062e+02             4.6424e-06       -16.905511512569
     1.5625e+02     1.5625e+03             1.1617e-06       -16.905511515560
     6.2500e+02     6.2500e+03             2.9049e-07       -16.905511518423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7256
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424409e-01 1 1  ON 1
 uu_2                 4.035073e-02 1 1  ON 2
 uu_3                -2.262853e-02 1 1  ON 3
 uu_4                -6.861463e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320303e-01 1 1  ON 6
 uu_7                -1.463940e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545299e-01 1 1  ON 10
 ud_1                 1.880334e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308366e-03 1 1  ON 13
 ud_4                -6.304030e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514808e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.630002e-01 1 1  ON 20
 eO_1                -4.398946e-01 1 1  ON 21
 eO_2                -1.719182e-02 1 1  ON 22
 eO_3                 3.067127e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404216e-01 1 1  ON 28
 eO_9                -1.100409e-01 1 1  ON 29
eH1_0                -2.568779e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285332e-02 1 1  ON 33
eH1_4                -3.899596e-03 1 1  ON 34
eH1_5                 3.156562e-02 1 1  ON 35
eH1_6                 9.284640e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962646e-01 1 1  ON 38
eH1_9                 9.881752e-02 1 1  ON 39
eH2_0                -2.541973e-01 1 1  ON 40
eH2_1                -1.521772e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021344e-02 1 1  ON 43
eH2_4                -1.229897e-03 1 1  ON 44
eH2_5                 3.330001e-02 1 1  ON 45
eH2_6                 9.473290e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990256e-01 1 1  ON 48
eH2_9                 9.252037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.4316
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345919688569
                                         uncertainty =       0.007469691374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345919688569
                                         uncertainty =       0.007469691374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415850688
  error estimate for blocks of size 2^( 2) =       0.000428773086
  error estimate for blocks of size 2^( 3) =       0.000441730369
  error estimate for blocks of size 2^( 4) =       0.000453592722
  error estimate for blocks of size 2^( 5) =       0.000463573002
  error estimate for blocks of size 2^( 6) =       0.000470667296
  error estimate for blocks of size 2^( 7) =       0.000477208291

      target function =                  N/A
              le_mean =     -16.905999531103
             les_mean =     286.158683561731
             stat err =       0.000466260328
             autocorr =       1.257135472189
              std dev =       0.588101682542
             le_variance =       0.345863589009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599953110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905999531103       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905999532938       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905999531978       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905999531689       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905999532050       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905999532288       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905999532312       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 4.540003e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905999531103       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905999531562       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905999531322       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905999531252       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905999531340       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905999531401       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905999531405       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.135069e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905999531103       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905999531218       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905999531158       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905999531140       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905999531162       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905999531177       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905999531180       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 2.837714e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6149e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424408e-01 1 1  ON 1
 uu_2                 4.035078e-02 1 1  ON 2
 uu_3                -2.262851e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320303e-01 1 1  ON 6
 uu_7                -1.463940e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545299e-01 1 1  ON 10
 ud_1                 1.880335e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308376e-03 1 1  ON 13
 ud_4                -6.304037e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453069e-01 1 1  ON 19
 eO_0                -7.630001e-01 1 1  ON 20
 eO_1                -4.398946e-01 1 1  ON 21
 eO_2                -1.719183e-02 1 1  ON 22
 eO_3                 3.067128e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404216e-01 1 1  ON 28
 eO_9                -1.100410e-01 1 1  ON 29
eH1_0                -2.568780e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285334e-02 1 1  ON 33
eH1_4                -3.899640e-03 1 1  ON 34
eH1_5                 3.156561e-02 1 1  ON 35
eH1_6                 9.284641e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962646e-01 1 1  ON 38
eH1_9                 9.881762e-02 1 1  ON 39
eH2_0                -2.541974e-01 1 1  ON 40
eH2_1                -1.521773e-01 1 1  ON 41
eH2_2                -1.048811e-01 1 1  ON 42
eH2_3                -5.021350e-02 1 1  ON 43
eH2_4                -1.229907e-03 1 1  ON 44
eH2_5                 3.330004e-02 1 1  ON 45
eH2_6                 9.473286e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990256e-01 1 1  ON 48
eH2_9                 9.252048e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.485525
====================================================
  Execution time = 2.0109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3683e-01
  Total weights = 2.0000e+06
  Execution time = 1.8958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850965360
                                         uncertainty =       0.003248451967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850965360
                                         uncertainty =       0.003248451967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410384255
  error estimate for blocks of size 2^( 2) =       0.000423288060
  error estimate for blocks of size 2^( 3) =       0.000436864011
  error estimate for blocks of size 2^( 4) =       0.000449928710
  error estimate for blocks of size 2^( 5) =       0.000460253786
  error estimate for blocks of size 2^( 6) =       0.000467502678
  error estimate for blocks of size 2^( 7) =       0.000473568315

      target function =                  N/A
              le_mean =     -16.905973142731
             les_mean =     286.148758207027
             stat err =       0.000462813372
             autocorr =       1.271833962879
              std dev =       0.580370978527
             le_variance =       0.336830472717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850627723
                                         uncertainty =       0.003248449116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850627723
                                         uncertainty =       0.003248449116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410384049
  error estimate for blocks of size 2^( 2) =       0.000423287863
  error estimate for blocks of size 2^( 3) =       0.000436863823
  error estimate for blocks of size 2^( 4) =       0.000449928527
  error estimate for blocks of size 2^( 5) =       0.000460253611
  error estimate for blocks of size 2^( 6) =       0.000467502518
  error estimate for blocks of size 2^( 7) =       0.000473568148

      target function =                  N/A
              le_mean =     -16.905973142742
             les_mean =     286.148757869734
             stat err =       0.000462813201
             autocorr =       1.271834296688
              std dev =       0.580370687600
             le_variance =       0.336830135025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850796375
                                         uncertainty =       0.003248450540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850796375
                                         uncertainty =       0.003248450540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410384152
  error estimate for blocks of size 2^( 2) =       0.000423287962
  error estimate for blocks of size 2^( 3) =       0.000436863917
  error estimate for blocks of size 2^( 4) =       0.000449928619
  error estimate for blocks of size 2^( 5) =       0.000460253698
  error estimate for blocks of size 2^( 6) =       0.000467502598
  error estimate for blocks of size 2^( 7) =       0.000473568231

      target function =                  N/A
              le_mean =     -16.905973142736
             les_mean =     286.148758038197
             stat err =       0.000462813286
             autocorr =       1.271834129948
              std dev =       0.580370832920
             le_variance =       0.336830303705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850944232
                                         uncertainty =       0.003248451789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850944232
                                         uncertainty =       0.003248451789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410384242
  error estimate for blocks of size 2^( 2) =       0.000423288048
  error estimate for blocks of size 2^( 3) =       0.000436863999
  error estimate for blocks of size 2^( 4) =       0.000449928699
  error estimate for blocks of size 2^( 5) =       0.000460253775
  error estimate for blocks of size 2^( 6) =       0.000467502668
  error estimate for blocks of size 2^( 7) =       0.000473568305

      target function =                  N/A
              le_mean =     -16.905973142731
             les_mean =     286.148758185917
             stat err =       0.000462813361
             autocorr =       1.271833983771
              std dev =       0.580370960322
             le_variance =       0.336830451585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905973142731        initial
     3.9062e+02     3.9062e+03             4.5400e-07       -16.905973142742  <--
     1.5625e+03     1.5625e+04             1.1351e-07       -16.905973142736
     6.2500e+03     6.2500e+04             2.8377e-08       -16.905973142731

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9701e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035091e-02 1 1  ON 2
 uu_3                -2.262845e-02 1 1  ON 3
 uu_4                -6.861470e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677877e-02 1 1  ON 12
 ud_3                -5.308406e-03 1 1  ON 13
 ud_4                -6.304058e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337755e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100412e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285342e-02 1 1  ON 33
eH1_4                -3.899773e-03 1 1  ON 34
eH1_5                 3.156558e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881792e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229937e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252082e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.176127
====================================================
  Execution time = 2.0602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8434e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384465614629
                                         uncertainty =       0.036789731571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384465614629
                                         uncertainty =       0.036789731571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438374776
  error estimate for blocks of size 2^( 2) =       0.000450506068
  error estimate for blocks of size 2^( 3) =       0.000463268747
  error estimate for blocks of size 2^( 4) =       0.000474888723
  error estimate for blocks of size 2^( 5) =       0.000485688162
  error estimate for blocks of size 2^( 6) =       0.000493643396
  error estimate for blocks of size 2^( 7) =       0.000497741871

      target function =                  N/A
              le_mean =     -16.905861267470
             les_mean =     286.192489892102
             stat err =       0.000487990538
             autocorr =       1.239172273877
              std dev =       0.619955554322
             le_variance =       0.384344889335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586126747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905861267470       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905861270715       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905861272087       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905861272637       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905861266879       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905861264544       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905861265108       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905861265389       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.138110e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905861267470       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905861268282       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905861268625       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905861268764       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905861267322       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905861266735       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905861266875       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905861266945       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.346174e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905861267470       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905861267673       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905861267759       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905861267793       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905861267433       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905861267286       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905861267321       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905861267336       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.336600e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6153e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035102e-02 1 1  ON 2
 uu_3                -2.262838e-02 1 1  ON 3
 uu_4                -6.861485e-02 1 1  ON 4
 uu_5                -1.038998e-01 1 1  ON 5
 uu_6                -1.320307e-01 1 1  ON 6
 uu_7                -1.463942e-01 1 1  ON 7
 uu_8                -1.390386e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677856e-02 1 1  ON 12
 ud_3                -5.308295e-03 1 1  ON 13
 ud_4                -6.304068e-02 1 1  ON 14
 ud_5                -1.052231e-01 1 1  ON 15
 ud_6                -1.337751e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719209e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998053e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100416e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552945e-01 1 1  ON 31
eH1_2                -1.078398e-01 1 1  ON 32
eH1_3                -5.285336e-02 1 1  ON 33
eH1_4                -3.899870e-03 1 1  ON 34
eH1_5                 3.156566e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962649e-01 1 1  ON 38
eH1_9                 9.881821e-02 1 1  ON 39
eH2_0                -2.541975e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021380e-02 1 1  ON 43
eH2_4                -1.230246e-03 1 1  ON 44
eH2_5                 3.330008e-02 1 1  ON 45
eH2_6                 9.473264e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.275196
====================================================
  Execution time = 2.0020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3343e-01
  Total weights = 2.0000e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406466984
                                         uncertainty =       0.002766084565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406466984
                                         uncertainty =       0.002766084565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309172
  error estimate for blocks of size 2^( 2) =       0.000420881830
  error estimate for blocks of size 2^( 3) =       0.000434020199
  error estimate for blocks of size 2^( 4) =       0.000446245298
  error estimate for blocks of size 2^( 5) =       0.000457994148
  error estimate for blocks of size 2^( 6) =       0.000467703964
  error estimate for blocks of size 2^( 7) =       0.000475648691

      target function =                  N/A
              le_mean =     -16.906236538113
             les_mean =     286.154266475876
             stat err =       0.000461898025
             autocorr =       1.279716999791
              std dev =       0.577436368753
             le_variance =       0.333432759958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406101113
                                         uncertainty =       0.002766088723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406101113
                                         uncertainty =       0.002766088723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408308949
  error estimate for blocks of size 2^( 2) =       0.000420881613
  error estimate for blocks of size 2^( 3) =       0.000434019971
  error estimate for blocks of size 2^( 4) =       0.000446245070
  error estimate for blocks of size 2^( 5) =       0.000457993886
  error estimate for blocks of size 2^( 6) =       0.000467703703
  error estimate for blocks of size 2^( 7) =       0.000475648360

      target function =                  N/A
              le_mean =     -16.906236521391
             les_mean =     286.154265545918
             stat err =       0.000461897755
             autocorr =       1.279716901837
              std dev =       0.577436053110
             le_variance =       0.333432395432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406282912
                                         uncertainty =       0.002766086653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406282912
                                         uncertainty =       0.002766086653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309060
  error estimate for blocks of size 2^( 2) =       0.000420881721
  error estimate for blocks of size 2^( 3) =       0.000434020084
  error estimate for blocks of size 2^( 4) =       0.000446245183
  error estimate for blocks of size 2^( 5) =       0.000457994016
  error estimate for blocks of size 2^( 6) =       0.000467703833
  error estimate for blocks of size 2^( 7) =       0.000475648525

      target function =                  N/A
              le_mean =     -16.906236529713
             les_mean =     286.154266008450
             stat err =       0.000461897889
             autocorr =       1.279716950961
              std dev =       0.577436209950
             le_variance =       0.333432576562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406443936
                                         uncertainty =       0.002766084826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406443936
                                         uncertainty =       0.002766084826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309158
  error estimate for blocks of size 2^( 2) =       0.000420881816
  error estimate for blocks of size 2^( 3) =       0.000434020185
  error estimate for blocks of size 2^( 4) =       0.000446245284
  error estimate for blocks of size 2^( 5) =       0.000457994131
  error estimate for blocks of size 2^( 6) =       0.000467703947
  error estimate for blocks of size 2^( 7) =       0.000475648670

      target function =                  N/A
              le_mean =     -16.906236537062
             les_mean =     286.154266417358
             stat err =       0.000461898008
             autocorr =       1.279716993685
              std dev =       0.577436348869
             le_variance =       0.333432736995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906236538113        initial  <--
     9.7656e+01     9.7656e+02             2.1381e-06       -16.906236521391
     3.9062e+02     3.9062e+03             5.3462e-07       -16.906236529713
     1.5625e+03     1.5625e+04             1.3366e-07       -16.906236537062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5814
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035091e-02 1 1  ON 2
 uu_3                -2.262845e-02 1 1  ON 3
 uu_4                -6.861470e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677877e-02 1 1  ON 12
 ud_3                -5.308406e-03 1 1  ON 13
 ud_4                -6.304058e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337755e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100412e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285342e-02 1 1  ON 33
eH1_4                -3.899773e-03 1 1  ON 34
eH1_5                 3.156558e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881792e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229937e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252082e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5744e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.360306
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4388e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343947276022
                                         uncertainty =       0.011130707049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343947276022
                                         uncertainty =       0.011130707049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414656501
  error estimate for blocks of size 2^( 2) =       0.000427114376
  error estimate for blocks of size 2^( 3) =       0.000439716921
  error estimate for blocks of size 2^( 4) =       0.000451742778
  error estimate for blocks of size 2^( 5) =       0.000461081798
  error estimate for blocks of size 2^( 6) =       0.000466987276
  error estimate for blocks of size 2^( 7) =       0.000469246201

      target function =                  N/A
              le_mean =     -16.906436585687
             les_mean =     286.171477881079
             stat err =       0.000462264513
             autocorr =       1.242808322871
              std dev =       0.586412847038
             le_variance =       0.343880027171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643658569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436585687       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436585831       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436587161       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436587281       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436587482       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436587323       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436587136       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436587238       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.453403e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436585687       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436585723       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436586055       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436586085       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436586134       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436586075       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436586060       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436586074       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 6.133925e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436585687       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436585696       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436585779       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436585786       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436585799       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436585794       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436585766       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436585770       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.533507e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6016e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035092e-02 1 1  ON 2
 uu_3                -2.262841e-02 1 1  ON 3
 uu_4                -6.861466e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463942e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308410e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719189e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695340e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899795e-03 1 1  ON 34
eH1_5                 3.156559e-02 1 1  ON 35
eH1_6                 9.284646e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881795e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021370e-02 1 1  ON 43
eH2_4                -1.229999e-03 1 1  ON 44
eH2_5                 3.330015e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252087e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8733
    reference variance = 0.159493
====================================================
  Execution time = 2.0292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4230e-01
  Total weights = 2.0000e+06
  Execution time = 1.8917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372906119
                                         uncertainty =       0.004876384823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372906119
                                         uncertainty =       0.004876384823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413702153
  error estimate for blocks of size 2^( 2) =       0.000426473009
  error estimate for blocks of size 2^( 3) =       0.000440039983
  error estimate for blocks of size 2^( 4) =       0.000452652890
  error estimate for blocks of size 2^( 5) =       0.000463312302
  error estimate for blocks of size 2^( 6) =       0.000469368044
  error estimate for blocks of size 2^( 7) =       0.000474147620

      target function =                  N/A
              le_mean =     -16.906187247084
             les_mean =     286.161466005314
             stat err =       0.000464870214
             autocorr =       1.262664231508
              std dev =       0.585063195730
             le_variance =       0.342298942998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372818347
                                         uncertainty =       0.004876381118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372818347
                                         uncertainty =       0.004876381118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413702100
  error estimate for blocks of size 2^( 2) =       0.000426472959
  error estimate for blocks of size 2^( 3) =       0.000440039936
  error estimate for blocks of size 2^( 4) =       0.000452652843
  error estimate for blocks of size 2^( 5) =       0.000463312259
  error estimate for blocks of size 2^( 6) =       0.000469368000
  error estimate for blocks of size 2^( 7) =       0.000474147579

      target function =                  N/A
              le_mean =     -16.906187246910
             les_mean =     286.161465911813
             stat err =       0.000464870170
             autocorr =       1.262664317077
              std dev =       0.585063120846
             le_variance =       0.342298855374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372862218
                                         uncertainty =       0.004876382970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372862218
                                         uncertainty =       0.004876382970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413702127
  error estimate for blocks of size 2^( 2) =       0.000426472984
  error estimate for blocks of size 2^( 3) =       0.000440039959
  error estimate for blocks of size 2^( 4) =       0.000452652866
  error estimate for blocks of size 2^( 5) =       0.000463312281
  error estimate for blocks of size 2^( 6) =       0.000469368022
  error estimate for blocks of size 2^( 7) =       0.000474147599

      target function =                  N/A
              le_mean =     -16.906187246997
             les_mean =     286.161465958547
             stat err =       0.000464870192
             autocorr =       1.262664274314
              std dev =       0.585063158275
             le_variance =       0.342298899170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372900631
                                         uncertainty =       0.004876384591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342372900631
                                         uncertainty =       0.004876384591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413702150
  error estimate for blocks of size 2^( 2) =       0.000426473006
  error estimate for blocks of size 2^( 3) =       0.000440039980
  error estimate for blocks of size 2^( 4) =       0.000452652887
  error estimate for blocks of size 2^( 5) =       0.000463312299
  error estimate for blocks of size 2^( 6) =       0.000469368042
  error estimate for blocks of size 2^( 7) =       0.000474147617

      target function =                  N/A
              le_mean =     -16.906187247073
             les_mean =     286.161465999468
             stat err =       0.000464870211
             autocorr =       1.262664236856
              std dev =       0.585063191047
             le_variance =       0.342298937519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906187247084        initial  <--
     9.7656e+02     9.7656e+03             2.4534e-07       -16.906187246910
     3.9062e+03     3.9062e+04             6.1339e-08       -16.906187246997
     1.5625e+04     1.5625e+05             1.5335e-08       -16.906187247073

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8851
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035091e-02 1 1  ON 2
 uu_3                -2.262845e-02 1 1  ON 3
 uu_4                -6.861470e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677877e-02 1 1  ON 12
 ud_3                -5.308406e-03 1 1  ON 13
 ud_4                -6.304058e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337755e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100412e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285342e-02 1 1  ON 33
eH1_4                -3.899773e-03 1 1  ON 34
eH1_5                 3.156558e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881792e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229937e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252082e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9652
    reference variance = 0.870061
====================================================
  Execution time = 2.0267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3385e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769238925
                                         uncertainty =       0.002488369560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333769238925
                                         uncertainty =       0.002488369560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408563100
  error estimate for blocks of size 2^( 2) =       0.000421470643
  error estimate for blocks of size 2^( 3) =       0.000434633209
  error estimate for blocks of size 2^( 4) =       0.000447522400
  error estimate for blocks of size 2^( 5) =       0.000457980338
  error estimate for blocks of size 2^( 6) =       0.000465563782
  error estimate for blocks of size 2^( 7) =       0.000470472771

      target function =                  N/A
              le_mean =     -16.905277250966
             les_mean =     286.122246379204
             stat err =       0.000460384823
             autocorr =       1.269766061211
              std dev =       0.577795477748
             le_variance =       0.333847614106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690527725097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277250966       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277251107       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277251143       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277251128       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277251144       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277251170       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277251176       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277251181       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.732692e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277250966       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277251001       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277251010       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277251006       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277251017       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277251046       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277251030       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277251066       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.331790e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277250966       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277250975       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277250977       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277251042       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277250976       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277251012       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277250897       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277250835       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.082951e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5794e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035092e-02 1 1  ON 2
 uu_3                -2.262845e-02 1 1  ON 3
 uu_4                -6.861470e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677877e-02 1 1  ON 12
 ud_3                -5.308406e-03 1 1  ON 13
 ud_4                -6.304058e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337755e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100412e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285342e-02 1 1  ON 33
eH1_4                -3.899773e-03 1 1  ON 34
eH1_5                 3.156558e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881793e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229941e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252083e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.150667
====================================================
  Execution time = 1.9857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4450e-01
  Total weights = 2.0000e+06
  Execution time = 1.8748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586424474
                                         uncertainty =       0.005234170564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586424474
                                         uncertainty =       0.005234170564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415030011
  error estimate for blocks of size 2^( 2) =       0.000427348441
  error estimate for blocks of size 2^( 3) =       0.000440482464
  error estimate for blocks of size 2^( 4) =       0.000452963909
  error estimate for blocks of size 2^( 5) =       0.000463434544
  error estimate for blocks of size 2^( 6) =       0.000471836018
  error estimate for blocks of size 2^( 7) =       0.000475516393

      target function =                  N/A
              le_mean =     -16.906474768529
             les_mean =     286.173388746075
             stat err =       0.000465937716
             autocorr =       1.260366148154
              std dev =       0.586941069806
             le_variance =       0.344499819425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586420350
                                         uncertainty =       0.005234170391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586420350
                                         uncertainty =       0.005234170391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415030008
  error estimate for blocks of size 2^( 2) =       0.000427348439
  error estimate for blocks of size 2^( 3) =       0.000440482462
  error estimate for blocks of size 2^( 4) =       0.000452963907
  error estimate for blocks of size 2^( 5) =       0.000463434542
  error estimate for blocks of size 2^( 6) =       0.000471836016
  error estimate for blocks of size 2^( 7) =       0.000475516392

      target function =                  N/A
              le_mean =     -16.906474768691
             les_mean =     286.173388747436
             stat err =       0.000465937714
             autocorr =       1.260366153875
              std dev =       0.586941066295
             le_variance =       0.344499815304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586422412
                                         uncertainty =       0.005234170477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586422412
                                         uncertainty =       0.005234170477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415030009
  error estimate for blocks of size 2^( 2) =       0.000427348440
  error estimate for blocks of size 2^( 3) =       0.000440482463
  error estimate for blocks of size 2^( 4) =       0.000452963908
  error estimate for blocks of size 2^( 5) =       0.000463434543
  error estimate for blocks of size 2^( 6) =       0.000471836017
  error estimate for blocks of size 2^( 7) =       0.000475516393

      target function =                  N/A
              le_mean =     -16.906474768610
             les_mean =     286.173388746755
             stat err =       0.000465937715
             autocorr =       1.260366151019
              std dev =       0.586941068050
             le_variance =       0.344499817364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586424216
                                         uncertainty =       0.005234170553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344586424216
                                         uncertainty =       0.005234170553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415030010
  error estimate for blocks of size 2^( 2) =       0.000427348441
  error estimate for blocks of size 2^( 3) =       0.000440482464
  error estimate for blocks of size 2^( 4) =       0.000452963909
  error estimate for blocks of size 2^( 5) =       0.000463434544
  error estimate for blocks of size 2^( 6) =       0.000471836018
  error estimate for blocks of size 2^( 7) =       0.000475516393

      target function =                  N/A
              le_mean =     -16.906474768539
             les_mean =     286.173388746160
             stat err =       0.000465937716
             autocorr =       1.260366148518
              std dev =       0.586941069586
             le_variance =       0.344499819167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906474768529        initial
     9.7656e+03     9.7656e+04             1.7327e-08       -16.906474768691  <--
     3.9062e+04     3.9062e+05             4.3318e-09       -16.906474768610
     1.5625e+05     1.5625e+06             1.0830e-09       -16.906474768539

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.9411e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035093e-02 1 1  ON 2
 uu_3                -2.262846e-02 1 1  ON 3
 uu_4                -6.861469e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677877e-02 1 1  ON 12
 ud_3                -5.308407e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337755e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695342e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100412e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899773e-03 1 1  ON 34
eH1_5                 3.156558e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881794e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229951e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252084e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8699
    reference variance = 0.176837
====================================================
  Execution time = 2.2792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335863098765
                                         uncertainty =       0.003093378584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335863098765
                                         uncertainty =       0.003093378584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409754380
  error estimate for blocks of size 2^( 2) =       0.000423038879
  error estimate for blocks of size 2^( 3) =       0.000436304250
  error estimate for blocks of size 2^( 4) =       0.000448105282
  error estimate for blocks of size 2^( 5) =       0.000457283155
  error estimate for blocks of size 2^( 6) =       0.000465757042
  error estimate for blocks of size 2^( 7) =       0.000469806377

      target function =                  N/A
              le_mean =     -16.906458730698
             les_mean =     286.164143949385
             stat err =       0.000460237964
             autocorr =       1.261588349653
              std dev =       0.579480201977
             le_variance =       0.335797304483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645873070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458730698       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458730835       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458730983       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458731042       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458731275       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458731381       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458731331       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906458731247       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 7.418151e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458730698       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458730733       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458730769       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458730782       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458730837       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458730870       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458730856       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906458730839       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.854651e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458730698       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458730707       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458730716       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458730720       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458730732       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458730733       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458730751       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906458730733       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.636697e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8426e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424407e-01 1 1  ON 1
 uu_2                 4.035093e-02 1 1  ON 2
 uu_3                -2.262845e-02 1 1  ON 3
 uu_4                -6.861468e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677878e-02 1 1  ON 12
 ud_3                -5.308408e-03 1 1  ON 13
 ud_4                -6.304058e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337755e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398945e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899772e-03 1 1  ON 34
eH1_5                 3.156558e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881795e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521774e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229952e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473277e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252085e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8975
    reference variance = 0.479048
====================================================
  Execution time = 2.0055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4156e-01
  Total weights = 2.0000e+06
  Execution time = 1.8718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590783800
                                         uncertainty =       0.003026804209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590783800
                                         uncertainty =       0.003026804209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413253060
  error estimate for blocks of size 2^( 2) =       0.000426060376
  error estimate for blocks of size 2^( 3) =       0.000438740075
  error estimate for blocks of size 2^( 4) =       0.000451215144
  error estimate for blocks of size 2^( 5) =       0.000462697807
  error estimate for blocks of size 2^( 6) =       0.000472557514
  error estimate for blocks of size 2^( 7) =       0.000479318983

      target function =                  N/A
              le_mean =     -16.906053939519
             les_mean =     286.156215818906
             stat err =       0.000466447362
             autocorr =       1.274010847151
              std dev =       0.584428082610
             le_variance =       0.341556183743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590738213
                                         uncertainty =       0.003026803837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590738213
                                         uncertainty =       0.003026803837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413253033
  error estimate for blocks of size 2^( 2) =       0.000426060350
  error estimate for blocks of size 2^( 3) =       0.000438740050
  error estimate for blocks of size 2^( 4) =       0.000451215120
  error estimate for blocks of size 2^( 5) =       0.000462697782
  error estimate for blocks of size 2^( 6) =       0.000472557492
  error estimate for blocks of size 2^( 7) =       0.000479318960

      target function =                  N/A
              le_mean =     -16.906053939853
             les_mean =     286.156215784617
             stat err =       0.000466447338
             autocorr =       1.274010888750
              std dev =       0.584428043623
             le_variance =       0.341556138173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590761002
                                         uncertainty =       0.003026804023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590761002
                                         uncertainty =       0.003026804023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413253047
  error estimate for blocks of size 2^( 2) =       0.000426060363
  error estimate for blocks of size 2^( 3) =       0.000438740062
  error estimate for blocks of size 2^( 4) =       0.000451215132
  error estimate for blocks of size 2^( 5) =       0.000462697794
  error estimate for blocks of size 2^( 6) =       0.000472557503
  error estimate for blocks of size 2^( 7) =       0.000479318971

      target function =                  N/A
              le_mean =     -16.906053939686
             les_mean =     286.156215801759
             stat err =       0.000466447350
             autocorr =       1.274010867955
              std dev =       0.584428063113
             le_variance =       0.341556160954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590780950
                                         uncertainty =       0.003026804186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341590780950
                                         uncertainty =       0.003026804186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413253059
  error estimate for blocks of size 2^( 2) =       0.000426060375
  error estimate for blocks of size 2^( 3) =       0.000438740073
  error estimate for blocks of size 2^( 4) =       0.000451215143
  error estimate for blocks of size 2^( 5) =       0.000462697805
  error estimate for blocks of size 2^( 6) =       0.000472557513
  error estimate for blocks of size 2^( 7) =       0.000479318981

      target function =                  N/A
              le_mean =     -16.906053939540
             les_mean =     286.156215816763
             stat err =       0.000466447361
             autocorr =       1.274010849758
              std dev =       0.584428080173
             le_variance =       0.341556180895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906053939519        initial
     2.4414e+03     2.4414e+04             7.4182e-08       -16.906053939853  <--
     9.7656e+03     9.7656e+04             1.8547e-08       -16.906053939686
     3.9062e+04     3.9062e+05             4.6367e-09       -16.906053939540

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.9603e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035095e-02 1 1  ON 2
 uu_3                -2.262842e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677880e-02 1 1  ON 12
 ud_3                -5.308411e-03 1 1  ON 13
 ud_4                -6.304056e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719186e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285342e-02 1 1  ON 33
eH1_4                -3.899769e-03 1 1  ON 34
eH1_5                 3.156556e-02 1 1  ON 35
eH1_6                 9.284643e-02 1 1  ON 36
eH1_7                 1.557767e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881800e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021370e-02 1 1  ON 43
eH2_4                -1.229955e-03 1 1  ON 44
eH2_5                 3.330012e-02 1 1  ON 45
eH2_6                 9.473276e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.308854
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336941096492
                                         uncertainty =       0.004376315293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336941096492
                                         uncertainty =       0.004376315293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410443804
  error estimate for blocks of size 2^( 2) =       0.000423519422
  error estimate for blocks of size 2^( 3) =       0.000436936016
  error estimate for blocks of size 2^( 4) =       0.000449432997
  error estimate for blocks of size 2^( 5) =       0.000459637450
  error estimate for blocks of size 2^( 6) =       0.000467080394
  error estimate for blocks of size 2^( 7) =       0.000474938233

      target function =                  N/A
              le_mean =     -16.906743047806
             les_mean =     286.174888548711
             stat err =       0.000462772268
             autocorr =       1.271239104823
              std dev =       0.580455194333
             le_variance =       0.336928232628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674304781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743047806       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906743046874       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906743045720       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743045432       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906743045519       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743045835       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906743045868       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906743045838       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 2.952975e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743047806       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906743047573       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906743047284       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743047212       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906743047236       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743047311       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906743047321       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906743047314       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 7.384261e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743047806       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906743047748       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906743047676       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743047658       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906743047663       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743047683       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906743047690       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906743047684       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.846179e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198635 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6124e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035097e-02 1 1  ON 2
 uu_3                -2.262841e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463942e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308394e-03 1 1  ON 13
 ud_4                -6.304056e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695344e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100414e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285344e-02 1 1  ON 33
eH1_4                -3.899786e-03 1 1  ON 34
eH1_5                 3.156552e-02 1 1  ON 35
eH1_6                 9.284643e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881806e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021369e-02 1 1  ON 43
eH2_4                -1.229936e-03 1 1  ON 44
eH2_5                 3.330013e-02 1 1  ON 45
eH2_6                 9.473275e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252094e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8538
    reference variance = 0.520032
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3989e-01
  Total weights = 2.0000e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965451884
                                         uncertainty =       0.003546756659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965451884
                                         uncertainty =       0.003546756659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412245739
  error estimate for blocks of size 2^( 2) =       0.000425196156
  error estimate for blocks of size 2^( 3) =       0.000438583146
  error estimate for blocks of size 2^( 4) =       0.000450947434
  error estimate for blocks of size 2^( 5) =       0.000461631214
  error estimate for blocks of size 2^( 6) =       0.000470500626
  error estimate for blocks of size 2^( 7) =       0.000476973468

      target function =                  N/A
              le_mean =     -16.905438963741
             les_mean =     286.133759484776
             stat err =       0.000465013185
             autocorr =       1.272383958210
              std dev =       0.583003514515
             le_variance =       0.339893097937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965443919
                                         uncertainty =       0.003546758447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965443919
                                         uncertainty =       0.003546758447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412245734
  error estimate for blocks of size 2^( 2) =       0.000425196148
  error estimate for blocks of size 2^( 3) =       0.000438583137
  error estimate for blocks of size 2^( 4) =       0.000450947421
  error estimate for blocks of size 2^( 5) =       0.000461631201
  error estimate for blocks of size 2^( 6) =       0.000470500615
  error estimate for blocks of size 2^( 7) =       0.000476973459

      target function =                  N/A
              le_mean =     -16.905438963322
             les_mean =     286.133759462705
             stat err =       0.000465013174
             autocorr =       1.272383923769
              std dev =       0.583003507759
             le_variance =       0.339893090059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965447884
                                         uncertainty =       0.003546757554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965447884
                                         uncertainty =       0.003546757554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412245736
  error estimate for blocks of size 2^( 2) =       0.000425196152
  error estimate for blocks of size 2^( 3) =       0.000438583142
  error estimate for blocks of size 2^( 4) =       0.000450947427
  error estimate for blocks of size 2^( 5) =       0.000461631208
  error estimate for blocks of size 2^( 6) =       0.000470500620
  error estimate for blocks of size 2^( 7) =       0.000476973463

      target function =                  N/A
              le_mean =     -16.905438963531
             les_mean =     286.133759473718
             stat err =       0.000465013180
             autocorr =       1.272383940989
              std dev =       0.583003511122
             le_variance =       0.339893093980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965451383
                                         uncertainty =       0.003546756771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965451383
                                         uncertainty =       0.003546756771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412245738
  error estimate for blocks of size 2^( 2) =       0.000425196155
  error estimate for blocks of size 2^( 3) =       0.000438583146
  error estimate for blocks of size 2^( 4) =       0.000450947433
  error estimate for blocks of size 2^( 5) =       0.000461631214
  error estimate for blocks of size 2^( 6) =       0.000470500626
  error estimate for blocks of size 2^( 7) =       0.000476973467

      target function =                  N/A
              le_mean =     -16.905438963715
             les_mean =     286.133759483392
             stat err =       0.000465013185
             autocorr =       1.272383956050
              std dev =       0.583003514090
             le_variance =       0.339893097442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905438963741        initial  <--
     6.1035e+02     6.1035e+03             2.9530e-07       -16.905438963322
     2.4414e+03     2.4414e+04             7.3843e-08       -16.905438963531
     9.7656e+03     9.7656e+04             1.8462e-08       -16.905438963715

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9318
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035095e-02 1 1  ON 2
 uu_3                -2.262842e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677880e-02 1 1  ON 12
 ud_3                -5.308411e-03 1 1  ON 13
 ud_4                -6.304056e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719186e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285342e-02 1 1  ON 33
eH1_4                -3.899769e-03 1 1  ON 34
eH1_5                 3.156556e-02 1 1  ON 35
eH1_6                 9.284643e-02 1 1  ON 36
eH1_7                 1.557767e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881800e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021370e-02 1 1  ON 43
eH2_4                -1.229955e-03 1 1  ON 44
eH2_5                 3.330012e-02 1 1  ON 45
eH2_6                 9.473276e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9937
    reference variance = 0.428665
====================================================
  Execution time = 2.0463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3260e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510556654
                                         uncertainty =       0.003006285790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332510556654
                                         uncertainty =       0.003006285790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407796056
  error estimate for blocks of size 2^( 2) =       0.000420826581
  error estimate for blocks of size 2^( 3) =       0.000433962118
  error estimate for blocks of size 2^( 4) =       0.000446414964
  error estimate for blocks of size 2^( 5) =       0.000457622874
  error estimate for blocks of size 2^( 6) =       0.000464870737
  error estimate for blocks of size 2^( 7) =       0.000469882370

      target function =                  N/A
              le_mean =     -16.906772563000
             les_mean =     286.171553576901
             stat err =       0.000459697737
             autocorr =       1.270745817194
              std dev =       0.576710712731
             le_variance =       0.332595246179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690677256300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906772563000       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906772563100       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906772563093       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906772563083       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906772563061       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906772563068       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906772563062       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906772563061       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.849427e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906772563000       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906772563025       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906772563024       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906772563023       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906772563012       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906772563004       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906772563016       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906772563024       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 7.123712e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906772563000       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906772563006       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906772563006       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906772563033       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906772563040       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906772563004       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906772563006       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906772562958       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 1.780938e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6075e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035095e-02 1 1  ON 2
 uu_3                -2.262842e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677880e-02 1 1  ON 12
 ud_3                -5.308410e-03 1 1  ON 13
 ud_4                -6.304056e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404217e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568781e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899771e-03 1 1  ON 34
eH1_5                 3.156556e-02 1 1  ON 35
eH1_6                 9.284643e-02 1 1  ON 36
eH1_7                 1.557767e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881801e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021369e-02 1 1  ON 43
eH2_4                -1.229960e-03 1 1  ON 44
eH2_5                 3.330012e-02 1 1  ON 45
eH2_6                 9.473276e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252090e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9048
    reference variance = 0.121379
====================================================
  Execution time = 1.9945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3940e-01
  Total weights = 2.0000e+06
  Execution time = 1.8790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528111741
                                         uncertainty =       0.003095278643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528111741
                                         uncertainty =       0.003095278643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411945594
  error estimate for blocks of size 2^( 2) =       0.000424267224
  error estimate for blocks of size 2^( 3) =       0.000437248265
  error estimate for blocks of size 2^( 4) =       0.000448962670
  error estimate for blocks of size 2^( 5) =       0.000458072469
  error estimate for blocks of size 2^( 6) =       0.000466885920
  error estimate for blocks of size 2^( 7) =       0.000471197642

      target function =                  N/A
              le_mean =     -16.906120678562
             les_mean =     286.156314573714
             stat err =       0.000461279676
             autocorr =       1.253859614182
              std dev =       0.582579046405
             le_variance =       0.339398345310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528081108
                                         uncertainty =       0.003095278482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528081108
                                         uncertainty =       0.003095278482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411945576
  error estimate for blocks of size 2^( 2) =       0.000424267206
  error estimate for blocks of size 2^( 3) =       0.000437248248
  error estimate for blocks of size 2^( 4) =       0.000448962653
  error estimate for blocks of size 2^( 5) =       0.000458072453
  error estimate for blocks of size 2^( 6) =       0.000466885905
  error estimate for blocks of size 2^( 7) =       0.000471197626

      target function =                  N/A
              le_mean =     -16.906120678732
             les_mean =     286.156314548860
             stat err =       0.000461279659
             autocorr =       1.253859638815
              std dev =       0.582579020128
             le_variance =       0.339398314693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528096424
                                         uncertainty =       0.003095278562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528096424
                                         uncertainty =       0.003095278562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411945585
  error estimate for blocks of size 2^( 2) =       0.000424267215
  error estimate for blocks of size 2^( 3) =       0.000437248256
  error estimate for blocks of size 2^( 4) =       0.000448962662
  error estimate for blocks of size 2^( 5) =       0.000458072461
  error estimate for blocks of size 2^( 6) =       0.000466885913
  error estimate for blocks of size 2^( 7) =       0.000471197634

      target function =                  N/A
              le_mean =     -16.906120678647
             les_mean =     286.156314561286
             stat err =       0.000461279667
             autocorr =       1.253859626496
              std dev =       0.582579033266
             le_variance =       0.339398330001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528109827
                                         uncertainty =       0.003095278633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339528109827
                                         uncertainty =       0.003095278633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411945593
  error estimate for blocks of size 2^( 2) =       0.000424267223
  error estimate for blocks of size 2^( 3) =       0.000437248264
  error estimate for blocks of size 2^( 4) =       0.000448962669
  error estimate for blocks of size 2^( 5) =       0.000458072468
  error estimate for blocks of size 2^( 6) =       0.000466885920
  error estimate for blocks of size 2^( 7) =       0.000471197641

      target function =                  N/A
              le_mean =     -16.906120678573
             les_mean =     286.156314572160
             stat err =       0.000461279675
             autocorr =       1.253859615728
              std dev =       0.582579044762
             le_variance =       0.339398343396


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906120678562        initial
     6.1035e+03     6.1035e+04             2.8494e-08       -16.906120678732  <--
     2.4414e+04     2.4414e+05             7.1237e-09       -16.906120678647
     9.7656e+04     9.7656e+05             1.7809e-09       -16.906120678573

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 2.9529e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035096e-02 1 1  ON 2
 uu_3                -2.262840e-02 1 1  ON 3
 uu_4                -6.861466e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463942e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880337e-01 1 1  ON 11
 ud_2                 6.677880e-02 1 1  ON 12
 ud_3                -5.308407e-03 1 1  ON 13
 ud_4                -6.304056e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568782e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899775e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284643e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881803e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229973e-03 1 1  ON 44
eH2_5                 3.330011e-02 1 1  ON 45
eH2_6                 9.473276e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.827
    reference variance = 0.366503
====================================================
  Execution time = 2.0868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337499540619
                                         uncertainty =       0.004088532489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337499540619
                                         uncertainty =       0.004088532489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410782360
  error estimate for blocks of size 2^( 2) =       0.000423789121
  error estimate for blocks of size 2^( 3) =       0.000436902307
  error estimate for blocks of size 2^( 4) =       0.000448536340
  error estimate for blocks of size 2^( 5) =       0.000459900602
  error estimate for blocks of size 2^( 6) =       0.000469072692
  error estimate for blocks of size 2^( 7) =       0.000473724434

      target function =                  N/A
              le_mean =     -16.906601935944
             les_mean =     286.170673146962
             stat err =       0.000462808517
             autocorr =       1.269343352540
              std dev =       0.580933985264
             le_variance =       0.337484295234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660193594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906601935944       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906601936529       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906601936767       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906601936783       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906601937369       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906601937404       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906601937236       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906601937240       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.260963e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906601935944       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906601936090       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906601936150       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906601936156       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906601936303       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906601936308       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906601936267       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906601936269       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.152921e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906601935944       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906601935981       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906601935996       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906601935996       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906601936030       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906601936036       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906601936010       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906601936013       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 7.882622e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6401e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424406e-01 1 1  ON 1
 uu_2                 4.035097e-02 1 1  ON 2
 uu_3                -2.262838e-02 1 1  ON 3
 uu_4                -6.861466e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880338e-01 1 1  ON 11
 ud_2                 6.677881e-02 1 1  ON 12
 ud_3                -5.308392e-03 1 1  ON 13
 ud_4                -6.304057e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398944e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100413e-01 1 1  ON 29
eH1_0                -2.568782e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899780e-03 1 1  ON 34
eH1_5                 3.156553e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962648e-01 1 1  ON 38
eH1_9                 9.881805e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.229992e-03 1 1  ON 44
eH2_5                 3.330014e-02 1 1  ON 45
eH2_6                 9.473275e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252094e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.0206
    reference variance = 1.48788
====================================================
  Execution time = 2.0331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010398868
                                         uncertainty =       0.005878078714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010398868
                                         uncertainty =       0.005878078714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411153136
  error estimate for blocks of size 2^( 2) =       0.000423942449
  error estimate for blocks of size 2^( 3) =       0.000436619874
  error estimate for blocks of size 2^( 4) =       0.000448800430
  error estimate for blocks of size 2^( 5) =       0.000459843792
  error estimate for blocks of size 2^( 6) =       0.000469943450
  error estimate for blocks of size 2^( 7) =       0.000478126999

      target function =                  N/A
              le_mean =     -16.905711340888
             les_mean =     286.141169574918
             stat err =       0.000464178668
             autocorr =       1.274568384308
              std dev =       0.581458341199
             le_variance =       0.338093802550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010295644
                                         uncertainty =       0.005878078068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010295644
                                         uncertainty =       0.005878078068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411153073
  error estimate for blocks of size 2^( 2) =       0.000423942389
  error estimate for blocks of size 2^( 3) =       0.000436619817
  error estimate for blocks of size 2^( 4) =       0.000448800376
  error estimate for blocks of size 2^( 5) =       0.000459843740
  error estimate for blocks of size 2^( 6) =       0.000469943400
  error estimate for blocks of size 2^( 7) =       0.000478126948

      target function =                  N/A
              le_mean =     -16.905711341921
             les_mean =     286.141169506505
             stat err =       0.000464178616
             autocorr =       1.274568487017
              std dev =       0.581458252326
             le_variance =       0.338093699198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010347242
                                         uncertainty =       0.005878078391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010347242
                                         uncertainty =       0.005878078391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411153105
  error estimate for blocks of size 2^( 2) =       0.000423942419
  error estimate for blocks of size 2^( 3) =       0.000436619846
  error estimate for blocks of size 2^( 4) =       0.000448800403
  error estimate for blocks of size 2^( 5) =       0.000459843766
  error estimate for blocks of size 2^( 6) =       0.000469943425
  error estimate for blocks of size 2^( 7) =       0.000478126974

      target function =                  N/A
              le_mean =     -16.905711341404
             les_mean =     286.141169540699
             stat err =       0.000464178642
             autocorr =       1.274568435674
              std dev =       0.581458296750
             le_variance =       0.338093750860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010392414
                                         uncertainty =       0.005878078673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338010392414
                                         uncertainty =       0.005878078673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411153132
  error estimate for blocks of size 2^( 2) =       0.000423942445
  error estimate for blocks of size 2^( 3) =       0.000436619871
  error estimate for blocks of size 2^( 4) =       0.000448800427
  error estimate for blocks of size 2^( 5) =       0.000459843789
  error estimate for blocks of size 2^( 6) =       0.000469943447
  error estimate for blocks of size 2^( 7) =       0.000478126996

      target function =                  N/A
              le_mean =     -16.905711340952
             les_mean =     286.141169570640
             stat err =       0.000464178665
             autocorr =       1.274568390725
              std dev =       0.581458335643
             le_variance =       0.338093796089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711340888        initial
     1.5259e+03     1.5259e+04             1.2610e-07       -16.905711341921  <--
     6.1035e+03     6.1035e+04             3.1529e-08       -16.905711341404
     2.4414e+04     2.4414e+05             7.8826e-09       -16.905711340952

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.9922e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035098e-02 1 1  ON 2
 uu_3                -2.262832e-02 1 1  ON 3
 uu_4                -6.861468e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677885e-02 1 1  ON 12
 ud_3                -5.308348e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453069e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695340e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100414e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899796e-03 1 1  ON 34
eH1_5                 3.156551e-02 1 1  ON 35
eH1_6                 9.284647e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962649e-01 1 1  ON 38
eH1_9                 9.881812e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021367e-02 1 1  ON 43
eH2_4                -1.230049e-03 1 1  ON 44
eH2_5                 3.330023e-02 1 1  ON 45
eH2_6                 9.473274e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8238
    reference variance = 0.334709
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345165993944
                                         uncertainty =       0.011506217548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345165993944
                                         uncertainty =       0.011506217548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415574860
  error estimate for blocks of size 2^( 2) =       0.000428047497
  error estimate for blocks of size 2^( 3) =       0.000441411881
  error estimate for blocks of size 2^( 4) =       0.000453894665
  error estimate for blocks of size 2^( 5) =       0.000465559802
  error estimate for blocks of size 2^( 6) =       0.000474090841
  error estimate for blocks of size 2^( 7) =       0.000479296518

      target function =                  N/A
              le_mean =     -16.905377173109
             les_mean =     286.137182121097
             stat err =       0.000468210456
             autocorr =       1.269356706202
              std dev =       0.587711603366
             le_variance =       0.345404928732


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537717311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905377173109       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905377173618       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905377173493       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905377174234       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905377174524       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905377174503       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905377174689       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905377174802       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.346641e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905377173109       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905377173236       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905377173205       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905377173390       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905377173463       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905377173457       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905377173504       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905377173531       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.336717e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905377173109       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905377173141       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905377173133       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905377173179       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905377173197       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905377173196       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905377173207       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905377173225       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.341828e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6121e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035098e-02 1 1  ON 2
 uu_3                -2.262828e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320306e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677881e-02 1 1  ON 12
 ud_3                -5.308352e-03 1 1  ON 13
 ud_4                -6.304056e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453069e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067128e-01 1 1  ON 23
 eO_4                 5.357809e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695343e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100415e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285348e-02 1 1  ON 33
eH1_4                -3.899863e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284641e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881826e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521776e-01 1 1  ON 41
eH2_2                -1.048813e-01 1 1  ON 42
eH2_3                -5.021365e-02 1 1  ON 43
eH2_4                -1.230056e-03 1 1  ON 44
eH2_5                 3.330026e-02 1 1  ON 45
eH2_6                 9.473273e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990257e-01 1 1  ON 48
eH2_9                 9.252111e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.0038
    reference variance = 0.411005
====================================================
  Execution time = 2.0093e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4555e-01
  Total weights = 2.0000e+06
  Execution time = 1.8642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654750310
                                         uncertainty =       0.008584031665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654750310
                                         uncertainty =       0.008584031665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415661041
  error estimate for blocks of size 2^( 2) =       0.000428243679
  error estimate for blocks of size 2^( 3) =       0.000441645978
  error estimate for blocks of size 2^( 4) =       0.000454188445
  error estimate for blocks of size 2^( 5) =       0.000464989902
  error estimate for blocks of size 2^( 6) =       0.000473331648
  error estimate for blocks of size 2^( 7) =       0.000481089895

      target function =                  N/A
              le_mean =     -16.905967425031
             les_mean =     286.157282606275
             stat err =       0.000468399972
             autocorr =       1.269857764094
              std dev =       0.587833482228
             le_variance =       0.345548202828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654700053
                                         uncertainty =       0.008584026294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654700053
                                         uncertainty =       0.008584026294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415661011
  error estimate for blocks of size 2^( 2) =       0.000428243647
  error estimate for blocks of size 2^( 3) =       0.000441645943
  error estimate for blocks of size 2^( 4) =       0.000454188410
  error estimate for blocks of size 2^( 5) =       0.000464989866
  error estimate for blocks of size 2^( 6) =       0.000473331603
  error estimate for blocks of size 2^( 7) =       0.000481089854

      target function =                  N/A
              le_mean =     -16.905967424984
             les_mean =     286.157282554172
             stat err =       0.000468399933
             autocorr =       1.269857737444
              std dev =       0.587833439277
             le_variance =       0.345548152332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654725119
                                         uncertainty =       0.008584028977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654725119
                                         uncertainty =       0.008584028977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415661026
  error estimate for blocks of size 2^( 2) =       0.000428243663
  error estimate for blocks of size 2^( 3) =       0.000441645960
  error estimate for blocks of size 2^( 4) =       0.000454188427
  error estimate for blocks of size 2^( 5) =       0.000464989884
  error estimate for blocks of size 2^( 6) =       0.000473331626
  error estimate for blocks of size 2^( 7) =       0.000481089874

      target function =                  N/A
              le_mean =     -16.905967425007
             les_mean =     286.157282580143
             stat err =       0.000468399953
             autocorr =       1.269857750772
              std dev =       0.587833460699
             le_variance =       0.345548177517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654747159
                                         uncertainty =       0.008584031329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654747159
                                         uncertainty =       0.008584031329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415661040
  error estimate for blocks of size 2^( 2) =       0.000428243677
  error estimate for blocks of size 2^( 3) =       0.000441645976
  error estimate for blocks of size 2^( 4) =       0.000454188443
  error estimate for blocks of size 2^( 5) =       0.000464989899
  error estimate for blocks of size 2^( 6) =       0.000473331646
  error estimate for blocks of size 2^( 7) =       0.000481089892

      target function =                  N/A
              le_mean =     -16.905967425028
             les_mean =     286.157282603006
             stat err =       0.000468399970
             autocorr =       1.269857762428
              std dev =       0.587833479535
             le_variance =       0.345548199662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905967425031        initial  <--
     3.8147e+02     3.8147e+03             5.3466e-07       -16.905967424984
     1.5259e+03     1.5259e+04             1.3367e-07       -16.905967425007
     6.1035e+03     6.1035e+04             3.3418e-08       -16.905967425028

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4853
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035098e-02 1 1  ON 2
 uu_3                -2.262832e-02 1 1  ON 3
 uu_4                -6.861468e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545297e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677885e-02 1 1  ON 12
 ud_3                -5.308348e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453069e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998049e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695340e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100414e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285343e-02 1 1  ON 33
eH1_4                -3.899796e-03 1 1  ON 34
eH1_5                 3.156551e-02 1 1  ON 35
eH1_6                 9.284647e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962649e-01 1 1  ON 38
eH1_9                 9.881812e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048812e-01 1 1  ON 42
eH2_3                -5.021367e-02 1 1  ON 43
eH2_4                -1.230049e-03 1 1  ON 44
eH2_5                 3.330023e-02 1 1  ON 45
eH2_6                 9.473274e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8801
    reference variance = 0.207759
====================================================
  Execution time = 2.1786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3722e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337306814587
                                         uncertainty =       0.002767309281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337306814587
                                         uncertainty =       0.002767309281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410622336
  error estimate for blocks of size 2^( 2) =       0.000422799123
  error estimate for blocks of size 2^( 3) =       0.000436110263
  error estimate for blocks of size 2^( 4) =       0.000447821533
  error estimate for blocks of size 2^( 5) =       0.000457775165
  error estimate for blocks of size 2^( 6) =       0.000465924970
  error estimate for blocks of size 2^( 7) =       0.000470508664

      target function =                  N/A
              le_mean =     -16.905885904846
             les_mean =     286.146199463969
             stat err =       0.000460507583
             autocorr =       1.257732937632
              std dev =       0.580707675954
             le_variance =       0.337221404911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588590485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905885904846       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905885904821       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905885904996       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905885904927       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905885904825       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905885904835       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905885904887       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905885904915       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.880825e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905885904846       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905885904840       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905885904884       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905885904867       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905885904831       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905885904857       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905885904841       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905885904877       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.470211e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905885904846       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905885904844       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905885904855       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905885904851       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905885904835       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905885904842       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905885904889       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905885904887       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.675530e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7762e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035098e-02 1 1  ON 2
 uu_3                -2.262832e-02 1 1  ON 3
 uu_4                -6.861468e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463941e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677884e-02 1 1  ON 12
 ud_3                -5.308350e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453069e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719185e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695341e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100414e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552941e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285344e-02 1 1  ON 33
eH1_4                -3.899800e-03 1 1  ON 34
eH1_5                 3.156551e-02 1 1  ON 35
eH1_6                 9.284647e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962649e-01 1 1  ON 38
eH1_9                 9.881813e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048813e-01 1 1  ON 42
eH2_3                -5.021367e-02 1 1  ON 43
eH2_4                -1.230057e-03 1 1  ON 44
eH2_5                 3.330022e-02 1 1  ON 45
eH2_6                 9.473274e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.919
    reference variance = 0.222052
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.6807e-01
  Total weights = 2.0000e+06
  Execution time = 1.8725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152536050
                                         uncertainty =       0.019495561675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152536050
                                         uncertainty =       0.019495561675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428992460
  error estimate for blocks of size 2^( 2) =       0.000441311174
  error estimate for blocks of size 2^( 3) =       0.000453498116
  error estimate for blocks of size 2^( 4) =       0.000465271479
  error estimate for blocks of size 2^( 5) =       0.000475328627
  error estimate for blocks of size 2^( 6) =       0.000483576277
  error estimate for blocks of size 2^( 7) =       0.000488432283

      target function =                  N/A
              le_mean =     -16.906512301079
             les_mean =     286.198227064457
             stat err =       0.000478152166
             autocorr =       1.242318455680
              std dev =       0.606686955491
             le_variance =       0.368069061963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152506739
                                         uncertainty =       0.019495563124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152506739
                                         uncertainty =       0.019495563124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428992443
  error estimate for blocks of size 2^( 2) =       0.000441311158
  error estimate for blocks of size 2^( 3) =       0.000453498101
  error estimate for blocks of size 2^( 4) =       0.000465271464
  error estimate for blocks of size 2^( 5) =       0.000475328613
  error estimate for blocks of size 2^( 6) =       0.000483576263
  error estimate for blocks of size 2^( 7) =       0.000488432269

      target function =                  N/A
              le_mean =     -16.906512301285
             les_mean =     286.198227042112
             stat err =       0.000478152152
             autocorr =       1.242318480507
              std dev =       0.606686931334
             le_variance =       0.368069032652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152521393
                                         uncertainty =       0.019495562400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152521393
                                         uncertainty =       0.019495562400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428992452
  error estimate for blocks of size 2^( 2) =       0.000441311166
  error estimate for blocks of size 2^( 3) =       0.000453498109
  error estimate for blocks of size 2^( 4) =       0.000465271471
  error estimate for blocks of size 2^( 5) =       0.000475328620
  error estimate for blocks of size 2^( 6) =       0.000483576270
  error estimate for blocks of size 2^( 7) =       0.000488432276

      target function =                  N/A
              le_mean =     -16.906512301182
             les_mean =     286.198227053283
             stat err =       0.000478152159
             autocorr =       1.242318468088
              std dev =       0.606686943412
             le_variance =       0.368069047306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152534218
                                         uncertainty =       0.019495561765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368152534218
                                         uncertainty =       0.019495561765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428992459
  error estimate for blocks of size 2^( 2) =       0.000441311173
  error estimate for blocks of size 2^( 3) =       0.000453498115
  error estimate for blocks of size 2^( 4) =       0.000465271478
  error estimate for blocks of size 2^( 5) =       0.000475328626
  error estimate for blocks of size 2^( 6) =       0.000483576277
  error estimate for blocks of size 2^( 7) =       0.000488432282

      target function =                  N/A
              le_mean =     -16.906512301092
             les_mean =     286.198227063061
             stat err =       0.000478152166
             autocorr =       1.242318457232
              std dev =       0.606686953981
             le_variance =       0.368069060131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906512301079        initial
     3.8147e+03     3.8147e+04             5.8808e-08       -16.906512301285  <--
     1.5259e+04     1.5259e+05             1.4702e-08       -16.906512301182
     6.1035e+04     6.1035e+05             3.6755e-09       -16.906512301092

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 3.0074e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035098e-02 1 1  ON 2
 uu_3                -2.262829e-02 1 1  ON 3
 uu_4                -6.861468e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463942e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677883e-02 1 1  ON 12
 ud_3                -5.308358e-03 1 1  ON 13
 ud_4                -6.304057e-02 1 1  ON 14
 ud_5                -1.052232e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.630000e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719187e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706126e-01 1 1  ON 26
 eO_7                -3.695342e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100414e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285346e-02 1 1  ON 33
eH1_4                -3.899813e-03 1 1  ON 34
eH1_5                 3.156550e-02 1 1  ON 35
eH1_6                 9.284646e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962649e-01 1 1  ON 38
eH1_9                 9.881817e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048813e-01 1 1  ON 42
eH2_3                -5.021368e-02 1 1  ON 43
eH2_4                -1.230080e-03 1 1  ON 44
eH2_5                 3.330020e-02 1 1  ON 45
eH2_6                 9.473272e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7843e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.587937
====================================================
  Execution time = 2.0922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339407335363
                                         uncertainty =       0.005110137225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339407335363
                                         uncertainty =       0.005110137225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412042121
  error estimate for blocks of size 2^( 2) =       0.000424574002
  error estimate for blocks of size 2^( 3) =       0.000436722053
  error estimate for blocks of size 2^( 4) =       0.000447384828
  error estimate for blocks of size 2^( 5) =       0.000456425951
  error estimate for blocks of size 2^( 6) =       0.000461250796
  error estimate for blocks of size 2^( 7) =       0.000464988361

      target function =                  N/A
              le_mean =     -16.906388202442
             les_mean =     286.165519300569
             stat err =       0.000457512484
             autocorr =       1.232885287948
              std dev =       0.582715555561
             le_variance =       0.339557418693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638820244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906388202442       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906388203734       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906388203447       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906388203233       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906388203317       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906388203459       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906388203433       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906388203415       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.750559e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906388202442       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906388202765       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906388202693       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906388202639       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906388202660       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906388202698       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906388202692       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906388202685       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 4.376671e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906388202442       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906388202522       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906388202504       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906388202491       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906388202497       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906388202504       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906388202509       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906388202498       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.094185e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035099e-02 1 1  ON 2
 uu_3                -2.262829e-02 1 1  ON 3
 uu_4                -6.861468e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463942e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880339e-01 1 1  ON 11
 ud_2                 6.677882e-02 1 1  ON 12
 ud_3                -5.308353e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398943e-01 1 1  ON 21
 eO_2                -1.719186e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695344e-02 1 1  ON 27
 eO_8                -2.404218e-01 1 1  ON 28
 eO_9                -1.100415e-01 1 1  ON 29
eH1_0                -2.568783e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285348e-02 1 1  ON 33
eH1_4                -3.899835e-03 1 1  ON 34
eH1_5                 3.156549e-02 1 1  ON 35
eH1_6                 9.284647e-02 1 1  ON 36
eH1_7                 1.557768e-01 1 1  ON 37
eH1_8                 1.962649e-01 1 1  ON 38
eH1_9                 9.881820e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048813e-01 1 1  ON 42
eH2_3                -5.021366e-02 1 1  ON 43
eH2_4                -1.230090e-03 1 1  ON 44
eH2_5                 3.330019e-02 1 1  ON 45
eH2_6                 9.473269e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990258e-01 1 1  ON 48
eH2_9                 9.252111e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.26174
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3508e-01
  Total weights = 2.0000e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018014306
                                         uncertainty =       0.003759897068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018014306
                                         uncertainty =       0.003759897068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409314945
  error estimate for blocks of size 2^( 2) =       0.000421856750
  error estimate for blocks of size 2^( 3) =       0.000434655865
  error estimate for blocks of size 2^( 4) =       0.000446962116
  error estimate for blocks of size 2^( 5) =       0.000458400110
  error estimate for blocks of size 2^( 6) =       0.000467372501
  error estimate for blocks of size 2^( 7) =       0.000473634707

      target function =                  N/A
              le_mean =     -16.906007242610
             les_mean =     286.148158168791
             stat err =       0.000461592358
             autocorr =       1.271750790279
              std dev =       0.578858747155
             le_variance =       0.335077449158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018029249
                                         uncertainty =       0.003759897266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018029249
                                         uncertainty =       0.003759897266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409314955
  error estimate for blocks of size 2^( 2) =       0.000421856757
  error estimate for blocks of size 2^( 3) =       0.000434655868
  error estimate for blocks of size 2^( 4) =       0.000446962114
  error estimate for blocks of size 2^( 5) =       0.000458400108
  error estimate for blocks of size 2^( 6) =       0.000467372500
  error estimate for blocks of size 2^( 7) =       0.000473634712

      target function =                  N/A
              le_mean =     -16.906007244377
             les_mean =     286.148158243581
             stat err =       0.000461592359
             autocorr =       1.271750734177
              std dev =       0.578858760133
             le_variance =       0.335077464182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018021764
                                         uncertainty =       0.003759897167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018021764
                                         uncertainty =       0.003759897167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409314950
  error estimate for blocks of size 2^( 2) =       0.000421856753
  error estimate for blocks of size 2^( 3) =       0.000434655867
  error estimate for blocks of size 2^( 4) =       0.000446962115
  error estimate for blocks of size 2^( 5) =       0.000458400109
  error estimate for blocks of size 2^( 6) =       0.000467372501
  error estimate for blocks of size 2^( 7) =       0.000473634709

      target function =                  N/A
              le_mean =     -16.906007243494
             les_mean =     286.148158206184
             stat err =       0.000461592359
             autocorr =       1.271750762237
              std dev =       0.578858753633
             le_variance =       0.335077456657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018015238
                                         uncertainty =       0.003759897080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335018015238
                                         uncertainty =       0.003759897080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409314946
  error estimate for blocks of size 2^( 2) =       0.000421856750
  error estimate for blocks of size 2^( 3) =       0.000434655865
  error estimate for blocks of size 2^( 4) =       0.000446962116
  error estimate for blocks of size 2^( 5) =       0.000458400110
  error estimate for blocks of size 2^( 6) =       0.000467372501
  error estimate for blocks of size 2^( 7) =       0.000473634707

      target function =                  N/A
              le_mean =     -16.906007242720
             les_mean =     286.148158173465
             stat err =       0.000461592358
             autocorr =       1.271750786770
              std dev =       0.578858747964
             le_variance =       0.335077450095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906007242610        initial
     9.5367e+02     9.5367e+03             1.7506e-07       -16.906007244377  <--
     3.8147e+03     3.8147e+04             4.3767e-08       -16.906007243494
     1.5259e+04     1.5259e+05             1.0942e-08       -16.906007242720

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 3.0050e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035103e-02 1 1  ON 2
 uu_3                -2.262826e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308339e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100415e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285353e-02 1 1  ON 33
eH1_4                -3.899902e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881831e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021358e-02 1 1  ON 43
eH2_4                -1.230118e-03 1 1  ON 44
eH2_5                 3.330016e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.198718
====================================================
  Execution time = 2.0557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3830e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278474457
                                         uncertainty =       0.003378335017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278474457
                                         uncertainty =       0.003378335017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411277646
  error estimate for blocks of size 2^( 2) =       0.000424227488
  error estimate for blocks of size 2^( 3) =       0.000437121639
  error estimate for blocks of size 2^( 4) =       0.000449892382
  error estimate for blocks of size 2^( 5) =       0.000460771013
  error estimate for blocks of size 2^( 6) =       0.000470180530
  error estimate for blocks of size 2^( 7) =       0.000472967669

      target function =                  N/A
              le_mean =     -16.905443769492
             les_mean =     286.132327477800
             stat err =       0.000463452898
             autocorr =       1.269816587270
              std dev =       0.581634424272
             le_variance =       0.338298603499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690544376949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905443769492       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905443770070       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905443773132       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905443774407       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905443776067       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905443774760       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905443774887       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905443775111       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.026527e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905443769492       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905443769636       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905443770403       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905443770721       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905443771137       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905443770810       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905443770840       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905443770896       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.006786e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905443769492       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905443769528       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905443769720       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905443769799       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905443769902       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905443769820       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905443769828       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905443769841       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.017062e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6085e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424404e-01 1 1  ON 1
 uu_2                 4.035108e-02 1 1  ON 2
 uu_3                -2.262823e-02 1 1  ON 3
 uu_4                -6.861469e-02 1 1  ON 4
 uu_5                -1.039001e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390389e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677873e-02 1 1  ON 12
 ud_3                -5.308376e-03 1 1  ON 13
 ud_4                -6.304068e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453067e-01 1 1  ON 19
 eO_0                -7.629998e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719183e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357806e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100417e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552943e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285358e-02 1 1  ON 33
eH1_4                -3.899936e-03 1 1  ON 34
eH1_5                 3.156535e-02 1 1  ON 35
eH1_6                 9.284650e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962651e-01 1 1  ON 38
eH1_9                 9.881848e-02 1 1  ON 39
eH2_0                -2.541978e-01 1 1  ON 40
eH2_1                -1.521776e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021367e-02 1 1  ON 43
eH2_4                -1.230184e-03 1 1  ON 44
eH2_5                 3.330022e-02 1 1  ON 45
eH2_6                 9.473262e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252141e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9336
    reference variance = 0.310773
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5205e-01
  Total weights = 2.0000e+06
  Execution time = 1.8731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098944901
                                         uncertainty =       0.014885989402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098944901
                                         uncertainty =       0.014885989402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419551338
  error estimate for blocks of size 2^( 2) =       0.000432225224
  error estimate for blocks of size 2^( 3) =       0.000445050010
  error estimate for blocks of size 2^( 4) =       0.000456715996
  error estimate for blocks of size 2^( 5) =       0.000467279458
  error estimate for blocks of size 2^( 6) =       0.000475352043
  error estimate for blocks of size 2^( 7) =       0.000481321755

      target function =                  N/A
              le_mean =     -16.905787774355
             les_mean =     286.157706745492
             stat err =       0.000470167313
             autocorr =       1.255840964688
              std dev =       0.593335191925
             le_variance =       0.352046649976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098122402
                                         uncertainty =       0.014885860046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098122402
                                         uncertainty =       0.014885860046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419550848
  error estimate for blocks of size 2^( 2) =       0.000432224754
  error estimate for blocks of size 2^( 3) =       0.000445049559
  error estimate for blocks of size 2^( 4) =       0.000456715562
  error estimate for blocks of size 2^( 5) =       0.000467279028
  error estimate for blocks of size 2^( 6) =       0.000475351608
  error estimate for blocks of size 2^( 7) =       0.000481321337

      target function =                  N/A
              le_mean =     -16.905787770392
             les_mean =     286.157705789145
             stat err =       0.000470166884
             autocorr =       1.255841605224
              std dev =       0.593334498948
             le_variance =       0.352045827642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098533033
                                         uncertainty =       0.014885924623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098533033
                                         uncertainty =       0.014885924623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419551092
  error estimate for blocks of size 2^( 2) =       0.000432224988
  error estimate for blocks of size 2^( 3) =       0.000445049784
  error estimate for blocks of size 2^( 4) =       0.000456715778
  error estimate for blocks of size 2^( 5) =       0.000467279243
  error estimate for blocks of size 2^( 6) =       0.000475351825
  error estimate for blocks of size 2^( 7) =       0.000481321546

      target function =                  N/A
              le_mean =     -16.905787772371
             les_mean =     286.157706266619
             stat err =       0.000470167098
             autocorr =       1.255841285446
              std dev =       0.593334844916
             le_variance =       0.352046238191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098893398
                                         uncertainty =       0.014885981302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352098893398
                                         uncertainty =       0.014885981302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419551307
  error estimate for blocks of size 2^( 2) =       0.000432225194
  error estimate for blocks of size 2^( 3) =       0.000445049982
  error estimate for blocks of size 2^( 4) =       0.000456715969
  error estimate for blocks of size 2^( 5) =       0.000467279431
  error estimate for blocks of size 2^( 6) =       0.000475352016
  error estimate for blocks of size 2^( 7) =       0.000481321729

      target function =                  N/A
              le_mean =     -16.905787774107
             les_mean =     286.157706685609
             stat err =       0.000470167286
             autocorr =       1.255841004795
              std dev =       0.593335148532
             le_variance =       0.352046598483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905787774355        initial  <--
     2.3842e+02     2.3842e+03             8.0265e-07       -16.905787770392
     9.5367e+02     9.5367e+03             2.0068e-07       -16.905787772371
     3.8147e+03     3.8147e+04             5.0171e-08       -16.905787774107

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7115
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035103e-02 1 1  ON 2
 uu_3                -2.262826e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308339e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100415e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285353e-02 1 1  ON 33
eH1_4                -3.899902e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881831e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021358e-02 1 1  ON 43
eH2_4                -1.230118e-03 1 1  ON 44
eH2_5                 3.330016e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9566
    reference variance = 0.226428
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4161e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341714318978
                                         uncertainty =       0.003334912583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341714318978
                                         uncertainty =       0.003334912583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413285901
  error estimate for blocks of size 2^( 2) =       0.000425979964
  error estimate for blocks of size 2^( 3) =       0.000438957265
  error estimate for blocks of size 2^( 4) =       0.000451736123
  error estimate for blocks of size 2^( 5) =       0.000464322942
  error estimate for blocks of size 2^( 6) =       0.000473775801
  error estimate for blocks of size 2^( 7) =       0.000480448074

      target function =                  N/A
              le_mean =     -16.905481401160
             les_mean =     286.136911706600
             stat err =       0.000467570735
             autocorr =       1.279951347697
              std dev =       0.584474526759
             le_variance =       0.341610472430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548140116e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905481401160       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905481401372       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905481401569       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905481401545       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905481401630       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905481401697       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481401557       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905481401572       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 7.480353e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905481401160       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905481401213       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905481401262       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905481401256       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905481401279       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905481401292       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481401257       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905481401261       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.870189e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905481401160       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905481401174       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905481401186       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905481401184       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905481401163       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905481401205       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481401173       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905481401206       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 4.675535e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6429e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035104e-02 1 1  ON 2
 uu_3                -2.262826e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308335e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100416e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285354e-02 1 1  ON 33
eH1_4                -3.899912e-03 1 1  ON 34
eH1_5                 3.156547e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881833e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021357e-02 1 1  ON 43
eH2_4                -1.230131e-03 1 1  ON 44
eH2_5                 3.330017e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.831
    reference variance = 0.174883
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3009e-01
  Total weights = 2.0000e+06
  Execution time = 1.8769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945631964
                                         uncertainty =       0.003451463123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945631964
                                         uncertainty =       0.003451463123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406258235
  error estimate for blocks of size 2^( 2) =       0.000418970830
  error estimate for blocks of size 2^( 3) =       0.000431772188
  error estimate for blocks of size 2^( 4) =       0.000443352733
  error estimate for blocks of size 2^( 5) =       0.000452824580
  error estimate for blocks of size 2^( 6) =       0.000459078914
  error estimate for blocks of size 2^( 7) =       0.000464933768

      target function =                  N/A
              le_mean =     -16.906132428318
             les_mean =     286.147405026451
             stat err =       0.000455047499
             autocorr =       1.254611047084
              std dev =       0.574535906334
             le_variance =       0.330091507667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945596623
                                         uncertainty =       0.003451462935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945596623
                                         uncertainty =       0.003451462935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406258214
  error estimate for blocks of size 2^( 2) =       0.000418970809
  error estimate for blocks of size 2^( 3) =       0.000431772168
  error estimate for blocks of size 2^( 4) =       0.000443352714
  error estimate for blocks of size 2^( 5) =       0.000452824562
  error estimate for blocks of size 2^( 6) =       0.000459078894
  error estimate for blocks of size 2^( 7) =       0.000464933747

      target function =                  N/A
              le_mean =     -16.906132427823
             les_mean =     286.147404974438
             stat err =       0.000455047479
             autocorr =       1.254611074529
              std dev =       0.574535875644
             le_variance =       0.330091472402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945614290
                                         uncertainty =       0.003451463029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945614290
                                         uncertainty =       0.003451463029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406258225
  error estimate for blocks of size 2^( 2) =       0.000418970820
  error estimate for blocks of size 2^( 3) =       0.000431772178
  error estimate for blocks of size 2^( 4) =       0.000443352724
  error estimate for blocks of size 2^( 5) =       0.000452824571
  error estimate for blocks of size 2^( 6) =       0.000459078904
  error estimate for blocks of size 2^( 7) =       0.000464933757

      target function =                  N/A
              le_mean =     -16.906132428070
             les_mean =     286.147405000439
             stat err =       0.000455047489
             autocorr =       1.254611060820
              std dev =       0.574535890986
             le_variance =       0.330091490031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945629754
                                         uncertainty =       0.003451463111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329945629754
                                         uncertainty =       0.003451463111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406258234
  error estimate for blocks of size 2^( 2) =       0.000418970828
  error estimate for blocks of size 2^( 3) =       0.000431772186
  error estimate for blocks of size 2^( 4) =       0.000443352732
  error estimate for blocks of size 2^( 5) =       0.000452824579
  error estimate for blocks of size 2^( 6) =       0.000459078913
  error estimate for blocks of size 2^( 7) =       0.000464933766

      target function =                  N/A
              le_mean =     -16.906132428287
             les_mean =     286.147405023199
             stat err =       0.000455047497
             autocorr =       1.254611048816
              std dev =       0.574535904415
             le_variance =       0.330091505462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906132428318        initial  <--
     2.3842e+03     2.3842e+04             7.4804e-08       -16.906132427823
     9.5367e+03     9.5367e+04             1.8702e-08       -16.906132428070
     3.8147e+04     3.8147e+05             4.6755e-09       -16.906132428287

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8687
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035103e-02 1 1  ON 2
 uu_3                -2.262826e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308339e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100415e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285353e-02 1 1  ON 33
eH1_4                -3.899902e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881831e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021358e-02 1 1  ON 43
eH2_4                -1.230118e-03 1 1  ON 44
eH2_5                 3.330016e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6304e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.247252
====================================================
  Execution time = 2.1000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4925e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349207875565
                                         uncertainty =       0.013397838556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349207875565
                                         uncertainty =       0.013397838556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417883069
  error estimate for blocks of size 2^( 2) =       0.000430805761
  error estimate for blocks of size 2^( 3) =       0.000443555383
  error estimate for blocks of size 2^( 4) =       0.000455310182
  error estimate for blocks of size 2^( 5) =       0.000466026922
  error estimate for blocks of size 2^( 6) =       0.000474326500
  error estimate for blocks of size 2^( 7) =       0.000478369556

      target function =                  N/A
              le_mean =     -16.906272317689
             les_mean =     286.171296023584
             stat err =       0.000468508290
             autocorr =       1.256970278740
              std dev =       0.590975903372
             le_variance =       0.349252518366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627231769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272317689       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272317712       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272317724       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272317728       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272317739       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272317733       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272317742       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272317743       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.079215e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272317689       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272317694       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272317697       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272317671       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272317731       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272317669       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272317687       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272317600       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.019830e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272317689       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272317690       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272317691       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272317686       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272317884       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272317556       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272317665       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272317705       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.049591e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6493e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035103e-02 1 1  ON 2
 uu_3                -2.262826e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308338e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100415e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285353e-02 1 1  ON 33
eH1_4                -3.899903e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881831e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021358e-02 1 1  ON 43
eH2_4                -1.230118e-03 1 1  ON 44
eH2_5                 3.330016e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.0031
    reference variance = 0.448352
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4172e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449647134
                                         uncertainty =       0.003993047211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449647134
                                         uncertainty =       0.003993047211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413353459
  error estimate for blocks of size 2^( 2) =       0.000425942487
  error estimate for blocks of size 2^( 3) =       0.000438607575
  error estimate for blocks of size 2^( 4) =       0.000450882921
  error estimate for blocks of size 2^( 5) =       0.000461341374
  error estimate for blocks of size 2^( 6) =       0.000469692733
  error estimate for blocks of size 2^( 7) =       0.000474097039

      target function =                  N/A
              le_mean =     -16.905184023081
             les_mean =     286.126968848009
             stat err =       0.000464003517
             autocorr =       1.260083692541
              std dev =       0.584570068191
             le_variance =       0.341722164624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449640948
                                         uncertainty =       0.003993047153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449640948
                                         uncertainty =       0.003993047153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413353456
  error estimate for blocks of size 2^( 2) =       0.000425942483
  error estimate for blocks of size 2^( 3) =       0.000438607572
  error estimate for blocks of size 2^( 4) =       0.000450882918
  error estimate for blocks of size 2^( 5) =       0.000461341371
  error estimate for blocks of size 2^( 6) =       0.000469692729
  error estimate for blocks of size 2^( 7) =       0.000474097035

      target function =                  N/A
              le_mean =     -16.905184023169
             les_mean =     286.126968844763
             stat err =       0.000464003513
             autocorr =       1.260083696557
              std dev =       0.584570062891
             le_variance =       0.341722158428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449644041
                                         uncertainty =       0.003993047182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449644041
                                         uncertainty =       0.003993047182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413353457
  error estimate for blocks of size 2^( 2) =       0.000425942485
  error estimate for blocks of size 2^( 3) =       0.000438607573
  error estimate for blocks of size 2^( 4) =       0.000450882919
  error estimate for blocks of size 2^( 5) =       0.000461341372
  error estimate for blocks of size 2^( 6) =       0.000469692731
  error estimate for blocks of size 2^( 7) =       0.000474097037

      target function =                  N/A
              le_mean =     -16.905184023125
             les_mean =     286.126968846386
             stat err =       0.000464003515
             autocorr =       1.260083694540
              std dev =       0.584570065541
             le_variance =       0.341722161526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449646748
                                         uncertainty =       0.003993047207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449646748
                                         uncertainty =       0.003993047207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413353459
  error estimate for blocks of size 2^( 2) =       0.000425942487
  error estimate for blocks of size 2^( 3) =       0.000438607575
  error estimate for blocks of size 2^( 4) =       0.000450882921
  error estimate for blocks of size 2^( 5) =       0.000461341374
  error estimate for blocks of size 2^( 6) =       0.000469692733
  error estimate for blocks of size 2^( 7) =       0.000474097039

      target function =                  N/A
              le_mean =     -16.905184023087
             les_mean =     286.126968847806
             stat err =       0.000464003516
             autocorr =       1.260083692790
              std dev =       0.584570067859
             le_variance =       0.341722164237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905184023081        initial
     2.3842e+04     2.3842e+05             8.0792e-09       -16.905184023169  <--
     9.5367e+04     9.5367e+05             2.0198e-09       -16.905184023125
     3.8147e+05     3.8147e+06             5.0496e-10       -16.905184023087

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.9789e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035104e-02 1 1  ON 2
 uu_3                -2.262826e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308335e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719185e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100416e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285353e-02 1 1  ON 33
eH1_4                -3.899905e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881832e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021358e-02 1 1  ON 43
eH2_4                -1.230118e-03 1 1  ON 44
eH2_5                 3.330016e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252122e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.162168
====================================================
  Execution time = 2.0988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3850e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338604412812
                                         uncertainty =       0.002980890668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338604412812
                                         uncertainty =       0.002980890668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411398348
  error estimate for blocks of size 2^( 2) =       0.000424741831
  error estimate for blocks of size 2^( 3) =       0.000438111311
  error estimate for blocks of size 2^( 4) =       0.000450453520
  error estimate for blocks of size 2^( 5) =       0.000460893056
  error estimate for blocks of size 2^( 6) =       0.000468430851
  error estimate for blocks of size 2^( 7) =       0.000471704246

      target function =                  N/A
              le_mean =     -16.905393348122
             les_mean =     286.130821287084
             stat err =       0.000462870418
             autocorr =       1.265883576384
              std dev =       0.581805123385
             le_variance =       0.338497201598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539334812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905393348122       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905393348126       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905393348044       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905393347973       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905393347983       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393347969       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905393347993       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905393347990       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 2.968689e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905393348122       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905393348123       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905393348103       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905393348085       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905393348088       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393348092       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905393348086       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905393348089       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 7.421732e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905393348122       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905393348122       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905393348117       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905393348106       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905393348128       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393348076       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905393348104       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905393348163       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 1.855434e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6506e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035104e-02 1 1  ON 2
 uu_3                -2.262825e-02 1 1  ON 3
 uu_4                -6.861472e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880340e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308335e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719185e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100416e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285353e-02 1 1  ON 33
eH1_4                -3.899911e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881832e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021358e-02 1 1  ON 43
eH2_4                -1.230119e-03 1 1  ON 44
eH2_5                 3.330017e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9733
    reference variance = 0.293099
====================================================
  Execution time = 2.2906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3777e-01
  Total weights = 2.0000e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801294525
                                         uncertainty =       0.003179935564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801294525
                                         uncertainty =       0.003179935564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410955773
  error estimate for blocks of size 2^( 2) =       0.000423719769
  error estimate for blocks of size 2^( 3) =       0.000437034862
  error estimate for blocks of size 2^( 4) =       0.000449357740
  error estimate for blocks of size 2^( 5) =       0.000460392436
  error estimate for blocks of size 2^( 6) =       0.000469699300
  error estimate for blocks of size 2^( 7) =       0.000474665777

      target function =                  N/A
              le_mean =     -16.906058831907
             les_mean =     286.152594354344
             stat err =       0.000463528813
             autocorr =       1.272223162908
              std dev =       0.581179228228
             le_variance =       0.337769295324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801278501
                                         uncertainty =       0.003179935346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801278501
                                         uncertainty =       0.003179935346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410955764
  error estimate for blocks of size 2^( 2) =       0.000423719760
  error estimate for blocks of size 2^( 3) =       0.000437034853
  error estimate for blocks of size 2^( 4) =       0.000449357731
  error estimate for blocks of size 2^( 5) =       0.000460392428
  error estimate for blocks of size 2^( 6) =       0.000469699292
  error estimate for blocks of size 2^( 7) =       0.000474665769

      target function =                  N/A
              le_mean =     -16.906058831915
             les_mean =     286.152594338587
             stat err =       0.000463528805
             autocorr =       1.272223179253
              std dev =       0.581179214435
             le_variance =       0.337769279291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801286512
                                         uncertainty =       0.003179935455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801286512
                                         uncertainty =       0.003179935455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410955768
  error estimate for blocks of size 2^( 2) =       0.000423719764
  error estimate for blocks of size 2^( 3) =       0.000437034858
  error estimate for blocks of size 2^( 4) =       0.000449357735
  error estimate for blocks of size 2^( 5) =       0.000460392432
  error estimate for blocks of size 2^( 6) =       0.000469699296
  error estimate for blocks of size 2^( 7) =       0.000474665773

      target function =                  N/A
              le_mean =     -16.906058831911
             les_mean =     286.152594346465
             stat err =       0.000463528809
             autocorr =       1.272223171081
              std dev =       0.581179221331
             le_variance =       0.337769287307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801293523
                                         uncertainty =       0.003179935550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337801293523
                                         uncertainty =       0.003179935550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410955773
  error estimate for blocks of size 2^( 2) =       0.000423719768
  error estimate for blocks of size 2^( 3) =       0.000437034861
  error estimate for blocks of size 2^( 4) =       0.000449357739
  error estimate for blocks of size 2^( 5) =       0.000460392436
  error estimate for blocks of size 2^( 6) =       0.000469699300
  error estimate for blocks of size 2^( 7) =       0.000474665776

      target function =                  N/A
              le_mean =     -16.906058831908
             les_mean =     286.152594353359
             stat err =       0.000463528813
             autocorr =       1.272223163931
              std dev =       0.581179227366
             le_variance =       0.337769294321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906058831907        initial
     5.9605e+03     5.9605e+04             2.9687e-08       -16.906058831915  <--
     2.3842e+04     2.3842e+05             7.4217e-09       -16.906058831911
     9.5367e+04     9.5367e+05             1.8554e-09       -16.906058831908

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 3.2334e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035104e-02 1 1  ON 2
 uu_3                -2.262824e-02 1 1  ON 3
 uu_4                -6.861472e-02 1 1  ON 4
 uu_5                -1.039000e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463943e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308335e-03 1 1  ON 13
 ud_4                -6.304061e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719185e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100416e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285354e-02 1 1  ON 33
eH1_4                -3.899928e-03 1 1  ON 34
eH1_5                 3.156545e-02 1 1  ON 35
eH1_6                 9.284651e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881835e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021359e-02 1 1  ON 43
eH2_4                -1.230122e-03 1 1  ON 44
eH2_5                 3.330018e-02 1 1  ON 45
eH2_6                 9.473259e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252125e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8846e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8237
    reference variance = 0.392092
====================================================
  Execution time = 2.1006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341148747063
                                         uncertainty =       0.003930249353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341148747063
                                         uncertainty =       0.003930249353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412934540
  error estimate for blocks of size 2^( 2) =       0.000425260942
  error estimate for blocks of size 2^( 3) =       0.000437692396
  error estimate for blocks of size 2^( 4) =       0.000449148220
  error estimate for blocks of size 2^( 5) =       0.000459072228
  error estimate for blocks of size 2^( 6) =       0.000464883715
  error estimate for blocks of size 2^( 7) =       0.000471180134

      target function =                  N/A
              le_mean =     -16.906588613554
             les_mean =     286.173768245552
             stat err =       0.000461071074
             autocorr =       1.246732649251
              std dev =       0.583977626370
             le_variance =       0.341029868101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658861355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906588613554       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906588613438       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906588613446       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906588613492       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588613567       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906588613559       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906588613619       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588613582       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.182955e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906588613554       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906588613525       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906588613527       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906588613539       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588613558       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906588613556       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906588613568       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588613571       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 2.957504e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906588613554       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906588613547       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906588613548       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906588613550       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588613556       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906588613549       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906588613554       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588613543       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 7.393834e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6479e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035106e-02 1 1  ON 2
 uu_3                -2.262824e-02 1 1  ON 3
 uu_4                -6.861472e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320305e-01 1 1  ON 6
 uu_7                -1.463944e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677879e-02 1 1  ON 12
 ud_3                -5.308328e-03 1 1  ON 13
 ud_4                -6.304061e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998050e-01 1 1  ON 25
 eO_6                 2.706127e-01 1 1  ON 26
 eO_7                -3.695353e-02 1 1  ON 27
 eO_8                -2.404219e-01 1 1  ON 28
 eO_9                -1.100416e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285354e-02 1 1  ON 33
eH1_4                -3.899937e-03 1 1  ON 34
eH1_5                 3.156546e-02 1 1  ON 35
eH1_6                 9.284652e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881837e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521775e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021359e-02 1 1  ON 43
eH2_4                -1.230113e-03 1 1  ON 44
eH2_5                 3.330017e-02 1 1  ON 45
eH2_6                 9.473258e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252127e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.259628
====================================================
  Execution time = 2.0470e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 1.8726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621792886
                                         uncertainty =       0.004024616657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621792886
                                         uncertainty =       0.004024616657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828998
  error estimate for blocks of size 2^( 2) =       0.000423810252
  error estimate for blocks of size 2^( 3) =       0.000436346014
  error estimate for blocks of size 2^( 4) =       0.000448884242
  error estimate for blocks of size 2^( 5) =       0.000458425070
  error estimate for blocks of size 2^( 6) =       0.000465464383
  error estimate for blocks of size 2^( 7) =       0.000469917448

      target function =                  N/A
              le_mean =     -16.905991016086
             les_mean =     286.150092999122
             stat err =       0.000460672786
             autocorr =       1.257369532916
              std dev =       0.580999941415
             le_variance =       0.337560931924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621775874
                                         uncertainty =       0.004024616535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621775874
                                         uncertainty =       0.004024616535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828988
  error estimate for blocks of size 2^( 2) =       0.000423810241
  error estimate for blocks of size 2^( 3) =       0.000436346002
  error estimate for blocks of size 2^( 4) =       0.000448884230
  error estimate for blocks of size 2^( 5) =       0.000458425056
  error estimate for blocks of size 2^( 6) =       0.000465464369
  error estimate for blocks of size 2^( 7) =       0.000469917436

      target function =                  N/A
              le_mean =     -16.905991016292
             les_mean =     286.150092989081
             stat err =       0.000460672773
             autocorr =       1.257369525416
              std dev =       0.580999926786
             le_variance =       0.337560914926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621784378
                                         uncertainty =       0.004024616596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621784378
                                         uncertainty =       0.004024616596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828993
  error estimate for blocks of size 2^( 2) =       0.000423810247
  error estimate for blocks of size 2^( 3) =       0.000436346008
  error estimate for blocks of size 2^( 4) =       0.000448884236
  error estimate for blocks of size 2^( 5) =       0.000458425063
  error estimate for blocks of size 2^( 6) =       0.000465464376
  error estimate for blocks of size 2^( 7) =       0.000469917442

      target function =                  N/A
              le_mean =     -16.905991016189
             les_mean =     286.150092994099
             stat err =       0.000460672779
             autocorr =       1.257369529168
              std dev =       0.580999934098
             le_variance =       0.337560923422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621791823
                                         uncertainty =       0.004024616650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337621791823
                                         uncertainty =       0.004024616650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410828998
  error estimate for blocks of size 2^( 2) =       0.000423810252
  error estimate for blocks of size 2^( 3) =       0.000436346013
  error estimate for blocks of size 2^( 4) =       0.000448884241
  error estimate for blocks of size 2^( 5) =       0.000458425069
  error estimate for blocks of size 2^( 6) =       0.000465464382
  error estimate for blocks of size 2^( 7) =       0.000469917447

      target function =                  N/A
              le_mean =     -16.905991016099
             les_mean =     286.150092998494
             stat err =       0.000460672785
             autocorr =       1.257369532443
              std dev =       0.580999940500
             le_variance =       0.337560930862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905991016086        initial
     1.4901e+03     1.4901e+04             1.1830e-07       -16.905991016292  <--
     5.9605e+03     5.9605e+04             2.9575e-08       -16.905991016189
     2.3842e+04     2.3842e+05             7.3938e-09       -16.905991016099

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 2.9895e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424405e-01 1 1  ON 1
 uu_2                 4.035110e-02 1 1  ON 2
 uu_3                -2.262822e-02 1 1  ON 3
 uu_4                -6.861471e-02 1 1  ON 4
 uu_5                -1.038999e-01 1 1  ON 5
 uu_6                -1.320306e-01 1 1  ON 6
 uu_7                -1.463945e-01 1 1  ON 7
 uu_8                -1.390389e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677881e-02 1 1  ON 12
 ud_3                -5.308306e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629999e-01 1 1  ON 20
 eO_1                -4.398942e-01 1 1  ON 21
 eO_2                -1.719181e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357807e-01 1 1  ON 24
 eO_5                 4.998051e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695354e-02 1 1  ON 27
 eO_8                -2.404220e-01 1 1  ON 28
 eO_9                -1.100417e-01 1 1  ON 29
eH1_0                -2.568784e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285354e-02 1 1  ON 33
eH1_4                -3.899967e-03 1 1  ON 34
eH1_5                 3.156547e-02 1 1  ON 35
eH1_6                 9.284654e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962650e-01 1 1  ON 38
eH1_9                 9.881842e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521776e-01 1 1  ON 41
eH2_2                -1.048814e-01 1 1  ON 42
eH2_3                -5.021360e-02 1 1  ON 43
eH2_4                -1.230084e-03 1 1  ON 44
eH2_5                 3.330015e-02 1 1  ON 45
eH2_6                 9.473254e-02 1 1  ON 46
eH2_7                 1.558652e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252135e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.170158
====================================================
  Execution time = 2.1169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344003731033
                                         uncertainty =       0.003858929169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344003731033
                                         uncertainty =       0.003858929169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414778215
  error estimate for blocks of size 2^( 2) =       0.000427589651
  error estimate for blocks of size 2^( 3) =       0.000440323094
  error estimate for blocks of size 2^( 4) =       0.000453468057
  error estimate for blocks of size 2^( 5) =       0.000465252883
  error estimate for blocks of size 2^( 6) =       0.000474246675
  error estimate for blocks of size 2^( 7) =       0.000479894206

      target function =                  N/A
              le_mean =     -16.905911133822
             les_mean =     286.153913027792
             stat err =       0.000468215455
             autocorr =       1.274264587029
              std dev =       0.586584976916
             le_variance =       0.344081935144


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591113382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905911133822       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905911134582       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911135992       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905911136356       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911137063       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911137163       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911136901       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911136855       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.019728e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905911133822       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905911134012       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911134365       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905911134456       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911134633       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911134658       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911134592       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911134582       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.505014e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905911133822       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905911133870       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911133958       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905911133981       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905911134026       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905911134034       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905911134006       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905911134011       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.762585e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6844e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424404e-01 1 1  ON 1
 uu_2                 4.035116e-02 1 1  ON 2
 uu_3                -2.262821e-02 1 1  ON 3
 uu_4                -6.861473e-02 1 1  ON 4
 uu_5                -1.038998e-01 1 1  ON 5
 uu_6                -1.320306e-01 1 1  ON 6
 uu_7                -1.463946e-01 1 1  ON 7
 uu_8                -1.390389e-01 1 1  ON 8
 uu_9                -1.110348e-01 1 1  ON 9
 ud_0                 4.545296e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677875e-02 1 1  ON 12
 ud_3                -5.308246e-03 1 1  ON 13
 ud_4                -6.304063e-02 1 1  ON 14
 ud_5                -1.052233e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527637e-01 1 1  ON 18
 ud_9                -1.453068e-01 1 1  ON 19
 eO_0                -7.629998e-01 1 1  ON 20
 eO_1                -4.398941e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998051e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695353e-02 1 1  ON 27
 eO_8                -2.404220e-01 1 1  ON 28
 eO_9                -1.100417e-01 1 1  ON 29
eH1_0                -2.568785e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285349e-02 1 1  ON 33
eH1_4                -3.900081e-03 1 1  ON 34
eH1_5                 3.156543e-02 1 1  ON 35
eH1_6                 9.284654e-02 1 1  ON 36
eH1_7                 1.557770e-01 1 1  ON 37
eH1_8                 1.962651e-01 1 1  ON 38
eH1_9                 9.881850e-02 1 1  ON 39
eH2_0                -2.541977e-01 1 1  ON 40
eH2_1                -1.521776e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021364e-02 1 1  ON 43
eH2_4                -1.230110e-03 1 1  ON 44
eH2_5                 3.330007e-02 1 1  ON 45
eH2_6                 9.473250e-02 1 1  ON 46
eH2_7                 1.558653e-01 1 1  ON 47
eH2_8                 1.990259e-01 1 1  ON 48
eH2_9                 9.252150e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.879
    reference variance = 0.226827
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4254e-01
  Total weights = 2.0000e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668841502
                                         uncertainty =       0.004232678429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668841502
                                         uncertainty =       0.004232678429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413847558
  error estimate for blocks of size 2^( 2) =       0.000426249102
  error estimate for blocks of size 2^( 3) =       0.000439274136
  error estimate for blocks of size 2^( 4) =       0.000450970334
  error estimate for blocks of size 2^( 5) =       0.000461651514
  error estimate for blocks of size 2^( 6) =       0.000467769748
  error estimate for blocks of size 2^( 7) =       0.000470607801

      target function =                  N/A
              le_mean =     -16.905517454813
             les_mean =     286.139059846342
             stat err =       0.000462749849
             autocorr =       1.250292938158
              std dev =       0.585268829355
             le_variance =       0.342539602614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668629727
                                         uncertainty =       0.004232676125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668629727
                                         uncertainty =       0.004232676125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413847430
  error estimate for blocks of size 2^( 2) =       0.000426248980
  error estimate for blocks of size 2^( 3) =       0.000439274023
  error estimate for blocks of size 2^( 4) =       0.000450970226
  error estimate for blocks of size 2^( 5) =       0.000461651407
  error estimate for blocks of size 2^( 6) =       0.000467769636
  error estimate for blocks of size 2^( 7) =       0.000470607701

      target function =                  N/A
              le_mean =     -16.905517460106
             les_mean =     286.139059813547
             stat err =       0.000462749742
             autocorr =       1.250293131410
              std dev =       0.585268648461
             le_variance =       0.342539390871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668735541
                                         uncertainty =       0.004232677275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668735541
                                         uncertainty =       0.004232677275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413847494
  error estimate for blocks of size 2^( 2) =       0.000426249041
  error estimate for blocks of size 2^( 3) =       0.000439274079
  error estimate for blocks of size 2^( 4) =       0.000450970280
  error estimate for blocks of size 2^( 5) =       0.000461651460
  error estimate for blocks of size 2^( 6) =       0.000467769692
  error estimate for blocks of size 2^( 7) =       0.000470607751

      target function =                  N/A
              le_mean =     -16.905517457462
             les_mean =     286.139059829961
             stat err =       0.000462749796
             autocorr =       1.250293034845
              std dev =       0.585268738845
             le_variance =       0.342539496669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668828254
                                         uncertainty =       0.004232678284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668828254
                                         uncertainty =       0.004232678284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413847550
  error estimate for blocks of size 2^( 2) =       0.000426249094
  error estimate for blocks of size 2^( 3) =       0.000439274129
  error estimate for blocks of size 2^( 4) =       0.000450970327
  error estimate for blocks of size 2^( 5) =       0.000461651507
  error estimate for blocks of size 2^( 6) =       0.000467769741
  error estimate for blocks of size 2^( 7) =       0.000470607795

      target function =                  N/A
              le_mean =     -16.905517455144
             les_mean =     286.139059844294
             stat err =       0.000462749843
             autocorr =       1.250292950239
              std dev =       0.585268818039
             le_variance =       0.342539589369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905517454813        initial
     3.7253e+02     3.7253e+03             6.0197e-07       -16.905517460106  <--
     1.4901e+03     1.4901e+04             1.5050e-07       -16.905517457462
     5.9605e+03     5.9605e+04             3.7626e-08       -16.905517455144

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 2.9963e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424400e-01 1 1  ON 1
 uu_2                 4.035135e-02 1 1  ON 2
 uu_3                -2.262819e-02 1 1  ON 3
 uu_4                -6.861480e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320309e-01 1 1  ON 6
 uu_7                -1.463948e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110346e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677857e-02 1 1  ON 12
 ud_3                -5.308067e-03 1 1  ON 13
 ud_4                -6.304075e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527635e-01 1 1  ON 18
 ud_9                -1.453066e-01 1 1  ON 19
 eO_0                -7.629998e-01 1 1  ON 20
 eO_1                -4.398939e-01 1 1  ON 21
 eO_2                -1.719210e-02 1 1  ON 22
 eO_3                 3.067132e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998052e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404221e-01 1 1  ON 28
 eO_9                -1.100419e-01 1 1  ON 29
eH1_0                -2.568787e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285335e-02 1 1  ON 33
eH1_4                -3.900422e-03 1 1  ON 34
eH1_5                 3.156531e-02 1 1  ON 35
eH1_6                 9.284653e-02 1 1  ON 36
eH1_7                 1.557770e-01 1 1  ON 37
eH1_8                 1.962653e-01 1 1  ON 38
eH1_9                 9.881875e-02 1 1  ON 39
eH2_0                -2.541978e-01 1 1  ON 40
eH2_1                -1.521778e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021375e-02 1 1  ON 43
eH2_4                -1.230190e-03 1 1  ON 44
eH2_5                 3.329982e-02 1 1  ON 45
eH2_6                 9.473238e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990261e-01 1 1  ON 48
eH2_9                 9.252195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.994
    reference variance = 0.519845
====================================================
  Execution time = 2.1138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715138746
                                         uncertainty =       0.003728969005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715138746
                                         uncertainty =       0.003728969005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412145385
  error estimate for blocks of size 2^( 2) =       0.000424920847
  error estimate for blocks of size 2^( 3) =       0.000437554010
  error estimate for blocks of size 2^( 4) =       0.000449465323
  error estimate for blocks of size 2^( 5) =       0.000461300659
  error estimate for blocks of size 2^( 6) =       0.000470291208
  error estimate for blocks of size 2^( 7) =       0.000477323724

      target function =                  N/A
              le_mean =     -16.905422167260
             les_mean =     286.133026119992
             stat err =       0.000464595228
             autocorr =       1.270716319944
              std dev =       0.582861592993
             le_variance =       0.339727636587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690542216726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905422167260       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905422172294       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905422184678       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905422186957       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905422186945       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905422186963       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905422188662       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905422188500       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.261104e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905422167260       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905422168520       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905422171623       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905422172196       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905422172191       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905422172195       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905422172621       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905422172580       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.654066e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905422167260       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905422167575       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905422168351       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905422168494       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905422168493       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905422168493       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905422168601       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905422168592       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.413598e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6712e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093240e-01 1 1  ON 0
 uu_1                 1.424396e-01 1 1  ON 1
 uu_2                 4.035128e-02 1 1  ON 2
 uu_3                -2.262819e-02 1 1  ON 3
 uu_4                -6.861498e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320310e-01 1 1  ON 6
 uu_7                -1.463949e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110345e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880342e-01 1 1  ON 11
 ud_2                 6.677835e-02 1 1  ON 12
 ud_3                -5.308053e-03 1 1  ON 13
 ud_4                -6.304098e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337754e-01 1 1  ON 16
 ud_7                -1.514812e-01 1 1  ON 17
 ud_8                -1.527631e-01 1 1  ON 18
 ud_9                -1.453062e-01 1 1  ON 19
 eO_0                -7.629996e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719219e-02 1 1  ON 22
 eO_3                 3.067132e-01 1 1  ON 23
 eO_4                 5.357806e-01 1 1  ON 24
 eO_5                 4.998054e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695357e-02 1 1  ON 27
 eO_8                -2.404220e-01 1 1  ON 28
 eO_9                -1.100422e-01 1 1  ON 29
eH1_0                -2.568789e-01 1 1  ON 30
eH1_1                -1.552943e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285376e-02 1 1  ON 33
eH1_4                -3.900581e-03 1 1  ON 34
eH1_5                 3.156524e-02 1 1  ON 35
eH1_6                 9.284644e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962655e-01 1 1  ON 38
eH1_9                 9.881927e-02 1 1  ON 39
eH2_0                -2.541976e-01 1 1  ON 40
eH2_1                -1.521782e-01 1 1  ON 41
eH2_2                -1.048817e-01 1 1  ON 42
eH2_3                -5.021370e-02 1 1  ON 43
eH2_4                -1.230583e-03 1 1  ON 44
eH2_5                 3.329962e-02 1 1  ON 45
eH2_6                 9.473221e-02 1 1  ON 46
eH2_7                 1.558657e-01 1 1  ON 47
eH2_8                 1.990264e-01 1 1  ON 48
eH2_9                 9.252252e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9178
    reference variance = 0.158125
====================================================
  Execution time = 1.9902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3284e-01
  Total weights = 2.0000e+06
  Execution time = 1.8609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332875988368
                                         uncertainty =       0.002788963607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332875988368
                                         uncertainty =       0.002788963607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407943609
  error estimate for blocks of size 2^( 2) =       0.000420431577
  error estimate for blocks of size 2^( 3) =       0.000433619778
  error estimate for blocks of size 2^( 4) =       0.000445536912
  error estimate for blocks of size 2^( 5) =       0.000456231224
  error estimate for blocks of size 2^( 6) =       0.000464406919
  error estimate for blocks of size 2^( 7) =       0.000470596457

      target function =                  N/A
              le_mean =     -16.906550105073
             les_mean =     286.164272265042
             stat err =       0.000459192878
             autocorr =       1.267039108520
              std dev =       0.576919384408
             le_variance =       0.332835976106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332876310236
                                         uncertainty =       0.002788971325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332876310236
                                         uncertainty =       0.002788971325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407943806
  error estimate for blocks of size 2^( 2) =       0.000420431771
  error estimate for blocks of size 2^( 3) =       0.000433619961
  error estimate for blocks of size 2^( 4) =       0.000445537095
  error estimate for blocks of size 2^( 5) =       0.000456231384
  error estimate for blocks of size 2^( 6) =       0.000464407079
  error estimate for blocks of size 2^( 7) =       0.000470596613

      target function =                  N/A
              le_mean =     -16.906550087490
             les_mean =     286.164271992846
             stat err =       0.000459193043
             autocorr =       1.267038791996
              std dev =       0.576919663778
             le_variance =       0.332836298453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332876149459
                                         uncertainty =       0.002788967473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332876149459
                                         uncertainty =       0.002788967473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407943708
  error estimate for blocks of size 2^( 2) =       0.000420431674
  error estimate for blocks of size 2^( 3) =       0.000433619870
  error estimate for blocks of size 2^( 4) =       0.000445537004
  error estimate for blocks of size 2^( 5) =       0.000456231304
  error estimate for blocks of size 2^( 6) =       0.000464406999
  error estimate for blocks of size 2^( 7) =       0.000470596535

      target function =                  N/A
              le_mean =     -16.906550096253
             les_mean =     286.164272128138
             stat err =       0.000459192961
             autocorr =       1.267038949947
              std dev =       0.576919524230
             le_variance =       0.332836137438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332876008507
                                         uncertainty =       0.002788964091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332876008507
                                         uncertainty =       0.002788964091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407943621
  error estimate for blocks of size 2^( 2) =       0.000420431589
  error estimate for blocks of size 2^( 3) =       0.000433619790
  error estimate for blocks of size 2^( 4) =       0.000445536924
  error estimate for blocks of size 2^( 5) =       0.000456231234
  error estimate for blocks of size 2^( 6) =       0.000464406929
  error estimate for blocks of size 2^( 7) =       0.000470596467

      target function =                  N/A
              le_mean =     -16.906550103970
             les_mean =     286.164272247890
             stat err =       0.000459192888
             autocorr =       1.267039088691
              std dev =       0.576919401888
             le_variance =       0.332835996275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906550105073        initial  <--
     9.3132e+01     9.3132e+02             2.2611e-06       -16.906550087490
     3.7253e+02     3.7253e+03             5.6541e-07       -16.906550096253
     1.4901e+03     1.4901e+04             1.4136e-07       -16.906550103970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2687
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424400e-01 1 1  ON 1
 uu_2                 4.035135e-02 1 1  ON 2
 uu_3                -2.262819e-02 1 1  ON 3
 uu_4                -6.861480e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320309e-01 1 1  ON 6
 uu_7                -1.463948e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110346e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677857e-02 1 1  ON 12
 ud_3                -5.308067e-03 1 1  ON 13
 ud_4                -6.304075e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527635e-01 1 1  ON 18
 ud_9                -1.453066e-01 1 1  ON 19
 eO_0                -7.629998e-01 1 1  ON 20
 eO_1                -4.398939e-01 1 1  ON 21
 eO_2                -1.719210e-02 1 1  ON 22
 eO_3                 3.067132e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998052e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695352e-02 1 1  ON 27
 eO_8                -2.404221e-01 1 1  ON 28
 eO_9                -1.100419e-01 1 1  ON 29
eH1_0                -2.568787e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285335e-02 1 1  ON 33
eH1_4                -3.900422e-03 1 1  ON 34
eH1_5                 3.156531e-02 1 1  ON 35
eH1_6                 9.284653e-02 1 1  ON 36
eH1_7                 1.557770e-01 1 1  ON 37
eH1_8                 1.962653e-01 1 1  ON 38
eH1_9                 9.881875e-02 1 1  ON 39
eH2_0                -2.541978e-01 1 1  ON 40
eH2_1                -1.521778e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021375e-02 1 1  ON 43
eH2_4                -1.230190e-03 1 1  ON 44
eH2_5                 3.329982e-02 1 1  ON 45
eH2_6                 9.473238e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990261e-01 1 1  ON 48
eH2_9                 9.252195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 0.234406
====================================================
  Execution time = 2.0433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4050e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340529497109
                                         uncertainty =       0.003606589075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340529497109
                                         uncertainty =       0.003606589075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412614465
  error estimate for blocks of size 2^( 2) =       0.000425853500
  error estimate for blocks of size 2^( 3) =       0.000438621128
  error estimate for blocks of size 2^( 4) =       0.000450604215
  error estimate for blocks of size 2^( 5) =       0.000460795069
  error estimate for blocks of size 2^( 6) =       0.000469600713
  error estimate for blocks of size 2^( 7) =       0.000474579412

      target function =                  N/A
              le_mean =     -16.905800667264
             les_mean =     286.146597424306
             stat err =       0.000463894852
             autocorr =       1.264009123208
              std dev =       0.583524972300
             le_variance =       0.340501393298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580066726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800667264       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800667252       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800666303       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800666199       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800666565       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800666602       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800666533       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800666532       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.006432e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800667264       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800667261       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800667024       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800666996       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800667089       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800667100       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800667083       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800667081       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.016198e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800667264       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800667263       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800667204       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800667194       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800667222       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800667235       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800667226       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800667213       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.254057e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5953e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424400e-01 1 1  ON 1
 uu_2                 4.035135e-02 1 1  ON 2
 uu_3                -2.262818e-02 1 1  ON 3
 uu_4                -6.861482e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320309e-01 1 1  ON 6
 uu_7                -1.463948e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110346e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880341e-01 1 1  ON 11
 ud_2                 6.677856e-02 1 1  ON 12
 ud_3                -5.308063e-03 1 1  ON 13
 ud_4                -6.304075e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527635e-01 1 1  ON 18
 ud_9                -1.453066e-01 1 1  ON 19
 eO_0                -7.629998e-01 1 1  ON 20
 eO_1                -4.398939e-01 1 1  ON 21
 eO_2                -1.719209e-02 1 1  ON 22
 eO_3                 3.067132e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998053e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695353e-02 1 1  ON 27
 eO_8                -2.404221e-01 1 1  ON 28
 eO_9                -1.100420e-01 1 1  ON 29
eH1_0                -2.568787e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285336e-02 1 1  ON 33
eH1_4                -3.900432e-03 1 1  ON 34
eH1_5                 3.156535e-02 1 1  ON 35
eH1_6                 9.284650e-02 1 1  ON 36
eH1_7                 1.557770e-01 1 1  ON 37
eH1_8                 1.962653e-01 1 1  ON 38
eH1_9                 9.881880e-02 1 1  ON 39
eH2_0                -2.541978e-01 1 1  ON 40
eH2_1                -1.521778e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021378e-02 1 1  ON 43
eH2_4                -1.230208e-03 1 1  ON 44
eH2_5                 3.329984e-02 1 1  ON 45
eH2_6                 9.473240e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990261e-01 1 1  ON 48
eH2_9                 9.252200e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9451
    reference variance = 0.66933
====================================================
  Execution time = 2.0485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373920752
                                         uncertainty =       0.005559857129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373920752
                                         uncertainty =       0.005559857129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415585363
  error estimate for blocks of size 2^( 2) =       0.000428572210
  error estimate for blocks of size 2^( 3) =       0.000441672648
  error estimate for blocks of size 2^( 4) =       0.000453490651
  error estimate for blocks of size 2^( 5) =       0.000464556240
  error estimate for blocks of size 2^( 6) =       0.000473783045
  error estimate for blocks of size 2^( 7) =       0.000479452601

      target function =                  N/A
              le_mean =     -16.905470669983
             les_mean =     286.140360789530
             stat err =       0.000467820634
             autocorr =       1.267179853916
              std dev =       0.587726457293
             le_variance =       0.345422388602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373896545
                                         uncertainty =       0.005559854280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373896545
                                         uncertainty =       0.005559854280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415585349
  error estimate for blocks of size 2^( 2) =       0.000428572195
  error estimate for blocks of size 2^( 3) =       0.000441672634
  error estimate for blocks of size 2^( 4) =       0.000453490638
  error estimate for blocks of size 2^( 5) =       0.000464556227
  error estimate for blocks of size 2^( 6) =       0.000473783031
  error estimate for blocks of size 2^( 7) =       0.000479452590

      target function =                  N/A
              le_mean =     -16.905470670460
             les_mean =     286.140360781389
             stat err =       0.000467820621
             autocorr =       1.267179872969
              std dev =       0.587726436643
             le_variance =       0.345422364329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373908638
                                         uncertainty =       0.005559855704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373908638
                                         uncertainty =       0.005559855704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415585356
  error estimate for blocks of size 2^( 2) =       0.000428572202
  error estimate for blocks of size 2^( 3) =       0.000441672641
  error estimate for blocks of size 2^( 4) =       0.000453490644
  error estimate for blocks of size 2^( 5) =       0.000464556234
  error estimate for blocks of size 2^( 6) =       0.000473783038
  error estimate for blocks of size 2^( 7) =       0.000479452595

      target function =                  N/A
              le_mean =     -16.905470670221
             les_mean =     286.140360785448
             stat err =       0.000467820628
             autocorr =       1.267179863448
              std dev =       0.587726446959
             le_variance =       0.345422376455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373919237
                                         uncertainty =       0.005559856951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345373919237
                                         uncertainty =       0.005559856951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415585363
  error estimate for blocks of size 2^( 2) =       0.000428572209
  error estimate for blocks of size 2^( 3) =       0.000441672647
  error estimate for blocks of size 2^( 4) =       0.000453490650
  error estimate for blocks of size 2^( 5) =       0.000464556240
  error estimate for blocks of size 2^( 6) =       0.000473783044
  error estimate for blocks of size 2^( 7) =       0.000479452600

      target function =                  N/A
              le_mean =     -16.905470670012
             les_mean =     286.140360789019
             stat err =       0.000467820634
             autocorr =       1.267179855117
              std dev =       0.587726456001
             le_variance =       0.345422387083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905470669983        initial
     9.3132e+02     9.3132e+03             2.0064e-07       -16.905470670460  <--
     3.7253e+03     3.7253e+04             5.0162e-08       -16.905470670221
     1.4901e+04     1.4901e+05             1.2541e-08       -16.905470670012

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 2.9832e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424399e-01 1 1  ON 1
 uu_2                 4.035137e-02 1 1  ON 2
 uu_3                -2.262815e-02 1 1  ON 3
 uu_4                -6.861488e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320309e-01 1 1  ON 6
 uu_7                -1.463948e-01 1 1  ON 7
 uu_8                -1.390387e-01 1 1  ON 8
 uu_9                -1.110346e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880342e-01 1 1  ON 11
 ud_2                 6.677852e-02 1 1  ON 12
 ud_3                -5.308052e-03 1 1  ON 13
 ud_4                -6.304078e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514810e-01 1 1  ON 17
 ud_8                -1.527634e-01 1 1  ON 18
 ud_9                -1.453065e-01 1 1  ON 19
 eO_0                -7.629998e-01 1 1  ON 20
 eO_1                -4.398938e-01 1 1  ON 21
 eO_2                -1.719207e-02 1 1  ON 22
 eO_3                 3.067132e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998054e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695356e-02 1 1  ON 27
 eO_8                -2.404221e-01 1 1  ON 28
 eO_9                -1.100420e-01 1 1  ON 29
eH1_0                -2.568788e-01 1 1  ON 30
eH1_1                -1.552942e-01 1 1  ON 31
eH1_2                -1.078398e-01 1 1  ON 32
eH1_3                -5.285338e-02 1 1  ON 33
eH1_4                -3.900464e-03 1 1  ON 34
eH1_5                 3.156548e-02 1 1  ON 35
eH1_6                 9.284641e-02 1 1  ON 36
eH1_7                 1.557769e-01 1 1  ON 37
eH1_8                 1.962654e-01 1 1  ON 38
eH1_9                 9.881895e-02 1 1  ON 39
eH2_0                -2.541979e-01 1 1  ON 40
eH2_1                -1.521779e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021385e-02 1 1  ON 43
eH2_4                -1.230264e-03 1 1  ON 44
eH2_5                 3.329990e-02 1 1  ON 45
eH2_6                 9.473246e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990261e-01 1 1  ON 48
eH2_9                 9.252214e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5791e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.197828
====================================================
  Execution time = 2.0794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4608e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346138969616
                                         uncertainty =       0.006161851822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346138969616
                                         uncertainty =       0.006161851822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415981648
  error estimate for blocks of size 2^( 2) =       0.000428601015
  error estimate for blocks of size 2^( 3) =       0.000441583279
  error estimate for blocks of size 2^( 4) =       0.000452984090
  error estimate for blocks of size 2^( 5) =       0.000463313629
  error estimate for blocks of size 2^( 6) =       0.000470885113
  error estimate for blocks of size 2^( 7) =       0.000475751929

      target function =                  N/A
              le_mean =     -16.906067727309
             les_mean =     286.161207289499
             stat err =       0.000465733690
             autocorr =       1.253507593594
              std dev =       0.588286887656
             le_variance =       0.346081462188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606772731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067727309       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067730092       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067731852       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067736399       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067736319       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067735205       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067735495       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067735438       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.786900e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067727309       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067728005       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067728446       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067729583       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067729565       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067729287       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067729357       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067729344       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.197502e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067727309       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067727483       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067727593       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067727876       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067727873       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067727808       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067727823       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067727818       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.494242e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6372e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424398e-01 1 1  ON 1
 uu_2                 4.035151e-02 1 1  ON 2
 uu_3                -2.262805e-02 1 1  ON 3
 uu_4                -6.861486e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320310e-01 1 1  ON 6
 uu_7                -1.463948e-01 1 1  ON 7
 uu_8                -1.390388e-01 1 1  ON 8
 uu_9                -1.110347e-01 1 1  ON 9
 ud_0                 4.545295e-01 1 1  ON 10
 ud_1                 1.880343e-01 1 1  ON 11
 ud_2                 6.677855e-02 1 1  ON 12
 ud_3                -5.307987e-03 1 1  ON 13
 ud_4                -6.304077e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337753e-01 1 1  ON 16
 ud_7                -1.514809e-01 1 1  ON 17
 ud_8                -1.527636e-01 1 1  ON 18
 ud_9                -1.453066e-01 1 1  ON 19
 eO_0                -7.629997e-01 1 1  ON 20
 eO_1                -4.398938e-01 1 1  ON 21
 eO_2                -1.719203e-02 1 1  ON 22
 eO_3                 3.067131e-01 1 1  ON 23
 eO_4                 5.357808e-01 1 1  ON 24
 eO_5                 4.998054e-01 1 1  ON 25
 eO_6                 2.706128e-01 1 1  ON 26
 eO_7                -3.695350e-02 1 1  ON 27
 eO_8                -2.404222e-01 1 1  ON 28
 eO_9                -1.100422e-01 1 1  ON 29
eH1_0                -2.568789e-01 1 1  ON 30
eH1_1                -1.552944e-01 1 1  ON 31
eH1_2                -1.078397e-01 1 1  ON 32
eH1_3                -5.285346e-02 1 1  ON 33
eH1_4                -3.900416e-03 1 1  ON 34
eH1_5                 3.156548e-02 1 1  ON 35
eH1_6                 9.284645e-02 1 1  ON 36
eH1_7                 1.557770e-01 1 1  ON 37
eH1_8                 1.962654e-01 1 1  ON 38
eH1_9                 9.881906e-02 1 1  ON 39
eH2_0                -2.541979e-01 1 1  ON 40
eH2_1                -1.521780e-01 1 1  ON 41
eH2_2                -1.048815e-01 1 1  ON 42
eH2_3                -5.021389e-02 1 1  ON 43
eH2_4                -1.230484e-03 1 1  ON 44
eH2_5                 3.329997e-02 1 1  ON 45
eH2_6                 9.473248e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990262e-01 1 1  ON 48
eH2_9                 9.252233e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.945
    reference variance = 0.208949
====================================================
  Execution time = 1.9878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4057e-01
  Total weights = 2.0000e+06
  Execution time = 1.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281636720
                                         uncertainty =       0.004211663573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281636720
                                         uncertainty =       0.004211663573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412653528
  error estimate for blocks of size 2^( 2) =       0.000425394075
  error estimate for blocks of size 2^( 3) =       0.000438464000
  error estimate for blocks of size 2^( 4) =       0.000450303746
  error estimate for blocks of size 2^( 5) =       0.000461283235
  error estimate for blocks of size 2^( 6) =       0.000468918106
  error estimate for blocks of size 2^( 7) =       0.000476111163

      target function =                  N/A
              le_mean =     -16.906398666212
             les_mean =     286.166881558700
             stat err =       0.000464154062
             autocorr =       1.265182532074
              std dev =       0.583580215644
             le_variance =       0.340565868091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281012661
                                         uncertainty =       0.004211652813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281012661
                                         uncertainty =       0.004211652813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412653148
  error estimate for blocks of size 2^( 2) =       0.000425393706
  error estimate for blocks of size 2^( 3) =       0.000438463639
  error estimate for blocks of size 2^( 4) =       0.000450303402
  error estimate for blocks of size 2^( 5) =       0.000461282907
  error estimate for blocks of size 2^( 6) =       0.000468917781
  error estimate for blocks of size 2^( 7) =       0.000476110836

      target function =                  N/A
              le_mean =     -16.906398671135
             les_mean =     286.166881098850
             stat err =       0.000464153732
             autocorr =       1.265183054925
              std dev =       0.583579679027
             le_variance =       0.340565241774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281324195
                                         uncertainty =       0.004211658184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281324195
                                         uncertainty =       0.004211658184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412653338
  error estimate for blocks of size 2^( 2) =       0.000425393890
  error estimate for blocks of size 2^( 3) =       0.000438463819
  error estimate for blocks of size 2^( 4) =       0.000450303574
  error estimate for blocks of size 2^( 5) =       0.000461283071
  error estimate for blocks of size 2^( 6) =       0.000468917943
  error estimate for blocks of size 2^( 7) =       0.000476111000

      target function =                  N/A
              le_mean =     -16.906398668677
             les_mean =     286.166881328409
             stat err =       0.000464153897
             autocorr =       1.265182793917
              std dev =       0.583579946910
             le_variance =       0.340565554435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281597639
                                         uncertainty =       0.004211662899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340281597639
                                         uncertainty =       0.004211662899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412653504
  error estimate for blocks of size 2^( 2) =       0.000425394052
  error estimate for blocks of size 2^( 3) =       0.000438463978
  error estimate for blocks of size 2^( 4) =       0.000450303724
  error estimate for blocks of size 2^( 5) =       0.000461283214
  error estimate for blocks of size 2^( 6) =       0.000468918085
  error estimate for blocks of size 2^( 7) =       0.000476111143

      target function =                  N/A
              le_mean =     -16.906398666520
             les_mean =     286.166881529900
             stat err =       0.000464154042
             autocorr =       1.265182564815
              std dev =       0.583580182038
             le_variance =       0.340565828868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906398666212        initial
     2.3283e+02     2.3283e+03             8.7869e-07       -16.906398671135  <--
     9.3132e+02     9.3132e+03             2.1975e-07       -16.906398668677
     3.7253e+03     3.7253e+04             5.4942e-08       -16.906398666520

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 3.3157e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424395e-01 1 1  ON 1
 uu_2                 4.035194e-02 1 1  ON 2
 uu_3                -2.262775e-02 1 1  ON 3
 uu_4                -6.861478e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320311e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390392e-01 1 1  ON 8
 uu_9                -1.110351e-01 1 1  ON 9
 ud_0                 4.545294e-01 1 1  ON 10
 ud_1                 1.880347e-01 1 1  ON 11
 ud_2                 6.677863e-02 1 1  ON 12
 ud_3                -5.307793e-03 1 1  ON 13
 ud_4                -6.304075e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337750e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527639e-01 1 1  ON 18
 ud_9                -1.453071e-01 1 1  ON 19
 eO_0                -7.629992e-01 1 1  ON 20
 eO_1                -4.398937e-01 1 1  ON 21
 eO_2                -1.719190e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357809e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695332e-02 1 1  ON 27
 eO_8                -2.404226e-01 1 1  ON 28
 eO_9                -1.100427e-01 1 1  ON 29
eH1_0                -2.568792e-01 1 1  ON 30
eH1_1                -1.552947e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285367e-02 1 1  ON 33
eH1_4                -3.900272e-03 1 1  ON 34
eH1_5                 3.156549e-02 1 1  ON 35
eH1_6                 9.284658e-02 1 1  ON 36
eH1_7                 1.557772e-01 1 1  ON 37
eH1_8                 1.962655e-01 1 1  ON 38
eH1_9                 9.881939e-02 1 1  ON 39
eH2_0                -2.541979e-01 1 1  ON 40
eH2_1                -1.521782e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021401e-02 1 1  ON 43
eH2_4                -1.231142e-03 1 1  ON 44
eH2_5                 3.330017e-02 1 1  ON 45
eH2_6                 9.473255e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990264e-01 1 1  ON 48
eH2_9                 9.252289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9535e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8652
    reference variance = 0.301578
====================================================
  Execution time = 2.0586e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337736850082
                                         uncertainty =       0.003135464141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337736850082
                                         uncertainty =       0.003135464141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410950773
  error estimate for blocks of size 2^( 2) =       0.000423906915
  error estimate for blocks of size 2^( 3) =       0.000436901549
  error estimate for blocks of size 2^( 4) =       0.000448772030
  error estimate for blocks of size 2^( 5) =       0.000459538306
  error estimate for blocks of size 2^( 6) =       0.000466327121
  error estimate for blocks of size 2^( 7) =       0.000474541043

      target function =                  N/A
              le_mean =     -16.906632731762
             les_mean =     286.171991232867
             stat err =       0.000462294625
             autocorr =       1.265488157348
              std dev =       0.581172156126
             le_variance =       0.337761075056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663273176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906632731762       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906632726590       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906632719877       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906632715041       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906632718264       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906632720562       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906632720756       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906632721596       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.758317e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906632731762       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906632730467       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906632728779       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906632727565       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906632728371       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906632728941       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906632728986       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906632729195       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 9.398269e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906632731762       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906632731438       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906632731016       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906632730712       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906632730913       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906632731056       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906632731067       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906632731121       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.349723e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6144e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093239e-01 1 1  ON 0
 uu_1                 1.424390e-01 1 1  ON 1
 uu_2                 4.035205e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861481e-02 1 1  ON 4
 uu_5                -1.038995e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463954e-01 1 1  ON 7
 uu_8                -1.390392e-01 1 1  ON 8
 uu_9                -1.110351e-01 1 1  ON 9
 ud_0                 4.545292e-01 1 1  ON 10
 ud_1                 1.880351e-01 1 1  ON 11
 ud_2                 6.677849e-02 1 1  ON 12
 ud_3                -5.307840e-03 1 1  ON 13
 ud_4                -6.304082e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337749e-01 1 1  ON 16
 ud_7                -1.514803e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.629993e-01 1 1  ON 20
 eO_1                -4.398931e-01 1 1  ON 21
 eO_2                -1.719196e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357811e-01 1 1  ON 24
 eO_5                 4.998053e-01 1 1  ON 25
 eO_6                 2.706132e-01 1 1  ON 26
 eO_7                -3.695312e-02 1 1  ON 27
 eO_8                -2.404230e-01 1 1  ON 28
 eO_9                -1.100432e-01 1 1  ON 29
eH1_0                -2.568799e-01 1 1  ON 30
eH1_1                -1.552950e-01 1 1  ON 31
eH1_2                -1.078401e-01 1 1  ON 32
eH1_3                -5.285418e-02 1 1  ON 33
eH1_4                -3.900295e-03 1 1  ON 34
eH1_5                 3.156591e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557772e-01 1 1  ON 37
eH1_8                 1.962661e-01 1 1  ON 38
eH1_9                 9.882033e-02 1 1  ON 39
eH2_0                -2.541987e-01 1 1  ON 40
eH2_1                -1.521786e-01 1 1  ON 41
eH2_2                -1.048818e-01 1 1  ON 42
eH2_3                -5.021403e-02 1 1  ON 43
eH2_4                -1.231327e-03 1 1  ON 44
eH2_5                 3.330048e-02 1 1  ON 45
eH2_6                 9.473282e-02 1 1  ON 46
eH2_7                 1.558656e-01 1 1  ON 47
eH2_8                 1.990266e-01 1 1  ON 48
eH2_9                 9.252351e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8514
    reference variance = 0.619802
====================================================
  Execution time = 2.0040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3586e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921302402
                                         uncertainty =       0.003659096843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921302402
                                         uncertainty =       0.003659096843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409790496
  error estimate for blocks of size 2^( 2) =       0.000422403048
  error estimate for blocks of size 2^( 3) =       0.000435329984
  error estimate for blocks of size 2^( 4) =       0.000446998868
  error estimate for blocks of size 2^( 5) =       0.000457351829
  error estimate for blocks of size 2^( 6) =       0.000464940740
  error estimate for blocks of size 2^( 7) =       0.000469890402

      target function =                  N/A
              le_mean =     -16.906298771804
             les_mean =     286.158794495461
             stat err =       0.000459795460
             autocorr =       1.258941622465
              std dev =       0.579531277744
             le_variance =       0.335856501883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335920125000
                                         uncertainty =       0.003659079483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335920125000
                                         uncertainty =       0.003659079483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409789778
  error estimate for blocks of size 2^( 2) =       0.000422402371
  error estimate for blocks of size 2^( 3) =       0.000435329333
  error estimate for blocks of size 2^( 4) =       0.000446998230
  error estimate for blocks of size 2^( 5) =       0.000457351210
  error estimate for blocks of size 2^( 6) =       0.000464940060
  error estimate for blocks of size 2^( 7) =       0.000469889677

      target function =                  N/A
              le_mean =     -16.906298763554
             les_mean =     286.158793039608
             stat err =       0.000459794794
             autocorr =       1.258942389188
              std dev =       0.579530262372
             le_variance =       0.335855325005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335920708245
                                         uncertainty =       0.003659088093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335920708245
                                         uncertainty =       0.003659088093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409790134
  error estimate for blocks of size 2^( 2) =       0.000422402706
  error estimate for blocks of size 2^( 3) =       0.000435329656
  error estimate for blocks of size 2^( 4) =       0.000446998546
  error estimate for blocks of size 2^( 5) =       0.000457351516
  error estimate for blocks of size 2^( 6) =       0.000464940397
  error estimate for blocks of size 2^( 7) =       0.000469890036

      target function =                  N/A
              le_mean =     -16.906298767654
             les_mean =     286.158793761253
             stat err =       0.000459795124
             autocorr =       1.258942009571
              std dev =       0.579530765352
             le_variance =       0.335855907990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921227956
                                         uncertainty =       0.003659095747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921227956
                                         uncertainty =       0.003659095747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409790451
  error estimate for blocks of size 2^( 2) =       0.000422403005
  error estimate for blocks of size 2^( 3) =       0.000435329943
  error estimate for blocks of size 2^( 4) =       0.000446998827
  error estimate for blocks of size 2^( 5) =       0.000457351790
  error estimate for blocks of size 2^( 6) =       0.000464940697
  error estimate for blocks of size 2^( 7) =       0.000469890356

      target function =                  N/A
              le_mean =     -16.906298771284
             les_mean =     286.158794403464
             stat err =       0.000459795418
             autocorr =       1.258941670977
              std dev =       0.579531213542
             le_variance =       0.335856427470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906298771804        initial  <--
     5.8208e+01     5.8208e+02             3.7583e-06       -16.906298763554
     2.3283e+02     2.3283e+03             9.3983e-07       -16.906298767654
     9.3132e+02     9.3132e+03             2.3497e-07       -16.906298771284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4510
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424395e-01 1 1  ON 1
 uu_2                 4.035194e-02 1 1  ON 2
 uu_3                -2.262775e-02 1 1  ON 3
 uu_4                -6.861478e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320311e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390392e-01 1 1  ON 8
 uu_9                -1.110351e-01 1 1  ON 9
 ud_0                 4.545294e-01 1 1  ON 10
 ud_1                 1.880347e-01 1 1  ON 11
 ud_2                 6.677863e-02 1 1  ON 12
 ud_3                -5.307793e-03 1 1  ON 13
 ud_4                -6.304075e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337750e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527639e-01 1 1  ON 18
 ud_9                -1.453071e-01 1 1  ON 19
 eO_0                -7.629992e-01 1 1  ON 20
 eO_1                -4.398937e-01 1 1  ON 21
 eO_2                -1.719190e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357809e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695332e-02 1 1  ON 27
 eO_8                -2.404226e-01 1 1  ON 28
 eO_9                -1.100427e-01 1 1  ON 29
eH1_0                -2.568792e-01 1 1  ON 30
eH1_1                -1.552947e-01 1 1  ON 31
eH1_2                -1.078396e-01 1 1  ON 32
eH1_3                -5.285367e-02 1 1  ON 33
eH1_4                -3.900272e-03 1 1  ON 34
eH1_5                 3.156549e-02 1 1  ON 35
eH1_6                 9.284658e-02 1 1  ON 36
eH1_7                 1.557772e-01 1 1  ON 37
eH1_8                 1.962655e-01 1 1  ON 38
eH1_9                 9.881939e-02 1 1  ON 39
eH2_0                -2.541979e-01 1 1  ON 40
eH2_1                -1.521782e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021401e-02 1 1  ON 43
eH2_4                -1.231142e-03 1 1  ON 44
eH2_5                 3.330017e-02 1 1  ON 45
eH2_6                 9.473255e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990264e-01 1 1  ON 48
eH2_9                 9.252289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8446
    reference variance = 0.325161
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4147e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341515702166
                                         uncertainty =       0.003465881502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341515702166
                                         uncertainty =       0.003465881502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413198654
  error estimate for blocks of size 2^( 2) =       0.000425487324
  error estimate for blocks of size 2^( 3) =       0.000438066401
  error estimate for blocks of size 2^( 4) =       0.000450396335
  error estimate for blocks of size 2^( 5) =       0.000459821743
  error estimate for blocks of size 2^( 6) =       0.000466320792
  error estimate for blocks of size 2^( 7) =       0.000469670470

      target function =                  N/A
              le_mean =     -16.906361042449
             les_mean =     286.166509781701
             stat err =       0.000461552335
             autocorr =       1.247740032570
              std dev =       0.584351139983
             le_variance =       0.341466254799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636104245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361042449       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361042982       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361041611       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361041311       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361041412       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361041270       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361041466       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361041370       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.381028e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361042449       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361042582       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361042239       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361042164       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361042189       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361042154       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361042203       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361042178       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.457355e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361042449       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361042482       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361042397       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361042378       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361042388       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361042377       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361042388       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361042382       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.114638e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6059e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093238e-01 1 1  ON 0
 uu_1                 1.424395e-01 1 1  ON 1
 uu_2                 4.035203e-02 1 1  ON 2
 uu_3                -2.262772e-02 1 1  ON 3
 uu_4                -6.861475e-02 1 1  ON 4
 uu_5                -1.038994e-01 1 1  ON 5
 uu_6                -1.320311e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390392e-01 1 1  ON 8
 uu_9                -1.110352e-01 1 1  ON 9
 ud_0                 4.545294e-01 1 1  ON 10
 ud_1                 1.880348e-01 1 1  ON 11
 ud_2                 6.677862e-02 1 1  ON 12
 ud_3                -5.307796e-03 1 1  ON 13
 ud_4                -6.304072e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337749e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527639e-01 1 1  ON 18
 ud_9                -1.453071e-01 1 1  ON 19
 eO_0                -7.629992e-01 1 1  ON 20
 eO_1                -4.398937e-01 1 1  ON 21
 eO_2                -1.719189e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695332e-02 1 1  ON 27
 eO_8                -2.404227e-01 1 1  ON 28
 eO_9                -1.100428e-01 1 1  ON 29
eH1_0                -2.568793e-01 1 1  ON 30
eH1_1                -1.552947e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285367e-02 1 1  ON 33
eH1_4                -3.900296e-03 1 1  ON 34
eH1_5                 3.156550e-02 1 1  ON 35
eH1_6                 9.284658e-02 1 1  ON 36
eH1_7                 1.557772e-01 1 1  ON 37
eH1_8                 1.962655e-01 1 1  ON 38
eH1_9                 9.881945e-02 1 1  ON 39
eH2_0                -2.541979e-01 1 1  ON 40
eH2_1                -1.521782e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021404e-02 1 1  ON 43
eH2_4                -1.231153e-03 1 1  ON 44
eH2_5                 3.330016e-02 1 1  ON 45
eH2_6                 9.473257e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990264e-01 1 1  ON 48
eH2_9                 9.252297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9897
    reference variance = 0.356175
====================================================
  Execution time = 1.9955e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4511e-01
  Total weights = 2.0000e+06
  Execution time = 1.8575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065299583
                                         uncertainty =       0.005185777566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065299583
                                         uncertainty =       0.005185777566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415395084
  error estimate for blocks of size 2^( 2) =       0.000428193364
  error estimate for blocks of size 2^( 3) =       0.000440458223
  error estimate for blocks of size 2^( 4) =       0.000453051702
  error estimate for blocks of size 2^( 5) =       0.000462994748
  error estimate for blocks of size 2^( 6) =       0.000469751024
  error estimate for blocks of size 2^( 7) =       0.000477161212

      target function =                  N/A
              le_mean =     -16.905295484627
             les_mean =     286.134121402364
             stat err =       0.000465739672
             autocorr =       1.257082438570
              std dev =       0.587457362176
             le_variance =       0.345106152375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345064832056
                                         uncertainty =       0.005185775562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345064832056
                                         uncertainty =       0.005185775562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415394803
  error estimate for blocks of size 2^( 2) =       0.000428193092
  error estimate for blocks of size 2^( 3) =       0.000440457962
  error estimate for blocks of size 2^( 4) =       0.000453051450
  error estimate for blocks of size 2^( 5) =       0.000462994502
  error estimate for blocks of size 2^( 6) =       0.000469750789
  error estimate for blocks of size 2^( 7) =       0.000477160975

      target function =                  N/A
              le_mean =     -16.905295485938
             les_mean =     286.134120979182
             stat err =       0.000465739429
             autocorr =       1.257082832653
              std dev =       0.587456964255
             le_variance =       0.345105684851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065065673
                                         uncertainty =       0.005185776563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065065673
                                         uncertainty =       0.005185776563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415394944
  error estimate for blocks of size 2^( 2) =       0.000428193228
  error estimate for blocks of size 2^( 3) =       0.000440458092
  error estimate for blocks of size 2^( 4) =       0.000453051576
  error estimate for blocks of size 2^( 5) =       0.000462994625
  error estimate for blocks of size 2^( 6) =       0.000469750907
  error estimate for blocks of size 2^( 7) =       0.000477161094

      target function =                  N/A
              le_mean =     -16.905295485283
             les_mean =     286.134121190628
             stat err =       0.000465739550
             autocorr =       1.257082635741
              std dev =       0.587457163091
             le_variance =       0.345105918466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065270339
                                         uncertainty =       0.005185777441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065270339
                                         uncertainty =       0.005185777441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415395067
  error estimate for blocks of size 2^( 2) =       0.000428193347
  error estimate for blocks of size 2^( 3) =       0.000440458206
  error estimate for blocks of size 2^( 4) =       0.000453051686
  error estimate for blocks of size 2^( 5) =       0.000462994733
  error estimate for blocks of size 2^( 6) =       0.000469751010
  error estimate for blocks of size 2^( 7) =       0.000477161198

      target function =                  N/A
              le_mean =     -16.905295484709
             les_mean =     286.134121375892
             stat err =       0.000465739657
             autocorr =       1.257082463224
              std dev =       0.587457337286
             le_variance =       0.345106123131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905295484627        initial
     5.8208e+02     5.8208e+03             3.3810e-07       -16.905295485938  <--
     2.3283e+03     2.3283e+04             8.4574e-08       -16.905295485283
     9.3132e+03     9.3132e+04             2.1146e-08       -16.905295484709

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 2.9335e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093236e-01 1 1  ON 0
 uu_1                 1.424394e-01 1 1  ON 1
 uu_2                 4.035228e-02 1 1  ON 2
 uu_3                -2.262764e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545292e-01 1 1  ON 10
 ud_1                 1.880351e-01 1 1  ON 11
 ud_2                 6.677860e-02 1 1  ON 12
 ud_3                -5.307806e-03 1 1  ON 13
 ud_4                -6.304063e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337749e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527639e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398937e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695334e-02 1 1  ON 27
 eO_8                -2.404228e-01 1 1  ON 28
 eO_9                -1.100429e-01 1 1  ON 29
eH1_0                -2.568795e-01 1 1  ON 30
eH1_1                -1.552947e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285366e-02 1 1  ON 33
eH1_4                -3.900370e-03 1 1  ON 34
eH1_5                 3.156555e-02 1 1  ON 35
eH1_6                 9.284656e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881962e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521784e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021412e-02 1 1  ON 43
eH2_4                -1.231186e-03 1 1  ON 44
eH2_5                 3.330010e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9354
    reference variance = 0.327081
====================================================
  Execution time = 2.0328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4644e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346511621717
                                         uncertainty =       0.005049751394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346511621717
                                         uncertainty =       0.005049751394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416198819
  error estimate for blocks of size 2^( 2) =       0.000428822261
  error estimate for blocks of size 2^( 3) =       0.000441882427
  error estimate for blocks of size 2^( 4) =       0.000454097808
  error estimate for blocks of size 2^( 5) =       0.000465908083
  error estimate for blocks of size 2^( 6) =       0.000472340777
  error estimate for blocks of size 2^( 7) =       0.000477790678

      target function =                  N/A
              le_mean =     -16.906112871146
             les_mean =     286.163095152679
             stat err =       0.000467534337
             autocorr =       1.261901150365
              std dev =       0.588594014553
             le_variance =       0.346442913968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611287115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906112871146       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112867397       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906112861986       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112861155       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112860884       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112861142       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906112862230       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.259149e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906112871146       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112870208       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906112868853       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112868643       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112868574       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112868639       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906112868912       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.148349e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906112871146       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112870912       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906112870573       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112870518       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112870503       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112870521       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906112870588       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 7.871169e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242751 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5855e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093233e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035244e-02 1 1  ON 2
 uu_3                -2.262749e-02 1 1  ON 3
 uu_4                -6.861467e-02 1 1  ON 4
 uu_5                -1.038992e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463951e-01 1 1  ON 7
 uu_8                -1.390394e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545292e-01 1 1  ON 10
 ud_1                 1.880351e-01 1 1  ON 11
 ud_2                 6.677861e-02 1 1  ON 12
 ud_3                -5.307758e-03 1 1  ON 13
 ud_4                -6.304069e-02 1 1  ON 14
 ud_5                -1.052236e-01 1 1  ON 15
 ud_6                -1.337749e-01 1 1  ON 16
 ud_7                -1.514804e-01 1 1  ON 17
 ud_8                -1.527638e-01 1 1  ON 18
 ud_9                -1.453070e-01 1 1  ON 19
 eO_0                -7.629989e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719201e-02 1 1  ON 22
 eO_3                 3.067129e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998058e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695342e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100431e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285378e-02 1 1  ON 33
eH1_4                -3.900454e-03 1 1  ON 34
eH1_5                 3.156548e-02 1 1  ON 35
eH1_6                 9.284641e-02 1 1  ON 36
eH1_7                 1.557772e-01 1 1  ON 37
eH1_8                 1.962657e-01 1 1  ON 38
eH1_9                 9.881994e-02 1 1  ON 39
eH2_0                -2.541981e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048817e-01 1 1  ON 42
eH2_3                -5.021420e-02 1 1  ON 43
eH2_4                -1.231289e-03 1 1  ON 44
eH2_5                 3.330017e-02 1 1  ON 45
eH2_6                 9.473262e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252352e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.6426
    reference variance = 5.85952
====================================================
  Execution time = 1.9959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5326e-01
  Total weights = 2.0000e+06
  Execution time = 1.8692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352928835791
                                         uncertainty =       0.011611508570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352928835791
                                         uncertainty =       0.011611508570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420275471
  error estimate for blocks of size 2^( 2) =       0.000433255378
  error estimate for blocks of size 2^( 3) =       0.000446382649
  error estimate for blocks of size 2^( 4) =       0.000458725675
  error estimate for blocks of size 2^( 5) =       0.000469888088
  error estimate for blocks of size 2^( 6) =       0.000479557633
  error estimate for blocks of size 2^( 7) =       0.000484422307

      target function =                  N/A
              le_mean =     -16.905372927703
             les_mean =     286.144896590799
             stat err =       0.000473148426
             autocorr =       1.267437966709
              std dev =       0.594359270738
             le_variance =       0.353262942712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352927851203
                                         uncertainty =       0.011611463882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352927851203
                                         uncertainty =       0.011611463882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420274883
  error estimate for blocks of size 2^( 2) =       0.000433254822
  error estimate for blocks of size 2^( 3) =       0.000446382124
  error estimate for blocks of size 2^( 4) =       0.000458725172
  error estimate for blocks of size 2^( 5) =       0.000469887578
  error estimate for blocks of size 2^( 6) =       0.000479557148
  error estimate for blocks of size 2^( 7) =       0.000484421821

      target function =                  N/A
              le_mean =     -16.905372925848
             les_mean =     286.144895539704
             stat err =       0.000473147930
             autocorr =       1.267438855126
              std dev =       0.594358439285
             le_variance =       0.353261954349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352928342638
                                         uncertainty =       0.011611486175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352928342638
                                         uncertainty =       0.011611486175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420275176
  error estimate for blocks of size 2^( 2) =       0.000433255100
  error estimate for blocks of size 2^( 3) =       0.000446382386
  error estimate for blocks of size 2^( 4) =       0.000458725423
  error estimate for blocks of size 2^( 5) =       0.000469887833
  error estimate for blocks of size 2^( 6) =       0.000479557390
  error estimate for blocks of size 2^( 7) =       0.000484422064

      target function =                  N/A
              le_mean =     -16.905372926775
             les_mean =     286.144896064378
             stat err =       0.000473148177
             autocorr =       1.267438411728
              std dev =       0.594358854285
             le_variance =       0.353262447667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352928774120
                                         uncertainty =       0.011611505769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352928774120
                                         uncertainty =       0.011611505769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420275434
  error estimate for blocks of size 2^( 2) =       0.000433255343
  error estimate for blocks of size 2^( 3) =       0.000446382616
  error estimate for blocks of size 2^( 4) =       0.000458725643
  error estimate for blocks of size 2^( 5) =       0.000469888056
  error estimate for blocks of size 2^( 6) =       0.000479557603
  error estimate for blocks of size 2^( 7) =       0.000484422277

      target function =                  N/A
              le_mean =     -16.905372927587
             les_mean =     286.144896524966
             stat err =       0.000473148395
             autocorr =       1.267438022358
              std dev =       0.594359218658
             le_variance =       0.353262880804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905372927703        initial  <--
     1.4552e+02     1.4552e+03             1.2591e-06       -16.905372925848
     5.8208e+02     5.8208e+03             3.1483e-07       -16.905372926775
     2.3283e+03     2.3283e+04             7.8712e-08       -16.905372927587

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3801
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093236e-01 1 1  ON 0
 uu_1                 1.424394e-01 1 1  ON 1
 uu_2                 4.035228e-02 1 1  ON 2
 uu_3                -2.262764e-02 1 1  ON 3
 uu_4                -6.861465e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545292e-01 1 1  ON 10
 ud_1                 1.880351e-01 1 1  ON 11
 ud_2                 6.677860e-02 1 1  ON 12
 ud_3                -5.307806e-03 1 1  ON 13
 ud_4                -6.304063e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337749e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527639e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398937e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695334e-02 1 1  ON 27
 eO_8                -2.404228e-01 1 1  ON 28
 eO_9                -1.100429e-01 1 1  ON 29
eH1_0                -2.568795e-01 1 1  ON 30
eH1_1                -1.552947e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285366e-02 1 1  ON 33
eH1_4                -3.900370e-03 1 1  ON 34
eH1_5                 3.156555e-02 1 1  ON 35
eH1_6                 9.284656e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881962e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521784e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021412e-02 1 1  ON 43
eH2_4                -1.231186e-03 1 1  ON 44
eH2_5                 3.330010e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 0.147496
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6520e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365243541617
                                         uncertainty =       0.026374920536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365243541617
                                         uncertainty =       0.026374920536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427316745
  error estimate for blocks of size 2^( 2) =       0.000439697561
  error estimate for blocks of size 2^( 3) =       0.000451813874
  error estimate for blocks of size 2^( 4) =       0.000463496238
  error estimate for blocks of size 2^( 5) =       0.000474001333
  error estimate for blocks of size 2^( 6) =       0.000481978756
  error estimate for blocks of size 2^( 7) =       0.000486472902

      target function =                  N/A
              le_mean =     -16.906371981251
             les_mean =     286.190612586434
             stat err =       0.000476487307
             autocorr =       1.243377059324
              std dev =       0.604317135786
             le_variance =       0.365199200604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637198125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371981251       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371981680       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371982217       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371982365       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371983026       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371983189       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371983287       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906371983249       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.733689e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371981251       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371981358       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371981493       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371981529       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371981695       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371981736       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371981757       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906371981755       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.334605e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371981251       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371981278       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371981311       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371981321       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371981349       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371981350       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371981371       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906371981328       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.083675e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5921e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093235e-01 1 1  ON 0
 uu_1                 1.424394e-01 1 1  ON 1
 uu_2                 4.035231e-02 1 1  ON 2
 uu_3                -2.262763e-02 1 1  ON 3
 uu_4                -6.861463e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545292e-01 1 1  ON 10
 ud_1                 1.880351e-01 1 1  ON 11
 ud_2                 6.677862e-02 1 1  ON 12
 ud_3                -5.307801e-03 1 1  ON 13
 ud_4                -6.304062e-02 1 1  ON 14
 ud_5                -1.052235e-01 1 1  ON 15
 ud_6                -1.337749e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527639e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706129e-01 1 1  ON 26
 eO_7                -3.695334e-02 1 1  ON 27
 eO_8                -2.404228e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568795e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285366e-02 1 1  ON 33
eH1_4                -3.900362e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284656e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881965e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521784e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021412e-02 1 1  ON 43
eH2_4                -1.231191e-03 1 1  ON 44
eH2_5                 3.330008e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252325e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8898
    reference variance = 0.293315
====================================================
  Execution time = 1.9943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4165e-01
  Total weights = 2.0000e+06
  Execution time = 1.8622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725504524
                                         uncertainty =       0.004905690729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725504524
                                         uncertainty =       0.004905690729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413312315
  error estimate for blocks of size 2^( 2) =       0.000426025034
  error estimate for blocks of size 2^( 3) =       0.000439499317
  error estimate for blocks of size 2^( 4) =       0.000451730309
  error estimate for blocks of size 2^( 5) =       0.000462622731
  error estimate for blocks of size 2^( 6) =       0.000472859105
  error estimate for blocks of size 2^( 7) =       0.000479699236

      target function =                  N/A
              le_mean =     -16.906195256508
             les_mean =     286.161092020376
             stat err =       0.000466727845
             autocorr =       1.275177764896
              std dev =       0.584511881858
             le_variance =       0.341654140033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725235995
                                         uncertainty =       0.004905686724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725235995
                                         uncertainty =       0.004905686724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413312153
  error estimate for blocks of size 2^( 2) =       0.000426024879
  error estimate for blocks of size 2^( 3) =       0.000439499168
  error estimate for blocks of size 2^( 4) =       0.000451730164
  error estimate for blocks of size 2^( 5) =       0.000462622590
  error estimate for blocks of size 2^( 6) =       0.000472858967
  error estimate for blocks of size 2^( 7) =       0.000479699098

      target function =                  N/A
              le_mean =     -16.906195257246
             les_mean =     286.161091776792
             stat err =       0.000466727705
             autocorr =       1.275177999789
              std dev =       0.584511652156
             le_variance =       0.341653871506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725370228
                                         uncertainty =       0.004905688726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725370228
                                         uncertainty =       0.004905688726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413312234
  error estimate for blocks of size 2^( 2) =       0.000426024956
  error estimate for blocks of size 2^( 3) =       0.000439499242
  error estimate for blocks of size 2^( 4) =       0.000451730236
  error estimate for blocks of size 2^( 5) =       0.000462622660
  error estimate for blocks of size 2^( 6) =       0.000472859036
  error estimate for blocks of size 2^( 7) =       0.000479699167

      target function =                  N/A
              le_mean =     -16.906195256877
             les_mean =     286.161091898553
             stat err =       0.000466727775
             autocorr =       1.275177882373
              std dev =       0.584511766980
             le_variance =       0.341654005738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725487736
                                         uncertainty =       0.004905690478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341725487736
                                         uncertainty =       0.004905690478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413312305
  error estimate for blocks of size 2^( 2) =       0.000426025024
  error estimate for blocks of size 2^( 3) =       0.000439499308
  error estimate for blocks of size 2^( 4) =       0.000451730300
  error estimate for blocks of size 2^( 5) =       0.000462622722
  error estimate for blocks of size 2^( 6) =       0.000472859096
  error estimate for blocks of size 2^( 7) =       0.000479699227

      target function =                  N/A
              le_mean =     -16.906195256554
             les_mean =     286.161092005147
             stat err =       0.000466727836
             autocorr =       1.275177779575
              std dev =       0.584511867497
             le_variance =       0.341654123245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906195256508        initial
     1.4552e+03     1.4552e+04             1.7337e-07       -16.906195257246  <--
     5.8208e+03     5.8208e+04             4.3346e-08       -16.906195256877
     2.3283e+04     2.3283e+05             1.0837e-08       -16.906195256554

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 2.9334e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8679
    reference variance = 0.222719
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4962e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349772094988
                                         uncertainty =       0.004843556815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349772094988
                                         uncertainty =       0.004843556815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418104095
  error estimate for blocks of size 2^( 2) =       0.000430951008
  error estimate for blocks of size 2^( 3) =       0.000443882996
  error estimate for blocks of size 2^( 4) =       0.000455809088
  error estimate for blocks of size 2^( 5) =       0.000466757790
  error estimate for blocks of size 2^( 6) =       0.000475303984
  error estimate for blocks of size 2^( 7) =       0.000480697054

      target function =                  N/A
              le_mean =     -16.906262061664
             les_mean =     286.171318792032
             stat err =       0.000469641979
             autocorr =       1.261725776989
              std dev =       0.591288482190
             le_variance =       0.349622069171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626206166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262061664       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262060488       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262062719       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262062613       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262063487       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262063874       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262064022       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262063938       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.325704e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262061664       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262061370       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262061928       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262061902       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262062120       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262062216       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262062254       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262062232       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.331512e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262061664       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262061591       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262061730       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262061724       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262061779       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262061799       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262061814       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262061811       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.328833e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6338e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093233e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035243e-02 1 1  ON 2
 uu_3                -2.262758e-02 1 1  ON 3
 uu_4                -6.861456e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463951e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677864e-02 1 1  ON 12
 ud_3                -5.307785e-03 1 1  ON 13
 ud_4                -6.304061e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527641e-01 1 1  ON 18
 ud_9                -1.453071e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398935e-01 1 1  ON 21
 eO_2                -1.719184e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998057e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695339e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100431e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078394e-01 1 1  ON 32
eH1_3                -5.285371e-02 1 1  ON 33
eH1_4                -3.900329e-03 1 1  ON 34
eH1_5                 3.156548e-02 1 1  ON 35
eH1_6                 9.284645e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881984e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521786e-01 1 1  ON 41
eH2_2                -1.048817e-01 1 1  ON 42
eH2_3                -5.021403e-02 1 1  ON 43
eH2_4                -1.231334e-03 1 1  ON 44
eH2_5                 3.330001e-02 1 1  ON 45
eH2_6                 9.473270e-02 1 1  ON 46
eH2_7                 1.558655e-01 1 1  ON 47
eH2_8                 1.990266e-01 1 1  ON 48
eH2_9                 9.252350e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9893
    reference variance = 0.520665
====================================================
  Execution time = 2.0039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3635e-01
  Total weights = 2.0000e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479813573
                                         uncertainty =       0.003561659087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479813573
                                         uncertainty =       0.003561659087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410093047
  error estimate for blocks of size 2^( 2) =       0.000423006415
  error estimate for blocks of size 2^( 3) =       0.000436636104
  error estimate for blocks of size 2^( 4) =       0.000449008411
  error estimate for blocks of size 2^( 5) =       0.000459985043
  error estimate for blocks of size 2^( 6) =       0.000467726436
  error estimate for blocks of size 2^( 7) =       0.000474093705

      target function =                  N/A
              le_mean =     -16.906713699529
             les_mean =     286.173320564665
             stat err =       0.000462703399
             autocorr =       1.273035651653
              std dev =       0.579959149418
             le_variance =       0.336352614994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479341854
                                         uncertainty =       0.003561656287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479341854
                                         uncertainty =       0.003561656287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410092760
  error estimate for blocks of size 2^( 2) =       0.000423006136
  error estimate for blocks of size 2^( 3) =       0.000436635834
  error estimate for blocks of size 2^( 4) =       0.000449008148
  error estimate for blocks of size 2^( 5) =       0.000459984794
  error estimate for blocks of size 2^( 6) =       0.000467726198
  error estimate for blocks of size 2^( 7) =       0.000474093479

      target function =                  N/A
              le_mean =     -16.906713696960
             les_mean =     286.173320006004
             stat err =       0.000462703155
             autocorr =       1.273036094642
              std dev =       0.579958742675
             le_variance =       0.336352143205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479577465
                                         uncertainty =       0.003561657685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479577465
                                         uncertainty =       0.003561657685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410092903
  error estimate for blocks of size 2^( 2) =       0.000423006275
  error estimate for blocks of size 2^( 3) =       0.000436635969
  error estimate for blocks of size 2^( 4) =       0.000449008280
  error estimate for blocks of size 2^( 5) =       0.000459984918
  error estimate for blocks of size 2^( 6) =       0.000467726317
  error estimate for blocks of size 2^( 7) =       0.000474093592

      target function =                  N/A
              le_mean =     -16.906713698243
             les_mean =     286.173320285020
             stat err =       0.000462703277
             autocorr =       1.273035873383
              std dev =       0.579958945832
             le_variance =       0.336352378851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479784051
                                         uncertainty =       0.003561658912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336479784051
                                         uncertainty =       0.003561658912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410093029
  error estimate for blocks of size 2^( 2) =       0.000423006397
  error estimate for blocks of size 2^( 3) =       0.000436636087
  error estimate for blocks of size 2^( 4) =       0.000449008395
  error estimate for blocks of size 2^( 5) =       0.000459985027
  error estimate for blocks of size 2^( 6) =       0.000467726421
  error estimate for blocks of size 2^( 7) =       0.000474093691

      target function =                  N/A
              le_mean =     -16.906713699368
             les_mean =     286.173320529698
             stat err =       0.000462703383
             autocorr =       1.273035679377
              std dev =       0.579959123963
             le_variance =       0.336352585468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906713699529        initial  <--
     3.6380e+02     3.6380e+03             5.3257e-07       -16.906713696960
     1.4552e+03     1.4552e+04             1.3315e-07       -16.906713698243
     5.8208e+03     5.8208e+04             3.3288e-08       -16.906713699368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4198
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5764e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8308
    reference variance = 0.377667
====================================================
  Execution time = 2.3036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4204e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341836143064
                                         uncertainty =       0.003803008664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341836143064
                                         uncertainty =       0.003803008664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413544477
  error estimate for blocks of size 2^( 2) =       0.000425994921
  error estimate for blocks of size 2^( 3) =       0.000438870769
  error estimate for blocks of size 2^( 4) =       0.000451294965
  error estimate for blocks of size 2^( 5) =       0.000461567006
  error estimate for blocks of size 2^( 6) =       0.000469174446
  error estimate for blocks of size 2^( 7) =       0.000474964218

      target function =                  N/A
              le_mean =     -16.905773012585
             les_mean =     286.147199051581
             stat err =       0.000464250159
             autocorr =       1.260258602458
              std dev =       0.584840208576
             le_variance =       0.342038069568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577301258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905773012585       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773012771       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905773012857       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905773012864       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905773012811       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905773012787       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905773012788       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905773012793       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 5.625251e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905773012585       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773012631       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905773012653       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905773012650       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905773012645       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905773012635       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905773012631       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905773012620       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.406361e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905773012585       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773012596       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905773012602       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905773012583       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905773012591       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905773012595       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905773012673       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905773012638       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.515931e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.250517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8515e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307790e-03 1 1  ON 13
 ud_4                -6.304059e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900342e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284654e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881974e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330004e-02 1 1  ON 45
eH2_6                 9.473266e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9776
    reference variance = 0.277796
====================================================
  Execution time = 1.9927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4147e-01
  Total weights = 2.0000e+06
  Execution time = 1.8579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478969247
                                         uncertainty =       0.004163637597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478969247
                                         uncertainty =       0.004163637597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413200574
  error estimate for blocks of size 2^( 2) =       0.000425921416
  error estimate for blocks of size 2^( 3) =       0.000437987616
  error estimate for blocks of size 2^( 4) =       0.000449505463
  error estimate for blocks of size 2^( 5) =       0.000458133718
  error estimate for blocks of size 2^( 6) =       0.000465552300
  error estimate for blocks of size 2^( 7) =       0.000470115806

      target function =                  N/A
              le_mean =     -16.906339618980
             les_mean =     286.165788570208
             stat err =       0.000460826822
             autocorr =       1.243808914144
              std dev =       0.584353855683
             le_variance =       0.341469428652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478953949
                                         uncertainty =       0.004163637712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478953949
                                         uncertainty =       0.004163637712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413200565
  error estimate for blocks of size 2^( 2) =       0.000425921407
  error estimate for blocks of size 2^( 3) =       0.000437987606
  error estimate for blocks of size 2^( 4) =       0.000449505453
  error estimate for blocks of size 2^( 5) =       0.000458133709
  error estimate for blocks of size 2^( 6) =       0.000465552291
  error estimate for blocks of size 2^( 7) =       0.000470115796

      target function =                  N/A
              le_mean =     -16.906339618830
             les_mean =     286.165788549871
             stat err =       0.000460826812
             autocorr =       1.243808917597
              std dev =       0.584353842622
             le_variance =       0.341469413387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478961596
                                         uncertainty =       0.004163637654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478961596
                                         uncertainty =       0.004163637654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413200569
  error estimate for blocks of size 2^( 2) =       0.000425921411
  error estimate for blocks of size 2^( 3) =       0.000437987611
  error estimate for blocks of size 2^( 4) =       0.000449505458
  error estimate for blocks of size 2^( 5) =       0.000458133713
  error estimate for blocks of size 2^( 6) =       0.000465552295
  error estimate for blocks of size 2^( 7) =       0.000470115801

      target function =                  N/A
              le_mean =     -16.906339618905
             les_mean =     286.165788560037
             stat err =       0.000460826817
             autocorr =       1.243808915869
              std dev =       0.584353849151
             le_variance =       0.341469421018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478968290
                                         uncertainty =       0.004163637604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478968290
                                         uncertainty =       0.004163637604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413200573
  error estimate for blocks of size 2^( 2) =       0.000425921416
  error estimate for blocks of size 2^( 3) =       0.000437987616
  error estimate for blocks of size 2^( 4) =       0.000449505463
  error estimate for blocks of size 2^( 5) =       0.000458133717
  error estimate for blocks of size 2^( 6) =       0.000465552299
  error estimate for blocks of size 2^( 7) =       0.000470115805

      target function =                  N/A
              le_mean =     -16.906339618971
             les_mean =     286.165788568936
             stat err =       0.000460826821
             autocorr =       1.243808914361
              std dev =       0.584353854867
             le_variance =       0.341469427697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906339618980        initial  <--
     3.6380e+03     3.6380e+04             5.6253e-08       -16.906339618830
     1.4552e+04     1.4552e+05             1.4064e-08       -16.906339618905
     5.8208e+04     5.8208e+05             3.5159e-09       -16.906339618971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2962
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.892
    reference variance = 0.191656
====================================================
  Execution time = 2.0393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3436e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334385864903
                                         uncertainty =       0.003018339530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334385864903
                                         uncertainty =       0.003018339530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408877457
  error estimate for blocks of size 2^( 2) =       0.000421841345
  error estimate for blocks of size 2^( 3) =       0.000434840856
  error estimate for blocks of size 2^( 4) =       0.000447546310
  error estimate for blocks of size 2^( 5) =       0.000457951977
  error estimate for blocks of size 2^( 6) =       0.000466127936
  error estimate for blocks of size 2^( 7) =       0.000470207644

      target function =                  N/A
              le_mean =     -16.906027892014
             les_mean =     286.148140468742
             stat err =       0.000460458467
             autocorr =       1.268219981493
              std dev =       0.578240045625
             le_variance =       0.334361550364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602789201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027892014       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027892022       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027892029       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027892012       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027892047       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027892046       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027892043       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906027892036       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 5.458385e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027892014       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027892016       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027892018       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027892018       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027891583       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027891937       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027891922       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906027891940       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.364601e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027892014       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027892015       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027892015       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027892442       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027892355       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027892029       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027892138       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906027892074       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.411500e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253090 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5878e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156553e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881974e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231207e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473266e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.84
    reference variance = 0.299281
====================================================
  Execution time = 2.0033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.0000e+06
  Execution time = 1.8747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860977012
                                         uncertainty =       0.005323430204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860977012
                                         uncertainty =       0.005323430204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410974453
  error estimate for blocks of size 2^( 2) =       0.000423880654
  error estimate for blocks of size 2^( 3) =       0.000437160573
  error estimate for blocks of size 2^( 4) =       0.000450293086
  error estimate for blocks of size 2^( 5) =       0.000462068148
  error estimate for blocks of size 2^( 6) =       0.000471509534
  error estimate for blocks of size 2^( 7) =       0.000475338959

      target function =                  N/A
              le_mean =     -16.905615746371
             les_mean =     286.137643596308
             stat err =       0.000464802431
             autocorr =       1.279107753051
              std dev =       0.581205644546
             le_variance =       0.337800001252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860975425
                                         uncertainty =       0.005323430159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860975425
                                         uncertainty =       0.005323430159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410974452
  error estimate for blocks of size 2^( 2) =       0.000423880653
  error estimate for blocks of size 2^( 3) =       0.000437160572
  error estimate for blocks of size 2^( 4) =       0.000450293085
  error estimate for blocks of size 2^( 5) =       0.000462068147
  error estimate for blocks of size 2^( 6) =       0.000471509533
  error estimate for blocks of size 2^( 7) =       0.000475338958

      target function =                  N/A
              le_mean =     -16.905615746359
             les_mean =     286.137643594302
             stat err =       0.000464802431
             autocorr =       1.279107753919
              std dev =       0.581205643180
             le_variance =       0.337799999664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860976218
                                         uncertainty =       0.005323430182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860976218
                                         uncertainty =       0.005323430182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410974452
  error estimate for blocks of size 2^( 2) =       0.000423880654
  error estimate for blocks of size 2^( 3) =       0.000437160573
  error estimate for blocks of size 2^( 4) =       0.000450293085
  error estimate for blocks of size 2^( 5) =       0.000462068147
  error estimate for blocks of size 2^( 6) =       0.000471509534
  error estimate for blocks of size 2^( 7) =       0.000475338958

      target function =                  N/A
              le_mean =     -16.905615746365
             les_mean =     286.137643595305
             stat err =       0.000464802431
             autocorr =       1.279107753490
              std dev =       0.581205643863
             le_variance =       0.337800000458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860976913
                                         uncertainty =       0.005323430202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860976913
                                         uncertainty =       0.005323430202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410974452
  error estimate for blocks of size 2^( 2) =       0.000423880654
  error estimate for blocks of size 2^( 3) =       0.000437160573
  error estimate for blocks of size 2^( 4) =       0.000450293085
  error estimate for blocks of size 2^( 5) =       0.000462068148
  error estimate for blocks of size 2^( 6) =       0.000471509534
  error estimate for blocks of size 2^( 7) =       0.000475338958

      target function =                  N/A
              le_mean =     -16.905615746370
             les_mean =     286.137643596183
             stat err =       0.000464802431
             autocorr =       1.279107753102
              std dev =       0.581205644461
             le_variance =       0.337800001153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905615746371        initial  <--
     3.6380e+04     3.6380e+05             5.4584e-09       -16.905615746359
     1.4552e+05     1.4552e+06             1.3646e-09       -16.905615746365
     5.8208e+05     5.8208e+06             3.4115e-10       -16.905615746370

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4221
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9438
    reference variance = 0.21995
====================================================
  Execution time = 2.0137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4060e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340538699185
                                         uncertainty =       0.003589619096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340538699185
                                         uncertainty =       0.003589619096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412675611
  error estimate for blocks of size 2^( 2) =       0.000425250963
  error estimate for blocks of size 2^( 3) =       0.000437752048
  error estimate for blocks of size 2^( 4) =       0.000450061761
  error estimate for blocks of size 2^( 5) =       0.000458618212
  error estimate for blocks of size 2^( 6) =       0.000465043484
  error estimate for blocks of size 2^( 7) =       0.000469249191

      target function =                  N/A
              le_mean =     -16.906506434899
             les_mean =     286.170561982735
             stat err =       0.000460743162
             autocorr =       1.246522698936
              std dev =       0.583611445862
             le_variance =       0.340602319741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650643490e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506434899       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506434899       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906506434898       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906506434898       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906506435000       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906506434894       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906506435064       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906506434655       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 6.062393e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506434899       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506434899       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906506434899       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906506434636       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906506434746       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906506435152       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906506434339       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906506435161       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.515598e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506434899       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506434899       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906506434899       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906506435271       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906506433964       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906506434611       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906506436446       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906506428716       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.788994e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5729e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9464
    reference variance = 0.141699
====================================================
  Execution time = 1.9822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3798e-01
  Total weights = 2.0000e+06
  Execution time = 1.8660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768974
                                         uncertainty =       0.003357291150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768974
                                         uncertainty =       0.003357291150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087046
  error estimate for blocks of size 2^( 2) =       0.000423595154
  error estimate for blocks of size 2^( 3) =       0.000436297098
  error estimate for blocks of size 2^( 4) =       0.000447856938
  error estimate for blocks of size 2^( 5) =       0.000457318871
  error estimate for blocks of size 2^( 6) =       0.000464138356
  error estimate for blocks of size 2^( 7) =       0.000465338479

      target function =                  N/A
              le_mean =     -16.905990609906
             les_mean =     286.150503452610
             stat err =       0.000458663161
             autocorr =       1.244858919912
              std dev =       0.581364876267
             le_variance =       0.337985119357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768874
                                         uncertainty =       0.003357291151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768874
                                         uncertainty =       0.003357291151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087046
  error estimate for blocks of size 2^( 2) =       0.000423595154
  error estimate for blocks of size 2^( 3) =       0.000436297098
  error estimate for blocks of size 2^( 4) =       0.000447856938
  error estimate for blocks of size 2^( 5) =       0.000457318871
  error estimate for blocks of size 2^( 6) =       0.000464138356
  error estimate for blocks of size 2^( 7) =       0.000465338479

      target function =                  N/A
              le_mean =     -16.905990609906
             les_mean =     286.150503452504
             stat err =       0.000458663161
             autocorr =       1.244858919961
              std dev =       0.581364876181
             le_variance =       0.337985119257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768924
                                         uncertainty =       0.003357291150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768924
                                         uncertainty =       0.003357291150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087046
  error estimate for blocks of size 2^( 2) =       0.000423595154
  error estimate for blocks of size 2^( 3) =       0.000436297098
  error estimate for blocks of size 2^( 4) =       0.000447856938
  error estimate for blocks of size 2^( 5) =       0.000457318871
  error estimate for blocks of size 2^( 6) =       0.000464138356
  error estimate for blocks of size 2^( 7) =       0.000465338479

      target function =                  N/A
              le_mean =     -16.905990609906
             les_mean =     286.150503452557
             stat err =       0.000458663161
             autocorr =       1.244858919938
              std dev =       0.581364876224
             le_variance =       0.337985119307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768968
                                         uncertainty =       0.003357291150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100768968
                                         uncertainty =       0.003357291150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087046
  error estimate for blocks of size 2^( 2) =       0.000423595154
  error estimate for blocks of size 2^( 3) =       0.000436297098
  error estimate for blocks of size 2^( 4) =       0.000447856938
  error estimate for blocks of size 2^( 5) =       0.000457318871
  error estimate for blocks of size 2^( 6) =       0.000464138356
  error estimate for blocks of size 2^( 7) =       0.000465338479

      target function =                  N/A
              le_mean =     -16.905990609906
             les_mean =     286.150503452604
             stat err =       0.000458663161
             autocorr =       1.244858919919
              std dev =       0.581364876262
             le_variance =       0.337985119351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905990609906        initial  <--
     3.6380e+05     3.6380e+06             6.0624e-10       -16.905990609906
     1.4552e+06     1.4552e+07             1.5156e-10       -16.905990609906
     5.8208e+06     5.8208e+07             3.7890e-11       -16.905990609906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2241
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8828
    reference variance = 0.334756
====================================================
  Execution time = 2.0117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3296e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332931568534
                                         uncertainty =       0.002650773030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332931568534
                                         uncertainty =       0.002650773030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408019780
  error estimate for blocks of size 2^( 2) =       0.000421276509
  error estimate for blocks of size 2^( 3) =       0.000434357939
  error estimate for blocks of size 2^( 4) =       0.000447012607
  error estimate for blocks of size 2^( 5) =       0.000458532419
  error estimate for blocks of size 2^( 6) =       0.000468872284
  error estimate for blocks of size 2^( 7) =       0.000475542157

      target function =                  N/A
              le_mean =     -16.906262245660
             les_mean =     286.154663233710
             stat err =       0.000462489867
             autocorr =       1.284819175422
              std dev =       0.577027106097
             le_variance =       0.332960281171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626224566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262245660       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262245660       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262245660       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262245660       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262244409       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262246736       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262243488       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262241555       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 5.891336e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262245660       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262245660       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262245660       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262245660       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262245378       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262257283       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262244084       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262246033       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.472862e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262245660       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262245660       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262245660       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262243542       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262207771       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262276928       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262190252       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262231145       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.681570e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5731e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.175233
====================================================
  Execution time = 1.9984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4098e-01
  Total weights = 2.0000e+06
  Execution time = 1.8625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153321
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153321
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412903248
  error estimate for blocks of size 2^( 2) =       0.000426123963
  error estimate for blocks of size 2^( 3) =       0.000439131033
  error estimate for blocks of size 2^( 4) =       0.000451644245
  error estimate for blocks of size 2^( 5) =       0.000464034695
  error estimate for blocks of size 2^( 6) =       0.000471891890
  error estimate for blocks of size 2^( 7) =       0.000479138808

      target function =                  N/A
              le_mean =     -16.906344865230
             les_mean =     286.165474715922
             stat err =       0.000466677410
             autocorr =       1.277429552642
              std dev =       0.583933373189
             le_variance =       0.340978184324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153286
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153286
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412903248
  error estimate for blocks of size 2^( 2) =       0.000426123963
  error estimate for blocks of size 2^( 3) =       0.000439131033
  error estimate for blocks of size 2^( 4) =       0.000451644245
  error estimate for blocks of size 2^( 5) =       0.000464034695
  error estimate for blocks of size 2^( 6) =       0.000471891890
  error estimate for blocks of size 2^( 7) =       0.000479138808

      target function =                  N/A
              le_mean =     -16.906344865230
             les_mean =     286.165474715875
             stat err =       0.000466677410
             autocorr =       1.277429552681
              std dev =       0.583933373160
             le_variance =       0.340978184290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153304
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153304
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412903248
  error estimate for blocks of size 2^( 2) =       0.000426123963
  error estimate for blocks of size 2^( 3) =       0.000439131033
  error estimate for blocks of size 2^( 4) =       0.000451644245
  error estimate for blocks of size 2^( 5) =       0.000464034695
  error estimate for blocks of size 2^( 6) =       0.000471891890
  error estimate for blocks of size 2^( 7) =       0.000479138808

      target function =                  N/A
              le_mean =     -16.906344865230
             les_mean =     286.165474715899
             stat err =       0.000466677410
             autocorr =       1.277429552659
              std dev =       0.583933373175
             le_variance =       0.340978184307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153319
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341053153319
                                         uncertainty =       0.003767070552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412903248
  error estimate for blocks of size 2^( 2) =       0.000426123963
  error estimate for blocks of size 2^( 3) =       0.000439131033
  error estimate for blocks of size 2^( 4) =       0.000451644245
  error estimate for blocks of size 2^( 5) =       0.000464034695
  error estimate for blocks of size 2^( 6) =       0.000471891890
  error estimate for blocks of size 2^( 7) =       0.000479138808

      target function =                  N/A
              le_mean =     -16.906344865230
             les_mean =     286.165474715919
             stat err =       0.000466677410
             autocorr =       1.277429552647
              std dev =       0.583933373187
             le_variance =       0.340978184322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906344865230        initial  <--
     3.6380e+06     3.6380e+07             5.8913e-11       -16.906344865230
     1.4552e+07     1.4552e+08             1.4729e-11       -16.906344865230
     5.8208e+07     5.8208e+08             3.6816e-12       -16.906344865230

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3480
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5090e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.313198
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4464e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647844144
                                         uncertainty =       0.013553936513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647844144
                                         uncertainty =       0.013553936513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415114246
  error estimate for blocks of size 2^( 2) =       0.000427865797
  error estimate for blocks of size 2^( 3) =       0.000441002257
  error estimate for blocks of size 2^( 4) =       0.000452966059
  error estimate for blocks of size 2^( 5) =       0.000463261431
  error estimate for blocks of size 2^( 6) =       0.000471113429
  error estimate for blocks of size 2^( 7) =       0.000472666617

      target function =                  N/A
              le_mean =     -16.904617285858
             les_mean =     286.110725084149
             stat err =       0.000465001884
             autocorr =       1.254798956531
              std dev =       0.587060197192
             le_variance =       0.344639675127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690461728586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904617285858       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904617285858       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904617285858       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904617287111       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904617286675       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904617269797       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904617300713       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904617273764       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 6.518005e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904617285858       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904617285858       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904617285858       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904617316057       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904617071524       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904617310177       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904617264320       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904617308597       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.629805e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904617285858       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904617285858       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904617285858       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904616796279       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904617210302       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904617293393       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904617233936       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904617436141       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.076352e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5968e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9464
    reference variance = 0.380773
====================================================
  Execution time = 1.9784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3786e-01
  Total weights = 2.0000e+06
  Execution time = 1.8638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384875
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384875
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013446
  error estimate for blocks of size 2^( 2) =       0.000423902870
  error estimate for blocks of size 2^( 3) =       0.000436096600
  error estimate for blocks of size 2^( 4) =       0.000448156940
  error estimate for blocks of size 2^( 5) =       0.000458344021
  error estimate for blocks of size 2^( 6) =       0.000465688046
  error estimate for blocks of size 2^( 7) =       0.000469999710

      target function =                  N/A
              le_mean =     -16.907032547593
             les_mean =     286.185613502753
             stat err =       0.000460547179
             autocorr =       1.255556305294
              std dev =       0.581260790286
             le_variance =       0.337864106324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384873
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384873
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013446
  error estimate for blocks of size 2^( 2) =       0.000423902870
  error estimate for blocks of size 2^( 3) =       0.000436096600
  error estimate for blocks of size 2^( 4) =       0.000448156940
  error estimate for blocks of size 2^( 5) =       0.000458344021
  error estimate for blocks of size 2^( 6) =       0.000465688046
  error estimate for blocks of size 2^( 7) =       0.000469999710

      target function =                  N/A
              le_mean =     -16.907032547593
             les_mean =     286.185613502751
             stat err =       0.000460547179
             autocorr =       1.255556305300
              std dev =       0.581260790283
             le_variance =       0.337864106321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384874
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384874
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013446
  error estimate for blocks of size 2^( 2) =       0.000423902870
  error estimate for blocks of size 2^( 3) =       0.000436096600
  error estimate for blocks of size 2^( 4) =       0.000448156940
  error estimate for blocks of size 2^( 5) =       0.000458344021
  error estimate for blocks of size 2^( 6) =       0.000465688046
  error estimate for blocks of size 2^( 7) =       0.000469999710

      target function =                  N/A
              le_mean =     -16.907032547593
             les_mean =     286.185613502752
             stat err =       0.000460547179
             autocorr =       1.255556305288
              std dev =       0.581260790285
             le_variance =       0.337864106322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384875
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337852384875
                                         uncertainty =       0.003977430263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411013446
  error estimate for blocks of size 2^( 2) =       0.000423902870
  error estimate for blocks of size 2^( 3) =       0.000436096600
  error estimate for blocks of size 2^( 4) =       0.000448156940
  error estimate for blocks of size 2^( 5) =       0.000458344021
  error estimate for blocks of size 2^( 6) =       0.000465688046
  error estimate for blocks of size 2^( 7) =       0.000469999710

      target function =                  N/A
              le_mean =     -16.907032547593
             les_mean =     286.185613502753
             stat err =       0.000460547179
             autocorr =       1.255556305292
              std dev =       0.581260790285
             le_variance =       0.337864106323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907032547593        initial
     3.6380e+07     3.6380e+08             6.5180e-12       -16.907032547593  <--
     1.4552e+08     1.4552e+09             1.6298e-12       -16.907032547593
     5.8208e+08     5.8208e+09             4.0764e-13       -16.907032547593

*****************************************************************************
Applying the update for shift_i =   3.6380e+07     and shift_s =   3.6380e+08
*****************************************************************************

  Execution time = 2.9192e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.163061
====================================================
  Execution time = 1.9950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4228e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342321643783
                                         uncertainty =       0.006737303509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342321643783
                                         uncertainty =       0.006737303509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413688119
  error estimate for blocks of size 2^( 2) =       0.000426480956
  error estimate for blocks of size 2^( 3) =       0.000439952296
  error estimate for blocks of size 2^( 4) =       0.000453476064
  error estimate for blocks of size 2^( 5) =       0.000464190573
  error estimate for blocks of size 2^( 6) =       0.000473394683
  error estimate for blocks of size 2^( 7) =       0.000482345131

      target function =                  N/A
              le_mean =     -16.905770535515
             les_mean =     286.147352947435
             stat err =       0.000468351613
             autocorr =       1.281734116127
              std dev =       0.585043348037
             le_variance =       0.342275719082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577053552e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770535515       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770535515       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905770535515       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905770535515       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905770532027       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905770535601       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905770536627       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905770547311       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 2.177475e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770535515       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770535515       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905770535515       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905770544987       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905770532316       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905770528614       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905770548392       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905770533885       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 5.443731e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770535515       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770535515       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905770535515       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905770535515       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905770521358       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905770537709       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905770544267       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905770587844       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.360856e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5567e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8705
    reference variance = 0.197574
====================================================
  Execution time = 2.2270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.0000e+06
  Execution time = 1.8556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194992
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194992
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475973
  error estimate for blocks of size 2^( 2) =       0.000422383561
  error estimate for blocks of size 2^( 3) =       0.000434902671
  error estimate for blocks of size 2^( 4) =       0.000446798996
  error estimate for blocks of size 2^( 5) =       0.000457689622
  error estimate for blocks of size 2^( 6) =       0.000466397606
  error estimate for blocks of size 2^( 7) =       0.000472236447

      target function =                  N/A
              le_mean =     -16.906095603984
             les_mean =     286.151409547718
             stat err =       0.000460780668
             autocorr =       1.266285556138
              std dev =       0.579086473968
             le_variance =       0.335341144333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194982
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194982
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475973
  error estimate for blocks of size 2^( 2) =       0.000422383561
  error estimate for blocks of size 2^( 3) =       0.000434902671
  error estimate for blocks of size 2^( 4) =       0.000446798996
  error estimate for blocks of size 2^( 5) =       0.000457689622
  error estimate for blocks of size 2^( 6) =       0.000466397606
  error estimate for blocks of size 2^( 7) =       0.000472236447

      target function =                  N/A
              le_mean =     -16.906095603984
             les_mean =     286.151409547713
             stat err =       0.000460780668
             autocorr =       1.266285556139
              std dev =       0.579086473960
             le_variance =       0.335341144323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194987
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194987
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475973
  error estimate for blocks of size 2^( 2) =       0.000422383561
  error estimate for blocks of size 2^( 3) =       0.000434902671
  error estimate for blocks of size 2^( 4) =       0.000446798996
  error estimate for blocks of size 2^( 5) =       0.000457689622
  error estimate for blocks of size 2^( 6) =       0.000466397606
  error estimate for blocks of size 2^( 7) =       0.000472236447

      target function =                  N/A
              le_mean =     -16.906095603984
             les_mean =     286.151409547715
             stat err =       0.000460780668
             autocorr =       1.266285556135
              std dev =       0.579086473964
             le_variance =       0.335341144328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194991
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335381194991
                                         uncertainty =       0.003065163237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409475973
  error estimate for blocks of size 2^( 2) =       0.000422383561
  error estimate for blocks of size 2^( 3) =       0.000434902671
  error estimate for blocks of size 2^( 4) =       0.000446798996
  error estimate for blocks of size 2^( 5) =       0.000457689622
  error estimate for blocks of size 2^( 6) =       0.000466397606
  error estimate for blocks of size 2^( 7) =       0.000472236447

      target function =                  N/A
              le_mean =     -16.906095603984
             les_mean =     286.151409547718
             stat err =       0.000460780668
             autocorr =       1.266285556132
              std dev =       0.579086473968
             le_variance =       0.335341144332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906095603984        initial
     9.0949e+06     9.0949e+07             2.1775e-11       -16.906095603984  <--
     3.6380e+07     3.6380e+08             5.4437e-12       -16.906095603984
     1.4552e+08     1.4552e+09             1.3609e-12       -16.906095603984

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 3.1620e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093234e-01 1 1  ON 0
 uu_1                 1.424393e-01 1 1  ON 1
 uu_2                 4.035239e-02 1 1  ON 2
 uu_3                -2.262760e-02 1 1  ON 3
 uu_4                -6.861458e-02 1 1  ON 4
 uu_5                -1.038993e-01 1 1  ON 5
 uu_6                -1.320312e-01 1 1  ON 6
 uu_7                -1.463950e-01 1 1  ON 7
 uu_8                -1.390393e-01 1 1  ON 8
 uu_9                -1.110353e-01 1 1  ON 9
 ud_0                 4.545291e-01 1 1  ON 10
 ud_1                 1.880352e-01 1 1  ON 11
 ud_2                 6.677867e-02 1 1  ON 12
 ud_3                -5.307788e-03 1 1  ON 13
 ud_4                -6.304060e-02 1 1  ON 14
 ud_5                -1.052234e-01 1 1  ON 15
 ud_6                -1.337748e-01 1 1  ON 16
 ud_7                -1.514805e-01 1 1  ON 17
 ud_8                -1.527640e-01 1 1  ON 18
 ud_9                -1.453072e-01 1 1  ON 19
 eO_0                -7.629990e-01 1 1  ON 20
 eO_1                -4.398936e-01 1 1  ON 21
 eO_2                -1.719188e-02 1 1  ON 22
 eO_3                 3.067130e-01 1 1  ON 23
 eO_4                 5.357810e-01 1 1  ON 24
 eO_5                 4.998056e-01 1 1  ON 25
 eO_6                 2.706130e-01 1 1  ON 26
 eO_7                -3.695337e-02 1 1  ON 27
 eO_8                -2.404229e-01 1 1  ON 28
 eO_9                -1.100430e-01 1 1  ON 29
eH1_0                -2.568796e-01 1 1  ON 30
eH1_1                -1.552948e-01 1 1  ON 31
eH1_2                -1.078395e-01 1 1  ON 32
eH1_3                -5.285368e-02 1 1  ON 33
eH1_4                -3.900338e-03 1 1  ON 34
eH1_5                 3.156554e-02 1 1  ON 35
eH1_6                 9.284655e-02 1 1  ON 36
eH1_7                 1.557771e-01 1 1  ON 37
eH1_8                 1.962656e-01 1 1  ON 38
eH1_9                 9.881973e-02 1 1  ON 39
eH2_0                -2.541980e-01 1 1  ON 40
eH2_1                -1.521785e-01 1 1  ON 41
eH2_2                -1.048816e-01 1 1  ON 42
eH2_3                -5.021411e-02 1 1  ON 43
eH2_4                -1.231206e-03 1 1  ON 44
eH2_5                 3.330003e-02 1 1  ON 45
eH2_6                 9.473265e-02 1 1  ON 46
eH2_7                 1.558654e-01 1 1  ON 47
eH2_8                 1.990265e-01 1 1  ON 48
eH2_9                 9.252337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7192e+01 secs
  Total Execution time = 2.2498e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
