--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0207.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 73461 MB
Rank =    1  Free Memory = 73459 MB
Rank =    2  Free Memory = 73458 MB
Rank =    3  Free Memory = 73458 MB
Rank =    4  Free Memory = 73458 MB
Rank =    5  Free Memory = 73458 MB
Rank =    6  Free Memory = 73458 MB
Rank =    7  Free Memory = 73458 MB
Rank =    8  Free Memory = 73458 MB
Rank =    9  Free Memory = 73458 MB
Rank =   10  Free Memory = 73458 MB
Rank =   11  Free Memory = 73458 MB
Rank =   12  Free Memory = 73458 MB
Rank =   13  Free Memory = 73458 MB
Rank =   14  Free Memory = 73457 MB
Rank =   15  Free Memory = 73457 MB
Rank =   16  Free Memory = 73456 MB
Rank =   17  Free Memory = 73456 MB
Rank =   18  Free Memory = 73456 MB
Rank =   19  Free Memory = 73456 MB
Rank =   20  Free Memory = 73456 MB
Rank =   21  Free Memory = 73456 MB
Rank =   22  Free Memory = 73456 MB
Rank =   23  Free Memory = 73456 MB
Rank =   24  Free Memory = 73456 MB
Rank =   25  Free Memory = 73456 MB
Rank =   26  Free Memory = 73456 MB
Rank =   27  Free Memory = 73456 MB
Rank =   28  Free Memory = 73456 MB
Rank =   29  Free Memory = 73456 MB
Rank =   30  Free Memory = 73456 MB
Rank =   31  Free Memory = 73456 MB
Rank =   32  Free Memory = 73456 MB
Rank =   33  Free Memory = 73456 MB
Rank =   34  Free Memory = 73456 MB
Rank =   35  Free Memory = 73456 MB
Rank =   36  Free Memory = 73456 MB
Rank =   37  Free Memory = 73456 MB
Rank =   38  Free Memory = 73456 MB
Rank =   39  Free Memory = 73456 MB
Rank =   40  Free Memory = 74429 MB
Rank =   41  Free Memory = 74429 MB
Rank =   42  Free Memory = 74429 MB
Rank =   43  Free Memory = 74429 MB
Rank =   44  Free Memory = 74429 MB
Rank =   45  Free Memory = 74429 MB
Rank =   46  Free Memory = 74429 MB
Rank =   47  Free Memory = 74429 MB
Rank =   48  Free Memory = 74429 MB
Rank =   49  Free Memory = 74429 MB
Rank =   50  Free Memory = 74429 MB
Rank =   51  Free Memory = 74429 MB
Rank =   52  Free Memory = 74429 MB
Rank =   53  Free Memory = 74428 MB
Rank =   54  Free Memory = 74428 MB
Rank =   55  Free Memory = 74428 MB
Rank =   56  Free Memory = 74428 MB
Rank =   57  Free Memory = 74428 MB
Rank =   58  Free Memory = 74428 MB
Rank =   59  Free Memory = 74428 MB
Rank =   60  Free Memory = 74428 MB
Rank =   61  Free Memory = 74428 MB
Rank =   62  Free Memory = 74428 MB
Rank =   63  Free Memory = 74428 MB
Rank =   64  Free Memory = 74428 MB
Rank =   65  Free Memory = 74428 MB
Rank =   66  Free Memory = 74428 MB
Rank =   67  Free Memory = 74427 MB
Rank =   68  Free Memory = 74427 MB
Rank =   69  Free Memory = 74427 MB
Rank =   70  Free Memory = 74427 MB
Rank =   71  Free Memory = 74427 MB
Rank =   72  Free Memory = 74427 MB
Rank =   73  Free Memory = 74427 MB
Rank =   74  Free Memory = 74427 MB
Rank =   75  Free Memory = 74427 MB
Rank =   76  Free Memory = 74427 MB
Rank =   77  Free Memory = 74427 MB
Rank =   78  Free Memory = 74427 MB
Rank =   79  Free Memory = 74427 MB
Rank =   80  Free Memory = 77858 MB
Rank =   81  Free Memory = 77858 MB
Rank =   82  Free Memory = 77858 MB
Rank =   83  Free Memory = 77858 MB
Rank =   84  Free Memory = 77858 MB
Rank =   85  Free Memory = 77858 MB
Rank =   86  Free Memory = 77858 MB
Rank =   87  Free Memory = 77858 MB
Rank =   88  Free Memory = 77858 MB
Rank =   89  Free Memory = 77858 MB
Rank =   90  Free Memory = 77858 MB
Rank =   91  Free Memory = 77858 MB
Rank =   92  Free Memory = 77858 MB
Rank =   93  Free Memory = 77858 MB
Rank =   94  Free Memory = 77858 MB
Rank =   95  Free Memory = 77858 MB
Rank =   96  Free Memory = 77858 MB
Rank =   97  Free Memory = 77858 MB
Rank =   98  Free Memory = 77858 MB
Rank =   99  Free Memory = 77858 MB
Rank =  100  Free Memory = 77858 MB
Rank =  101  Free Memory = 77858 MB
Rank =  102  Free Memory = 77858 MB
Rank =  103  Free Memory = 77858 MB
Rank =  104  Free Memory = 77858 MB
Rank =  105  Free Memory = 77858 MB
Rank =  106  Free Memory = 77858 MB
Rank =  107  Free Memory = 77858 MB
Rank =  108  Free Memory = 77858 MB
Rank =  109  Free Memory = 77858 MB
Rank =  110  Free Memory = 77858 MB
Rank =  111  Free Memory = 77858 MB
Rank =  112  Free Memory = 77858 MB
Rank =  113  Free Memory = 77858 MB
Rank =  114  Free Memory = 77858 MB
Rank =  115  Free Memory = 77858 MB
Rank =  116  Free Memory = 77858 MB
Rank =  117  Free Memory = 77858 MB
Rank =  118  Free Memory = 77858 MB
Rank =  119  Free Memory = 77858 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001v.xml 
Rank =  120  Free Memory = 77002 MB
Rank =  121  Free Memory = 77002 MB
Rank =  127  Free Memory = 77002 MB
Rank =  122  Free Memory = 77002 MB
Rank =  123  Free Memory = 77002 MB
Rank =  124  Free Memory = 77002 MB
Rank =  125  Free Memory = 77002 MB
Rank =  126  Free Memory = 77002 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001v.xml

  Project = H2O
  date    = 2023-04-24 17:08:46 PDT
  host    = n0204.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 526

  Range of prime numbers to use as seeds over processors and threads = 3797-4909


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.112493e-01    1         1  ON     0
     uu_1                 1.438480e-01    1         1  ON     1
     uu_2                 4.181258e-02    1         1  ON     2
     uu_3                -2.116843e-02    1         1  ON     3
     uu_4                -6.720914e-02    1         1  ON     4
     uu_5                -1.024212e-01    1         1  ON     5
     uu_6                -1.301670e-01    1         1  ON     6
     uu_7                -1.439945e-01    1         1  ON     7
     uu_8                -1.368472e-01    1         1  ON     8
     uu_9                -1.068377e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.504141e-01    1         1  ON     0
     ud_1                 1.844321e-01    1         1  ON     1
     ud_2                 6.378900e-02    1         1  ON     2
     ud_3                -7.801596e-03    1         1  ON     3
     ud_4                -6.532437e-02    1         1  ON     4
     ud_5                -1.074847e-01    1         1  ON     5
     ud_6                -1.355016e-01    1         1  ON     6
     ud_7                -1.522621e-01    1         1  ON     7
     ud_8                -1.533195e-01    1         1  ON     8
     ud_9                -1.446549e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.587149e-01    1         1  ON     0
     eO_1                -4.368821e-01    1         1  ON     1
     eO_2                -2.095939e-02    1         1  ON     2
     eO_3                 2.976869e-01    1         1  ON     3
     eO_4                 5.257818e-01    1         1  ON     4
     eO_5                 4.893344e-01    1         1  ON     5
     eO_6                 2.622161e-01    1         1  ON     6
     eO_7                -4.035664e-02    1         1  ON     7
     eO_8                -2.247578e-01    1         1  ON     8
     eO_9                -9.111909e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.526305e-01    1         1  ON     0
     eH1_1                -1.489031e-01    1         1  ON     1
     eH1_2                -1.002505e-01    1         1  ON     2
     eH1_3                -4.528531e-02    1         1  ON     3
     eH1_4                 3.530556e-03    1         1  ON     4
     eH1_5                 3.780331e-02    1         1  ON     5
     eH1_6                 9.678894e-02    1         1  ON     6
     eH1_7                 1.548739e-01    1         1  ON     7
     eH1_8                 1.824037e-01    1         1  ON     8
     eH1_9                 7.492777e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.507527e-01    1         1  ON     0
     eH2_1                -1.465265e-01    1         1  ON     1
     eH2_2                -9.771203e-02    1         1  ON     2
     eH2_3                -4.301194e-02    1         1  ON     3
     eH2_4                 5.940527e-03    1         1  ON     4
     eH2_5                 4.032473e-02    1         1  ON     5
     eH2_6                 9.973953e-02    1         1  ON     6
     eH2_7                 1.560881e-01    1         1  ON     7
     eH2_8                 1.867106e-01    1         1  ON     8
     eH2_9                 6.499977e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.995201e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1854e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0204.savio3:219713] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0204.savio3:219713] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.220087
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3382e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333823186727
                                         uncertainty =       0.002933807739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333823186727
                                         uncertainty =       0.002933807739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408546508
  error estimate for blocks of size 2^( 2) =       0.000421014706
  error estimate for blocks of size 2^( 3) =       0.000433727490
  error estimate for blocks of size 2^( 4) =       0.000445448950
  error estimate for blocks of size 2^( 5) =       0.000456216453
  error estimate for blocks of size 2^( 6) =       0.000463788466
  error estimate for blocks of size 2^( 7) =       0.000468362594

      target function =                  N/A
              le_mean =     -16.905664866150
             les_mean =     286.135324898370
             stat err =       0.000458454116
             autocorr =       1.259240681310
              std dev =       0.577772012735
             le_variance =       0.333820498700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690566486615e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905664866150       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905666408972       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667668388       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667777081       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667636678       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667282966       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667564119       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667958621       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905667984689       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905668148063       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.545052e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905664866150       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665436890       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665907380       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665839722       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665748492       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665646314       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905665710415       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665815361       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905665804500       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.044910e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905664866150       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665028280       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665162113       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665137670       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665074993       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665078179       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905665089677       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665112203       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.165496e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.409610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6547e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.113083e-01                 1 1 ON  0
uu_1  1.438495e-01                 1 1 ON  1
uu_2  4.186214e-02                 1 1 ON  2
uu_3  -2.115024e-02                1 1 ON  3
uu_4  -6.716233e-02                1 1 ON  4
uu_5  -1.025570e-01                1 1 ON  5
uu_6  -1.302453e-01                1 1 ON  6
uu_7  -1.440895e-01                1 1 ON  7
uu_8  -1.369464e-01                1 1 ON  8
uu_9  -1.068321e-01                1 1 ON  9
ud_0  4.504135e-01                 1 1 ON  10
ud_1  1.845118e-01                 1 1 ON  11
ud_2  6.375614e-02                 1 1 ON  12
ud_3  -7.844547e-03                1 1 ON  13
ud_4  -6.537993e-02                1 1 ON  14
ud_5  -1.074936e-01                1 1 ON  15
ud_6  -1.355173e-01                1 1 ON  16
ud_7  -1.522729e-01                1 1 ON  17
ud_8  -1.532648e-01                1 1 ON  18
ud_9  -1.445915e-01                1 1 ON  19
eO_0  -7.586640e-01                1 1 ON  20
eO_1  -4.368192e-01                1 1 ON  21
eO_2  -2.093251e-02                1 1 ON  22
eO_3  2.976245e-01                 1 1 ON  23
eO_4  5.257892e-01                 1 1 ON  24
eO_5  4.893665e-01                 1 1 ON  25
eO_6  2.622684e-01                 1 1 ON  26
eO_7  -4.035054e-02                1 1 ON  27
eO_8  -2.248107e-01                1 1 ON  28
eO_9  -9.122325e-02                1 1 ON  29
eH1_0 -2.528145e-01                1 1 ON  30
eH1_1 -1.489930e-01                1 1 ON  31
eH1_2 -1.003090e-01                1 1 ON  32
eH1_3 -4.536750e-02                1 1 ON  33
eH1_4 3.669475e-03                 1 1 ON  34
eH1_5 3.789777e-02                 1 1 ON  35
eH1_6 9.672406e-02                 1 1 ON  36
eH1_7 1.548381e-01                 1 1 ON  37
eH1_8 1.825119e-01                 1 1 ON  38
eH1_9 7.507848e-02                 1 1 ON  39
eH2_0 -2.509572e-01                1 1 ON  40
eH2_1 -1.466699e-01                1 1 ON  41
eH2_2 -9.773558e-02                1 1 ON  42
eH2_3 -4.309892e-02                1 1 ON  43
eH2_4 5.866694e-03                 1 1 ON  44
eH2_5 4.034204e-02                 1 1 ON  45
eH2_6 9.986899e-02                 1 1 ON  46
eH2_7 1.561619e-01                 1 1 ON  47
eH2_8 1.867949e-01                 1 1 ON  48
eH2_9 6.518771e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8989
    reference variance = 0.491689
====================================================
  Execution time = 2.0246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5504e-01
  Total weights = 2.0000e+06
  Execution time = 1.9037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355135572479
                                         uncertainty =       0.011449605929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355135572479
                                         uncertainty =       0.011449605929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421341327
  error estimate for blocks of size 2^( 2) =       0.000433737897
  error estimate for blocks of size 2^( 3) =       0.000446087699
  error estimate for blocks of size 2^( 4) =       0.000457451829
  error estimate for blocks of size 2^( 5) =       0.000466959483
  error estimate for blocks of size 2^( 6) =       0.000475082479
  error estimate for blocks of size 2^( 7) =       0.000479125328

      target function =                  N/A
              le_mean =     -16.906298019947
             les_mean =     286.177969589810
             stat err =       0.000469654780
             autocorr =       1.242479910257
              std dev =       0.595866619354
             le_variance =       0.355057028060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355133173917
                                         uncertainty =       0.011439054104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355133173917
                                         uncertainty =       0.011439054104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421339853
  error estimate for blocks of size 2^( 2) =       0.000433736216
  error estimate for blocks of size 2^( 3) =       0.000446082155
  error estimate for blocks of size 2^( 4) =       0.000457442946
  error estimate for blocks of size 2^( 5) =       0.000466944957
  error estimate for blocks of size 2^( 6) =       0.000475065243
  error estimate for blocks of size 2^( 7) =       0.000479105018

      target function =                  N/A
              le_mean =     -16.906297102381
             les_mean =     286.177936080073
             stat err =       0.000469639541
             autocorr =       1.242407974842
              std dev =       0.595864534621
             le_variance =       0.355054543620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355100728672
                                         uncertainty =       0.011439079486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355100728672
                                         uncertainty =       0.011439079486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421320613
  error estimate for blocks of size 2^( 2) =       0.000433717720
  error estimate for blocks of size 2^( 3) =       0.000446065148
  error estimate for blocks of size 2^( 4) =       0.000457426690
  error estimate for blocks of size 2^( 5) =       0.000466929496
  error estimate for blocks of size 2^( 6) =       0.000475049525
  error estimate for blocks of size 2^( 7) =       0.000479090451

      target function =                  N/A
              le_mean =     -16.906296889911
             les_mean =     286.177896469741
             stat err =       0.000469624041
             autocorr =       1.242439435261
              std dev =       0.595837324646
             le_variance =       0.355022117441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355126008272
                                         uncertainty =       0.011447899528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355126008272
                                         uncertainty =       0.011447899528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421335647
  error estimate for blocks of size 2^( 2) =       0.000433732405
  error estimate for blocks of size 2^( 3) =       0.000446081936
  error estimate for blocks of size 2^( 4) =       0.000457445698
  error estimate for blocks of size 2^( 5) =       0.000466952518
  error estimate for blocks of size 2^( 6) =       0.000475075034
  error estimate for blocks of size 2^( 7) =       0.000479117546

      target function =                  N/A
              le_mean =     -16.906297778021
             les_mean =     286.177951835976
             stat err =       0.000469647699
             autocorr =       1.242475947366
              std dev =       0.595858585888
             le_variance =       0.355047454376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906298019947        initial  <--
     2.5000e-01     2.5000e+00             7.5451e-04       -16.906297102381
     1.0000e+00     1.0000e+01             2.0449e-04       -16.906296889911
     4.0000e+00     4.0000e+01             5.1655e-05       -16.906297778021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8744
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6879e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9291
    reference variance = 0.185715
====================================================
  Execution time = 2.0583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349690371881
                                         uncertainty =       0.012001714956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349690371881
                                         uncertainty =       0.012001714956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418099485
  error estimate for blocks of size 2^( 2) =       0.000431040870
  error estimate for blocks of size 2^( 3) =       0.000443643058
  error estimate for blocks of size 2^( 4) =       0.000455356387
  error estimate for blocks of size 2^( 5) =       0.000466211422
  error estimate for blocks of size 2^( 6) =       0.000475067656
  error estimate for blocks of size 2^( 7) =       0.000478746004

      target function =                  N/A
              le_mean =     -16.906834136950
             les_mean =     286.190654718971
             stat err =       0.000468845367
             autocorr =       1.257476831986
              std dev =       0.591281962734
             le_variance =       0.349614359455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683413695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906834136950       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906834340938       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834609605       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834619461       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834562420       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834678123       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834778639       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906834750631       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.705843e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906834136950       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906834192116       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834264757       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834267488       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834251493       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834280246       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834305962       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906834299244       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.477766e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906834136950       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906834151029       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834169578       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834170287       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834166191       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834173364       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834179804       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906834178146       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 6.226967e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6079e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.112538e-01 1 1  ON 0
 uu_1                 1.438488e-01 1 1  ON 1
 uu_2                 4.180685e-02 1 1  ON 2
 uu_3                -2.116385e-02 1 1  ON 3
 uu_4                -6.720279e-02 1 1  ON 4
 uu_5                -1.024209e-01 1 1  ON 5
 uu_6                -1.301669e-01 1 1  ON 6
 uu_7                -1.440050e-01 1 1  ON 7
 uu_8                -1.368555e-01 1 1  ON 8
 uu_9                -1.068457e-01 1 1  ON 9
 ud_0                 4.504230e-01 1 1  ON 10
 ud_1                 1.844443e-01 1 1  ON 11
 ud_2                 6.378731e-02 1 1  ON 12
 ud_3                -7.802040e-03 1 1  ON 13
 ud_4                -6.532698e-02 1 1  ON 14
 ud_5                -1.074854e-01 1 1  ON 15
 ud_6                -1.354976e-01 1 1  ON 16
 ud_7                -1.522802e-01 1 1  ON 17
 ud_8                -1.533204e-01 1 1  ON 18
 ud_9                -1.446521e-01 1 1  ON 19
 eO_0                -7.587079e-01 1 1  ON 20
 eO_1                -4.368833e-01 1 1  ON 21
 eO_2                -2.095410e-02 1 1  ON 22
 eO_3                 2.976845e-01 1 1  ON 23
 eO_4                 5.257851e-01 1 1  ON 24
 eO_5                 4.893484e-01 1 1  ON 25
 eO_6                 2.622264e-01 1 1  ON 26
 eO_7                -4.036108e-02 1 1  ON 27
 eO_8                -2.247732e-01 1 1  ON 28
 eO_9                -9.113288e-02 1 1  ON 29
eH1_0                -2.526553e-01 1 1  ON 30
eH1_1                -1.489019e-01 1 1  ON 31
eH1_2                -1.002503e-01 1 1  ON 32
eH1_3                -4.529414e-02 1 1  ON 33
eH1_4                 3.531903e-03 1 1  ON 34
eH1_5                 3.781151e-02 1 1  ON 35
eH1_6                 9.678668e-02 1 1  ON 36
eH1_7                 1.548715e-01 1 1  ON 37
eH1_8                 1.824149e-01 1 1  ON 38
eH1_9                 7.494281e-02 1 1  ON 39
eH2_0                -2.507768e-01 1 1  ON 40
eH2_1                -1.465417e-01 1 1  ON 41
eH2_2                -9.771657e-02 1 1  ON 42
eH2_3                -4.301887e-02 1 1  ON 43
eH2_4                 5.939191e-03 1 1  ON 44
eH2_5                 4.032945e-02 1 1  ON 45
eH2_6                 9.974405e-02 1 1  ON 46
eH2_7                 1.560949e-01 1 1  ON 47
eH2_8                 1.867223e-01 1 1  ON 48
eH2_9                 6.502057e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8143
    reference variance = 0.225183
====================================================
  Execution time = 2.0261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3551e-01
  Total weights = 2.0000e+06
  Execution time = 1.8980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470210922
                                         uncertainty =       0.002566942224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470210922
                                         uncertainty =       0.002566942224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409576468
  error estimate for blocks of size 2^( 2) =       0.000422260202
  error estimate for blocks of size 2^( 3) =       0.000435272742
  error estimate for blocks of size 2^( 4) =       0.000447728914
  error estimate for blocks of size 2^( 5) =       0.000458557816
  error estimate for blocks of size 2^( 6) =       0.000467095217
  error estimate for blocks of size 2^( 7) =       0.000471683203

      target function =                  N/A
              le_mean =     -16.906195119129
             les_mean =     286.154939005347
             stat err =       0.000461266287
             autocorr =       1.268333416992
              std dev =       0.579228596520
             le_variance =       0.335505767027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335489656619
                                         uncertainty =       0.002567191605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335489656619
                                         uncertainty =       0.002567191605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409588334
  error estimate for blocks of size 2^( 2) =       0.000422271316
  error estimate for blocks of size 2^( 3) =       0.000435283041
  error estimate for blocks of size 2^( 4) =       0.000447738488
  error estimate for blocks of size 2^( 5) =       0.000458566822
  error estimate for blocks of size 2^( 6) =       0.000467103566
  error estimate for blocks of size 2^( 7) =       0.000471691282

      target function =                  N/A
              le_mean =     -16.906194898012
             les_mean =     286.154950967919
             stat err =       0.000461275040
             autocorr =       1.268308063738
              std dev =       0.579245376436
             le_variance =       0.335525206123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335480492377
                                         uncertainty =       0.002567074944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335480492377
                                         uncertainty =       0.002567074944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409582742
  error estimate for blocks of size 2^( 2) =       0.000422266059
  error estimate for blocks of size 2^( 3) =       0.000435278168
  error estimate for blocks of size 2^( 4) =       0.000447733964
  error estimate for blocks of size 2^( 5) =       0.000458562538
  error estimate for blocks of size 2^( 6) =       0.000467099582
  error estimate for blocks of size 2^( 7) =       0.000471687461

      target function =                  N/A
              le_mean =     -16.906194988433
             les_mean =     286.154944864416
             stat err =       0.000461270886
             autocorr =       1.268319852376
              std dev =       0.579237468803
             le_variance =       0.335516045265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335471513665
                                         uncertainty =       0.002566959089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335471513665
                                         uncertainty =       0.002566959089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409577263
  error estimate for blocks of size 2^( 2) =       0.000422260943
  error estimate for blocks of size 2^( 3) =       0.000435273428
  error estimate for blocks of size 2^( 4) =       0.000447729553
  error estimate for blocks of size 2^( 5) =       0.000458558411
  error estimate for blocks of size 2^( 6) =       0.000467095767
  error estimate for blocks of size 2^( 7) =       0.000471683741

      target function =                  N/A
              le_mean =     -16.906195101470
             les_mean =     286.154939710575
             stat err =       0.000461266868
             autocorr =       1.268331686772
              std dev =       0.579229720725
             le_variance =       0.335507069371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906195119129        initial  <--
     2.5000e+00     2.5000e+01             9.7058e-05       -16.906194898012
     1.0000e+01     1.0000e+02             2.4778e-05       -16.906194988433
     4.0000e+01     4.0000e+02             6.2270e-06       -16.906195101470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8403
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5926e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6876e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8762
    reference variance = 0.322094
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4461e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344732337636
                                         uncertainty =       0.004421156615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344732337636
                                         uncertainty =       0.004421156615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415097099
  error estimate for blocks of size 2^( 2) =       0.000427660168
  error estimate for blocks of size 2^( 3) =       0.000440182184
  error estimate for blocks of size 2^( 4) =       0.000452757798
  error estimate for blocks of size 2^( 5) =       0.000464045028
  error estimate for blocks of size 2^( 6) =       0.000472477275
  error estimate for blocks of size 2^( 7) =       0.000478069665

      target function =                  N/A
              le_mean =     -16.905924444231
             les_mean =     286.154892345054
             stat err =       0.000466837442
             autocorr =       1.264829435285
              std dev =       0.587035947210
             le_variance =       0.344611203317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592444423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905924444231       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924447337       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905924471536       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905924489738       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905924482808       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905924484633       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905924483630       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905924477505       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.327543e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905924444231       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924445012       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905924451072       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905924455699       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905924454018       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905924454469       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905924454196       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905924452668       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.332192e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905924444231       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924444426       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905924445942       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905924447104       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905924446687       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905924446799       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905924446729       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905924446348       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 5.830647e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5910e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.112507e-01 1 1  ON 0
 uu_1                 1.438490e-01 1 1  ON 1
 uu_2                 4.181176e-02 1 1  ON 2
 uu_3                -2.116827e-02 1 1  ON 3
 uu_4                -6.720994e-02 1 1  ON 4
 uu_5                -1.024219e-01 1 1  ON 5
 uu_6                -1.301688e-01 1 1  ON 6
 uu_7                -1.439950e-01 1 1  ON 7
 uu_8                -1.368475e-01 1 1  ON 8
 uu_9                -1.068380e-01 1 1  ON 9
 ud_0                 4.504150e-01 1 1  ON 10
 ud_1                 1.844327e-01 1 1  ON 11
 ud_2                 6.378759e-02 1 1  ON 12
 ud_3                -7.801563e-03 1 1  ON 13
 ud_4                -6.532479e-02 1 1  ON 14
 ud_5                -1.074852e-01 1 1  ON 15
 ud_6                -1.355017e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533192e-01 1 1  ON 18
 ud_9                -1.446541e-01 1 1  ON 19
 eO_0                -7.587155e-01 1 1  ON 20
 eO_1                -4.368809e-01 1 1  ON 21
 eO_2                -2.095872e-02 1 1  ON 22
 eO_3                 2.976868e-01 1 1  ON 23
 eO_4                 5.257817e-01 1 1  ON 24
 eO_5                 4.893338e-01 1 1  ON 25
 eO_6                 2.622164e-01 1 1  ON 26
 eO_7                -4.035540e-02 1 1  ON 27
 eO_8                -2.247583e-01 1 1  ON 28
 eO_9                -9.112040e-02 1 1  ON 29
eH1_0                -2.526327e-01 1 1  ON 30
eH1_1                -1.489038e-01 1 1  ON 31
eH1_2                -1.002501e-01 1 1  ON 32
eH1_3                -4.528585e-02 1 1  ON 33
eH1_4                 3.530264e-03 1 1  ON 34
eH1_5                 3.780259e-02 1 1  ON 35
eH1_6                 9.678909e-02 1 1  ON 36
eH1_7                 1.548735e-01 1 1  ON 37
eH1_8                 1.824052e-01 1 1  ON 38
eH1_9                 7.493010e-02 1 1  ON 39
eH2_0                -2.507540e-01 1 1  ON 40
eH2_1                -1.465276e-01 1 1  ON 41
eH2_2                -9.771395e-02 1 1  ON 42
eH2_3                -4.301217e-02 1 1  ON 43
eH2_4                 5.941473e-03 1 1  ON 44
eH2_5                 4.032452e-02 1 1  ON 45
eH2_6                 9.974002e-02 1 1  ON 46
eH2_7                 1.560888e-01 1 1  ON 47
eH2_8                 1.867114e-01 1 1  ON 48
eH2_9                 6.500152e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9167
    reference variance = 0.17884
====================================================
  Execution time = 1.9981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4413e-01
  Total weights = 2.0000e+06
  Execution time = 1.8950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344148511727
                                         uncertainty =       0.005683854962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344148511727
                                         uncertainty =       0.005683854962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414804833
  error estimate for blocks of size 2^( 2) =       0.000427642180
  error estimate for blocks of size 2^( 3) =       0.000441222942
  error estimate for blocks of size 2^( 4) =       0.000454420355
  error estimate for blocks of size 2^( 5) =       0.000466715934
  error estimate for blocks of size 2^( 6) =       0.000477681194
  error estimate for blocks of size 2^( 7) =       0.000484775981

      target function =                  N/A
              le_mean =     -16.905929612018
             les_mean =     286.154581973967
             stat err =       0.000470898366
             autocorr =       1.288744279828
              std dev =       0.586622621051
             le_variance =       0.344126099529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344157517390
                                         uncertainty =       0.005683939847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344157517390
                                         uncertainty =       0.005683939847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414810259
  error estimate for blocks of size 2^( 2) =       0.000427647244
  error estimate for blocks of size 2^( 3) =       0.000441227664
  error estimate for blocks of size 2^( 4) =       0.000454424884
  error estimate for blocks of size 2^( 5) =       0.000466720235
  error estimate for blocks of size 2^( 6) =       0.000477685312
  error estimate for blocks of size 2^( 7) =       0.000484779729

      target function =                  N/A
              le_mean =     -16.905929689560
             les_mean =     286.154593597736
             stat err =       0.000470902540
             autocorr =       1.288733413407
              std dev =       0.586630293673
             le_variance =       0.344135101454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344153061615
                                         uncertainty =       0.005683897910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344153061615
                                         uncertainty =       0.005683897910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414807574
  error estimate for blocks of size 2^( 2) =       0.000427644738
  error estimate for blocks of size 2^( 3) =       0.000441225327
  error estimate for blocks of size 2^( 4) =       0.000454422643
  error estimate for blocks of size 2^( 5) =       0.000466718106
  error estimate for blocks of size 2^( 6) =       0.000477683274
  error estimate for blocks of size 2^( 7) =       0.000484777873

      target function =                  N/A
              le_mean =     -16.905929651388
             les_mean =     286.154587853135
             stat err =       0.000470900474
             autocorr =       1.288738786532
              std dev =       0.586626497456
             le_variance =       0.344130647517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344149081902
                                         uncertainty =       0.005683860347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344149081902
                                         uncertainty =       0.005683860347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414805177
  error estimate for blocks of size 2^( 2) =       0.000427642501
  error estimate for blocks of size 2^( 3) =       0.000441223240
  error estimate for blocks of size 2^( 4) =       0.000454420641
  error estimate for blocks of size 2^( 5) =       0.000466716206
  error estimate for blocks of size 2^( 6) =       0.000477681455
  error estimate for blocks of size 2^( 7) =       0.000484776218

      target function =                  N/A
              le_mean =     -16.905929616951
             les_mean =     286.154582710701
             stat err =       0.000470898630
             autocorr =       1.288743591251
              std dev =       0.586623106829
             le_variance =       0.344126669465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905929612018        initial
     2.5000e+01     2.5000e+02             9.3275e-06       -16.905929689560  <--
     1.0000e+02     1.0000e+03             2.3322e-06       -16.905929651388
     4.0000e+02     4.0000e+03             5.8306e-07       -16.905929616951

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 3.2686e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.112547e-01 1 1  ON 0
 uu_1                 1.438517e-01 1 1  ON 1
 uu_2                 4.180938e-02 1 1  ON 2
 uu_3                -2.116783e-02 1 1  ON 3
 uu_4                -6.721233e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301741e-01 1 1  ON 6
 uu_7                -1.439965e-01 1 1  ON 7
 uu_8                -1.368483e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844344e-01 1 1  ON 11
 ud_2                 6.378345e-02 1 1  ON 12
 ud_3                -7.801505e-03 1 1  ON 13
 ud_4                -6.532603e-02 1 1  ON 14
 ud_5                -1.074866e-01 1 1  ON 15
 ud_6                -1.355022e-01 1 1  ON 16
 ud_7                -1.522618e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446518e-01 1 1  ON 19
 eO_0                -7.587172e-01 1 1  ON 20
 eO_1                -4.368773e-01 1 1  ON 21
 eO_2                -2.095675e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257814e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622171e-01 1 1  ON 26
 eO_7                -4.035168e-02 1 1  ON 27
 eO_8                -2.247599e-01 1 1  ON 28
 eO_9                -9.112436e-02 1 1  ON 29
eH1_0                -2.526393e-01 1 1  ON 30
eH1_1                -1.489058e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528747e-02 1 1  ON 33
eH1_4                 3.529388e-03 1 1  ON 34
eH1_5                 3.780045e-02 1 1  ON 35
eH1_6                 9.678957e-02 1 1  ON 36
eH1_7                 1.548723e-01 1 1  ON 37
eH1_8                 1.824098e-01 1 1  ON 38
eH1_9                 7.493710e-02 1 1  ON 39
eH2_0                -2.507577e-01 1 1  ON 40
eH2_1                -1.465309e-01 1 1  ON 41
eH2_2                -9.771968e-02 1 1  ON 42
eH2_3                -4.301289e-02 1 1  ON 43
eH2_4                 5.944306e-03 1 1  ON 44
eH2_5                 4.032390e-02 1 1  ON 45
eH2_6                 9.974150e-02 1 1  ON 46
eH2_7                 1.560910e-01 1 1  ON 47
eH2_8                 1.867139e-01 1 1  ON 48
eH2_9                 6.500674e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8603e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9358
    reference variance = 0.210463
====================================================
  Execution time = 2.0376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3215e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332173786386
                                         uncertainty =       0.003382431861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332173786386
                                         uncertainty =       0.003382431861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407521287
  error estimate for blocks of size 2^( 2) =       0.000420895298
  error estimate for blocks of size 2^( 3) =       0.000434464065
  error estimate for blocks of size 2^( 4) =       0.000447075463
  error estimate for blocks of size 2^( 5) =       0.000456746814
  error estimate for blocks of size 2^( 6) =       0.000462858268
  error estimate for blocks of size 2^( 7) =       0.000467502714

      target function =                  N/A
              le_mean =     -16.906414269894
             les_mean =     286.158990498688
             stat err =       0.000458545815
             autocorr =       1.266090844257
              std dev =       0.576322131696
             le_variance =       0.332147199482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641426989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414269894       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414267634       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414306633       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414310636       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414310214       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906414312218       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414341064       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414349638       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.465807e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414269894       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414269316       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414279514       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414280675       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414280485       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906414281120       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414287994       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414290035       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.678474e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414269894       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414269749       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906414272327       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906414272629       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414272576       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906414272747       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414274442       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414274944       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.170543e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5965e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438540e-01 1 1  ON 1
 uu_2                 4.180988e-02 1 1  ON 2
 uu_3                -2.116850e-02 1 1  ON 3
 uu_4                -6.720817e-02 1 1  ON 4
 uu_5                -1.024256e-01 1 1  ON 5
 uu_6                -1.301784e-01 1 1  ON 6
 uu_7                -1.439995e-01 1 1  ON 7
 uu_8                -1.368511e-01 1 1  ON 8
 uu_9                -1.068415e-01 1 1  ON 9
 ud_0                 4.504192e-01 1 1  ON 10
 ud_1                 1.844359e-01 1 1  ON 11
 ud_2                 6.378133e-02 1 1  ON 12
 ud_3                -7.802495e-03 1 1  ON 13
 ud_4                -6.532599e-02 1 1  ON 14
 ud_5                -1.074874e-01 1 1  ON 15
 ud_6                -1.355000e-01 1 1  ON 16
 ud_7                -1.522599e-01 1 1  ON 17
 ud_8                -1.533201e-01 1 1  ON 18
 ud_9                -1.446536e-01 1 1  ON 19
 eO_0                -7.587201e-01 1 1  ON 20
 eO_1                -4.368692e-01 1 1  ON 21
 eO_2                -2.095371e-02 1 1  ON 22
 eO_3                 2.976852e-01 1 1  ON 23
 eO_4                 5.257790e-01 1 1  ON 24
 eO_5                 4.893314e-01 1 1  ON 25
 eO_6                 2.622210e-01 1 1  ON 26
 eO_7                -4.034862e-02 1 1  ON 27
 eO_8                -2.247647e-01 1 1  ON 28
 eO_9                -9.112979e-02 1 1  ON 29
eH1_0                -2.526438e-01 1 1  ON 30
eH1_1                -1.489096e-01 1 1  ON 31
eH1_2                -1.002520e-01 1 1  ON 32
eH1_3                -4.528982e-02 1 1  ON 33
eH1_4                 3.525793e-03 1 1  ON 34
eH1_5                 3.779861e-02 1 1  ON 35
eH1_6                 9.679191e-02 1 1  ON 36
eH1_7                 1.548721e-01 1 1  ON 37
eH1_8                 1.824164e-01 1 1  ON 38
eH1_9                 7.494578e-02 1 1  ON 39
eH2_0                -2.507657e-01 1 1  ON 40
eH2_1                -1.465349e-01 1 1  ON 41
eH2_2                -9.772236e-02 1 1  ON 42
eH2_3                -4.301263e-02 1 1  ON 43
eH2_4                 5.945828e-03 1 1  ON 44
eH2_5                 4.032109e-02 1 1  ON 45
eH2_6                 9.974236e-02 1 1  ON 46
eH2_7                 1.560933e-01 1 1  ON 47
eH2_8                 1.867175e-01 1 1  ON 48
eH2_9                 6.501433e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9602
    reference variance = 0.228769
====================================================
  Execution time = 2.0155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4303e-01
  Total weights = 2.0000e+06
  Execution time = 1.8975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343121358856
                                         uncertainty =       0.004172315046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343121358856
                                         uncertainty =       0.004172315046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414144781
  error estimate for blocks of size 2^( 2) =       0.000427217032
  error estimate for blocks of size 2^( 3) =       0.000440514841
  error estimate for blocks of size 2^( 4) =       0.000454135056
  error estimate for blocks of size 2^( 5) =       0.000464970391
  error estimate for blocks of size 2^( 6) =       0.000472111944
  error estimate for blocks of size 2^( 7) =       0.000479846339

      target function =                  N/A
              le_mean =     -16.906349786840
             les_mean =     286.167694742636
             stat err =       0.000467765932
             autocorr =       1.275712444509
              std dev =       0.585689166004
             le_variance =       0.343031799175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343128967078
                                         uncertainty =       0.004172465142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343128967078
                                         uncertainty =       0.004172465142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414149369
  error estimate for blocks of size 2^( 2) =       0.000427221057
  error estimate for blocks of size 2^( 3) =       0.000440518344
  error estimate for blocks of size 2^( 4) =       0.000454138152
  error estimate for blocks of size 2^( 5) =       0.000464973363
  error estimate for blocks of size 2^( 6) =       0.000472114719
  error estimate for blocks of size 2^( 7) =       0.000479849607

      target function =                  N/A
              le_mean =     -16.906349679164
             les_mean =     286.167698702080
             stat err =       0.000467768960
             autocorr =       1.275700692879
              std dev =       0.585695654266
             le_variance =       0.343039399426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343125205954
                                         uncertainty =       0.004172390314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343125205954
                                         uncertainty =       0.004172390314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414147101
  error estimate for blocks of size 2^( 2) =       0.000427219061
  error estimate for blocks of size 2^( 3) =       0.000440516600
  error estimate for blocks of size 2^( 4) =       0.000454136609
  error estimate for blocks of size 2^( 5) =       0.000464971878
  error estimate for blocks of size 2^( 6) =       0.000472113336
  error estimate for blocks of size 2^( 7) =       0.000479847986

      target function =                  N/A
              le_mean =     -16.906349730186
             les_mean =     286.167696669886
             stat err =       0.000467767452
             autocorr =       1.275706442476
              std dev =       0.585692446632
             le_variance =       0.343035642042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343121840307
                                         uncertainty =       0.004172324453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343121840307
                                         uncertainty =       0.004172324453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414145071
  error estimate for blocks of size 2^( 2) =       0.000427217286
  error estimate for blocks of size 2^( 3) =       0.000440515060
  error estimate for blocks of size 2^( 4) =       0.000454135250
  error estimate for blocks of size 2^( 5) =       0.000464970577
  error estimate for blocks of size 2^( 6) =       0.000472112117
  error estimate for blocks of size 2^( 7) =       0.000479846544

      target function =                  N/A
              le_mean =     -16.906349779606
             les_mean =     286.167694978950
             stat err =       0.000467766122
             autocorr =       1.275711690495
              std dev =       0.585689576558
             le_variance =       0.343032280088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906349786840        initial  <--
     6.2500e+00     6.2500e+01             3.4658e-05       -16.906349679164
     2.5000e+01     2.5000e+02             8.6785e-06       -16.906349730186
     1.0000e+02     1.0000e+03             2.1705e-06       -16.906349779606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7236
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.112547e-01 1 1  ON 0
 uu_1                 1.438517e-01 1 1  ON 1
 uu_2                 4.180938e-02 1 1  ON 2
 uu_3                -2.116783e-02 1 1  ON 3
 uu_4                -6.721233e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301741e-01 1 1  ON 6
 uu_7                -1.439965e-01 1 1  ON 7
 uu_8                -1.368483e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844344e-01 1 1  ON 11
 ud_2                 6.378345e-02 1 1  ON 12
 ud_3                -7.801505e-03 1 1  ON 13
 ud_4                -6.532603e-02 1 1  ON 14
 ud_5                -1.074866e-01 1 1  ON 15
 ud_6                -1.355022e-01 1 1  ON 16
 ud_7                -1.522618e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446518e-01 1 1  ON 19
 eO_0                -7.587172e-01 1 1  ON 20
 eO_1                -4.368773e-01 1 1  ON 21
 eO_2                -2.095675e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257814e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622171e-01 1 1  ON 26
 eO_7                -4.035168e-02 1 1  ON 27
 eO_8                -2.247599e-01 1 1  ON 28
 eO_9                -9.112436e-02 1 1  ON 29
eH1_0                -2.526393e-01 1 1  ON 30
eH1_1                -1.489058e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528747e-02 1 1  ON 33
eH1_4                 3.529388e-03 1 1  ON 34
eH1_5                 3.780045e-02 1 1  ON 35
eH1_6                 9.678957e-02 1 1  ON 36
eH1_7                 1.548723e-01 1 1  ON 37
eH1_8                 1.824098e-01 1 1  ON 38
eH1_9                 7.493710e-02 1 1  ON 39
eH2_0                -2.507577e-01 1 1  ON 40
eH2_1                -1.465309e-01 1 1  ON 41
eH2_2                -9.771968e-02 1 1  ON 42
eH2_3                -4.301289e-02 1 1  ON 43
eH2_4                 5.944306e-03 1 1  ON 44
eH2_5                 4.032390e-02 1 1  ON 45
eH2_6                 9.974150e-02 1 1  ON 46
eH2_7                 1.560910e-01 1 1  ON 47
eH2_8                 1.867139e-01 1 1  ON 48
eH2_9                 6.500674e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9228
    reference variance = 0.341844
====================================================
  Execution time = 2.0304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3715e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337166416268
                                         uncertainty =       0.003381826131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337166416268
                                         uncertainty =       0.003381826131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410581041
  error estimate for blocks of size 2^( 2) =       0.000423405922
  error estimate for blocks of size 2^( 3) =       0.000436321009
  error estimate for blocks of size 2^( 4) =       0.000448300230
  error estimate for blocks of size 2^( 5) =       0.000460207473
  error estimate for blocks of size 2^( 6) =       0.000470741108
  error estimate for blocks of size 2^( 7) =       0.000479140780

      target function =                  N/A
              le_mean =     -16.906256236543
             les_mean =     286.158653349900
             stat err =       0.000464597398
             autocorr =       1.280429768730
              std dev =       0.580649276968
             le_variance =       0.337153582844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625623654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256236543       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256244801       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256245357       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256240575       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256243308       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256246910       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256246325       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256247483       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.366728e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256236543       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256238611       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256238747       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256237546       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256238224       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256239122       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256238982       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256239266       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.092601e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256236543       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256237060       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256237094       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256236793       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256236962       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256237187       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256237152       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256237223       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 2.732078e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5945e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.112549e-01 1 1  ON 0
 uu_1                 1.438521e-01 1 1  ON 1
 uu_2                 4.180946e-02 1 1  ON 2
 uu_3                -2.116768e-02 1 1  ON 3
 uu_4                -6.721236e-02 1 1  ON 4
 uu_5                -1.024242e-01 1 1  ON 5
 uu_6                -1.301743e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368486e-01 1 1  ON 8
 uu_9                -1.068393e-01 1 1  ON 9
 ud_0                 4.504174e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378362e-02 1 1  ON 12
 ud_3                -7.801399e-03 1 1  ON 13
 ud_4                -6.532602e-02 1 1  ON 14
 ud_5                -1.074866e-01 1 1  ON 15
 ud_6                -1.355017e-01 1 1  ON 16
 ud_7                -1.522619e-01 1 1  ON 17
 ud_8                -1.533183e-01 1 1  ON 18
 ud_9                -1.446520e-01 1 1  ON 19
 eO_0                -7.587169e-01 1 1  ON 20
 eO_1                -4.368768e-01 1 1  ON 21
 eO_2                -2.095647e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257812e-01 1 1  ON 24
 eO_5                 4.893320e-01 1 1  ON 25
 eO_6                 2.622175e-01 1 1  ON 26
 eO_7                -4.035146e-02 1 1  ON 27
 eO_8                -2.247604e-01 1 1  ON 28
 eO_9                -9.112494e-02 1 1  ON 29
eH1_0                -2.526404e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002489e-01 1 1  ON 32
eH1_3                -4.528742e-02 1 1  ON 33
eH1_4                 3.529451e-03 1 1  ON 34
eH1_5                 3.780076e-02 1 1  ON 35
eH1_6                 9.678949e-02 1 1  ON 36
eH1_7                 1.548721e-01 1 1  ON 37
eH1_8                 1.824099e-01 1 1  ON 38
eH1_9                 7.493768e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465314e-01 1 1  ON 41
eH2_2                -9.771995e-02 1 1  ON 42
eH2_3                -4.301302e-02 1 1  ON 43
eH2_4                 5.944597e-03 1 1  ON 44
eH2_5                 4.032396e-02 1 1  ON 45
eH2_6                 9.974112e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867144e-01 1 1  ON 48
eH2_9                 6.500773e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8839
    reference variance = 0.239984
====================================================
  Execution time = 2.0328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4111e-01
  Total weights = 2.0000e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341161271957
                                         uncertainty =       0.004474741230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341161271957
                                         uncertainty =       0.004474741230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412982794
  error estimate for blocks of size 2^( 2) =       0.000425673795
  error estimate for blocks of size 2^( 3) =       0.000438357704
  error estimate for blocks of size 2^( 4) =       0.000450241076
  error estimate for blocks of size 2^( 5) =       0.000460482409
  error estimate for blocks of size 2^( 6) =       0.000469197640
  error estimate for blocks of size 2^( 7) =       0.000476432373

      target function =                  N/A
              le_mean =     -16.906593049462
             les_mean =     286.173997946218
             stat err =       0.000464088375
             autocorr =       1.262808400466
              std dev =       0.584045868610
             le_variance =       0.341109576640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341160124725
                                         uncertainty =       0.004474729283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341160124725
                                         uncertainty =       0.004474729283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412982100
  error estimate for blocks of size 2^( 2) =       0.000425673094
  error estimate for blocks of size 2^( 3) =       0.000438356998
  error estimate for blocks of size 2^( 4) =       0.000450240384
  error estimate for blocks of size 2^( 5) =       0.000460481760
  error estimate for blocks of size 2^( 6) =       0.000469197053
  error estimate for blocks of size 2^( 7) =       0.000476431747

      target function =                  N/A
              le_mean =     -16.906593033696
             les_mean =     286.173996265650
             stat err =       0.000464087736
             autocorr =       1.262809173541
              std dev =       0.584044886287
             le_variance =       0.341108429199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341160694135
                                         uncertainty =       0.004474735211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341160694135
                                         uncertainty =       0.004474735211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412982444
  error estimate for blocks of size 2^( 2) =       0.000425673442
  error estimate for blocks of size 2^( 3) =       0.000438357349
  error estimate for blocks of size 2^( 4) =       0.000450240728
  error estimate for blocks of size 2^( 5) =       0.000460482082
  error estimate for blocks of size 2^( 6) =       0.000469197345
  error estimate for blocks of size 2^( 7) =       0.000476432058

      target function =                  N/A
              le_mean =     -16.906593041552
             les_mean =     286.173997100824
             stat err =       0.000464088053
             autocorr =       1.262808790745
              std dev =       0.584045373848
             le_variance =       0.341108998713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341161199594
                                         uncertainty =       0.004474740476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341161199594
                                         uncertainty =       0.004474740476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412982750
  error estimate for blocks of size 2^( 2) =       0.000425673750
  error estimate for blocks of size 2^( 3) =       0.000438357660
  error estimate for blocks of size 2^( 4) =       0.000450241032
  error estimate for blocks of size 2^( 5) =       0.000460482368
  error estimate for blocks of size 2^( 6) =       0.000469197603
  error estimate for blocks of size 2^( 7) =       0.000476432333

      target function =                  N/A
              le_mean =     -16.906593048472
             les_mean =     286.173997840364
             stat err =       0.000464088334
             autocorr =       1.262808449366
              std dev =       0.584045806650
             le_variance =       0.341109504265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906593049462        initial  <--
     6.2500e+01     6.2500e+02             4.3667e-06       -16.906593033696
     2.5000e+02     2.5000e+03             1.0926e-06       -16.906593041552
     1.0000e+03     1.0000e+04             2.7321e-07       -16.906593048472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8908
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.112547e-01 1 1  ON 0
 uu_1                 1.438517e-01 1 1  ON 1
 uu_2                 4.180938e-02 1 1  ON 2
 uu_3                -2.116783e-02 1 1  ON 3
 uu_4                -6.721233e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301741e-01 1 1  ON 6
 uu_7                -1.439965e-01 1 1  ON 7
 uu_8                -1.368483e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844344e-01 1 1  ON 11
 ud_2                 6.378345e-02 1 1  ON 12
 ud_3                -7.801505e-03 1 1  ON 13
 ud_4                -6.532603e-02 1 1  ON 14
 ud_5                -1.074866e-01 1 1  ON 15
 ud_6                -1.355022e-01 1 1  ON 16
 ud_7                -1.522618e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446518e-01 1 1  ON 19
 eO_0                -7.587172e-01 1 1  ON 20
 eO_1                -4.368773e-01 1 1  ON 21
 eO_2                -2.095675e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257814e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622171e-01 1 1  ON 26
 eO_7                -4.035168e-02 1 1  ON 27
 eO_8                -2.247599e-01 1 1  ON 28
 eO_9                -9.112436e-02 1 1  ON 29
eH1_0                -2.526393e-01 1 1  ON 30
eH1_1                -1.489058e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528747e-02 1 1  ON 33
eH1_4                 3.529388e-03 1 1  ON 34
eH1_5                 3.780045e-02 1 1  ON 35
eH1_6                 9.678957e-02 1 1  ON 36
eH1_7                 1.548723e-01 1 1  ON 37
eH1_8                 1.824098e-01 1 1  ON 38
eH1_9                 7.493710e-02 1 1  ON 39
eH2_0                -2.507577e-01 1 1  ON 40
eH2_1                -1.465309e-01 1 1  ON 41
eH2_2                -9.771968e-02 1 1  ON 42
eH2_3                -4.301289e-02 1 1  ON 43
eH2_4                 5.944306e-03 1 1  ON 44
eH2_5                 4.032390e-02 1 1  ON 45
eH2_6                 9.974150e-02 1 1  ON 46
eH2_7                 1.560910e-01 1 1  ON 47
eH2_8                 1.867139e-01 1 1  ON 48
eH2_9                 6.500674e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9003
    reference variance = 0.30441
====================================================
  Execution time = 2.0550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4455e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344493428252
                                         uncertainty =       0.004855957306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344493428252
                                         uncertainty =       0.004855957306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415063057
  error estimate for blocks of size 2^( 2) =       0.000427793664
  error estimate for blocks of size 2^( 3) =       0.000440615334
  error estimate for blocks of size 2^( 4) =       0.000453661081
  error estimate for blocks of size 2^( 5) =       0.000464213786
  error estimate for blocks of size 2^( 6) =       0.000471809241
  error estimate for blocks of size 2^( 7) =       0.000481425692

      target function =                  N/A
              le_mean =     -16.906300670005
             les_mean =     286.167556855236
             stat err =       0.000467777450
             autocorr =       1.270136518651
              std dev =       0.586987804730
             le_variance =       0.344554682901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630067001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300670005       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300669469       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300670166       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300670257       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300671791       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300671118       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300670591       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906300670809       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.438154e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300670005       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300669871       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300670045       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300670068       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300670452       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300670283       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300670151       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906300670206       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 8.595633e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300670005       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300669972       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300670015       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300670019       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300670120       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300670076       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300670040       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906300670066       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 2.148924e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6141e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.112547e-01 1 1  ON 0
 uu_1                 1.438518e-01 1 1  ON 1
 uu_2                 4.180937e-02 1 1  ON 2
 uu_3                -2.116778e-02 1 1  ON 3
 uu_4                -6.721230e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301742e-01 1 1  ON 6
 uu_7                -1.439966e-01 1 1  ON 7
 uu_8                -1.368483e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844345e-01 1 1  ON 11
 ud_2                 6.378344e-02 1 1  ON 12
 ud_3                -7.801518e-03 1 1  ON 13
 ud_4                -6.532603e-02 1 1  ON 14
 ud_5                -1.074865e-01 1 1  ON 15
 ud_6                -1.355023e-01 1 1  ON 16
 ud_7                -1.522618e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446518e-01 1 1  ON 19
 eO_0                -7.587172e-01 1 1  ON 20
 eO_1                -4.368772e-01 1 1  ON 21
 eO_2                -2.095671e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257814e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622171e-01 1 1  ON 26
 eO_7                -4.035166e-02 1 1  ON 27
 eO_8                -2.247599e-01 1 1  ON 28
 eO_9                -9.112442e-02 1 1  ON 29
eH1_0                -2.526394e-01 1 1  ON 30
eH1_1                -1.489058e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528748e-02 1 1  ON 33
eH1_4                 3.529357e-03 1 1  ON 34
eH1_5                 3.780044e-02 1 1  ON 35
eH1_6                 9.678958e-02 1 1  ON 36
eH1_7                 1.548723e-01 1 1  ON 37
eH1_8                 1.824098e-01 1 1  ON 38
eH1_9                 7.493717e-02 1 1  ON 39
eH2_0                -2.507578e-01 1 1  ON 40
eH2_1                -1.465309e-01 1 1  ON 41
eH2_2                -9.771969e-02 1 1  ON 42
eH2_3                -4.301291e-02 1 1  ON 43
eH2_4                 5.944304e-03 1 1  ON 44
eH2_5                 4.032387e-02 1 1  ON 45
eH2_6                 9.974145e-02 1 1  ON 46
eH2_7                 1.560910e-01 1 1  ON 47
eH2_8                 1.867139e-01 1 1  ON 48
eH2_9                 6.500683e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.193719
====================================================
  Execution time = 2.0025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4268e-01
  Total weights = 2.0000e+06
  Execution time = 1.9021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668993117
                                         uncertainty =       0.005686638694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668993117
                                         uncertainty =       0.005686638694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413932774
  error estimate for blocks of size 2^( 2) =       0.000426713731
  error estimate for blocks of size 2^( 3) =       0.000439266916
  error estimate for blocks of size 2^( 4) =       0.000451603133
  error estimate for blocks of size 2^( 5) =       0.000463295859
  error estimate for blocks of size 2^( 6) =       0.000470585900
  error estimate for blocks of size 2^( 7) =       0.000474979697

      target function =                  N/A
              le_mean =     -16.905681447557
             les_mean =     286.144745718516
             stat err =       0.000465116147
             autocorr =       1.262592499262
              std dev =       0.585389343572
             le_variance =       0.342680683567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668959686
                                         uncertainty =       0.005686624873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668959686
                                         uncertainty =       0.005686624873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413932754
  error estimate for blocks of size 2^( 2) =       0.000426713710
  error estimate for blocks of size 2^( 3) =       0.000439266894
  error estimate for blocks of size 2^( 4) =       0.000451603106
  error estimate for blocks of size 2^( 5) =       0.000463295833
  error estimate for blocks of size 2^( 6) =       0.000470585876
  error estimate for blocks of size 2^( 7) =       0.000474979663

      target function =                  N/A
              le_mean =     -16.905681447716
             les_mean =     286.144745690448
             stat err =       0.000465116120
             autocorr =       1.262592473065
              std dev =       0.585389315006
             le_variance =       0.342680650123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668976386
                                         uncertainty =       0.005686631779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668976386
                                         uncertainty =       0.005686631779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413932764
  error estimate for blocks of size 2^( 2) =       0.000426713720
  error estimate for blocks of size 2^( 3) =       0.000439266905
  error estimate for blocks of size 2^( 4) =       0.000451603120
  error estimate for blocks of size 2^( 5) =       0.000463295846
  error estimate for blocks of size 2^( 6) =       0.000470585888
  error estimate for blocks of size 2^( 7) =       0.000474979680

      target function =                  N/A
              le_mean =     -16.905681447637
             les_mean =     286.144745704462
             stat err =       0.000465116133
             autocorr =       1.262592486155
              std dev =       0.585389329276
             le_variance =       0.342680666830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668991025
                                         uncertainty =       0.005686637830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342668991025
                                         uncertainty =       0.005686637830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413932773
  error estimate for blocks of size 2^( 2) =       0.000426713730
  error estimate for blocks of size 2^( 3) =       0.000439266915
  error estimate for blocks of size 2^( 4) =       0.000451603131
  error estimate for blocks of size 2^( 5) =       0.000463295857
  error estimate for blocks of size 2^( 6) =       0.000470585899
  error estimate for blocks of size 2^( 7) =       0.000474979695

      target function =                  N/A
              le_mean =     -16.905681447567
             les_mean =     286.144745716759
             stat err =       0.000465116145
             autocorr =       1.262592497622
              std dev =       0.585389341784
             le_variance =       0.342680681475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905681447557        initial
     6.2500e+02     6.2500e+03             3.4382e-07       -16.905681447716  <--
     2.5000e+03     2.5000e+04             8.5956e-08       -16.905681447637
     1.0000e+04     1.0000e+05             2.1489e-08       -16.905681447567

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.9618e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180933e-02 1 1  ON 2
 uu_3                -2.116762e-02 1 1  ON 3
 uu_4                -6.721224e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301743e-01 1 1  ON 6
 uu_7                -1.439968e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844346e-01 1 1  ON 11
 ud_2                 6.378339e-02 1 1  ON 12
 ud_3                -7.801558e-03 1 1  ON 13
 ud_4                -6.532601e-02 1 1  ON 14
 ud_5                -1.074864e-01 1 1  ON 15
 ud_6                -1.355023e-01 1 1  ON 16
 ud_7                -1.522617e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446519e-01 1 1  ON 19
 eO_0                -7.587171e-01 1 1  ON 20
 eO_1                -4.368771e-01 1 1  ON 21
 eO_2                -2.095659e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257813e-01 1 1  ON 24
 eO_5                 4.893320e-01 1 1  ON 25
 eO_6                 2.622172e-01 1 1  ON 26
 eO_7                -4.035159e-02 1 1  ON 27
 eO_8                -2.247601e-01 1 1  ON 28
 eO_9                -9.112459e-02 1 1  ON 29
eH1_0                -2.526397e-01 1 1  ON 30
eH1_1                -1.489059e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528750e-02 1 1  ON 33
eH1_4                 3.529263e-03 1 1  ON 34
eH1_5                 3.780043e-02 1 1  ON 35
eH1_6                 9.678960e-02 1 1  ON 36
eH1_7                 1.548724e-01 1 1  ON 37
eH1_8                 1.824100e-01 1 1  ON 38
eH1_9                 7.493737e-02 1 1  ON 39
eH2_0                -2.507580e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771971e-02 1 1  ON 42
eH2_3                -4.301299e-02 1 1  ON 43
eH2_4                 5.944298e-03 1 1  ON 44
eH2_5                 4.032378e-02 1 1  ON 45
eH2_6                 9.974132e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867141e-01 1 1  ON 48
eH2_9                 6.500709e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.02
    reference variance = 0.366072
====================================================
  Execution time = 2.0820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4998e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350052827609
                                         uncertainty =       0.007732668571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350052827609
                                         uncertainty =       0.007732668571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418318282
  error estimate for blocks of size 2^( 2) =       0.000430980139
  error estimate for blocks of size 2^( 3) =       0.000443560368
  error estimate for blocks of size 2^( 4) =       0.000456207171
  error estimate for blocks of size 2^( 5) =       0.000467504979
  error estimate for blocks of size 2^( 6) =       0.000475019335
  error estimate for blocks of size 2^( 7) =       0.000478031598

      target function =                  N/A
              le_mean =     -16.906292959919
             les_mean =     286.172721841661
             stat err =       0.000469190771
             autocorr =       1.258013295233
              std dev =       0.591591387724
             le_variance =       0.349980370029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629295992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906292959919       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906292963489       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906292965288       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906292966261       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906292962403       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906292961274       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906292961834       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906292961531       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.786027e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906292959919       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906292960813       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906292961264       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906292961508       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906292960544       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906292960260       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906292960399       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906292960323       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.466071e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906292959919       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906292960143       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906292960256       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906292960317       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906292960076       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906292960006       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906292960040       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906292960023       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.116581e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6405e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.112548e-01 1 1  ON 0
 uu_1                 1.438518e-01 1 1  ON 1
 uu_2                 4.180920e-02 1 1  ON 2
 uu_3                -2.116761e-02 1 1  ON 3
 uu_4                -6.721235e-02 1 1  ON 4
 uu_5                -1.024242e-01 1 1  ON 5
 uu_6                -1.301744e-01 1 1  ON 6
 uu_7                -1.439968e-01 1 1  ON 7
 uu_8                -1.368486e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844347e-01 1 1  ON 11
 ud_2                 6.378344e-02 1 1  ON 12
 ud_3                -7.801612e-03 1 1  ON 13
 ud_4                -6.532594e-02 1 1  ON 14
 ud_5                -1.074866e-01 1 1  ON 15
 ud_6                -1.355024e-01 1 1  ON 16
 ud_7                -1.522619e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446518e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368769e-01 1 1  ON 21
 eO_2                -2.095653e-02 1 1  ON 22
 eO_3                 2.976863e-01 1 1  ON 23
 eO_4                 5.257814e-01 1 1  ON 24
 eO_5                 4.893320e-01 1 1  ON 25
 eO_6                 2.622172e-01 1 1  ON 26
 eO_7                -4.035152e-02 1 1  ON 27
 eO_8                -2.247602e-01 1 1  ON 28
 eO_9                -9.112476e-02 1 1  ON 29
eH1_0                -2.526401e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528774e-02 1 1  ON 33
eH1_4                 3.529260e-03 1 1  ON 34
eH1_5                 3.780045e-02 1 1  ON 35
eH1_6                 9.678971e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824102e-01 1 1  ON 38
eH1_9                 7.493770e-02 1 1  ON 39
eH2_0                -2.507581e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771983e-02 1 1  ON 42
eH2_3                -4.301297e-02 1 1  ON 43
eH2_4                 5.944197e-03 1 1  ON 44
eH2_5                 4.032375e-02 1 1  ON 45
eH2_6                 9.974121e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867143e-01 1 1  ON 48
eH2_9                 6.500739e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.816
    reference variance = 0.212653
====================================================
  Execution time = 2.0065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.0000e+06
  Execution time = 1.9114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336491711138
                                         uncertainty =       0.003227701165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336491711138
                                         uncertainty =       0.003227701165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410129449
  error estimate for blocks of size 2^( 2) =       0.000422968694
  error estimate for blocks of size 2^( 3) =       0.000436307086
  error estimate for blocks of size 2^( 4) =       0.000448147451
  error estimate for blocks of size 2^( 5) =       0.000459479706
  error estimate for blocks of size 2^( 6) =       0.000467798779
  error estimate for blocks of size 2^( 7) =       0.000471985604

      target function =                  N/A
              le_mean =     -16.906834686763
             les_mean =     286.177471287145
             stat err =       0.000461852885
             autocorr =       1.268134775724
              std dev =       0.580010629057
             le_variance =       0.336412329819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336492515672
                                         uncertainty =       0.003227708457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336492515672
                                         uncertainty =       0.003227708457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410129939
  error estimate for blocks of size 2^( 2) =       0.000422969161
  error estimate for blocks of size 2^( 3) =       0.000436307525
  error estimate for blocks of size 2^( 4) =       0.000448147873
  error estimate for blocks of size 2^( 5) =       0.000459480114
  error estimate for blocks of size 2^( 6) =       0.000467799156
  error estimate for blocks of size 2^( 7) =       0.000471985995

      target function =                  N/A
              le_mean =     -16.906834685574
             les_mean =     286.177472051238
             stat err =       0.000461853285
             autocorr =       1.268133939237
              std dev =       0.580011322394
             le_variance =       0.336413134105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336492113831
                                         uncertainty =       0.003227704815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336492113831
                                         uncertainty =       0.003227704815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410129694
  error estimate for blocks of size 2^( 2) =       0.000422968928
  error estimate for blocks of size 2^( 3) =       0.000436307306
  error estimate for blocks of size 2^( 4) =       0.000448147662
  error estimate for blocks of size 2^( 5) =       0.000459479911
  error estimate for blocks of size 2^( 6) =       0.000467798968
  error estimate for blocks of size 2^( 7) =       0.000471985799

      target function =                  N/A
              le_mean =     -16.906834686163
             les_mean =     286.177471669439
             stat err =       0.000461853085
             autocorr =       1.268134357013
              std dev =       0.580010976092
             le_variance =       0.336412732388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336491761487
                                         uncertainty =       0.003227701622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336491761487
                                         uncertainty =       0.003227701622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410129480
  error estimate for blocks of size 2^( 2) =       0.000422968724
  error estimate for blocks of size 2^( 3) =       0.000436307114
  error estimate for blocks of size 2^( 4) =       0.000448147477
  error estimate for blocks of size 2^( 5) =       0.000459479732
  error estimate for blocks of size 2^( 6) =       0.000467798802
  error estimate for blocks of size 2^( 7) =       0.000471985628

      target function =                  N/A
              le_mean =     -16.906834686688
             les_mean =     286.177471334934
             stat err =       0.000461852910
             autocorr =       1.268134723365
              std dev =       0.580010672447
             le_variance =       0.336412380153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906834686763        initial  <--
     1.5625e+02     1.5625e+03             1.7860e-06       -16.906834685574
     6.2500e+02     6.2500e+03             4.4661e-07       -16.906834686163
     2.5000e+03     2.5000e+04             1.1166e-07       -16.906834686688

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6953
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180933e-02 1 1  ON 2
 uu_3                -2.116762e-02 1 1  ON 3
 uu_4                -6.721224e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301743e-01 1 1  ON 6
 uu_7                -1.439968e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844346e-01 1 1  ON 11
 ud_2                 6.378339e-02 1 1  ON 12
 ud_3                -7.801558e-03 1 1  ON 13
 ud_4                -6.532601e-02 1 1  ON 14
 ud_5                -1.074864e-01 1 1  ON 15
 ud_6                -1.355023e-01 1 1  ON 16
 ud_7                -1.522617e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446519e-01 1 1  ON 19
 eO_0                -7.587171e-01 1 1  ON 20
 eO_1                -4.368771e-01 1 1  ON 21
 eO_2                -2.095659e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257813e-01 1 1  ON 24
 eO_5                 4.893320e-01 1 1  ON 25
 eO_6                 2.622172e-01 1 1  ON 26
 eO_7                -4.035159e-02 1 1  ON 27
 eO_8                -2.247601e-01 1 1  ON 28
 eO_9                -9.112459e-02 1 1  ON 29
eH1_0                -2.526397e-01 1 1  ON 30
eH1_1                -1.489059e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528750e-02 1 1  ON 33
eH1_4                 3.529263e-03 1 1  ON 34
eH1_5                 3.780043e-02 1 1  ON 35
eH1_6                 9.678960e-02 1 1  ON 36
eH1_7                 1.548724e-01 1 1  ON 37
eH1_8                 1.824100e-01 1 1  ON 38
eH1_9                 7.493737e-02 1 1  ON 39
eH2_0                -2.507580e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771971e-02 1 1  ON 42
eH2_3                -4.301299e-02 1 1  ON 43
eH2_4                 5.944298e-03 1 1  ON 44
eH2_5                 4.032378e-02 1 1  ON 45
eH2_6                 9.974132e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867141e-01 1 1  ON 48
eH2_9                 6.500709e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.311887
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333897382781
                                         uncertainty =       0.003671295545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333897382781
                                         uncertainty =       0.003671295545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408600482
  error estimate for blocks of size 2^( 2) =       0.000421635194
  error estimate for blocks of size 2^( 3) =       0.000434442053
  error estimate for blocks of size 2^( 4) =       0.000446435752
  error estimate for blocks of size 2^( 5) =       0.000457068237
  error estimate for blocks of size 2^( 6) =       0.000462691222
  error estimate for blocks of size 2^( 7) =       0.000467890544

      target function =                  N/A
              le_mean =     -16.906534599878
             les_mean =     286.164820718145
             stat err =       0.000458521439
             autocorr =       1.259277789085
              std dev =       0.577848343620
             le_variance =       0.333908708224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653459988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534599878       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534600157       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534600680       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534600419       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534600583       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534600622       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534600688       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906534600620       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.496037e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534599878       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534599948       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534600079       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534600013       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534600056       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534600066       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534600079       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906534600051       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.740231e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534599878       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534599895       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534599928       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534599908       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534599928       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534599948       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534599912       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906534599928       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 9.350665e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6482e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180932e-02 1 1  ON 2
 uu_3                -2.116761e-02 1 1  ON 3
 uu_4                -6.721224e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301743e-01 1 1  ON 6
 uu_7                -1.439968e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504175e-01 1 1  ON 10
 ud_1                 1.844346e-01 1 1  ON 11
 ud_2                 6.378339e-02 1 1  ON 12
 ud_3                -7.801563e-03 1 1  ON 13
 ud_4                -6.532601e-02 1 1  ON 14
 ud_5                -1.074864e-01 1 1  ON 15
 ud_6                -1.355023e-01 1 1  ON 16
 ud_7                -1.522617e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446519e-01 1 1  ON 19
 eO_0                -7.587171e-01 1 1  ON 20
 eO_1                -4.368771e-01 1 1  ON 21
 eO_2                -2.095658e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257812e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622172e-01 1 1  ON 26
 eO_7                -4.035159e-02 1 1  ON 27
 eO_8                -2.247601e-01 1 1  ON 28
 eO_9                -9.112461e-02 1 1  ON 29
eH1_0                -2.526397e-01 1 1  ON 30
eH1_1                -1.489059e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528751e-02 1 1  ON 33
eH1_4                 3.529268e-03 1 1  ON 34
eH1_5                 3.780041e-02 1 1  ON 35
eH1_6                 9.678960e-02 1 1  ON 36
eH1_7                 1.548724e-01 1 1  ON 37
eH1_8                 1.824100e-01 1 1  ON 38
eH1_9                 7.493740e-02 1 1  ON 39
eH2_0                -2.507580e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771973e-02 1 1  ON 42
eH2_3                -4.301300e-02 1 1  ON 43
eH2_4                 5.944290e-03 1 1  ON 44
eH2_5                 4.032377e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867142e-01 1 1  ON 48
eH2_9                 6.500712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.349182
====================================================
  Execution time = 2.0395e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3697e-01
  Total weights = 2.0000e+06
  Execution time = 1.9106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714394669
                                         uncertainty =       0.002561065313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714394669
                                         uncertainty =       0.002561065313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410467519
  error estimate for blocks of size 2^( 2) =       0.000423082536
  error estimate for blocks of size 2^( 3) =       0.000436288159
  error estimate for blocks of size 2^( 4) =       0.000448574351
  error estimate for blocks of size 2^( 5) =       0.000458676668
  error estimate for blocks of size 2^( 6) =       0.000468620500
  error estimate for blocks of size 2^( 7) =       0.000475916216

      target function =                  N/A
              le_mean =     -16.905992046335
             les_mean =     286.149534070527
             stat err =       0.000462946934
             autocorr =       1.272051901506
              std dev =       0.580488732249
             le_variance =       0.336967168269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714424202
                                         uncertainty =       0.002561065734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714424202
                                         uncertainty =       0.002561065734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410467537
  error estimate for blocks of size 2^( 2) =       0.000423082552
  error estimate for blocks of size 2^( 3) =       0.000436288173
  error estimate for blocks of size 2^( 4) =       0.000448574365
  error estimate for blocks of size 2^( 5) =       0.000458676683
  error estimate for blocks of size 2^( 6) =       0.000468620514
  error estimate for blocks of size 2^( 7) =       0.000475916227

      target function =                  N/A
              le_mean =     -16.905992046481
             les_mean =     286.149534104945
             stat err =       0.000462946947
             autocorr =       1.272051863821
              std dev =       0.580488757640
             le_variance =       0.336967197747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714409435
                                         uncertainty =       0.002561065524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714409435
                                         uncertainty =       0.002561065524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410467528
  error estimate for blocks of size 2^( 2) =       0.000423082544
  error estimate for blocks of size 2^( 3) =       0.000436288166
  error estimate for blocks of size 2^( 4) =       0.000448574358
  error estimate for blocks of size 2^( 5) =       0.000458676676
  error estimate for blocks of size 2^( 6) =       0.000468620507
  error estimate for blocks of size 2^( 7) =       0.000475916222

      target function =                  N/A
              le_mean =     -16.905992046408
             les_mean =     286.149534087736
             stat err =       0.000462946941
             autocorr =       1.272051882664
              std dev =       0.580488744944
             le_variance =       0.336967183007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714396515
                                         uncertainty =       0.002561065339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714396515
                                         uncertainty =       0.002561065339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410467520
  error estimate for blocks of size 2^( 2) =       0.000423082537
  error estimate for blocks of size 2^( 3) =       0.000436288159
  error estimate for blocks of size 2^( 4) =       0.000448574351
  error estimate for blocks of size 2^( 5) =       0.000458676669
  error estimate for blocks of size 2^( 6) =       0.000468620501
  error estimate for blocks of size 2^( 7) =       0.000475916217

      target function =                  N/A
              le_mean =     -16.905992046344
             les_mean =     286.149534072678
             stat err =       0.000462946935
             autocorr =       1.272051899153
              std dev =       0.580488733836
             le_variance =       0.336967170111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905992046335        initial
     1.5625e+03     1.5625e+04             1.4960e-07       -16.905992046481  <--
     6.2500e+03     6.2500e+04             3.7402e-08       -16.905992046408
     2.5000e+04     2.5000e+05             9.3507e-09       -16.905992046344

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 3.0077e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.112547e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180929e-02 1 1  ON 2
 uu_3                -2.116759e-02 1 1  ON 3
 uu_4                -6.721223e-02 1 1  ON 4
 uu_5                -1.024241e-01 1 1  ON 5
 uu_6                -1.301743e-01 1 1  ON 6
 uu_7                -1.439968e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504176e-01 1 1  ON 10
 ud_1                 1.844347e-01 1 1  ON 11
 ud_2                 6.378337e-02 1 1  ON 12
 ud_3                -7.801578e-03 1 1  ON 13
 ud_4                -6.532601e-02 1 1  ON 14
 ud_5                -1.074864e-01 1 1  ON 15
 ud_6                -1.355022e-01 1 1  ON 16
 ud_7                -1.522618e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446519e-01 1 1  ON 19
 eO_0                -7.587171e-01 1 1  ON 20
 eO_1                -4.368770e-01 1 1  ON 21
 eO_2                -2.095654e-02 1 1  ON 22
 eO_3                 2.976866e-01 1 1  ON 23
 eO_4                 5.257812e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622173e-01 1 1  ON 26
 eO_7                -4.035158e-02 1 1  ON 27
 eO_8                -2.247601e-01 1 1  ON 28
 eO_9                -9.112466e-02 1 1  ON 29
eH1_0                -2.526398e-01 1 1  ON 30
eH1_1                -1.489059e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528754e-02 1 1  ON 33
eH1_4                 3.529283e-03 1 1  ON 34
eH1_5                 3.780035e-02 1 1  ON 35
eH1_6                 9.678959e-02 1 1  ON 36
eH1_7                 1.548724e-01 1 1  ON 37
eH1_8                 1.824101e-01 1 1  ON 38
eH1_9                 7.493749e-02 1 1  ON 39
eH2_0                -2.507581e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771977e-02 1 1  ON 42
eH2_3                -4.301303e-02 1 1  ON 43
eH2_4                 5.944268e-03 1 1  ON 44
eH2_5                 4.032376e-02 1 1  ON 45
eH2_6                 9.974136e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867142e-01 1 1  ON 48
eH2_9                 6.500721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8792
    reference variance = 0.186216
====================================================
  Execution time = 2.3016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343689428588
                                         uncertainty =       0.004991827957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343689428588
                                         uncertainty =       0.004991827957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414467075
  error estimate for blocks of size 2^( 2) =       0.000427124790
  error estimate for blocks of size 2^( 3) =       0.000439768082
  error estimate for blocks of size 2^( 4) =       0.000451777530
  error estimate for blocks of size 2^( 5) =       0.000463166037
  error estimate for blocks of size 2^( 6) =       0.000471389773
  error estimate for blocks of size 2^( 7) =       0.000476432069

      target function =                  N/A
              le_mean =     -16.907092019317
             les_mean =     286.193326291051
             stat err =       0.000465691352
             autocorr =       1.262456065891
              std dev =       0.586144959186
             le_variance =       0.343565913180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690709201932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907092019317       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907092022003       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907092021801       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907092021219       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907092019781       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907092020185       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907092020531       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907092020588       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.803865e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907092019317       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907092019989       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907092019938       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907092019793       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907092019434       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907092019533       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907092019619       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907092019633       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.451014e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907092019317       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907092019485       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907092019472       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907092019436       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907092019345       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907092019367       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907092019394       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907092019398       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.627564e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8576e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180926e-02 1 1  ON 2
 uu_3                -2.116753e-02 1 1  ON 3
 uu_4                -6.721221e-02 1 1  ON 4
 uu_5                -1.024242e-01 1 1  ON 5
 uu_6                -1.301744e-01 1 1  ON 6
 uu_7                -1.439969e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068390e-01 1 1  ON 9
 ud_0                 4.504176e-01 1 1  ON 10
 ud_1                 1.844347e-01 1 1  ON 11
 ud_2                 6.378326e-02 1 1  ON 12
 ud_3                -7.801594e-03 1 1  ON 13
 ud_4                -6.532603e-02 1 1  ON 14
 ud_5                -1.074864e-01 1 1  ON 15
 ud_6                -1.355022e-01 1 1  ON 16
 ud_7                -1.522619e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446518e-01 1 1  ON 19
 eO_0                -7.587171e-01 1 1  ON 20
 eO_1                -4.368769e-01 1 1  ON 21
 eO_2                -2.095652e-02 1 1  ON 22
 eO_3                 2.976865e-01 1 1  ON 23
 eO_4                 5.257811e-01 1 1  ON 24
 eO_5                 4.893321e-01 1 1  ON 25
 eO_6                 2.622173e-01 1 1  ON 26
 eO_7                -4.035157e-02 1 1  ON 27
 eO_8                -2.247602e-01 1 1  ON 28
 eO_9                -9.112473e-02 1 1  ON 29
eH1_0                -2.526399e-01 1 1  ON 30
eH1_1                -1.489059e-01 1 1  ON 31
eH1_2                -1.002492e-01 1 1  ON 32
eH1_3                -4.528755e-02 1 1  ON 33
eH1_4                 3.529179e-03 1 1  ON 34
eH1_5                 3.780034e-02 1 1  ON 35
eH1_6                 9.678960e-02 1 1  ON 36
eH1_7                 1.548724e-01 1 1  ON 37
eH1_8                 1.824102e-01 1 1  ON 38
eH1_9                 7.493763e-02 1 1  ON 39
eH2_0                -2.507582e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771982e-02 1 1  ON 42
eH2_3                -4.301304e-02 1 1  ON 43
eH2_4                 5.944213e-03 1 1  ON 44
eH2_5                 4.032372e-02 1 1  ON 45
eH2_6                 9.974136e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867143e-01 1 1  ON 48
eH2_9                 6.500736e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8792
    reference variance = 0.300043
====================================================
  Execution time = 2.0076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7200e-01
  Total weights = 2.0000e+06
  Execution time = 1.9046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050387341
                                         uncertainty =       0.035690421885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050387341
                                         uncertainty =       0.035690421885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431276396
  error estimate for blocks of size 2^( 2) =       0.000443999854
  error estimate for blocks of size 2^( 3) =       0.000456726512
  error estimate for blocks of size 2^( 4) =       0.000469270553
  error estimate for blocks of size 2^( 5) =       0.000480016319
  error estimate for blocks of size 2^( 6) =       0.000486166921
  error estimate for blocks of size 2^( 7) =       0.000490563847

      target function =                  N/A
              le_mean =     -16.906526535655
             les_mean =     286.202637974915
             stat err =       0.000481504410
             autocorr =       1.246491032111
              std dev =       0.609916928866
             le_variance =       0.371998660118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050702325
                                         uncertainty =       0.035690370711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050702325
                                         uncertainty =       0.035690370711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431276579
  error estimate for blocks of size 2^( 2) =       0.000444000023
  error estimate for blocks of size 2^( 3) =       0.000456726671
  error estimate for blocks of size 2^( 4) =       0.000469270698
  error estimate for blocks of size 2^( 5) =       0.000480016455
  error estimate for blocks of size 2^( 6) =       0.000486167055
  error estimate for blocks of size 2^( 7) =       0.000490563970

      target function =                  N/A
              le_mean =     -16.906526537124
             les_mean =     286.202638339780
             stat err =       0.000481504545
             autocorr =       1.246490672961
              std dev =       0.609917187249
             le_variance =       0.371998975302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050544950
                                         uncertainty =       0.035690396269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050544950
                                         uncertainty =       0.035690396269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431276488
  error estimate for blocks of size 2^( 2) =       0.000443999939
  error estimate for blocks of size 2^( 3) =       0.000456726592
  error estimate for blocks of size 2^( 4) =       0.000469270626
  error estimate for blocks of size 2^( 5) =       0.000480016387
  error estimate for blocks of size 2^( 6) =       0.000486166988
  error estimate for blocks of size 2^( 7) =       0.000490563908

      target function =                  N/A
              le_mean =     -16.906526536389
             les_mean =     286.202638157468
             stat err =       0.000481504477
             autocorr =       1.246490852388
              std dev =       0.609917058154
             le_variance =       0.371998817827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050407046
                                         uncertainty =       0.035690418682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.372050407046
                                         uncertainty =       0.035690418682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431276408
  error estimate for blocks of size 2^( 2) =       0.000443999865
  error estimate for blocks of size 2^( 3) =       0.000456726522
  error estimate for blocks of size 2^( 4) =       0.000469270562
  error estimate for blocks of size 2^( 5) =       0.000480016328
  error estimate for blocks of size 2^( 6) =       0.000486166930
  error estimate for blocks of size 2^( 7) =       0.000490563854

      target function =                  N/A
              le_mean =     -16.906526535747
             les_mean =     286.202637997737
             stat err =       0.000481504418
             autocorr =       1.246491009636
              std dev =       0.609916945030
             le_variance =       0.371998679835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906526535655        initial
     3.9062e+02     3.9062e+03             5.8039e-07       -16.906526537124  <--
     1.5625e+03     1.5625e+04             1.4510e-07       -16.906526536389
     6.2500e+03     6.2500e+04             3.6276e-08       -16.906526535747

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9690e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112492e-02 1 1  ON 29
eH1_0                -2.526401e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528868e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944048e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.130009
====================================================
  Execution time = 2.0587e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4316e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258587880
                                         uncertainty =       0.005141318985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343258587880
                                         uncertainty =       0.005141318985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414223747
  error estimate for blocks of size 2^( 2) =       0.000426603780
  error estimate for blocks of size 2^( 3) =       0.000439575178
  error estimate for blocks of size 2^( 4) =       0.000451272497
  error estimate for blocks of size 2^( 5) =       0.000460507241
  error estimate for blocks of size 2^( 6) =       0.000470840945
  error estimate for blocks of size 2^( 7) =       0.000473692260

      target function =                  N/A
              le_mean =     -16.905686006792
             les_mean =     286.145381813357
             stat err =       0.000464078236
             autocorr =       1.255198516848
              std dev =       0.585800840470
             le_variance =       0.343162624696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568600679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686006792       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686019820       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686021984       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686020952       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686022962       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686024548       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686022221       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686021855       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.242202e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686006792       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686010056       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686010600       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686010345       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686010853       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686011244       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686010660       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686010569       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.620189e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686006792       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686007608       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686007745       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686007681       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686007809       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686007906       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686007760       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686007737       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.405967e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433356 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6148e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.112545e-01 1 1  ON 0
 uu_1                 1.438524e-01 1 1  ON 1
 uu_2                 4.180919e-02 1 1  ON 2
 uu_3                -2.116726e-02 1 1  ON 3
 uu_4                -6.721195e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301747e-01 1 1  ON 6
 uu_7                -1.439974e-01 1 1  ON 7
 uu_8                -1.368489e-01 1 1  ON 8
 uu_9                -1.068391e-01 1 1  ON 9
 ud_0                 4.504182e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378299e-02 1 1  ON 12
 ud_3                -7.801811e-03 1 1  ON 13
 ud_4                -6.532579e-02 1 1  ON 14
 ud_5                -1.074864e-01 1 1  ON 15
 ud_6                -1.355020e-01 1 1  ON 16
 ud_7                -1.522622e-01 1 1  ON 17
 ud_8                -1.533186e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587166e-01 1 1  ON 20
 eO_1                -4.368765e-01 1 1  ON 21
 eO_2                -2.095640e-02 1 1  ON 22
 eO_3                 2.976860e-01 1 1  ON 23
 eO_4                 5.257811e-01 1 1  ON 24
 eO_5                 4.893324e-01 1 1  ON 25
 eO_6                 2.622177e-01 1 1  ON 26
 eO_7                -4.035166e-02 1 1  ON 27
 eO_8                -2.247607e-01 1 1  ON 28
 eO_9                -9.112519e-02 1 1  ON 29
eH1_0                -2.526405e-01 1 1  ON 30
eH1_1                -1.489064e-01 1 1  ON 31
eH1_2                -1.002496e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.529103e-03 1 1  ON 34
eH1_5                 3.780041e-02 1 1  ON 35
eH1_6                 9.678969e-02 1 1  ON 36
eH1_7                 1.548724e-01 1 1  ON 37
eH1_8                 1.824107e-01 1 1  ON 38
eH1_9                 7.493836e-02 1 1  ON 39
eH2_0                -2.507589e-01 1 1  ON 40
eH2_1                -1.465315e-01 1 1  ON 41
eH2_2                -9.772035e-02 1 1  ON 42
eH2_3                -4.301342e-02 1 1  ON 43
eH2_4                 5.944055e-03 1 1  ON 44
eH2_5                 4.032376e-02 1 1  ON 45
eH2_6                 9.974147e-02 1 1  ON 46
eH2_7                 1.560914e-01 1 1  ON 47
eH2_8                 1.867150e-01 1 1  ON 48
eH2_9                 6.500835e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9495
    reference variance = 0.228438
====================================================
  Execution time = 2.0450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338359545476
                                         uncertainty =       0.003395739109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338359545476
                                         uncertainty =       0.003395739109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411273446
  error estimate for blocks of size 2^( 2) =       0.000423878701
  error estimate for blocks of size 2^( 3) =       0.000436771777
  error estimate for blocks of size 2^( 4) =       0.000448964788
  error estimate for blocks of size 2^( 5) =       0.000459908134
  error estimate for blocks of size 2^( 6) =       0.000467804361
  error estimate for blocks of size 2^( 7) =       0.000476099832

      target function =                  N/A
              le_mean =     -16.906647292438
             les_mean =     286.173014196090
             stat err =       0.000463194279
             autocorr =       1.268425702396
              std dev =       0.581628484791
             le_variance =       0.338291694321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338361451259
                                         uncertainty =       0.003395759082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338361451259
                                         uncertainty =       0.003395759082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411274604
  error estimate for blocks of size 2^( 2) =       0.000423879796
  error estimate for blocks of size 2^( 3) =       0.000436772783
  error estimate for blocks of size 2^( 4) =       0.000448965732
  error estimate for blocks of size 2^( 5) =       0.000459909055
  error estimate for blocks of size 2^( 6) =       0.000467805295
  error estimate for blocks of size 2^( 7) =       0.000476100835

      target function =                  N/A
              le_mean =     -16.906647289800
             les_mean =     286.173016012293
             stat err =       0.000463195229
             autocorr =       1.268423762527
              std dev =       0.581630122797
             le_variance =       0.338293599745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338360501656
                                         uncertainty =       0.003395749133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338360501656
                                         uncertainty =       0.003395749133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411274027
  error estimate for blocks of size 2^( 2) =       0.000423879250
  error estimate for blocks of size 2^( 3) =       0.000436772282
  error estimate for blocks of size 2^( 4) =       0.000448965262
  error estimate for blocks of size 2^( 5) =       0.000459908596
  error estimate for blocks of size 2^( 6) =       0.000467804830
  error estimate for blocks of size 2^( 7) =       0.000476100335

      target function =                  N/A
              le_mean =     -16.906647291107
             les_mean =     286.173015107086
             stat err =       0.000463194756
             autocorr =       1.268424729398
              std dev =       0.581629306621
             le_variance =       0.338292650321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338359665098
                                         uncertainty =       0.003395740363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338359665098
                                         uncertainty =       0.003395740363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411273518
  error estimate for blocks of size 2^( 2) =       0.000423878770
  error estimate for blocks of size 2^( 3) =       0.000436771840
  error estimate for blocks of size 2^( 4) =       0.000448964847
  error estimate for blocks of size 2^( 5) =       0.000459908192
  error estimate for blocks of size 2^( 6) =       0.000467804420
  error estimate for blocks of size 2^( 7) =       0.000476099895

      target function =                  N/A
              le_mean =     -16.906647292271
             les_mean =     286.173014310039
             stat err =       0.000463194339
             autocorr =       1.268425580679
              std dev =       0.581628587606
             le_variance =       0.338291813921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906647292438        initial  <--
     9.7656e+01     9.7656e+02             2.2422e-06       -16.906647289800
     3.9062e+02     3.9062e+03             5.6202e-07       -16.906647291107
     1.5625e+03     1.5625e+04             1.4060e-07       -16.906647292271

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0094
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112492e-02 1 1  ON 29
eH1_0                -2.526401e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528868e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944048e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6164e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.91
    reference variance = 0.229858
====================================================
  Execution time = 2.0768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4339e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343518982885
                                         uncertainty =       0.008817521726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343518982885
                                         uncertainty =       0.008817521726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414363032
  error estimate for blocks of size 2^( 2) =       0.000427042906
  error estimate for blocks of size 2^( 3) =       0.000440570425
  error estimate for blocks of size 2^( 4) =       0.000453631772
  error estimate for blocks of size 2^( 5) =       0.000465714547
  error estimate for blocks of size 2^( 6) =       0.000474892502
  error estimate for blocks of size 2^( 7) =       0.000481337968

      target function =                  N/A
              le_mean =     -16.906171231563
             les_mean =     286.162018984266
             stat err =       0.000468894197
             autocorr =       1.280523966103
              std dev =       0.585997819999
             le_variance =       0.343393445043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617123156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171231563       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171231847       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171232167       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171232427       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171232871       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171233265       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171233173       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171233158       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.599022e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171231563       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171231634       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171231714       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171231777       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171231889       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171231987       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171231965       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171231963       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 6.497860e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171231563       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171231581       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171231600       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171231617       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171231650       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171231653       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171231660       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171231661       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.624484e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6323e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180920e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721214e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801644e-03 1 1  ON 13
 ud_4                -6.532608e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095646e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528760e-02 1 1  ON 33
eH1_4                 3.528886e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493810e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301307e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.140707
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4257e-01
  Total weights = 2.0000e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631192929
                                         uncertainty =       0.004392635636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631192929
                                         uncertainty =       0.004392635636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413865728
  error estimate for blocks of size 2^( 2) =       0.000426256751
  error estimate for blocks of size 2^( 3) =       0.000439584321
  error estimate for blocks of size 2^( 4) =       0.000451246915
  error estimate for blocks of size 2^( 5) =       0.000461226363
  error estimate for blocks of size 2^( 6) =       0.000467906260
  error estimate for blocks of size 2^( 7) =       0.000473271092

      target function =                  N/A
              le_mean =     -16.906691960477
             les_mean =     286.178802556497
             stat err =       0.000463412657
             autocorr =       1.253767059747
              std dev =       0.585294525281
             le_variance =       0.342569681324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631051096
                                         uncertainty =       0.004392633109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631051096
                                         uncertainty =       0.004392633109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413865642
  error estimate for blocks of size 2^( 2) =       0.000426256668
  error estimate for blocks of size 2^( 3) =       0.000439584242
  error estimate for blocks of size 2^( 4) =       0.000451246836
  error estimate for blocks of size 2^( 5) =       0.000461226290
  error estimate for blocks of size 2^( 6) =       0.000467906193
  error estimate for blocks of size 2^( 7) =       0.000473271024

      target function =                  N/A
              le_mean =     -16.906691959740
             les_mean =     286.178802389740
             stat err =       0.000463412586
             autocorr =       1.253767191648
              std dev =       0.585294404101
             le_variance =       0.342569539471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631121991
                                         uncertainty =       0.004392634372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631121991
                                         uncertainty =       0.004392634372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413865685
  error estimate for blocks of size 2^( 2) =       0.000426256709
  error estimate for blocks of size 2^( 3) =       0.000439584282
  error estimate for blocks of size 2^( 4) =       0.000451246875
  error estimate for blocks of size 2^( 5) =       0.000461226326
  error estimate for blocks of size 2^( 6) =       0.000467906226
  error estimate for blocks of size 2^( 7) =       0.000473271058

      target function =                  N/A
              le_mean =     -16.906691960109
             les_mean =     286.178802473094
             stat err =       0.000463412622
             autocorr =       1.253767125721
              std dev =       0.585294464673
             le_variance =       0.342569610377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631184061
                                         uncertainty =       0.004392635478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342631184061
                                         uncertainty =       0.004392635478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413865722
  error estimate for blocks of size 2^( 2) =       0.000426256746
  error estimate for blocks of size 2^( 3) =       0.000439584316
  error estimate for blocks of size 2^( 4) =       0.000451246910
  error estimate for blocks of size 2^( 5) =       0.000461226358
  error estimate for blocks of size 2^( 6) =       0.000467906256
  error estimate for blocks of size 2^( 7) =       0.000473271088

      target function =                  N/A
              le_mean =     -16.906691960431
             les_mean =     286.178802546071
             stat err =       0.000463412653
             autocorr =       1.253767068004
              std dev =       0.585294517705
             le_variance =       0.342569672455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906691960477        initial  <--
     9.7656e+02     9.7656e+03             2.5990e-07       -16.906691959740
     3.9062e+03     3.9062e+04             6.4979e-08       -16.906691960109
     1.5625e+04     1.5625e+05             1.6245e-08       -16.906691960431

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8735
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112492e-02 1 1  ON 29
eH1_0                -2.526401e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528868e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944048e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8264
    reference variance = 0.264728
====================================================
  Execution time = 2.0762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3928e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339373134761
                                         uncertainty =       0.003908713658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339373134761
                                         uncertainty =       0.003908713658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411874460
  error estimate for blocks of size 2^( 2) =       0.000424827783
  error estimate for blocks of size 2^( 3) =       0.000436802646
  error estimate for blocks of size 2^( 4) =       0.000448520104
  error estimate for blocks of size 2^( 5) =       0.000459578930
  error estimate for blocks of size 2^( 6) =       0.000466184230
  error estimate for blocks of size 2^( 7) =       0.000470572880

      target function =                  N/A
              le_mean =     -16.906005865213
             les_mean =     286.152315286361
             stat err =       0.000461214036
             autocorr =       1.253935814248
              std dev =       0.582478447143
             le_variance =       0.339281141386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600586521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005865213       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005865233       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005865248       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005865278       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005865299       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906005865300       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005865281       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005865296       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.733227e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005865213       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005865218       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005865222       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005865229       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005865258       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906005865234       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005865235       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005865252       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.833086e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005865213       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005865214       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005865215       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005865217       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005865157       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906005865269       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005865224       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005865220       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.708273e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6306e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721217e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801642e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112493e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528868e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678961e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944047e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500780e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.154351
====================================================
  Execution time = 2.0254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4263e-01
  Total weights = 2.0000e+06
  Execution time = 1.9084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698386161
                                         uncertainty =       0.007405161390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698386161
                                         uncertainty =       0.007405161390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904636
  error estimate for blocks of size 2^( 2) =       0.000426660418
  error estimate for blocks of size 2^( 3) =       0.000440277198
  error estimate for blocks of size 2^( 4) =       0.000452769709
  error estimate for blocks of size 2^( 5) =       0.000463631777
  error estimate for blocks of size 2^( 6) =       0.000469618405
  error estimate for blocks of size 2^( 7) =       0.000478279513

      target function =                  N/A
              le_mean =     -16.905508784646
             les_mean =     286.138861191499
             stat err =       0.000466074851
             autocorr =       1.267975195325
              std dev =       0.585349549483
             le_variance =       0.342634095080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698390554
                                         uncertainty =       0.007405161522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698390554
                                         uncertainty =       0.007405161522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904638
  error estimate for blocks of size 2^( 2) =       0.000426660420
  error estimate for blocks of size 2^( 3) =       0.000440277200
  error estimate for blocks of size 2^( 4) =       0.000452769712
  error estimate for blocks of size 2^( 5) =       0.000463631779
  error estimate for blocks of size 2^( 6) =       0.000469618407
  error estimate for blocks of size 2^( 7) =       0.000478279515

      target function =                  N/A
              le_mean =     -16.905508784583
             les_mean =     286.138861193752
             stat err =       0.000466074853
             autocorr =       1.267975189869
              std dev =       0.585349553232
             le_variance =       0.342634099469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698388357
                                         uncertainty =       0.007405161456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698388357
                                         uncertainty =       0.007405161456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904637
  error estimate for blocks of size 2^( 2) =       0.000426660419
  error estimate for blocks of size 2^( 3) =       0.000440277199
  error estimate for blocks of size 2^( 4) =       0.000452769710
  error estimate for blocks of size 2^( 5) =       0.000463631778
  error estimate for blocks of size 2^( 6) =       0.000469618406
  error estimate for blocks of size 2^( 7) =       0.000478279514

      target function =                  N/A
              le_mean =     -16.905508784614
             les_mean =     286.138861192625
             stat err =       0.000466074852
             autocorr =       1.267975192591
              std dev =       0.585349551358
             le_variance =       0.342634097275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698386435
                                         uncertainty =       0.007405161398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342698386435
                                         uncertainty =       0.007405161398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413904636
  error estimate for blocks of size 2^( 2) =       0.000426660418
  error estimate for blocks of size 2^( 3) =       0.000440277198
  error estimate for blocks of size 2^( 4) =       0.000452769709
  error estimate for blocks of size 2^( 5) =       0.000463631777
  error estimate for blocks of size 2^( 6) =       0.000469618405
  error estimate for blocks of size 2^( 7) =       0.000478279513

      target function =                  N/A
              le_mean =     -16.905508784642
             les_mean =     286.138861191639
             stat err =       0.000466074851
             autocorr =       1.267975194980
              std dev =       0.585349549717
             le_variance =       0.342634095354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905508784646        initial  <--
     9.7656e+03     9.7656e+04             2.7332e-08       -16.905508784583
     3.9062e+04     3.9062e+05             6.8331e-09       -16.905508784614
     1.5625e+05     1.5625e+06             1.7083e-09       -16.905508784642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8839
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112492e-02 1 1  ON 29
eH1_0                -2.526401e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528868e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944048e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.891
    reference variance = 0.228381
====================================================
  Execution time = 2.0818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4064e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340734551584
                                         uncertainty =       0.004118931190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340734551584
                                         uncertainty =       0.004118931190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412699316
  error estimate for blocks of size 2^( 2) =       0.000424744974
  error estimate for blocks of size 2^( 3) =       0.000437387669
  error estimate for blocks of size 2^( 4) =       0.000448846064
  error estimate for blocks of size 2^( 5) =       0.000459656203
  error estimate for blocks of size 2^( 6) =       0.000466742367
  error estimate for blocks of size 2^( 7) =       0.000471723859

      target function =                  N/A
              le_mean =     -16.906521267603
             les_mean =     286.171102652339
             stat err =       0.000461742123
             autocorr =       1.251790043718
              std dev =       0.583644969770
             le_variance =       0.340641450738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652126760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906521267603       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906521267607       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906521267609       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906521267632       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906521267609       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906521267759       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906521267696       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906521267604       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.539662e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906521267603       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906521267604       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906521267605       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906521267605       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906521267605       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906521267610       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906521267449       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906521267595       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 6.349160e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906521267603       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906521267604       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906521267604       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906521267638       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906521267604       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906521267847       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906521267604       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906521266660       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.587290e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.441201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6363e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112492e-02 1 1  ON 29
eH1_0                -2.526401e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528868e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944048e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.177422
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3760e-01
  Total weights = 2.0000e+06
  Execution time = 1.9052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569552508
                                         uncertainty =       0.002781844414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569552508
                                         uncertainty =       0.002781844414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410851702
  error estimate for blocks of size 2^( 2) =       0.000423378633
  error estimate for blocks of size 2^( 3) =       0.000436104885
  error estimate for blocks of size 2^( 4) =       0.000447629749
  error estimate for blocks of size 2^( 5) =       0.000459420802
  error estimate for blocks of size 2^( 6) =       0.000468060686
  error estimate for blocks of size 2^( 7) =       0.000473389045

      target function =                  N/A
              le_mean =     -16.906252178456
             les_mean =     286.158960794928
             stat err =       0.000462125070
             autocorr =       1.265169979522
              std dev =       0.581032049195
             le_variance =       0.337598242192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569551917
                                         uncertainty =       0.002781844412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569551917
                                         uncertainty =       0.002781844412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410851702
  error estimate for blocks of size 2^( 2) =       0.000423378633
  error estimate for blocks of size 2^( 3) =       0.000436104885
  error estimate for blocks of size 2^( 4) =       0.000447629748
  error estimate for blocks of size 2^( 5) =       0.000459420801
  error estimate for blocks of size 2^( 6) =       0.000468060685
  error estimate for blocks of size 2^( 7) =       0.000473389045

      target function =                  N/A
              le_mean =     -16.906252178463
             les_mean =     286.158960794579
             stat err =       0.000462125070
             autocorr =       1.265169979847
              std dev =       0.581032048687
             le_variance =       0.337598241601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569552212
                                         uncertainty =       0.002781844413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569552212
                                         uncertainty =       0.002781844413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410851702
  error estimate for blocks of size 2^( 2) =       0.000423378633
  error estimate for blocks of size 2^( 3) =       0.000436104885
  error estimate for blocks of size 2^( 4) =       0.000447629748
  error estimate for blocks of size 2^( 5) =       0.000459420801
  error estimate for blocks of size 2^( 6) =       0.000468060685
  error estimate for blocks of size 2^( 7) =       0.000473389045

      target function =                  N/A
              le_mean =     -16.906252178459
             les_mean =     286.158960794753
             stat err =       0.000462125070
             autocorr =       1.265169979698
              std dev =       0.581032048941
             le_variance =       0.337598241896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569552471
                                         uncertainty =       0.002781844414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337569552471
                                         uncertainty =       0.002781844414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410851702
  error estimate for blocks of size 2^( 2) =       0.000423378633
  error estimate for blocks of size 2^( 3) =       0.000436104885
  error estimate for blocks of size 2^( 4) =       0.000447629749
  error estimate for blocks of size 2^( 5) =       0.000459420802
  error estimate for blocks of size 2^( 6) =       0.000468060686
  error estimate for blocks of size 2^( 7) =       0.000473389045

      target function =                  N/A
              le_mean =     -16.906252178456
             les_mean =     286.158960794906
             stat err =       0.000462125070
             autocorr =       1.265169979539
              std dev =       0.581032049163
             le_variance =       0.337598242155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906252178456        initial
     9.7656e+04     9.7656e+05             2.5397e-09       -16.906252178463  <--
     3.9062e+05     3.9062e+06             6.3492e-10       -16.906252178459
     1.5625e+06     1.5625e+07             1.5873e-10       -16.906252178456

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 2.9899e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112492e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528869e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944048e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.353392
====================================================
  Execution time = 2.1008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337988432482
                                         uncertainty =       0.002920626360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337988432482
                                         uncertainty =       0.002920626360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411029427
  error estimate for blocks of size 2^( 2) =       0.000423565243
  error estimate for blocks of size 2^( 3) =       0.000436537000
  error estimate for blocks of size 2^( 4) =       0.000449000801
  error estimate for blocks of size 2^( 5) =       0.000458293740
  error estimate for blocks of size 2^( 6) =       0.000464272764
  error estimate for blocks of size 2^( 7) =       0.000467276922

      target function =                  N/A
              le_mean =     -16.906211924850
             les_mean =     286.157891859405
             stat err =       0.000459711057
             autocorr =       1.250904246330
              std dev =       0.581283390787
             le_variance =       0.337890380405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621192485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906211924850       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906211924867       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906211924845       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906211924843       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906211924883       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906211924880       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906211924874       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906211924862       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.037604e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906211924850       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906211924854       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906211924849       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906211924848       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906211924886       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906211924845       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906211924812       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906211924813       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.594026e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906211924850       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906211924851       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906211924850       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906211924850       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906211924817       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906211924719       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906211924874       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906211924679       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 6.485072e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.443796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6532e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438519e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112493e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528869e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678961e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493805e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944049e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500780e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.340469
====================================================
  Execution time = 2.2430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5659e-01
  Total weights = 2.0000e+06
  Execution time = 1.9117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555428170
                                         uncertainty =       0.022192892148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555428170
                                         uncertainty =       0.022192892148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422249660
  error estimate for blocks of size 2^( 2) =       0.000434509566
  error estimate for blocks of size 2^( 3) =       0.000446816716
  error estimate for blocks of size 2^( 4) =       0.000458431945
  error estimate for blocks of size 2^( 5) =       0.000467632678
  error estimate for blocks of size 2^( 6) =       0.000475368008
  error estimate for blocks of size 2^( 7) =       0.000481960100

      target function =                  N/A
              le_mean =     -16.906016559088
             les_mean =     286.169985268101
             stat err =       0.000470848183
             autocorr =       1.243435267253
              std dev =       0.597151195450
             le_variance =       0.356589550228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555437656
                                         uncertainty =       0.022192892828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555437656
                                         uncertainty =       0.022192892828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422249665
  error estimate for blocks of size 2^( 2) =       0.000434509572
  error estimate for blocks of size 2^( 3) =       0.000446816721
  error estimate for blocks of size 2^( 4) =       0.000458431950
  error estimate for blocks of size 2^( 5) =       0.000467632683
  error estimate for blocks of size 2^( 6) =       0.000475368013
  error estimate for blocks of size 2^( 7) =       0.000481960105

      target function =                  N/A
              le_mean =     -16.906016559123
             les_mean =     286.169985278761
             stat err =       0.000470848187
             autocorr =       1.243435258336
              std dev =       0.597151203393
             le_variance =       0.356589559714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555432913
                                         uncertainty =       0.022192892488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555432913
                                         uncertainty =       0.022192892488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422249663
  error estimate for blocks of size 2^( 2) =       0.000434509569
  error estimate for blocks of size 2^( 3) =       0.000446816718
  error estimate for blocks of size 2^( 4) =       0.000458431947
  error estimate for blocks of size 2^( 5) =       0.000467632680
  error estimate for blocks of size 2^( 6) =       0.000475368010
  error estimate for blocks of size 2^( 7) =       0.000481960103

      target function =                  N/A
              le_mean =     -16.906016559106
             les_mean =     286.169985273431
             stat err =       0.000470848185
             autocorr =       1.243435262795
              std dev =       0.597151199422
             le_variance =       0.356589554971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555428763
                                         uncertainty =       0.022192892190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356555428763
                                         uncertainty =       0.022192892190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422249660
  error estimate for blocks of size 2^( 2) =       0.000434509567
  error estimate for blocks of size 2^( 3) =       0.000446816716
  error estimate for blocks of size 2^( 4) =       0.000458431945
  error estimate for blocks of size 2^( 5) =       0.000467632678
  error estimate for blocks of size 2^( 6) =       0.000475368008
  error estimate for blocks of size 2^( 7) =       0.000481960101

      target function =                  N/A
              le_mean =     -16.906016559090
             les_mean =     286.169985268767
             stat err =       0.000470848183
             autocorr =       1.243435266693
              std dev =       0.597151195947
             le_variance =       0.356589550821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906016559088        initial
     2.4414e+04     2.4414e+05             1.0376e-08       -16.906016559123  <--
     9.7656e+04     9.7656e+05             2.5940e-09       -16.906016559106
     3.9062e+05     3.9062e+06             6.4851e-10       -16.906016559090

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 3.2068e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801641e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112493e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528867e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678961e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493806e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944052e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974135e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500780e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9258
    reference variance = 0.320386
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4086e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913818938
                                         uncertainty =       0.003685502314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340913818938
                                         uncertainty =       0.003685502314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412834612
  error estimate for blocks of size 2^( 2) =       0.000425728946
  error estimate for blocks of size 2^( 3) =       0.000438890683
  error estimate for blocks of size 2^( 4) =       0.000451342311
  error estimate for blocks of size 2^( 5) =       0.000461684049
  error estimate for blocks of size 2^( 6) =       0.000470431934
  error estimate for blocks of size 2^( 7) =       0.000477579559

      target function =                  N/A
              le_mean =     -16.907257022084
             les_mean =     286.196204674585
             stat err =       0.000465259463
             autocorr =       1.270100911355
              std dev =       0.583836307708
             le_variance =       0.340864834198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690725702208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907257022084       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907257022120       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907257022190       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907257022169       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907257022187       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907257022219       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907257022210       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907257022219       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.906524e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907257022084       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907257022093       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907257022111       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907257022105       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907257022110       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907257022112       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907257022123       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907257022088       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.226634e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907257022084       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907257022087       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907257022091       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907257022090       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907257022078       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907257022094       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907257022032       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907257022096       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.066587e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.446419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6134e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024245e-01 1 1  ON 5
 uu_6                -1.301745e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378294e-02 1 1  ON 12
 ud_3                -7.801644e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095644e-02 1 1  ON 22
 eO_3                 2.976862e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035155e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112494e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528870e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493806e-02 1 1  ON 39
eH2_0                -2.507585e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771997e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944050e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500781e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.946
    reference variance = 1.3683
====================================================
  Execution time = 1.9821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4308e-01
  Total weights = 2.0000e+06
  Execution time = 1.8930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754389914
                                         uncertainty =       0.006659449058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754389914
                                         uncertainty =       0.006659449058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414172710
  error estimate for blocks of size 2^( 2) =       0.000427061468
  error estimate for blocks of size 2^( 3) =       0.000440718887
  error estimate for blocks of size 2^( 4) =       0.000453184569
  error estimate for blocks of size 2^( 5) =       0.000465167511
  error estimate for blocks of size 2^( 6) =       0.000474496470
  error estimate for blocks of size 2^( 7) =       0.000479796830

      target function =                  N/A
              le_mean =     -16.905864154487
             les_mean =     286.151320705910
             stat err =       0.000468161345
             autocorr =       1.277697793113
              std dev =       0.585728663703
             le_variance =       0.343078067483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754391477
                                         uncertainty =       0.006659449525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754391477
                                         uncertainty =       0.006659449525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414172711
  error estimate for blocks of size 2^( 2) =       0.000427061469
  error estimate for blocks of size 2^( 3) =       0.000440718888
  error estimate for blocks of size 2^( 4) =       0.000453184569
  error estimate for blocks of size 2^( 5) =       0.000465167511
  error estimate for blocks of size 2^( 6) =       0.000474496471
  error estimate for blocks of size 2^( 7) =       0.000479796831

      target function =                  N/A
              le_mean =     -16.905864154492
             les_mean =     286.151320707695
             stat err =       0.000468161346
             autocorr =       1.277697791770
              std dev =       0.585728665085
             le_variance =       0.343078069103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754390695
                                         uncertainty =       0.006659449291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754390695
                                         uncertainty =       0.006659449291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414172711
  error estimate for blocks of size 2^( 2) =       0.000427061468
  error estimate for blocks of size 2^( 3) =       0.000440718888
  error estimate for blocks of size 2^( 4) =       0.000453184569
  error estimate for blocks of size 2^( 5) =       0.000465167511
  error estimate for blocks of size 2^( 6) =       0.000474496471
  error estimate for blocks of size 2^( 7) =       0.000479796831

      target function =                  N/A
              le_mean =     -16.905864154489
             les_mean =     286.151320706802
             stat err =       0.000468161345
             autocorr =       1.277697792442
              std dev =       0.585728664394
             le_variance =       0.343078068293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754390012
                                         uncertainty =       0.006659449087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342754390012
                                         uncertainty =       0.006659449087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414172710
  error estimate for blocks of size 2^( 2) =       0.000427061468
  error estimate for blocks of size 2^( 3) =       0.000440718887
  error estimate for blocks of size 2^( 4) =       0.000453184569
  error estimate for blocks of size 2^( 5) =       0.000465167511
  error estimate for blocks of size 2^( 6) =       0.000474496470
  error estimate for blocks of size 2^( 7) =       0.000479796830

      target function =                  N/A
              le_mean =     -16.905864154487
             les_mean =     286.151320706021
             stat err =       0.000468161345
             autocorr =       1.277697793032
              std dev =       0.585728663789
             le_variance =       0.343078067584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905864154487        initial
     6.1035e+03     6.1035e+04             4.9065e-08       -16.905864154492  <--
     2.4414e+04     2.4414e+05             1.2266e-08       -16.905864154489
     9.7656e+04     9.7656e+05             3.0666e-09       -16.905864154487

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 2.9377e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801651e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493808e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5518e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8728
    reference variance = 0.491873
====================================================
  Execution time = 2.0629e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353655593454
                                         uncertainty =       0.018730023687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353655593454
                                         uncertainty =       0.018730023687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420581577
  error estimate for blocks of size 2^( 2) =       0.000433190566
  error estimate for blocks of size 2^( 3) =       0.000446062629
  error estimate for blocks of size 2^( 4) =       0.000456886251
  error estimate for blocks of size 2^( 5) =       0.000468267247
  error estimate for blocks of size 2^( 6) =       0.000475472480
  error estimate for blocks of size 2^( 7) =       0.000482816379

      target function =                  N/A
              le_mean =     -16.906508163234
             les_mean =     286.183795821789
             stat err =       0.000470860589
             autocorr =       1.253384137616
              std dev =       0.594792169729
             le_variance =       0.353777725171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650816323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906508163234       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906508163064       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906508163014       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906508163184       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906508163312       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906508163205       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906508163366       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906508163379       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.917989e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906508163234       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906508163192       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906508163179       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906508163224       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906508163257       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906508163227       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906508163275       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906508163272       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.795061e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906508163234       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906508163224       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906508163221       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906508163231       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906508163239       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906508163232       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906508163237       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906508163244       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.198771e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.449058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6215e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116737e-02 1 1  ON 3
 uu_4                -6.721214e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801656e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074862e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095640e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035153e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112498e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528757e-02 1 1  ON 33
eH1_4                 3.528870e-03 1 1  ON 34
eH1_5                 3.780029e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493811e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771999e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944035e-03 1 1  ON 44
eH2_5                 4.032356e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500789e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.316007
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3485e-01
  Total weights = 2.0000e+06
  Execution time = 1.9086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806555234
                                         uncertainty =       0.002886025005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806555234
                                         uncertainty =       0.002886025005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409176043
  error estimate for blocks of size 2^( 2) =       0.000421664980
  error estimate for blocks of size 2^( 3) =       0.000434466621
  error estimate for blocks of size 2^( 4) =       0.000447609345
  error estimate for blocks of size 2^( 5) =       0.000458680207
  error estimate for blocks of size 2^( 6) =       0.000467407556
  error estimate for blocks of size 2^( 7) =       0.000474464081

      target function =                  N/A
              le_mean =     -16.906500160162
             les_mean =     286.164597566828
             stat err =       0.000462040297
             autocorr =       1.275085515803
              std dev =       0.578662309720
             le_variance =       0.334850068691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806619163
                                         uncertainty =       0.002886025495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806619163
                                         uncertainty =       0.002886025495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409176082
  error estimate for blocks of size 2^( 2) =       0.000421665015
  error estimate for blocks of size 2^( 3) =       0.000434466654
  error estimate for blocks of size 2^( 4) =       0.000447609376
  error estimate for blocks of size 2^( 5) =       0.000458680236
  error estimate for blocks of size 2^( 6) =       0.000467407588
  error estimate for blocks of size 2^( 7) =       0.000474464114

      target function =                  N/A
              le_mean =     -16.906500159316
             les_mean =     286.164597602152
             stat err =       0.000462040328
             autocorr =       1.275085444767
              std dev =       0.578662364966
             le_variance =       0.334850132628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806587203
                                         uncertainty =       0.002886025250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806587203
                                         uncertainty =       0.002886025250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409176063
  error estimate for blocks of size 2^( 2) =       0.000421664998
  error estimate for blocks of size 2^( 3) =       0.000434466638
  error estimate for blocks of size 2^( 4) =       0.000447609360
  error estimate for blocks of size 2^( 5) =       0.000458680221
  error estimate for blocks of size 2^( 6) =       0.000467407572
  error estimate for blocks of size 2^( 7) =       0.000474464098

      target function =                  N/A
              le_mean =     -16.906500159739
             les_mean =     286.164597584491
             stat err =       0.000462040313
             autocorr =       1.275085480281
              std dev =       0.578662337347
             le_variance =       0.334850100664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806559230
                                         uncertainty =       0.002886025036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334806559230
                                         uncertainty =       0.002886025036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409176046
  error estimate for blocks of size 2^( 2) =       0.000421664982
  error estimate for blocks of size 2^( 3) =       0.000434466623
  error estimate for blocks of size 2^( 4) =       0.000447609347
  error estimate for blocks of size 2^( 5) =       0.000458680209
  error estimate for blocks of size 2^( 6) =       0.000467407558
  error estimate for blocks of size 2^( 7) =       0.000474464083

      target function =                  N/A
              le_mean =     -16.906500160109
             les_mean =     286.164597569036
             stat err =       0.000462040299
             autocorr =       1.275085511365
              std dev =       0.578662313174
             le_variance =       0.334850072688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906500160162        initial  <--
     1.5259e+03     1.5259e+04             1.9180e-07       -16.906500159316
     6.1035e+03     6.1035e+04             4.7951e-08       -16.906500159739
     2.4414e+04     2.4414e+05             1.1988e-08       -16.906500160109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2430
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801651e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493808e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8387
    reference variance = 0.909885
====================================================
  Execution time = 2.0562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337573015722
                                         uncertainty =       0.003749359773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337573015722
                                         uncertainty =       0.003749359773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410826387
  error estimate for blocks of size 2^( 2) =       0.000423805637
  error estimate for blocks of size 2^( 3) =       0.000436552557
  error estimate for blocks of size 2^( 4) =       0.000449112590
  error estimate for blocks of size 2^( 5) =       0.000459844803
  error estimate for blocks of size 2^( 6) =       0.000467889532
  error estimate for blocks of size 2^( 7) =       0.000473335345

      target function =                  N/A
              le_mean =     -16.905279807050
             les_mean =     286.126041825973
             stat err =       0.000462545568
             autocorr =       1.267629646098
              std dev =       0.580996247931
             le_variance =       0.337556640109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690527980705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905279807050       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905279807081       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905279807078       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905279807077       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905279807095       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905279807110       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905279807100       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905279807149       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.494195e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905279807050       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905279807058       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905279807057       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905279807065       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905279807008       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905279807090       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905279807063       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905279807097       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.735492e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905279807050       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905279807052       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905279807051       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905279807051       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905279807203       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905279807232       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905279807231       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905279807606       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.338728e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.451649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6140e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801653e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.156167
====================================================
  Execution time = 1.9955e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3547e-01
  Total weights = 2.0000e+06
  Execution time = 1.9445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378388315
                                         uncertainty =       0.002685831756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378388315
                                         uncertainty =       0.002685831756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409553863
  error estimate for blocks of size 2^( 2) =       0.000423185210
  error estimate for blocks of size 2^( 3) =       0.000437345706
  error estimate for blocks of size 2^( 4) =       0.000450794697
  error estimate for blocks of size 2^( 5) =       0.000464431566
  error estimate for blocks of size 2^( 6) =       0.000474697986
  error estimate for blocks of size 2^( 7) =       0.000480815731

      target function =                  N/A
              le_mean =     -16.904738937152
             les_mean =     286.105667098402
             stat err =       0.000467684995
             autocorr =       1.304021705962
              std dev =       0.579196627131
             le_variance =       0.335468732880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378397170
                                         uncertainty =       0.002685831843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378397170
                                         uncertainty =       0.002685831843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409553868
  error estimate for blocks of size 2^( 2) =       0.000423185215
  error estimate for blocks of size 2^( 3) =       0.000437345711
  error estimate for blocks of size 2^( 4) =       0.000450794702
  error estimate for blocks of size 2^( 5) =       0.000464431570
  error estimate for blocks of size 2^( 6) =       0.000474697991
  error estimate for blocks of size 2^( 7) =       0.000480815735

      target function =                  N/A
              le_mean =     -16.904738937131
             les_mean =     286.105667106549
             stat err =       0.000467684999
             autocorr =       1.304021695442
              std dev =       0.579196634777
             le_variance =       0.335468741737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378392742
                                         uncertainty =       0.002685831799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378392742
                                         uncertainty =       0.002685831799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409553865
  error estimate for blocks of size 2^( 2) =       0.000423185213
  error estimate for blocks of size 2^( 3) =       0.000437345708
  error estimate for blocks of size 2^( 4) =       0.000450794700
  error estimate for blocks of size 2^( 5) =       0.000464431568
  error estimate for blocks of size 2^( 6) =       0.000474697988
  error estimate for blocks of size 2^( 7) =       0.000480815733

      target function =                  N/A
              le_mean =     -16.904738937141
             les_mean =     286.105667102476
             stat err =       0.000467684997
             autocorr =       1.304021700706
              std dev =       0.579196630954
             le_variance =       0.335468737309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378388868
                                         uncertainty =       0.002685831761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378388868
                                         uncertainty =       0.002685831761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409553863
  error estimate for blocks of size 2^( 2) =       0.000423185210
  error estimate for blocks of size 2^( 3) =       0.000437345706
  error estimate for blocks of size 2^( 4) =       0.000450794698
  error estimate for blocks of size 2^( 5) =       0.000464431566
  error estimate for blocks of size 2^( 6) =       0.000474697987
  error estimate for blocks of size 2^( 7) =       0.000480815731

      target function =                  N/A
              le_mean =     -16.904738937150
             les_mean =     286.105667098911
             stat err =       0.000467684995
             autocorr =       1.304021705311
              std dev =       0.579196627609
             le_variance =       0.335468733434


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904738937152        initial  <--
     1.5259e+04     1.5259e+05             1.4942e-08       -16.904738937131
     6.1035e+04     6.1035e+05             3.7355e-09       -16.904738937141
     2.4414e+05     2.4414e+06             9.3387e-10       -16.904738937150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5452
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801651e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493808e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8603
    reference variance = 0.491405
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3612e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336191783270
                                         uncertainty =       0.003278872792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336191783270
                                         uncertainty =       0.003278872792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409950567
  error estimate for blocks of size 2^( 2) =       0.000423235956
  error estimate for blocks of size 2^( 3) =       0.000435756494
  error estimate for blocks of size 2^( 4) =       0.000447338429
  error estimate for blocks of size 2^( 5) =       0.000457145744
  error estimate for blocks of size 2^( 6) =       0.000464931176
  error estimate for blocks of size 2^( 7) =       0.000468126850

      target function =                  N/A
              le_mean =     -16.906223197017
             les_mean =     286.156501553684
             stat err =       0.000459385550
             autocorr =       1.255716723334
              std dev =       0.579757651419
             le_variance =       0.336118934378


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622319702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223197017       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223197014       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223197013       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223197016       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223197082       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223197049       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223197018       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223196893       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.511958e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223197017       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223197017       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223197016       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223197016       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223197189       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223197412       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223197469       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223197205       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.779894e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223197017       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223197017       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223197017       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223197857       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223197017       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223197627       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223196578       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223198678       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.449735e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.454291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5938e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116736e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801651e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493808e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8986
    reference variance = 0.188252
====================================================
  Execution time = 2.0092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4654e-01
  Total weights = 2.0000e+06
  Execution time = 1.8971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605272114
                                         uncertainty =       0.008877076941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605272114
                                         uncertainty =       0.008877076941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416256437
  error estimate for blocks of size 2^( 2) =       0.000429141174
  error estimate for blocks of size 2^( 3) =       0.000441598209
  error estimate for blocks of size 2^( 4) =       0.000454322180
  error estimate for blocks of size 2^( 5) =       0.000463953790
  error estimate for blocks of size 2^( 6) =       0.000470871139
  error estimate for blocks of size 2^( 7) =       0.000475105957

      target function =                  N/A
              le_mean =     -16.904969768757
             les_mean =     286.124541551437
             stat err =       0.000466063266
             autocorr =       1.253625521604
              std dev =       0.588675498135
             le_variance =       0.346538842104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605271666
                                         uncertainty =       0.008877076917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605271666
                                         uncertainty =       0.008877076917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416256436
  error estimate for blocks of size 2^( 2) =       0.000429141173
  error estimate for blocks of size 2^( 3) =       0.000441598208
  error estimate for blocks of size 2^( 4) =       0.000454322180
  error estimate for blocks of size 2^( 5) =       0.000463953790
  error estimate for blocks of size 2^( 6) =       0.000470871139
  error estimate for blocks of size 2^( 7) =       0.000475105956

      target function =                  N/A
              le_mean =     -16.904969768769
             les_mean =     286.124541551374
             stat err =       0.000466063266
             autocorr =       1.253625521778
              std dev =       0.588675497755
             le_variance =       0.346538841657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605271890
                                         uncertainty =       0.008877076929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605271890
                                         uncertainty =       0.008877076929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416256437
  error estimate for blocks of size 2^( 2) =       0.000429141174
  error estimate for blocks of size 2^( 3) =       0.000441598209
  error estimate for blocks of size 2^( 4) =       0.000454322180
  error estimate for blocks of size 2^( 5) =       0.000463953790
  error estimate for blocks of size 2^( 6) =       0.000470871139
  error estimate for blocks of size 2^( 7) =       0.000475105957

      target function =                  N/A
              le_mean =     -16.904969768763
             les_mean =     286.124541551406
             stat err =       0.000466063266
             autocorr =       1.253625521688
              std dev =       0.588675497945
             le_variance =       0.346538841880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605272086
                                         uncertainty =       0.008877076939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346605272086
                                         uncertainty =       0.008877076939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416256437
  error estimate for blocks of size 2^( 2) =       0.000429141174
  error estimate for blocks of size 2^( 3) =       0.000441598209
  error estimate for blocks of size 2^( 4) =       0.000454322180
  error estimate for blocks of size 2^( 5) =       0.000463953790
  error estimate for blocks of size 2^( 6) =       0.000470871139
  error estimate for blocks of size 2^( 7) =       0.000475105957

      target function =                  N/A
              le_mean =     -16.904969768758
             les_mean =     286.124541551433
             stat err =       0.000466063266
             autocorr =       1.253625521604
              std dev =       0.588675498111
             le_variance =       0.346538842076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904969768757        initial
     1.5259e+05     1.5259e+06             1.5120e-09       -16.904969768769  <--
     6.1035e+05     6.1035e+06             3.7799e-10       -16.904969768763
     2.4414e+06     2.4414e+07             9.4497e-11       -16.904969768758

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 2.9647e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801651e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493808e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5591e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.150164
====================================================
  Execution time = 2.0385e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729818417
                                         uncertainty =       0.004525946567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346729818417
                                         uncertainty =       0.004525946567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416298793
  error estimate for blocks of size 2^( 2) =       0.000428765821
  error estimate for blocks of size 2^( 3) =       0.000442050792
  error estimate for blocks of size 2^( 4) =       0.000454700161
  error estimate for blocks of size 2^( 5) =       0.000463706505
  error estimate for blocks of size 2^( 6) =       0.000470322760
  error estimate for blocks of size 2^( 7) =       0.000475361517

      target function =                  N/A
              le_mean =     -16.905420897626
             les_mean =     286.139864922560
             stat err =       0.000466022736
             autocorr =       1.253152447959
              std dev =       0.588735398939
             le_variance =       0.346609369964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690542089763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905420897626       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905420897640       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905420897622       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905420897626       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905420897636       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905420897643       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905420897640       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905420897614       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.350978e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905420897626       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905420897630       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905420897625       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905420897626       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905420897660       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905420897618       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905420897785       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905420897612       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.837746e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905420897626       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905420897627       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905420897626       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905420898142       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905420897557       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905420897558       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905420897561       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905420897650       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.594364e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.456889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5975e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801651e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560911e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8322
    reference variance = 0.313521
====================================================
  Execution time = 2.0495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4578e-01
  Total weights = 2.0000e+06
  Execution time = 2.3131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818819177
                                         uncertainty =       0.005142516353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818819177
                                         uncertainty =       0.005142516353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415798418
  error estimate for blocks of size 2^( 2) =       0.000428345800
  error estimate for blocks of size 2^( 3) =       0.000441201699
  error estimate for blocks of size 2^( 4) =       0.000452564650
  error estimate for blocks of size 2^( 5) =       0.000461548533
  error estimate for blocks of size 2^( 6) =       0.000468245965
  error estimate for blocks of size 2^( 7) =       0.000472299654

      target function =                  N/A
              le_mean =     -16.906652602414
             les_mean =     286.180678693848
             stat err =       0.000463664701
             autocorr =       1.243490304198
              std dev =       0.588027761271
             le_variance =       0.345776648026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818817889
                                         uncertainty =       0.005142516349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818817889
                                         uncertainty =       0.005142516349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415798417
  error estimate for blocks of size 2^( 2) =       0.000428345799
  error estimate for blocks of size 2^( 3) =       0.000441201699
  error estimate for blocks of size 2^( 4) =       0.000452564650
  error estimate for blocks of size 2^( 5) =       0.000461548533
  error estimate for blocks of size 2^( 6) =       0.000468245964
  error estimate for blocks of size 2^( 7) =       0.000472299653

      target function =                  N/A
              le_mean =     -16.906652602419
             les_mean =     286.180678692723
             stat err =       0.000463664700
             autocorr =       1.243490304874
              std dev =       0.588027760175
             le_variance =       0.345776646736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818818533
                                         uncertainty =       0.005142516351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818818533
                                         uncertainty =       0.005142516351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415798417
  error estimate for blocks of size 2^( 2) =       0.000428345800
  error estimate for blocks of size 2^( 3) =       0.000441201699
  error estimate for blocks of size 2^( 4) =       0.000452564650
  error estimate for blocks of size 2^( 5) =       0.000461548533
  error estimate for blocks of size 2^( 6) =       0.000468245964
  error estimate for blocks of size 2^( 7) =       0.000472299654

      target function =                  N/A
              le_mean =     -16.906652602416
             les_mean =     286.180678693286
             stat err =       0.000463664700
             autocorr =       1.243490304538
              std dev =       0.588027760723
             le_variance =       0.345776647381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818819097
                                         uncertainty =       0.005142516353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345818819097
                                         uncertainty =       0.005142516353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415798417
  error estimate for blocks of size 2^( 2) =       0.000428345800
  error estimate for blocks of size 2^( 3) =       0.000441201699
  error estimate for blocks of size 2^( 4) =       0.000452564650
  error estimate for blocks of size 2^( 5) =       0.000461548533
  error estimate for blocks of size 2^( 6) =       0.000468245965
  error estimate for blocks of size 2^( 7) =       0.000472299654

      target function =                  N/A
              le_mean =     -16.906652602414
             les_mean =     286.180678693778
             stat err =       0.000463664701
             autocorr =       1.243490304239
              std dev =       0.588027761203
             le_variance =       0.345776647945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906652602414        initial
     3.8147e+04     3.8147e+05             7.3510e-09       -16.906652602419  <--
     1.5259e+05     1.5259e+06             1.8377e-09       -16.906652602416
     6.1035e+05     6.1035e+06             4.5944e-10       -16.906652602414

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 3.0743e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801652e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528879e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.916187
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337048632023
                                         uncertainty =       0.003468033136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337048632023
                                         uncertainty =       0.003468033136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410533376
  error estimate for blocks of size 2^( 2) =       0.000423103131
  error estimate for blocks of size 2^( 3) =       0.000436254624
  error estimate for blocks of size 2^( 4) =       0.000448603921
  error estimate for blocks of size 2^( 5) =       0.000459266957
  error estimate for blocks of size 2^( 6) =       0.000467217767
  error estimate for blocks of size 2^( 7) =       0.000471687287

      target function =                  N/A
              le_mean =     -16.905906773439
             les_mean =     286.146758970090
             stat err =       0.000461693983
             autocorr =       1.264769799038
              std dev =       0.580581868820
             le_variance =       0.337075306402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590677344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906773439       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906773440       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906773441       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906773424       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906773396       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906773413       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906773409       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905906773419       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.309574e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906773439       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906773440       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906773440       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906773436       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906773422       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906773390       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906773433       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905906773403       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.773990e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906773439       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906773439       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906773440       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906773439       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906773422       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906773393       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906773616       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905906773518       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.443500e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.459500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6086e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801654e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528878e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.316414
====================================================
  Execution time = 2.0240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3787e-01
  Total weights = 2.0000e+06
  Execution time = 1.8967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941275944
                                         uncertainty =       0.004879234510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941275944
                                         uncertainty =       0.004879234510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014927
  error estimate for blocks of size 2^( 2) =       0.000423946952
  error estimate for blocks of size 2^( 3) =       0.000436720352
  error estimate for blocks of size 2^( 4) =       0.000448882008
  error estimate for blocks of size 2^( 5) =       0.000459788331
  error estimate for blocks of size 2^( 6) =       0.000465155242
  error estimate for blocks of size 2^( 7) =       0.000471722872

      target function =                  N/A
              le_mean =     -16.906753044579
             les_mean =     286.176164882546
             stat err =       0.000461387113
             autocorr =       1.260131102126
              std dev =       0.581262884659
             le_variance =       0.337866541082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941286259
                                         uncertainty =       0.004879234636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941286259
                                         uncertainty =       0.004879234636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014934
  error estimate for blocks of size 2^( 2) =       0.000423946958
  error estimate for blocks of size 2^( 3) =       0.000436720358
  error estimate for blocks of size 2^( 4) =       0.000448882013
  error estimate for blocks of size 2^( 5) =       0.000459788337
  error estimate for blocks of size 2^( 6) =       0.000465155247
  error estimate for blocks of size 2^( 7) =       0.000471722877

      target function =                  N/A
              le_mean =     -16.906753044423
             les_mean =     286.176164887549
             stat err =       0.000461387118
             autocorr =       1.260131091089
              std dev =       0.581262893526
             le_variance =       0.337866551391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941281101
                                         uncertainty =       0.004879234573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941281101
                                         uncertainty =       0.004879234573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014931
  error estimate for blocks of size 2^( 2) =       0.000423946955
  error estimate for blocks of size 2^( 3) =       0.000436720355
  error estimate for blocks of size 2^( 4) =       0.000448882011
  error estimate for blocks of size 2^( 5) =       0.000459788334
  error estimate for blocks of size 2^( 6) =       0.000465155244
  error estimate for blocks of size 2^( 7) =       0.000471722875

      target function =                  N/A
              le_mean =     -16.906753044501
             les_mean =     286.176164885048
             stat err =       0.000461387116
             autocorr =       1.260131096609
              std dev =       0.581262889093
             le_variance =       0.337866546236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941276588
                                         uncertainty =       0.004879234517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941276588
                                         uncertainty =       0.004879234517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411014928
  error estimate for blocks of size 2^( 2) =       0.000423946952
  error estimate for blocks of size 2^( 3) =       0.000436720353
  error estimate for blocks of size 2^( 4) =       0.000448882008
  error estimate for blocks of size 2^( 5) =       0.000459788332
  error estimate for blocks of size 2^( 6) =       0.000465155242
  error estimate for blocks of size 2^( 7) =       0.000471722873

      target function =                  N/A
              le_mean =     -16.906753044570
             les_mean =     286.176164882859
             stat err =       0.000461387114
             autocorr =       1.260131101436
              std dev =       0.581262885213
             le_variance =       0.337866541726


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906753044579        initial  <--
     9.5367e+03     9.5367e+04             2.3096e-08       -16.906753044423
     3.8147e+04     3.8147e+05             5.7740e-09       -16.906753044501
     1.5259e+05     1.5259e+06             1.4435e-09       -16.906753044570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7834
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801652e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112495e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528879e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9555
    reference variance = 0.210578
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352045684875
                                         uncertainty =       0.008308206665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352045684875
                                         uncertainty =       0.008308206665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419566812
  error estimate for blocks of size 2^( 2) =       0.000431473177
  error estimate for blocks of size 2^( 3) =       0.000444096536
  error estimate for blocks of size 2^( 4) =       0.000455661287
  error estimate for blocks of size 2^( 5) =       0.000465946180
  error estimate for blocks of size 2^( 6) =       0.000475318157
  error estimate for blocks of size 2^( 7) =       0.000479280625

      target function =                  N/A
              le_mean =     -16.907064360121
             les_mean =     286.200897721051
             stat err =       0.000469051562
             autocorr =       1.249795387202
              std dev =       0.593357076140
             le_variance =       0.352072619806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690706436012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907064360121       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907064360120       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907064360126       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907064360129       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907064360098       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907064360103       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907064360141       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.806825e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907064360121       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907064360121       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907064360122       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907064360123       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907064360022       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907064360108       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907064360518       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.017065e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907064360121       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907064360121       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907064360122       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907064360121       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907064359921       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907064360422       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907064359984       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.754263e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5980e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801652e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528878e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.532369
====================================================
  Execution time = 2.0162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901915512
                                         uncertainty =       0.006145010824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901915512
                                         uncertainty =       0.006145010824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411006951
  error estimate for blocks of size 2^( 2) =       0.000423901117
  error estimate for blocks of size 2^( 3) =       0.000437051075
  error estimate for blocks of size 2^( 4) =       0.000449632876
  error estimate for blocks of size 2^( 5) =       0.000461640885
  error estimate for blocks of size 2^( 6) =       0.000473112035
  error estimate for blocks of size 2^( 7) =       0.000482252307

      target function =                  N/A
              le_mean =     -16.905387392558
             les_mean =     286.129976151629
             stat err =       0.000466659526
             autocorr =       1.289145498795
              std dev =       0.581251604814
             le_variance =       0.337853428099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901917128
                                         uncertainty =       0.006145010819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901917128
                                         uncertainty =       0.006145010819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411006952
  error estimate for blocks of size 2^( 2) =       0.000423901118
  error estimate for blocks of size 2^( 3) =       0.000437051076
  error estimate for blocks of size 2^( 4) =       0.000449632877
  error estimate for blocks of size 2^( 5) =       0.000461640886
  error estimate for blocks of size 2^( 6) =       0.000473112036
  error estimate for blocks of size 2^( 7) =       0.000482252308

      target function =                  N/A
              le_mean =     -16.905387392562
             les_mean =     286.129976153368
             stat err =       0.000466659527
             autocorr =       1.289145497000
              std dev =       0.581251606204
             le_variance =       0.337853429715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901916320
                                         uncertainty =       0.006145010821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901916320
                                         uncertainty =       0.006145010821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411006952
  error estimate for blocks of size 2^( 2) =       0.000423901118
  error estimate for blocks of size 2^( 3) =       0.000437051076
  error estimate for blocks of size 2^( 4) =       0.000449632876
  error estimate for blocks of size 2^( 5) =       0.000461640886
  error estimate for blocks of size 2^( 6) =       0.000473112036
  error estimate for blocks of size 2^( 7) =       0.000482252307

      target function =                  N/A
              le_mean =     -16.905387392560
             les_mean =     286.129976152498
             stat err =       0.000466659526
             autocorr =       1.289145497894
              std dev =       0.581251605509
             le_variance =       0.337853428907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901915613
                                         uncertainty =       0.006145010824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337901915613
                                         uncertainty =       0.006145010824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411006951
  error estimate for blocks of size 2^( 2) =       0.000423901117
  error estimate for blocks of size 2^( 3) =       0.000437051075
  error estimate for blocks of size 2^( 4) =       0.000449632876
  error estimate for blocks of size 2^( 5) =       0.000461640885
  error estimate for blocks of size 2^( 6) =       0.000473112036
  error estimate for blocks of size 2^( 7) =       0.000482252307

      target function =                  N/A
              le_mean =     -16.905387392558
             les_mean =     286.129976151737
             stat err =       0.000466659526
             autocorr =       1.289145498686
              std dev =       0.581251604901
             le_variance =       0.337853428199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905387392558        initial
     9.5367e+04     9.5367e+05             2.8068e-09       -16.905387392562  <--
     3.8147e+05     3.8147e+06             7.0171e-10       -16.905387392560
     1.5259e+06     1.5259e+07             1.7543e-10       -16.905387392558

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 2.9692e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801652e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528878e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944045e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9109
    reference variance = 0.479007
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347445267829
                                         uncertainty =       0.007079067043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347445267829
                                         uncertainty =       0.007079067043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416861335
  error estimate for blocks of size 2^( 2) =       0.000429670751
  error estimate for blocks of size 2^( 3) =       0.000443061809
  error estimate for blocks of size 2^( 4) =       0.000455660072
  error estimate for blocks of size 2^( 5) =       0.000466126182
  error estimate for blocks of size 2^( 6) =       0.000473993999
  error estimate for blocks of size 2^( 7) =       0.000479736804

      target function =                  N/A
              le_mean =     -16.906569218916
             les_mean =     286.179629325108
             stat err =       0.000468879264
             autocorr =       1.265140691572
              std dev =       0.589530953277
             le_variance =       0.347546744871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656921892e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906569218916       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906569218912       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906569218912       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906569218898       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906569218912       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906569218988       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906569218952       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906569218915       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.008377e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906569218916       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906569218915       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906569218915       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906569218937       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906569218905       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906569218886       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906569218893       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906569218874       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.252096e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906569218916       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906569218916       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906569218916       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906569218815       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906569219002       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906569218944       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906569218907       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906569218660       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.630241e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.464236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6108e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801653e-03 1 1  ON 13
 ud_4                -6.532609e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528877e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493809e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8551
    reference variance = 0.134913
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.0000e+06
  Execution time = 1.8988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797032108
                                         uncertainty =       0.002748046060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797032108
                                         uncertainty =       0.002748046060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410331765
  error estimate for blocks of size 2^( 2) =       0.000423430132
  error estimate for blocks of size 2^( 3) =       0.000436557631
  error estimate for blocks of size 2^( 4) =       0.000449595133
  error estimate for blocks of size 2^( 5) =       0.000458591498
  error estimate for blocks of size 2^( 6) =       0.000467040506
  error estimate for blocks of size 2^( 7) =       0.000471483865

      target function =                  N/A
              le_mean =     -16.906544892918
             les_mean =     286.168004361849
             stat err =       0.000461677751
             autocorr =       1.265923945867
              std dev =       0.580296746481
             le_variance =       0.336744313976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797037714
                                         uncertainty =       0.002748046084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797037714
                                         uncertainty =       0.002748046084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410331768
  error estimate for blocks of size 2^( 2) =       0.000423430136
  error estimate for blocks of size 2^( 3) =       0.000436557634
  error estimate for blocks of size 2^( 4) =       0.000449595136
  error estimate for blocks of size 2^( 5) =       0.000458591501
  error estimate for blocks of size 2^( 6) =       0.000467040508
  error estimate for blocks of size 2^( 7) =       0.000471483867

      target function =                  N/A
              le_mean =     -16.906544893015
             les_mean =     286.168004370743
             stat err =       0.000461677753
             autocorr =       1.265923939075
              std dev =       0.580296751312
             le_variance =       0.336744319583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797034911
                                         uncertainty =       0.002748046072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797034911
                                         uncertainty =       0.002748046072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410331766
  error estimate for blocks of size 2^( 2) =       0.000423430134
  error estimate for blocks of size 2^( 3) =       0.000436557633
  error estimate for blocks of size 2^( 4) =       0.000449595135
  error estimate for blocks of size 2^( 5) =       0.000458591500
  error estimate for blocks of size 2^( 6) =       0.000467040507
  error estimate for blocks of size 2^( 7) =       0.000471483866

      target function =                  N/A
              le_mean =     -16.906544892966
             les_mean =     286.168004366296
             stat err =       0.000461677752
             autocorr =       1.265923942470
              std dev =       0.580296748896
             le_variance =       0.336744316780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797032459
                                         uncertainty =       0.002748046061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336797032459
                                         uncertainty =       0.002748046061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410331765
  error estimate for blocks of size 2^( 2) =       0.000423430133
  error estimate for blocks of size 2^( 3) =       0.000436557631
  error estimate for blocks of size 2^( 4) =       0.000449595134
  error estimate for blocks of size 2^( 5) =       0.000458591498
  error estimate for blocks of size 2^( 6) =       0.000467040506
  error estimate for blocks of size 2^( 7) =       0.000471483865

      target function =                  N/A
              le_mean =     -16.906544892924
             les_mean =     286.168004362405
             stat err =       0.000461677751
             autocorr =       1.265923945449
              std dev =       0.580296746783
             le_variance =       0.336744314327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906544892918        initial
     2.3842e+04     2.3842e+05             9.0084e-09       -16.906544893015  <--
     9.5367e+04     9.5367e+05             2.2521e-09       -16.906544892966
     3.8147e+05     3.8147e+06             5.6302e-10       -16.906544892924

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 3.0051e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378293e-02 1 1  ON 12
 ud_3                -7.801653e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446517e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528874e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678963e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493810e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301311e-02 1 1  ON 43
eH2_4                 5.944039e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500787e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8485
    reference variance = 0.454193
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4029e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340357817916
                                         uncertainty =       0.004096731466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340357817916
                                         uncertainty =       0.004096731466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412489336
  error estimate for blocks of size 2^( 2) =       0.000425434679
  error estimate for blocks of size 2^( 3) =       0.000439172585
  error estimate for blocks of size 2^( 4) =       0.000451480429
  error estimate for blocks of size 2^( 5) =       0.000462567144
  error estimate for blocks of size 2^( 6) =       0.000472760920
  error estimate for blocks of size 2^( 7) =       0.000476562778

      target function =                  N/A
              le_mean =     -16.905898979575
             les_mean =     286.149715042122
             stat err =       0.000465842818
             autocorr =       1.275420394293
              std dev =       0.583348013357
             le_variance =       0.340294904687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589897957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898979575       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898979895       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898979841       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898979908       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898980009       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898980070       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898980030       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898980015       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.008087e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898979575       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898979655       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898979641       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898979658       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898979697       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898979691       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898979686       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898979702       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.252027e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898979575       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898979595       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898979591       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898979595       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898979679       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898979608       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898979621       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898979525       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 3.130072e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.466813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6505e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378292e-02 1 1  ON 12
 ud_3                -7.801657e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533182e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095643e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112496e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528871e-03 1 1  ON 34
eH1_5                 3.780028e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493811e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465310e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301311e-02 1 1  ON 43
eH2_4                 5.944040e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500788e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.0052
    reference variance = 0.540871
====================================================
  Execution time = 2.0075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4361e-01
  Total weights = 2.0000e+06
  Execution time = 1.9011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614715005
                                         uncertainty =       0.011743902139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614715005
                                         uncertainty =       0.011743902139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414492013
  error estimate for blocks of size 2^( 2) =       0.000427037110
  error estimate for blocks of size 2^( 3) =       0.000439149025
  error estimate for blocks of size 2^( 4) =       0.000450522638
  error estimate for blocks of size 2^( 5) =       0.000459966291
  error estimate for blocks of size 2^( 6) =       0.000466933330
  error estimate for blocks of size 2^( 7) =       0.000471633757

      target function =                  N/A
              le_mean =     -16.905622776102
             les_mean =     286.143688533551
             stat err =       0.000462264004
             autocorr =       1.243792177877
              std dev =       0.586180226107
             le_variance =       0.343607257479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614727067
                                         uncertainty =       0.011743903224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614727067
                                         uncertainty =       0.011743903224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414492020
  error estimate for blocks of size 2^( 2) =       0.000427037116
  error estimate for blocks of size 2^( 3) =       0.000439149031
  error estimate for blocks of size 2^( 4) =       0.000450522644
  error estimate for blocks of size 2^( 5) =       0.000459966297
  error estimate for blocks of size 2^( 6) =       0.000466933335
  error estimate for blocks of size 2^( 7) =       0.000471633761

      target function =                  N/A
              le_mean =     -16.905622776130
             les_mean =     286.143688546542
             stat err =       0.000462264010
             autocorr =       1.243792163266
              std dev =       0.586180236386
             le_variance =       0.343607269530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614721037
                                         uncertainty =       0.011743902681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614721037
                                         uncertainty =       0.011743902681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414492017
  error estimate for blocks of size 2^( 2) =       0.000427037113
  error estimate for blocks of size 2^( 3) =       0.000439149028
  error estimate for blocks of size 2^( 4) =       0.000450522641
  error estimate for blocks of size 2^( 5) =       0.000459966294
  error estimate for blocks of size 2^( 6) =       0.000466933333
  error estimate for blocks of size 2^( 7) =       0.000471633759

      target function =                  N/A
              le_mean =     -16.905622776116
             les_mean =     286.143688540046
             stat err =       0.000462264007
             autocorr =       1.243792170574
              std dev =       0.586180231247
             le_variance =       0.343607263505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614715759
                                         uncertainty =       0.011743902207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343614715759
                                         uncertainty =       0.011743902207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414492013
  error estimate for blocks of size 2^( 2) =       0.000427037110
  error estimate for blocks of size 2^( 3) =       0.000439149025
  error estimate for blocks of size 2^( 4) =       0.000450522638
  error estimate for blocks of size 2^( 5) =       0.000459966291
  error estimate for blocks of size 2^( 6) =       0.000466933331
  error estimate for blocks of size 2^( 7) =       0.000471633758

      target function =                  N/A
              le_mean =     -16.905622776104
             les_mean =     286.143688534363
             stat err =       0.000462264005
             autocorr =       1.243792176964
              std dev =       0.586180226750
             le_variance =       0.343607258233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905622776102        initial
     5.9605e+03     5.9605e+04             5.0081e-08       -16.905622776130  <--
     2.3842e+04     2.3842e+05             1.2520e-08       -16.905622776116
     9.5367e+04     9.5367e+05             3.1301e-09       -16.905622776104

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.9635e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9276
    reference variance = 0.367289
====================================================
  Execution time = 2.0327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3634e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336377966521
                                         uncertainty =       0.004041017614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336377966521
                                         uncertainty =       0.004041017614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410083727
  error estimate for blocks of size 2^( 2) =       0.000422516916
  error estimate for blocks of size 2^( 3) =       0.000434842922
  error estimate for blocks of size 2^( 4) =       0.000446867880
  error estimate for blocks of size 2^( 5) =       0.000456900697
  error estimate for blocks of size 2^( 6) =       0.000463007631
  error estimate for blocks of size 2^( 7) =       0.000467475760

      target function =                  N/A
              le_mean =     -16.906711171085
             les_mean =     286.173219781422
             stat err =       0.000458562992
             autocorr =       1.250411420981
              std dev =       0.579945969133
             le_variance =       0.336337327114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671117108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906711171085       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711171678       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711171472       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711171607       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711171850       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711172021       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711171857       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711171828       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.523816e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906711171085       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711171233       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711171181       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711171215       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711171276       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711171317       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711171290       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711171267       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.809585e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906711171085       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711171122       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711171109       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711171118       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711171129       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711171147       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711171130       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711171119       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.523990e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.469356 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5865e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180918e-02 1 1  ON 2
 uu_3                -2.116734e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801664e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035153e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112500e-02 1 1  ON 29
eH1_0                -2.526403e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528758e-02 1 1  ON 33
eH1_4                 3.528882e-03 1 1  ON 34
eH1_5                 3.780024e-02 1 1  ON 35
eH1_6                 9.678962e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493817e-02 1 1  ON 39
eH2_0                -2.507587e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.772000e-02 1 1  ON 42
eH2_3                -4.301311e-02 1 1  ON 43
eH2_4                 5.944042e-03 1 1  ON 44
eH2_5                 4.032359e-02 1 1  ON 45
eH2_6                 9.974134e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.24634
====================================================
  Execution time = 2.0100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3987e-01
  Total weights = 2.0000e+06
  Execution time = 1.9019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736224363
                                         uncertainty =       0.003559888495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736224363
                                         uncertainty =       0.003559888495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412230889
  error estimate for blocks of size 2^( 2) =       0.000425081320
  error estimate for blocks of size 2^( 3) =       0.000438567714
  error estimate for blocks of size 2^( 4) =       0.000450988802
  error estimate for blocks of size 2^( 5) =       0.000461705511
  error estimate for blocks of size 2^( 6) =       0.000468004106
  error estimate for blocks of size 2^( 7) =       0.000475662904

      target function =                  N/A
              le_mean =     -16.906114354193
             les_mean =     286.156570999577
             stat err =       0.000464090331
             autocorr =       1.267429984280
              std dev =       0.582982514719
             le_variance =       0.339868612468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736156780
                                         uncertainty =       0.003559887644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736156780
                                         uncertainty =       0.003559887644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412230848
  error estimate for blocks of size 2^( 2) =       0.000425081280
  error estimate for blocks of size 2^( 3) =       0.000438567673
  error estimate for blocks of size 2^( 4) =       0.000450988761
  error estimate for blocks of size 2^( 5) =       0.000461705471
  error estimate for blocks of size 2^( 6) =       0.000468004067
  error estimate for blocks of size 2^( 7) =       0.000475662865

      target function =                  N/A
              le_mean =     -16.906114353502
             les_mean =     286.156570908639
             stat err =       0.000464090291
             autocorr =       1.267430021055
              std dev =       0.582982456761
             le_variance =       0.339868544891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736190562
                                         uncertainty =       0.003559888070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736190562
                                         uncertainty =       0.003559888070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412230869
  error estimate for blocks of size 2^( 2) =       0.000425081300
  error estimate for blocks of size 2^( 3) =       0.000438567693
  error estimate for blocks of size 2^( 4) =       0.000450988782
  error estimate for blocks of size 2^( 5) =       0.000461705491
  error estimate for blocks of size 2^( 6) =       0.000468004087
  error estimate for blocks of size 2^( 7) =       0.000475662885

      target function =                  N/A
              le_mean =     -16.906114353847
             les_mean =     286.156570954097
             stat err =       0.000464090311
             autocorr =       1.267430002666
              std dev =       0.582982485732
             le_variance =       0.339868578670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736220138
                                         uncertainty =       0.003559888442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736220138
                                         uncertainty =       0.003559888442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412230887
  error estimate for blocks of size 2^( 2) =       0.000425081318
  error estimate for blocks of size 2^( 3) =       0.000438567711
  error estimate for blocks of size 2^( 4) =       0.000450988800
  error estimate for blocks of size 2^( 5) =       0.000461705508
  error estimate for blocks of size 2^( 6) =       0.000468004103
  error estimate for blocks of size 2^( 7) =       0.000475662902

      target function =                  N/A
              le_mean =     -16.906114354150
             les_mean =     286.156570993892
             stat err =       0.000464090328
             autocorr =       1.267429986572
              std dev =       0.582982511095
             le_variance =       0.339868608243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906114354193        initial  <--
     1.4901e+03     1.4901e+04             1.5238e-07       -16.906114353502
     5.9605e+03     5.9605e+04             3.8096e-08       -16.906114353847
     2.3842e+04     2.3842e+05             9.5240e-09       -16.906114354150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6756
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8812
    reference variance = 0.251969
====================================================
  Execution time = 2.2897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3407e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334082623228
                                         uncertainty =       0.002820249424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334082623228
                                         uncertainty =       0.002820249424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697599
  error estimate for blocks of size 2^( 2) =       0.000421272877
  error estimate for blocks of size 2^( 3) =       0.000434225671
  error estimate for blocks of size 2^( 4) =       0.000445809038
  error estimate for blocks of size 2^( 5) =       0.000454922177
  error estimate for blocks of size 2^( 6) =       0.000462627800
  error estimate for blocks of size 2^( 7) =       0.000466095590

      target function =                  N/A
              le_mean =     -16.906349216048
             les_mean =     286.158711102345
             stat err =       0.000457363651
             autocorr =       1.252330969049
              std dev =       0.577985687017
             le_variance =       0.334067454396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634921605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349216048       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349216088       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349216099       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349216074       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349216088       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349216094       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349216114       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349216117       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.540965e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349216048       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349216058       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349216061       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349216056       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349216075       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349216052       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349216082       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349216117       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.852427e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349216048       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349216051       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349216052       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349216050       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349216065       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906349217497       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906349216060       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906349215840       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.631066e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.471962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8468e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801668e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095644e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112498e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771999e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944041e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8366
    reference variance = 0.329248
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5201e-01
  Total weights = 2.0000e+06
  Execution time = 1.8958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114840007
                                         uncertainty =       0.007775432428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114840007
                                         uncertainty =       0.007775432428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419531378
  error estimate for blocks of size 2^( 2) =       0.000432469063
  error estimate for blocks of size 2^( 3) =       0.000445824225
  error estimate for blocks of size 2^( 4) =       0.000458678367
  error estimate for blocks of size 2^( 5) =       0.000469899872
  error estimate for blocks of size 2^( 6) =       0.000478467859
  error estimate for blocks of size 2^( 7) =       0.000484461015

      target function =                  N/A
              le_mean =     -16.905554474816
             les_mean =     286.149785078418
             stat err =       0.000472876778
             autocorr =       1.270477794163
              std dev =       0.593306963925
             le_variance =       0.352013153441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114845368
                                         uncertainty =       0.007775432487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114845368
                                         uncertainty =       0.007775432487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419531381
  error estimate for blocks of size 2^( 2) =       0.000432469066
  error estimate for blocks of size 2^( 3) =       0.000445824227
  error estimate for blocks of size 2^( 4) =       0.000458678369
  error estimate for blocks of size 2^( 5) =       0.000469899875
  error estimate for blocks of size 2^( 6) =       0.000478467861
  error estimate for blocks of size 2^( 7) =       0.000484461018

      target function =                  N/A
              le_mean =     -16.905554474798
             les_mean =     286.149785083150
             stat err =       0.000472876781
             autocorr =       1.270477788171
              std dev =       0.593306968439
             le_variance =       0.352013158799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114842688
                                         uncertainty =       0.007775432458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114842688
                                         uncertainty =       0.007775432458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419531379
  error estimate for blocks of size 2^( 2) =       0.000432469064
  error estimate for blocks of size 2^( 3) =       0.000445824226
  error estimate for blocks of size 2^( 4) =       0.000458678368
  error estimate for blocks of size 2^( 5) =       0.000469899873
  error estimate for blocks of size 2^( 6) =       0.000478467860
  error estimate for blocks of size 2^( 7) =       0.000484461016

      target function =                  N/A
              le_mean =     -16.905554474807
             les_mean =     286.149785080784
             stat err =       0.000472876779
             autocorr =       1.270477791166
              std dev =       0.593306966182
             le_variance =       0.352013156120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114840342
                                         uncertainty =       0.007775432431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352114840342
                                         uncertainty =       0.007775432431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419531378
  error estimate for blocks of size 2^( 2) =       0.000432469063
  error estimate for blocks of size 2^( 3) =       0.000445824225
  error estimate for blocks of size 2^( 4) =       0.000458678367
  error estimate for blocks of size 2^( 5) =       0.000469899872
  error estimate for blocks of size 2^( 6) =       0.000478467859
  error estimate for blocks of size 2^( 7) =       0.000484461015

      target function =                  N/A
              le_mean =     -16.905554474815
             les_mean =     286.149785078714
             stat err =       0.000472876778
             autocorr =       1.270477793782
              std dev =       0.593306964207
             le_variance =       0.352013153776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905554474816        initial  <--
     1.4901e+04     1.4901e+05             1.5410e-08       -16.905554474798
     5.9605e+04     5.9605e+05             3.8524e-09       -16.905554474807
     2.3842e+05     2.3842e+06             9.6311e-10       -16.905554474815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6314
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9433
    reference variance = 0.145806
====================================================
  Execution time = 2.0304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343815939820
                                         uncertainty =       0.007789677746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343815939820
                                         uncertainty =       0.007789677746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414598675
  error estimate for blocks of size 2^( 2) =       0.000426812490
  error estimate for blocks of size 2^( 3) =       0.000439617322
  error estimate for blocks of size 2^( 4) =       0.000451721223
  error estimate for blocks of size 2^( 5) =       0.000461654250
  error estimate for blocks of size 2^( 6) =       0.000470100200
  error estimate for blocks of size 2^( 7) =       0.000477028853

      target function =                  N/A
              le_mean =     -16.907051544644
             les_mean =     286.192175884493
             stat err =       0.000465126131
             autocorr =       1.258594005006
              std dev =       0.586331069562
             le_variance =       0.343784123134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690705154464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907051544644       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907051544646       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907051544647       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907051544661       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907051544513       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907051544645       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907051544642       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907051544646       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.954166e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907051544644       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907051544644       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907051544645       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907051544640       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907051544657       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907051544295       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907051544428       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907051544853       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.885417e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907051544644       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907051544644       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907051544644       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907051544644       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907051546578       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907051545189       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907051545079       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907051545229       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.221351e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.474548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5840e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9502
    reference variance = 0.376762
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3371e-01
  Total weights = 2.0000e+06
  Execution time = 1.8969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748305816
                                         uncertainty =       0.002701874205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748305816
                                         uncertainty =       0.002701874205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408476232
  error estimate for blocks of size 2^( 2) =       0.000420846087
  error estimate for blocks of size 2^( 3) =       0.000434508732
  error estimate for blocks of size 2^( 4) =       0.000447131401
  error estimate for blocks of size 2^( 5) =       0.000459293445
  error estimate for blocks of size 2^( 6) =       0.000470149232
  error estimate for blocks of size 2^( 7) =       0.000479348104

      target function =                  N/A
              le_mean =     -16.905450501118
             les_mean =     286.127962143259
             stat err =       0.000463980545
             autocorr =       1.290226504594
              std dev =       0.577672627328
             le_variance =       0.333705664364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748306059
                                         uncertainty =       0.002701874208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748306059
                                         uncertainty =       0.002701874208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408476232
  error estimate for blocks of size 2^( 2) =       0.000420846087
  error estimate for blocks of size 2^( 3) =       0.000434508732
  error estimate for blocks of size 2^( 4) =       0.000447131401
  error estimate for blocks of size 2^( 5) =       0.000459293445
  error estimate for blocks of size 2^( 6) =       0.000470149232
  error estimate for blocks of size 2^( 7) =       0.000479348104

      target function =                  N/A
              le_mean =     -16.905450501112
             les_mean =     286.127962143297
             stat err =       0.000463980545
             autocorr =       1.290226504300
              std dev =       0.577672627538
             le_variance =       0.333705664607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748305937
                                         uncertainty =       0.002701874207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748305937
                                         uncertainty =       0.002701874207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408476232
  error estimate for blocks of size 2^( 2) =       0.000420846087
  error estimate for blocks of size 2^( 3) =       0.000434508732
  error estimate for blocks of size 2^( 4) =       0.000447131401
  error estimate for blocks of size 2^( 5) =       0.000459293445
  error estimate for blocks of size 2^( 6) =       0.000470149232
  error estimate for blocks of size 2^( 7) =       0.000479348104

      target function =                  N/A
              le_mean =     -16.905450501115
             les_mean =     286.127962143278
             stat err =       0.000463980545
             autocorr =       1.290226504450
              std dev =       0.577672627433
             le_variance =       0.333705664485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748305831
                                         uncertainty =       0.002701874205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333748305831
                                         uncertainty =       0.002701874205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408476232
  error estimate for blocks of size 2^( 2) =       0.000420846087
  error estimate for blocks of size 2^( 3) =       0.000434508732
  error estimate for blocks of size 2^( 4) =       0.000447131401
  error estimate for blocks of size 2^( 5) =       0.000459293445
  error estimate for blocks of size 2^( 6) =       0.000470149232
  error estimate for blocks of size 2^( 7) =       0.000479348104

      target function =                  N/A
              le_mean =     -16.905450501118
             les_mean =     286.127962143262
             stat err =       0.000463980545
             autocorr =       1.290226504571
              std dev =       0.577672627341
             le_variance =       0.333705664379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905450501118        initial  <--
     1.4901e+05     1.4901e+06             1.9542e-09       -16.905450501112
     5.9605e+05     5.9605e+06             4.8854e-10       -16.905450501115
     2.3842e+06     2.3842e+07             1.2214e-10       -16.905450501118

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7265
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.862
    reference variance = 0.189058
====================================================
  Execution time = 2.0750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3634e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336343715013
                                         uncertainty =       0.002946944749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336343715013
                                         uncertainty =       0.002946944749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410085672
  error estimate for blocks of size 2^( 2) =       0.000422389924
  error estimate for blocks of size 2^( 3) =       0.000435590207
  error estimate for blocks of size 2^( 4) =       0.000446950726
  error estimate for blocks of size 2^( 5) =       0.000456310133
  error estimate for blocks of size 2^( 6) =       0.000465256622
  error estimate for blocks of size 2^( 7) =       0.000469461519

      target function =                  N/A
              le_mean =     -16.906838411273
             les_mean =     286.177525414028
             stat err =       0.000459494750
             autocorr =       1.255486117805
              std dev =       0.579948719558
             le_variance =       0.336340517317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683841127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906838411273       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906838411274       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906838411275       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906838411274       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906838411274       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906838411371       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906838411223       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906838411383       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.799497e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906838411273       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906838411273       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906838411273       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906838411602       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906838411619       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906838411315       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906838407096       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906838413295       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.498748e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906838411273       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906838411273       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906838411273       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906838411273       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906838418509       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906838411273       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906838402712       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906838427381       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.124687e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.477123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6357e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9182
    reference variance = 0.363682
====================================================
  Execution time = 2.0331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.0000e+06
  Execution time = 1.8978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571382
                                         uncertainty =       0.003433433494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571382
                                         uncertainty =       0.003433433494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697386
  error estimate for blocks of size 2^( 2) =       0.000423707549
  error estimate for blocks of size 2^( 3) =       0.000437282412
  error estimate for blocks of size 2^( 4) =       0.000450419645
  error estimate for blocks of size 2^( 5) =       0.000461632168
  error estimate for blocks of size 2^( 6) =       0.000468574140
  error estimate for blocks of size 2^( 7) =       0.000472648156

      target function =                  N/A
              le_mean =     -16.906231358601
             les_mean =     286.158003267453
             stat err =       0.000463318527
             autocorr =       1.272668975985
              std dev =       0.580813813191
             le_variance =       0.337344685593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571392
                                         uncertainty =       0.003433433495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571392
                                         uncertainty =       0.003433433495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697386
  error estimate for blocks of size 2^( 2) =       0.000423707549
  error estimate for blocks of size 2^( 3) =       0.000437282412
  error estimate for blocks of size 2^( 4) =       0.000450419645
  error estimate for blocks of size 2^( 5) =       0.000461632168
  error estimate for blocks of size 2^( 6) =       0.000468574140
  error estimate for blocks of size 2^( 7) =       0.000472648156

      target function =                  N/A
              le_mean =     -16.906231358601
             les_mean =     286.158003267489
             stat err =       0.000463318527
             autocorr =       1.272668975918
              std dev =       0.580813813200
             le_variance =       0.337344685604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571387
                                         uncertainty =       0.003433433495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571387
                                         uncertainty =       0.003433433495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697386
  error estimate for blocks of size 2^( 2) =       0.000423707549
  error estimate for blocks of size 2^( 3) =       0.000437282412
  error estimate for blocks of size 2^( 4) =       0.000450419645
  error estimate for blocks of size 2^( 5) =       0.000461632168
  error estimate for blocks of size 2^( 6) =       0.000468574140
  error estimate for blocks of size 2^( 7) =       0.000472648156

      target function =                  N/A
              le_mean =     -16.906231358601
             les_mean =     286.158003267471
             stat err =       0.000463318527
             autocorr =       1.272668975949
              std dev =       0.580813813195
             le_variance =       0.337344685598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571383
                                         uncertainty =       0.003433433494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337342571383
                                         uncertainty =       0.003433433494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697386
  error estimate for blocks of size 2^( 2) =       0.000423707549
  error estimate for blocks of size 2^( 3) =       0.000437282412
  error estimate for blocks of size 2^( 4) =       0.000450419645
  error estimate for blocks of size 2^( 5) =       0.000461632168
  error estimate for blocks of size 2^( 6) =       0.000468574140
  error estimate for blocks of size 2^( 7) =       0.000472648156

      target function =                  N/A
              le_mean =     -16.906231358601
             les_mean =     286.158003267455
             stat err =       0.000463318527
             autocorr =       1.272668975975
              std dev =       0.580813813191
             le_variance =       0.337344685594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906231358601        initial
     1.4901e+06     1.4901e+07             1.7995e-10       -16.906231358601  <--
     5.9605e+06     5.9605e+07             4.4987e-11       -16.906231358601
     2.3842e+07     2.3842e+08             1.1247e-11       -16.906231358601

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 2.9887e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8788
    reference variance = 0.231291
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4494e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344761931073
                                         uncertainty =       0.005402289201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344761931073
                                         uncertainty =       0.005402289201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415296767
  error estimate for blocks of size 2^( 2) =       0.000427779812
  error estimate for blocks of size 2^( 3) =       0.000441023730
  error estimate for blocks of size 2^( 4) =       0.000452898861
  error estimate for blocks of size 2^( 5) =       0.000462926848
  error estimate for blocks of size 2^( 6) =       0.000469354476
  error estimate for blocks of size 2^( 7) =       0.000472994877

      target function =                  N/A
              le_mean =     -16.905690917875
             les_mean =     286.147328047823
             stat err =       0.000464543765
             autocorr =       1.251227182175
              std dev =       0.587318320475
             le_variance =       0.344942809566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569091788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690917875       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690917877       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690917878       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690918064       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690917809       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690917831       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690917570       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690918238       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 8.645430e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690917875       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690917876       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690917876       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690917876       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690917610       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690917867       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690917875       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690919723       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.161358e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690917875       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690917875       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690917875       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690917875       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690921138       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690912996       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690917965       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905690926052       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.403414e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.479699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6183e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 0.311728
====================================================
  Execution time = 2.0011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3769e-01
  Total weights = 2.0000e+06
  Execution time = 1.8962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255507
                                         uncertainty =       0.003014317338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255507
                                         uncertainty =       0.003014317338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907433
  error estimate for blocks of size 2^( 2) =       0.000423929236
  error estimate for blocks of size 2^( 3) =       0.000437203631
  error estimate for blocks of size 2^( 4) =       0.000448424764
  error estimate for blocks of size 2^( 5) =       0.000458261740
  error estimate for blocks of size 2^( 6) =       0.000464855686
  error estimate for blocks of size 2^( 7) =       0.000469620719

      target function =                  N/A
              le_mean =     -16.906027094418
             les_mean =     286.151441786141
             stat err =       0.000460290727
             autocorr =       1.254805621904
              std dev =       0.581110865330
             le_variance =       0.337689837804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255919
                                         uncertainty =       0.003014317341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255919
                                         uncertainty =       0.003014317341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907434
  error estimate for blocks of size 2^( 2) =       0.000423929236
  error estimate for blocks of size 2^( 3) =       0.000437203631
  error estimate for blocks of size 2^( 4) =       0.000448424764
  error estimate for blocks of size 2^( 5) =       0.000458261740
  error estimate for blocks of size 2^( 6) =       0.000464855686
  error estimate for blocks of size 2^( 7) =       0.000469620719

      target function =                  N/A
              le_mean =     -16.906027094419
             les_mean =     286.151441786602
             stat err =       0.000460290727
             autocorr =       1.254805621411
              std dev =       0.581110865683
             le_variance =       0.337689838215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255713
                                         uncertainty =       0.003014317340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255713
                                         uncertainty =       0.003014317340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907434
  error estimate for blocks of size 2^( 2) =       0.000423929236
  error estimate for blocks of size 2^( 3) =       0.000437203631
  error estimate for blocks of size 2^( 4) =       0.000448424764
  error estimate for blocks of size 2^( 5) =       0.000458261740
  error estimate for blocks of size 2^( 6) =       0.000464855686
  error estimate for blocks of size 2^( 7) =       0.000469620719

      target function =                  N/A
              le_mean =     -16.906027094418
             les_mean =     286.151441786371
             stat err =       0.000460290727
             autocorr =       1.254805621667
              std dev =       0.581110865506
             le_variance =       0.337689838010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255533
                                         uncertainty =       0.003014317339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337761255533
                                         uncertainty =       0.003014317339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907434
  error estimate for blocks of size 2^( 2) =       0.000423929236
  error estimate for blocks of size 2^( 3) =       0.000437203631
  error estimate for blocks of size 2^( 4) =       0.000448424764
  error estimate for blocks of size 2^( 5) =       0.000458261740
  error estimate for blocks of size 2^( 6) =       0.000464855686
  error estimate for blocks of size 2^( 7) =       0.000469620719

      target function =                  N/A
              le_mean =     -16.906027094418
             les_mean =     286.151441786170
             stat err =       0.000460290727
             autocorr =       1.254805621876
              std dev =       0.581110865352
             le_variance =       0.337689837830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906027094418        initial
     3.7253e+05     3.7253e+06             8.6454e-10       -16.906027094419  <--
     1.4901e+06     1.4901e+07             2.1614e-10       -16.906027094418
     5.9605e+06     5.9605e+07             5.4034e-11       -16.906027094418

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 2.9562e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.343925
====================================================
  Execution time = 2.0484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3764e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337683216505
                                         uncertainty =       0.004204478923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337683216505
                                         uncertainty =       0.004204478923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874671
  error estimate for blocks of size 2^( 2) =       0.000423632893
  error estimate for blocks of size 2^( 3) =       0.000436648774
  error estimate for blocks of size 2^( 4) =       0.000447921531
  error estimate for blocks of size 2^( 5) =       0.000457681028
  error estimate for blocks of size 2^( 6) =       0.000464021097
  error estimate for blocks of size 2^( 7) =       0.000468625362

      target function =                  N/A
              le_mean =     -16.907147879985
             les_mean =     286.189285258003
             stat err =       0.000459562254
             autocorr =       1.251036448708
              std dev =       0.581064532673
             le_variance =       0.337635991131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690714787999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907147879985       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907147879985       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907147879990       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907147879991       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907147880000       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907147879932       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907147880039       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907147879961       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.184788e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907147879985       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907147879985       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907147879986       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907147880004       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907147879978       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907147879942       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907147879922       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907147879920       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 5.461973e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907147879985       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907147879985       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907147879986       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907147879892       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907147880037       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907147880788       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907147880287       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907147878987       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.365497e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6030e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9846
    reference variance = 0.347558
====================================================
  Execution time = 2.0004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3249e-01
  Total weights = 2.0000e+06
  Execution time = 1.9040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571279040
                                         uncertainty =       0.002414646425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571279040
                                         uncertainty =       0.002414646425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407733384
  error estimate for blocks of size 2^( 2) =       0.000420730303
  error estimate for blocks of size 2^( 3) =       0.000433621436
  error estimate for blocks of size 2^( 4) =       0.000446513439
  error estimate for blocks of size 2^( 5) =       0.000457468399
  error estimate for blocks of size 2^( 6) =       0.000466568908
  error estimate for blocks of size 2^( 7) =       0.000472408489

      target function =                  N/A
              le_mean =     -16.906237539849
             les_mean =     286.153360612299
             stat err =       0.000460739809
             autocorr =       1.276906012716
              std dev =       0.576622081376
             le_variance =       0.332493024730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571278376
                                         uncertainty =       0.002414646415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571278376
                                         uncertainty =       0.002414646415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407733384
  error estimate for blocks of size 2^( 2) =       0.000420730302
  error estimate for blocks of size 2^( 3) =       0.000433621436
  error estimate for blocks of size 2^( 4) =       0.000446513438
  error estimate for blocks of size 2^( 5) =       0.000457468399
  error estimate for blocks of size 2^( 6) =       0.000466568907
  error estimate for blocks of size 2^( 7) =       0.000472408489

      target function =                  N/A
              le_mean =     -16.906237539838
             les_mean =     286.153360611253
             stat err =       0.000460739808
             autocorr =       1.276906012706
              std dev =       0.576622080799
             le_variance =       0.332493024065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571278708
                                         uncertainty =       0.002414646420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571278708
                                         uncertainty =       0.002414646420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407733384
  error estimate for blocks of size 2^( 2) =       0.000420730303
  error estimate for blocks of size 2^( 3) =       0.000433621436
  error estimate for blocks of size 2^( 4) =       0.000446513438
  error estimate for blocks of size 2^( 5) =       0.000457468399
  error estimate for blocks of size 2^( 6) =       0.000466568907
  error estimate for blocks of size 2^( 7) =       0.000472408489

      target function =                  N/A
              le_mean =     -16.906237539844
             les_mean =     286.153360611776
             stat err =       0.000460739808
             autocorr =       1.276906012717
              std dev =       0.576622081088
             le_variance =       0.332493024398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571278999
                                         uncertainty =       0.002414646424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332571278999
                                         uncertainty =       0.002414646424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407733384
  error estimate for blocks of size 2^( 2) =       0.000420730303
  error estimate for blocks of size 2^( 3) =       0.000433621436
  error estimate for blocks of size 2^( 4) =       0.000446513439
  error estimate for blocks of size 2^( 5) =       0.000457468399
  error estimate for blocks of size 2^( 6) =       0.000466568908
  error estimate for blocks of size 2^( 7) =       0.000472408489

      target function =                  N/A
              le_mean =     -16.906237539849
             les_mean =     286.153360612234
             stat err =       0.000460739809
             autocorr =       1.276906012722
              std dev =       0.576622081340
             le_variance =       0.332493024689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906237539849        initial  <--
     9.3132e+04     9.3132e+05             2.1848e-09       -16.906237539838
     3.7253e+05     3.7253e+06             5.4620e-10       -16.906237539844
     1.4901e+06     1.4901e+07             1.3655e-10       -16.906237539849

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5863
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9141
    reference variance = 0.228612
====================================================
  Execution time = 2.0814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343921910389
                                         uncertainty =       0.005580873727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343921910389
                                         uncertainty =       0.005580873727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414912297
  error estimate for blocks of size 2^( 2) =       0.000427713905
  error estimate for blocks of size 2^( 3) =       0.000440996080
  error estimate for blocks of size 2^( 4) =       0.000453520817
  error estimate for blocks of size 2^( 5) =       0.000464421100
  error estimate for blocks of size 2^( 6) =       0.000473036943
  error estimate for blocks of size 2^( 7) =       0.000478754998

      target function =                  N/A
              le_mean =     -16.906089494530
             les_mean =     286.160166253381
             stat err =       0.000467433465
             autocorr =       1.269191016518
              std dev =       0.586774597666
             le_variance =       0.344304428466


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608949453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906089494530       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906089494531       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906089494532       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906089494532       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906089494238       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906089495172       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089494480       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906089494518       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.429110e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906089494530       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906089494531       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906089494531       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906089494531       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906089495861       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906089495674       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089497966       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906089496562       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 6.072778e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906089494530       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906089494530       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906089494530       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906089506639       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906089494452       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906089479434       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089494530       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906089474648       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.518194e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6493e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8488
    reference variance = 0.690454
====================================================
  Execution time = 2.2862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4242e-01
  Total weights = 2.0000e+06
  Execution time = 1.9027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951219
                                         uncertainty =       0.004432058711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951219
                                         uncertainty =       0.004432058711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413776441
  error estimate for blocks of size 2^( 2) =       0.000426386225
  error estimate for blocks of size 2^( 3) =       0.000439179597
  error estimate for blocks of size 2^( 4) =       0.000449977120
  error estimate for blocks of size 2^( 5) =       0.000460586113
  error estimate for blocks of size 2^( 6) =       0.000469035979
  error estimate for blocks of size 2^( 7) =       0.000472490249

      target function =                  N/A
              le_mean =     -16.906770023542
             les_mean =     286.181294343529
             stat err =       0.000463022365
             autocorr =       1.252196308478
              std dev =       0.585168254275
             le_variance =       0.342421885812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951309
                                         uncertainty =       0.004432058709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951309
                                         uncertainty =       0.004432058709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413776441
  error estimate for blocks of size 2^( 2) =       0.000426386225
  error estimate for blocks of size 2^( 3) =       0.000439179597
  error estimate for blocks of size 2^( 4) =       0.000449977120
  error estimate for blocks of size 2^( 5) =       0.000460586113
  error estimate for blocks of size 2^( 6) =       0.000469035979
  error estimate for blocks of size 2^( 7) =       0.000472490249

      target function =                  N/A
              le_mean =     -16.906770023541
             les_mean =     286.181294343580
             stat err =       0.000463022365
             autocorr =       1.252196308377
              std dev =       0.585168254352
             le_variance =       0.342421885902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951264
                                         uncertainty =       0.004432058710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951264
                                         uncertainty =       0.004432058710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413776441
  error estimate for blocks of size 2^( 2) =       0.000426386225
  error estimate for blocks of size 2^( 3) =       0.000439179597
  error estimate for blocks of size 2^( 4) =       0.000449977120
  error estimate for blocks of size 2^( 5) =       0.000460586113
  error estimate for blocks of size 2^( 6) =       0.000469035979
  error estimate for blocks of size 2^( 7) =       0.000472490249

      target function =                  N/A
              le_mean =     -16.906770023541
             les_mean =     286.181294343554
             stat err =       0.000463022365
             autocorr =       1.252196308427
              std dev =       0.585168254314
             le_variance =       0.342421885857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951225
                                         uncertainty =       0.004432058711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342468951225
                                         uncertainty =       0.004432058711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413776441
  error estimate for blocks of size 2^( 2) =       0.000426386225
  error estimate for blocks of size 2^( 3) =       0.000439179597
  error estimate for blocks of size 2^( 4) =       0.000449977120
  error estimate for blocks of size 2^( 5) =       0.000460586113
  error estimate for blocks of size 2^( 6) =       0.000469035979
  error estimate for blocks of size 2^( 7) =       0.000472490249

      target function =                  N/A
              le_mean =     -16.906770023542
             les_mean =     286.181294343532
             stat err =       0.000463022365
             autocorr =       1.252196308473
              std dev =       0.585168254280
             le_variance =       0.342421885817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906770023542        initial  <--
     9.3132e+05     9.3132e+06             2.4291e-10       -16.906770023541
     3.7253e+06     3.7253e+07             6.0728e-11       -16.906770023541
     1.4901e+07     1.4901e+08             1.5182e-11       -16.906770023542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.4364
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9802
    reference variance = 0.396385
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4924e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349311676617
                                         uncertainty =       0.006460438458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349311676617
                                         uncertainty =       0.006460438458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417877735
  error estimate for blocks of size 2^( 2) =       0.000430530919
  error estimate for blocks of size 2^( 3) =       0.000443672123
  error estimate for blocks of size 2^( 4) =       0.000456492150
  error estimate for blocks of size 2^( 5) =       0.000468410556
  error estimate for blocks of size 2^( 6) =       0.000475761339
  error estimate for blocks of size 2^( 7) =       0.000480061327

      target function =                  N/A
              le_mean =     -16.905366118191
             les_mean =     286.140647018171
             stat err =       0.000470181343
             autocorr =       1.265995961680
              std dev =       0.590968360150
             le_variance =       0.349243602698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690536611819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905366118191       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905366118191       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905366118192       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905366119003       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905366118073       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905366118929       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905366122282       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905366120535       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.907275e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905366118191       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905366118191       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905366118191       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905366113550       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905366115788       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905366118438       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905366113877       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905366070087       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 7.268275e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905366118191       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905366118191       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905366118191       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905366118191       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905366171197       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905366039570       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905365999052       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905366445713       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.817114e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.487477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5952e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9528
    reference variance = 0.44282
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3897e-01
  Total weights = 2.0000e+06
  Execution time = 1.8961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261488
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261488
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411686000
  error estimate for blocks of size 2^( 2) =       0.000424207988
  error estimate for blocks of size 2^( 3) =       0.000437843616
  error estimate for blocks of size 2^( 4) =       0.000449586710
  error estimate for blocks of size 2^( 5) =       0.000460491117
  error estimate for blocks of size 2^( 6) =       0.000467809203
  error estimate for blocks of size 2^( 7) =       0.000471220462

      target function =                  N/A
              le_mean =     -16.905964386382
             les_mean =     286.150602389171
             stat err =       0.000462276873
             autocorr =       1.260875300789
              std dev =       0.582211924503
             le_variance =       0.338970725033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261501
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261501
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411686000
  error estimate for blocks of size 2^( 2) =       0.000424207988
  error estimate for blocks of size 2^( 3) =       0.000437843616
  error estimate for blocks of size 2^( 4) =       0.000449586710
  error estimate for blocks of size 2^( 5) =       0.000460491117
  error estimate for blocks of size 2^( 6) =       0.000467809203
  error estimate for blocks of size 2^( 7) =       0.000471220462

      target function =                  N/A
              le_mean =     -16.905964386382
             les_mean =     286.150602389180
             stat err =       0.000462276873
             autocorr =       1.260875300771
              std dev =       0.582211924514
             le_variance =       0.338970725046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261494
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261494
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411686000
  error estimate for blocks of size 2^( 2) =       0.000424207988
  error estimate for blocks of size 2^( 3) =       0.000437843616
  error estimate for blocks of size 2^( 4) =       0.000449586710
  error estimate for blocks of size 2^( 5) =       0.000460491117
  error estimate for blocks of size 2^( 6) =       0.000467809203
  error estimate for blocks of size 2^( 7) =       0.000471220462

      target function =                  N/A
              le_mean =     -16.905964386382
             les_mean =     286.150602389176
             stat err =       0.000462276873
             autocorr =       1.260875300789
              std dev =       0.582211924508
             le_variance =       0.338970725039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261489
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886261489
                                         uncertainty =       0.003682044179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411686000
  error estimate for blocks of size 2^( 2) =       0.000424207988
  error estimate for blocks of size 2^( 3) =       0.000437843616
  error estimate for blocks of size 2^( 4) =       0.000449586710
  error estimate for blocks of size 2^( 5) =       0.000460491117
  error estimate for blocks of size 2^( 6) =       0.000467809203
  error estimate for blocks of size 2^( 7) =       0.000471220462

      target function =                  N/A
              le_mean =     -16.905964386382
             les_mean =     286.150602389172
             stat err =       0.000462276873
             autocorr =       1.260875300790
              std dev =       0.582211924503
             le_variance =       0.338970725034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905964386382        initial  <--
     9.3132e+06     9.3132e+07             2.9073e-11       -16.905964386382
     3.7253e+07     3.7253e+08             7.2683e-12       -16.905964386382
     1.4901e+08     1.4901e+09             1.8171e-12       -16.905964386382

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4622
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8281
    reference variance = 0.233563
====================================================
  Execution time = 2.0126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4282e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342806356708
                                         uncertainty =       0.003153996448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342806356708
                                         uncertainty =       0.003153996448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414014944
  error estimate for blocks of size 2^( 2) =       0.000426928817
  error estimate for blocks of size 2^( 3) =       0.000440320794
  error estimate for blocks of size 2^( 4) =       0.000452339737
  error estimate for blocks of size 2^( 5) =       0.000463334151
  error estimate for blocks of size 2^( 6) =       0.000472090731
  error estimate for blocks of size 2^( 7) =       0.000474562895

      target function =                  N/A
              le_mean =     -16.905971761371
             les_mean =     286.154697772436
             stat err =       0.000465581878
             autocorr =       1.264620162636
              std dev =       0.585505548710
             le_variance =       0.342816747570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597176137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905971761371       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905971761371       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905971761371       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905971817449       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905971761393       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905971761419       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905971759802       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905971803480       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.387534e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905971761371       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905971761371       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905971761371       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905971761371       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905971827146       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905971671843       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905971811624       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905972417766       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 5.969357e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905971761371       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905971761371       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905971761371       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905971952518       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905971809972       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905971644556       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905971336479       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905972253017       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 1.491363e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.490040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5569e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9604
    reference variance = 0.246957
====================================================
  Execution time = 2.0177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3034e-01
  Total weights = 2.0000e+06
  Execution time = 1.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406410597
  error estimate for blocks of size 2^( 2) =       0.000419529562
  error estimate for blocks of size 2^( 3) =       0.000433254465
  error estimate for blocks of size 2^( 4) =       0.000445274630
  error estimate for blocks of size 2^( 5) =       0.000457049693
  error estimate for blocks of size 2^( 6) =       0.000467150934
  error estimate for blocks of size 2^( 7) =       0.000475008354

      target function =                  N/A
              le_mean =     -16.906742310997
             les_mean =     286.168274551845
             stat err =       0.000461120903
             autocorr =       1.287358699357
              std dev =       0.574751378041
             le_variance =       0.330339146560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406410597
  error estimate for blocks of size 2^( 2) =       0.000419529562
  error estimate for blocks of size 2^( 3) =       0.000433254465
  error estimate for blocks of size 2^( 4) =       0.000445274630
  error estimate for blocks of size 2^( 5) =       0.000457049693
  error estimate for blocks of size 2^( 6) =       0.000467150934
  error estimate for blocks of size 2^( 7) =       0.000475008354

      target function =                  N/A
              le_mean =     -16.906742310997
             les_mean =     286.168274551846
             stat err =       0.000461120903
             autocorr =       1.287358699353
              std dev =       0.574751378041
             le_variance =       0.330339146560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406410597
  error estimate for blocks of size 2^( 2) =       0.000419529562
  error estimate for blocks of size 2^( 3) =       0.000433254465
  error estimate for blocks of size 2^( 4) =       0.000445274630
  error estimate for blocks of size 2^( 5) =       0.000457049693
  error estimate for blocks of size 2^( 6) =       0.000467150934
  error estimate for blocks of size 2^( 7) =       0.000475008354

      target function =                  N/A
              le_mean =     -16.906742310997
             les_mean =     286.168274551846
             stat err =       0.000461120903
             autocorr =       1.287358699367
              std dev =       0.574751378041
             le_variance =       0.330339146560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330360599756
                                         uncertainty =       0.003124440526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406410597
  error estimate for blocks of size 2^( 2) =       0.000419529562
  error estimate for blocks of size 2^( 3) =       0.000433254465
  error estimate for blocks of size 2^( 4) =       0.000445274630
  error estimate for blocks of size 2^( 5) =       0.000457049693
  error estimate for blocks of size 2^( 6) =       0.000467150934
  error estimate for blocks of size 2^( 7) =       0.000475008354

      target function =                  N/A
              le_mean =     -16.906742310997
             les_mean =     286.168274551845
             stat err =       0.000461120903
             autocorr =       1.287358699363
              std dev =       0.574751378041
             le_variance =       0.330339146560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906742310997        initial
     9.3132e+07     9.3132e+08             2.3875e-12       -16.906742310997  <--
     3.7253e+08     3.7253e+09             5.9694e-13       -16.906742310997
     1.4901e+09     1.4901e+10             1.4914e-13       -16.906742310997

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 2.9749e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.265196
====================================================
  Execution time = 2.0158e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3778e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337799424846
                                         uncertainty =       0.002821169493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337799424846
                                         uncertainty =       0.002821169493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410964611
  error estimate for blocks of size 2^( 2) =       0.000423731798
  error estimate for blocks of size 2^( 3) =       0.000436896957
  error estimate for blocks of size 2^( 4) =       0.000449380664
  error estimate for blocks of size 2^( 5) =       0.000460819868
  error estimate for blocks of size 2^( 6) =       0.000469000478
  error estimate for blocks of size 2^( 7) =       0.000474548698

      target function =                  N/A
              le_mean =     -16.906000458084
             les_mean =     286.150635143230
             stat err =       0.000463437427
             autocorr =       1.271666870275
              std dev =       0.581191726861
             le_variance =       0.337783823372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600045808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906000458084       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906000458084       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906000458084       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906000451694       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906000469497       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906000444701       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906000477583       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906000468496       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 9.628145e-12

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906000458084       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906000458084       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906000458084       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906000458084       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906000458084       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906000453308       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906000390274       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906000533394       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 2.407008e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906000458084       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906000458084       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906000458084       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906000458084       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906000458084       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906000484313       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906000510065       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906000276763       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 6.017534e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.492532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5660e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.159286
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3219e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958222
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958222
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407544775
  error estimate for blocks of size 2^( 2) =       0.000420436887
  error estimate for blocks of size 2^( 3) =       0.000433674603
  error estimate for blocks of size 2^( 4) =       0.000445626919
  error estimate for blocks of size 2^( 5) =       0.000456548384
  error estimate for blocks of size 2^( 6) =       0.000463810573
  error estimate for blocks of size 2^( 7) =       0.000466736675

      target function =                  N/A
              le_mean =     -16.906032614325
             les_mean =     286.146124078060
             stat err =       0.000458180638
             autocorr =       1.263929368859
              std dev =       0.576355348324
             le_variance =       0.332185487541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958233
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958233
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407544775
  error estimate for blocks of size 2^( 2) =       0.000420436887
  error estimate for blocks of size 2^( 3) =       0.000433674603
  error estimate for blocks of size 2^( 4) =       0.000445626919
  error estimate for blocks of size 2^( 5) =       0.000456548384
  error estimate for blocks of size 2^( 6) =       0.000463810573
  error estimate for blocks of size 2^( 7) =       0.000466736675

      target function =                  N/A
              le_mean =     -16.906032614325
             les_mean =     286.146124078070
             stat err =       0.000458180638
             autocorr =       1.263929368839
              std dev =       0.576355348333
             le_variance =       0.332185487552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958227
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958227
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407544775
  error estimate for blocks of size 2^( 2) =       0.000420436887
  error estimate for blocks of size 2^( 3) =       0.000433674603
  error estimate for blocks of size 2^( 4) =       0.000445626919
  error estimate for blocks of size 2^( 5) =       0.000456548384
  error estimate for blocks of size 2^( 6) =       0.000463810573
  error estimate for blocks of size 2^( 7) =       0.000466736675

      target function =                  N/A
              le_mean =     -16.906032614325
             les_mean =     286.146124078065
             stat err =       0.000458180638
             autocorr =       1.263929368851
              std dev =       0.576355348328
             le_variance =       0.332185487547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958222
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332209958222
                                         uncertainty =       0.003019859209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407544775
  error estimate for blocks of size 2^( 2) =       0.000420436887
  error estimate for blocks of size 2^( 3) =       0.000433674603
  error estimate for blocks of size 2^( 4) =       0.000445626919
  error estimate for blocks of size 2^( 5) =       0.000456548384
  error estimate for blocks of size 2^( 6) =       0.000463810573
  error estimate for blocks of size 2^( 7) =       0.000466736675

      target function =                  N/A
              le_mean =     -16.906032614325
             les_mean =     286.146124078061
             stat err =       0.000458180638
             autocorr =       1.263929368855
              std dev =       0.576355348324
             le_variance =       0.332185487542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906032614325        initial  <--
     2.3283e+07     2.3283e+08             9.6281e-12       -16.906032614325
     9.3132e+07     9.3132e+08             2.4070e-12       -16.906032614325
     3.7253e+08     3.7253e+09             6.0175e-13       -16.906032614325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5854
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.328666
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3827e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338338960653
                                         uncertainty =       0.004201584599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338338960653
                                         uncertainty =       0.004201584599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411262719
  error estimate for blocks of size 2^( 2) =       0.000424296028
  error estimate for blocks of size 2^( 3) =       0.000437738276
  error estimate for blocks of size 2^( 4) =       0.000450060852
  error estimate for blocks of size 2^( 5) =       0.000461362446
  error estimate for blocks of size 2^( 6) =       0.000470143750
  error estimate for blocks of size 2^( 7) =       0.000473863418

      target function =                  N/A
              le_mean =     -16.906442111602
             les_mean =     286.166058752568
             stat err =       0.000463857617
             autocorr =       1.272127668136
              std dev =       0.581613315501
             le_variance =       0.338274048768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644211160e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906442111602       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442111602       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906442111602       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906442379769       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906442178822       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906442109631       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906441995909       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906442317181       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.140363e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906442111602       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442111602       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906442111602       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906442183244       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906442135332       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906442300831       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906442897565       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906440722683       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.851268e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906442111602       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442111602       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906442111602       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906442111602       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906442433579       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906441178884       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906442078273       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906438967515       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 7.127968e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.495121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5910e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8677
    reference variance = 0.218256
====================================================
  Execution time = 2.0269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3905e-01
  Total weights = 2.0000e+06
  Execution time = 1.9012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258318
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258318
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411732709
  error estimate for blocks of size 2^( 2) =       0.000424294280
  error estimate for blocks of size 2^( 3) =       0.000436811619
  error estimate for blocks of size 2^( 4) =       0.000449744904
  error estimate for blocks of size 2^( 5) =       0.000460424479
  error estimate for blocks of size 2^( 6) =       0.000468393562
  error estimate for blocks of size 2^( 7) =       0.000475194580

      target function =                  N/A
              le_mean =     -16.905813260847
             les_mean =     286.145569487927
             stat err =       0.000463439381
             autocorr =       1.266937329233
              std dev =       0.582277980717
             le_variance =       0.339047646827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258319
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258319
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411732709
  error estimate for blocks of size 2^( 2) =       0.000424294280
  error estimate for blocks of size 2^( 3) =       0.000436811619
  error estimate for blocks of size 2^( 4) =       0.000449744904
  error estimate for blocks of size 2^( 5) =       0.000460424479
  error estimate for blocks of size 2^( 6) =       0.000468393562
  error estimate for blocks of size 2^( 7) =       0.000475194580

      target function =                  N/A
              le_mean =     -16.905813260847
             les_mean =     286.145569487928
             stat err =       0.000463439381
             autocorr =       1.266937329232
              std dev =       0.582277980717
             le_variance =       0.339047646828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258318
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258318
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411732709
  error estimate for blocks of size 2^( 2) =       0.000424294280
  error estimate for blocks of size 2^( 3) =       0.000436811619
  error estimate for blocks of size 2^( 4) =       0.000449744904
  error estimate for blocks of size 2^( 5) =       0.000460424479
  error estimate for blocks of size 2^( 6) =       0.000468393562
  error estimate for blocks of size 2^( 7) =       0.000475194580

      target function =                  N/A
              le_mean =     -16.905813260847
             les_mean =     286.145569487927
             stat err =       0.000463439381
             autocorr =       1.266937329226
              std dev =       0.582277980717
             le_variance =       0.339047646828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258318
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339109258318
                                         uncertainty =       0.003965756475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411732709
  error estimate for blocks of size 2^( 2) =       0.000424294280
  error estimate for blocks of size 2^( 3) =       0.000436811619
  error estimate for blocks of size 2^( 4) =       0.000449744904
  error estimate for blocks of size 2^( 5) =       0.000460424479
  error estimate for blocks of size 2^( 6) =       0.000468393562
  error estimate for blocks of size 2^( 7) =       0.000475194580

      target function =                  N/A
              le_mean =     -16.905813260847
             les_mean =     286.145569487927
             stat err =       0.000463439381
             autocorr =       1.266937329225
              std dev =       0.582277980717
             le_variance =       0.339047646827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905813260847        initial
     2.3283e+08     2.3283e+09             1.1404e-12       -16.905813260847  <--
     9.3132e+08     9.3132e+09             2.8513e-13       -16.905813260847
     3.7253e+09     3.7253e+10             7.1280e-14       -16.905813260847

*****************************************************************************
Applying the update for shift_i =   2.3283e+08     and shift_s =   2.3283e+09
*****************************************************************************

  Execution time = 2.9852e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8171
    reference variance = 0.247288
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342582935177
                                         uncertainty =       0.003694783656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342582935177
                                         uncertainty =       0.003694783656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413969124
  error estimate for blocks of size 2^( 2) =       0.000426718055
  error estimate for blocks of size 2^( 3) =       0.000439908141
  error estimate for blocks of size 2^( 4) =       0.000452574275
  error estimate for blocks of size 2^( 5) =       0.000463589096
  error estimate for blocks of size 2^( 6) =       0.000472099759
  error estimate for blocks of size 2^( 7) =       0.000479196142

      target function =                  N/A
              le_mean =     -16.906286713952
             les_mean =     286.165271154606
             stat err =       0.000466864818
             autocorr =       1.271880748667
              std dev =       0.585440749872
             le_variance =       0.342740871610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628671395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906286713952       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906286713952       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906286713952       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286738413       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906286695305       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906286709275       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906286714009       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906286720332       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.675424e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906286713952       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906286713952       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906286713952       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286713952       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906286794299       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906286716457       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906286430172       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906286501711       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 9.188710e-13

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906286713952       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906286713952       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906286713952       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286590671       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906286159191       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906286713953       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906286910350       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906286812514       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.297299e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.497690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5858e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9026
    reference variance = 0.355936
====================================================
  Execution time = 2.0095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587209
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587209
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417041390
  error estimate for blocks of size 2^( 2) =       0.000429709811
  error estimate for blocks of size 2^( 3) =       0.000442622017
  error estimate for blocks of size 2^( 4) =       0.000454232741
  error estimate for blocks of size 2^( 5) =       0.000464087712
  error estimate for blocks of size 2^( 6) =       0.000471506489
  error estimate for blocks of size 2^( 7) =       0.000478257527

      target function =                  N/A
              le_mean =     -16.906925607813
             les_mean =     286.191980376431
             stat err =       0.000467021117
             autocorr =       1.254049611367
              std dev =       0.589785590058
             le_variance =       0.347847042241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587210
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587210
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417041390
  error estimate for blocks of size 2^( 2) =       0.000429709811
  error estimate for blocks of size 2^( 3) =       0.000442622017
  error estimate for blocks of size 2^( 4) =       0.000454232741
  error estimate for blocks of size 2^( 5) =       0.000464087712
  error estimate for blocks of size 2^( 6) =       0.000471506489
  error estimate for blocks of size 2^( 7) =       0.000478257527

      target function =                  N/A
              le_mean =     -16.906925607813
             les_mean =     286.191980376433
             stat err =       0.000467021117
             autocorr =       1.254049611374
              std dev =       0.589785590059
             le_variance =       0.347847042241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587210
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587210
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417041390
  error estimate for blocks of size 2^( 2) =       0.000429709811
  error estimate for blocks of size 2^( 3) =       0.000442622017
  error estimate for blocks of size 2^( 4) =       0.000454232741
  error estimate for blocks of size 2^( 5) =       0.000464087712
  error estimate for blocks of size 2^( 6) =       0.000471506489
  error estimate for blocks of size 2^( 7) =       0.000478257527

      target function =                  N/A
              le_mean =     -16.906925607813
             les_mean =     286.191980376432
             stat err =       0.000467021117
             autocorr =       1.254049611366
              std dev =       0.589785590059
             le_variance =       0.347847042241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587209
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347769587209
                                         uncertainty =       0.006723763238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417041390
  error estimate for blocks of size 2^( 2) =       0.000429709811
  error estimate for blocks of size 2^( 3) =       0.000442622017
  error estimate for blocks of size 2^( 4) =       0.000454232741
  error estimate for blocks of size 2^( 5) =       0.000464087712
  error estimate for blocks of size 2^( 6) =       0.000471506489
  error estimate for blocks of size 2^( 7) =       0.000478257527

      target function =                  N/A
              le_mean =     -16.906925607813
             les_mean =     286.191980376432
             stat err =       0.000467021117
             autocorr =       1.254049611375
              std dev =       0.589785590058
             le_variance =       0.347847042241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906925607813        initial
     5.8208e+07     5.8208e+08             3.6754e-12       -16.906925607813  <--
     2.3283e+08     2.3283e+09             9.1887e-13       -16.906925607813
     9.3132e+08     9.3132e+09             2.2973e-13       -16.906925607813

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 3.2944e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8828
    reference variance = 0.346211
====================================================
  Execution time = 2.0410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785262018
                                         uncertainty =       0.002759884449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335785262018
                                         uncertainty =       0.002759884449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409704909
  error estimate for blocks of size 2^( 2) =       0.000422287927
  error estimate for blocks of size 2^( 3) =       0.000435188335
  error estimate for blocks of size 2^( 4) =       0.000446905999
  error estimate for blocks of size 2^( 5) =       0.000457581586
  error estimate for blocks of size 2^( 6) =       0.000464377085
  error estimate for blocks of size 2^( 7) =       0.000470403657

      target function =                  N/A
              le_mean =     -16.907035497607
             les_mean =     286.183565375112
             stat err =       0.000459817082
             autocorr =       1.259586118866
              std dev =       0.579410239505
             le_variance =       0.335716225644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690703549761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907035497607       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907035497606       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907035497606       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907035497607       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907035495561       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907035487752       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907035496247       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907035498839       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.668242e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907035497607       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907035497606       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907035497606       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907035497607       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907035509554       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907035500742       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907035465154       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907035483504       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.170589e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907035497607       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907035497606       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907035497607       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907035497606       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907035504100       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907035574179       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907035543283       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907036123755       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.043714e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.500303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6012e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9846
    reference variance = 0.228495
====================================================
  Execution time = 2.0131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3564e-01
  Total weights = 2.0000e+06
  Execution time = 1.9029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106766
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106766
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409660468
  error estimate for blocks of size 2^( 2) =       0.000422272220
  error estimate for blocks of size 2^( 3) =       0.000435722898
  error estimate for blocks of size 2^( 4) =       0.000447550206
  error estimate for blocks of size 2^( 5) =       0.000458247878
  error estimate for blocks of size 2^( 6) =       0.000465844537
  error estimate for blocks of size 2^( 7) =       0.000470182386

      target function =                  N/A
              le_mean =     -16.906460387306
             les_mean =     286.164046057057
             stat err =       0.000460456252
             autocorr =       1.263364400963
              std dev =       0.579347389175
             le_variance =       0.335643397344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106772
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106772
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409660468
  error estimate for blocks of size 2^( 2) =       0.000422272220
  error estimate for blocks of size 2^( 3) =       0.000435722898
  error estimate for blocks of size 2^( 4) =       0.000447550206
  error estimate for blocks of size 2^( 5) =       0.000458247878
  error estimate for blocks of size 2^( 6) =       0.000465844537
  error estimate for blocks of size 2^( 7) =       0.000470182386

      target function =                  N/A
              le_mean =     -16.906460387306
             les_mean =     286.164046057064
             stat err =       0.000460456252
             autocorr =       1.263364400968
              std dev =       0.579347389181
             le_variance =       0.335643397351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106769
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106769
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409660468
  error estimate for blocks of size 2^( 2) =       0.000422272220
  error estimate for blocks of size 2^( 3) =       0.000435722898
  error estimate for blocks of size 2^( 4) =       0.000447550206
  error estimate for blocks of size 2^( 5) =       0.000458247878
  error estimate for blocks of size 2^( 6) =       0.000465844537
  error estimate for blocks of size 2^( 7) =       0.000470182386

      target function =                  N/A
              le_mean =     -16.906460387306
             les_mean =     286.164046057061
             stat err =       0.000460456252
             autocorr =       1.263364400964
              std dev =       0.579347389178
             le_variance =       0.335643397347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106766
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335438106766
                                         uncertainty =       0.002943735000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409660468
  error estimate for blocks of size 2^( 2) =       0.000422272220
  error estimate for blocks of size 2^( 3) =       0.000435722898
  error estimate for blocks of size 2^( 4) =       0.000447550206
  error estimate for blocks of size 2^( 5) =       0.000458247878
  error estimate for blocks of size 2^( 6) =       0.000465844537
  error estimate for blocks of size 2^( 7) =       0.000470182386

      target function =                  N/A
              le_mean =     -16.906460387306
             les_mean =     286.164046057057
             stat err =       0.000460456252
             autocorr =       1.263364400964
              std dev =       0.579347389175
             le_variance =       0.335643397344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906460387306        initial
     1.4552e+07     1.4552e+08             1.6682e-11       -16.906460387306  <--
     5.8208e+07     5.8208e+08             4.1706e-12       -16.906460387306
     2.3283e+08     2.3283e+09             1.0437e-12       -16.906460387306

*****************************************************************************
Applying the update for shift_i =   1.4552e+07     and shift_s =   1.4552e+08
*****************************************************************************

  Execution time = 2.9716e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8487
    reference variance = 0.195091
====================================================
  Execution time = 2.0385e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4128e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341352806043
                                         uncertainty =       0.004412332176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341352806043
                                         uncertainty =       0.004412332176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413084193
  error estimate for blocks of size 2^( 2) =       0.000425645058
  error estimate for blocks of size 2^( 3) =       0.000438607733
  error estimate for blocks of size 2^( 4) =       0.000450224533
  error estimate for blocks of size 2^( 5) =       0.000462025865
  error estimate for blocks of size 2^( 6) =       0.000469693200
  error estimate for blocks of size 2^( 7) =       0.000476079742

      target function =                  N/A
              le_mean =     -16.907299100246
             les_mean =     286.198039795184
             stat err =       0.000464505835
             autocorr =       1.264460289664
              std dev =       0.584189267817
             le_variance =       0.341277100633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690729910025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907299100246       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907299100246       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907299100246       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907299100246       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907299100246       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907299100493       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907299097771       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907299099490       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 6.867073e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907299100246       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907299100246       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907299100246       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907299100246       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907299118696       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907299081245       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907299087097       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907299104090       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.716749e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907299100246       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907299100246       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907299100246       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907299100246       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907299141594       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907299110723       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907299084909       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907299144749       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.291911e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5958e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8699
    reference variance = 0.241492
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4054e-01
  Total weights = 2.0000e+06
  Execution time = 1.8965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449475
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449475
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412636690
  error estimate for blocks of size 2^( 2) =       0.000425531818
  error estimate for blocks of size 2^( 3) =       0.000438941280
  error estimate for blocks of size 2^( 4) =       0.000450843382
  error estimate for blocks of size 2^( 5) =       0.000461306310
  error estimate for blocks of size 2^( 6) =       0.000466977808
  error estimate for blocks of size 2^( 7) =       0.000468573707

      target function =                  N/A
              le_mean =     -16.905631011227
             les_mean =     286.140897793675
             stat err =       0.000461925302
             autocorr =       1.253163737757
              std dev =       0.583556403587
             le_variance =       0.340538076168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449483
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449483
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412636690
  error estimate for blocks of size 2^( 2) =       0.000425531818
  error estimate for blocks of size 2^( 3) =       0.000438941280
  error estimate for blocks of size 2^( 4) =       0.000450843382
  error estimate for blocks of size 2^( 5) =       0.000461306310
  error estimate for blocks of size 2^( 6) =       0.000466977808
  error estimate for blocks of size 2^( 7) =       0.000468573707

      target function =                  N/A
              le_mean =     -16.905631011228
             les_mean =     286.140897793684
             stat err =       0.000461925302
             autocorr =       1.253163737748
              std dev =       0.583556403594
             le_variance =       0.340538076176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449479
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449479
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412636690
  error estimate for blocks of size 2^( 2) =       0.000425531818
  error estimate for blocks of size 2^( 3) =       0.000438941280
  error estimate for blocks of size 2^( 4) =       0.000450843382
  error estimate for blocks of size 2^( 5) =       0.000461306310
  error estimate for blocks of size 2^( 6) =       0.000466977808
  error estimate for blocks of size 2^( 7) =       0.000468573707

      target function =                  N/A
              le_mean =     -16.905631011227
             les_mean =     286.140897793680
             stat err =       0.000461925302
             autocorr =       1.253163737745
              std dev =       0.583556403591
             le_variance =       0.340538076172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449476
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269449476
                                         uncertainty =       0.003350367722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412636690
  error estimate for blocks of size 2^( 2) =       0.000425531818
  error estimate for blocks of size 2^( 3) =       0.000438941280
  error estimate for blocks of size 2^( 4) =       0.000450843382
  error estimate for blocks of size 2^( 5) =       0.000461306310
  error estimate for blocks of size 2^( 6) =       0.000466977808
  error estimate for blocks of size 2^( 7) =       0.000468573707

      target function =                  N/A
              le_mean =     -16.905631011227
             les_mean =     286.140897793676
             stat err =       0.000461925302
             autocorr =       1.253163737755
              std dev =       0.583556403588
             le_variance =       0.340538076169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905631011227        initial
     3.6380e+06     3.6380e+07             6.8671e-11       -16.905631011228  <--
     1.4552e+07     1.4552e+08             1.7167e-11       -16.905631011227
     5.8208e+07     5.8208e+08             4.2919e-12       -16.905631011227

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 2.9599e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8808
    reference variance = 0.261854
====================================================
  Execution time = 2.0429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340084722510
                                         uncertainty =       0.005574225965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340084722510
                                         uncertainty =       0.005574225965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412311768
  error estimate for blocks of size 2^( 2) =       0.000425387418
  error estimate for blocks of size 2^( 3) =       0.000438532157
  error estimate for blocks of size 2^( 4) =       0.000451341576
  error estimate for blocks of size 2^( 5) =       0.000461841149
  error estimate for blocks of size 2^( 6) =       0.000470716270
  error estimate for blocks of size 2^( 7) =       0.000474496731

      target function =                  N/A
              le_mean =     -16.906067820613
             les_mean =     286.155130973486
             stat err =       0.000464598932
             autocorr =       1.269711205058
              std dev =       0.583096894456
             le_variance =       0.340001988324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606782061e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067820613       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067820612       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067820613       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067821029       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067820614       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067820553       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067819843       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067820456       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 2.552005e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067820613       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067820613       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067820613       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067820613       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067820479       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067821431       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067821158       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067821828       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 6.380004e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067820613       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067820613       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067820613       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067820196       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067828004       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067815522       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067823324       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906067814224       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.594996e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.505458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5987e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.202159
====================================================
  Execution time = 1.9987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3989e-01
  Total weights = 2.0000e+06
  Execution time = 1.8980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195667
                                         uncertainty =       0.005020623768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195667
                                         uncertainty =       0.005020623768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412243840
  error estimate for blocks of size 2^( 2) =       0.000424928290
  error estimate for blocks of size 2^( 3) =       0.000437539270
  error estimate for blocks of size 2^( 4) =       0.000449877670
  error estimate for blocks of size 2^( 5) =       0.000461124879
  error estimate for blocks of size 2^( 6) =       0.000470108744
  error estimate for blocks of size 2^( 7) =       0.000475123808

      target function =                  N/A
              le_mean =     -16.906706315158
             les_mean =     286.176608224150
             stat err =       0.000464058775
             autocorr =       1.267178014085
              std dev =       0.583000829423
             le_variance =       0.339889967108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195922
                                         uncertainty =       0.005020623772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195922
                                         uncertainty =       0.005020623772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412243840
  error estimate for blocks of size 2^( 2) =       0.000424928290
  error estimate for blocks of size 2^( 3) =       0.000437539270
  error estimate for blocks of size 2^( 4) =       0.000449877670
  error estimate for blocks of size 2^( 5) =       0.000461124879
  error estimate for blocks of size 2^( 6) =       0.000470108744
  error estimate for blocks of size 2^( 7) =       0.000475123808

      target function =                  N/A
              le_mean =     -16.906706315159
             les_mean =     286.176608224446
             stat err =       0.000464058775
             autocorr =       1.267178013816
              std dev =       0.583000829642
             le_variance =       0.339889967363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195794
                                         uncertainty =       0.005020623770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195794
                                         uncertainty =       0.005020623770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412243840
  error estimate for blocks of size 2^( 2) =       0.000424928290
  error estimate for blocks of size 2^( 3) =       0.000437539270
  error estimate for blocks of size 2^( 4) =       0.000449877670
  error estimate for blocks of size 2^( 5) =       0.000461124879
  error estimate for blocks of size 2^( 6) =       0.000470108744
  error estimate for blocks of size 2^( 7) =       0.000475123808

      target function =                  N/A
              le_mean =     -16.906706315158
             les_mean =     286.176608224298
             stat err =       0.000464058775
             autocorr =       1.267178013950
              std dev =       0.583000829532
             le_variance =       0.339889967236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195683
                                         uncertainty =       0.005020623768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339989195683
                                         uncertainty =       0.005020623768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412243840
  error estimate for blocks of size 2^( 2) =       0.000424928290
  error estimate for blocks of size 2^( 3) =       0.000437539270
  error estimate for blocks of size 2^( 4) =       0.000449877670
  error estimate for blocks of size 2^( 5) =       0.000461124879
  error estimate for blocks of size 2^( 6) =       0.000470108744
  error estimate for blocks of size 2^( 7) =       0.000475123808

      target function =                  N/A
              le_mean =     -16.906706315158
             les_mean =     286.176608224168
             stat err =       0.000464058775
             autocorr =       1.267178014067
              std dev =       0.583000829437
             le_variance =       0.339889967124


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906706315158        initial
     9.0949e+05     9.0949e+06             2.5520e-10       -16.906706315159  <--
     3.6380e+06     3.6380e+07             6.3800e-11       -16.906706315158
     1.4552e+07     1.4552e+08             1.5950e-11       -16.906706315158

*****************************************************************************
Applying the update for shift_i =   9.0949e+05     and shift_s =   9.0949e+06
*****************************************************************************

  Execution time = 2.9541e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5535e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.904
    reference variance = 0.491173
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339421343813
                                         uncertainty =       0.003056997975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339421343813
                                         uncertainty =       0.003056997975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918202
  error estimate for blocks of size 2^( 2) =       0.000424758308
  error estimate for blocks of size 2^( 3) =       0.000437857181
  error estimate for blocks of size 2^( 4) =       0.000450038666
  error estimate for blocks of size 2^( 5) =       0.000459615997
  error estimate for blocks of size 2^( 6) =       0.000467532405
  error estimate for blocks of size 2^( 7) =       0.000472787029

      target function =                  N/A
              le_mean =     -16.905764193721
             les_mean =     286.144216014877
             stat err =       0.000462493525
             autocorr =       1.260634957100
              std dev =       0.582540308365
             le_variance =       0.339353210870


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576419372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764193721       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764193719       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764193722       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764193725       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764193727       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764193648       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764193614       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764193476       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.713776e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764193721       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764193720       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764193721       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764193804       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764194187       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764193722       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764193725       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764193718       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 4.284446e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764193721       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764193720       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764193721       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764192943       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764193721       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764193836       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764192899       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764195232       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.071112e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.508027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6172e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771998e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8762
    reference variance = 0.28869
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.0000e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110936438
                                         uncertainty =       0.004215771097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110936438
                                         uncertainty =       0.004215771097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411203629
  error estimate for blocks of size 2^( 2) =       0.000423618107
  error estimate for blocks of size 2^( 3) =       0.000436547353
  error estimate for blocks of size 2^( 4) =       0.000447966393
  error estimate for blocks of size 2^( 5) =       0.000459326215
  error estimate for blocks of size 2^( 6) =       0.000468075746
  error estimate for blocks of size 2^( 7) =       0.000472572130

      target function =                  N/A
              le_mean =     -16.906591861527
             les_mean =     286.171025052772
             stat err =       0.000461985121
             autocorr =       1.262240465286
              std dev =       0.581529749556
             le_variance =       0.338176849619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110937976
                                         uncertainty =       0.004215771135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110937976
                                         uncertainty =       0.004215771135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411203630
  error estimate for blocks of size 2^( 2) =       0.000423618108
  error estimate for blocks of size 2^( 3) =       0.000436547353
  error estimate for blocks of size 2^( 4) =       0.000447966394
  error estimate for blocks of size 2^( 5) =       0.000459326216
  error estimate for blocks of size 2^( 6) =       0.000468075746
  error estimate for blocks of size 2^( 7) =       0.000472572130

      target function =                  N/A
              le_mean =     -16.906591861528
             les_mean =     286.171025054352
             stat err =       0.000461985122
             autocorr =       1.262240463661
              std dev =       0.581529750879
             le_variance =       0.338176851157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110937207
                                         uncertainty =       0.004215771116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110937207
                                         uncertainty =       0.004215771116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411203630
  error estimate for blocks of size 2^( 2) =       0.000423618107
  error estimate for blocks of size 2^( 3) =       0.000436547353
  error estimate for blocks of size 2^( 4) =       0.000447966394
  error estimate for blocks of size 2^( 5) =       0.000459326216
  error estimate for blocks of size 2^( 6) =       0.000468075746
  error estimate for blocks of size 2^( 7) =       0.000472572130

      target function =                  N/A
              le_mean =     -16.906591861527
             les_mean =     286.171025053562
             stat err =       0.000461985121
             autocorr =       1.262240464484
              std dev =       0.581529750218
             le_variance =       0.338176850388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110936535
                                         uncertainty =       0.004215771100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110936535
                                         uncertainty =       0.004215771100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411203629
  error estimate for blocks of size 2^( 2) =       0.000423618107
  error estimate for blocks of size 2^( 3) =       0.000436547353
  error estimate for blocks of size 2^( 4) =       0.000447966393
  error estimate for blocks of size 2^( 5) =       0.000459326215
  error estimate for blocks of size 2^( 6) =       0.000468075746
  error estimate for blocks of size 2^( 7) =       0.000472572130

      target function =                  N/A
              le_mean =     -16.906591861527
             les_mean =     286.171025052870
             stat err =       0.000461985121
             autocorr =       1.262240465188
              std dev =       0.581529749639
             le_variance =       0.338176849715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906591861527        initial
     2.2737e+05     2.2737e+06             1.7138e-09       -16.906591861528  <--
     9.0949e+05     9.0949e+06             4.2844e-10       -16.906591861527
     3.6380e+06     3.6380e+07             1.0711e-10       -16.906591861527

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 2.9813e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771999e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9034
    reference variance = 0.221184
====================================================
  Execution time = 2.0655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3550e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335522488359
                                         uncertainty =       0.003439776519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335522488359
                                         uncertainty =       0.003439776519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409573563
  error estimate for blocks of size 2^( 2) =       0.000422512385
  error estimate for blocks of size 2^( 3) =       0.000435672274
  error estimate for blocks of size 2^( 4) =       0.000447960116
  error estimate for blocks of size 2^( 5) =       0.000458402988
  error estimate for blocks of size 2^( 6) =       0.000466561391
  error estimate for blocks of size 2^( 7) =       0.000473046744

      target function =                  N/A
              le_mean =     -16.906620407924
             les_mean =     286.169314457118
             stat err =       0.000461492810
             autocorr =       1.269597459702
              std dev =       0.579224487780
             le_variance =       0.335501007244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690662040792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620407924       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620407930       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906620407928       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906620407925       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906620407932       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906620407857       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906620407922       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906620407942       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+04 is 5.203223e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620407924       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620407925       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906620407925       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906620407847       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906620407697       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906620407663       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906620407773       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906620407862       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.300807e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620407924       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620407924       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906620407924       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906620408455       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906620407652       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906620407969       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906620408117       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906620407905       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 3.252017e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.510627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6294e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771999e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944043e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.331049
====================================================
  Execution time = 2.0191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7569e-01
  Total weights = 2.0000e+06
  Execution time = 1.9020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265076
                                         uncertainty =       0.038789542695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265076
                                         uncertainty =       0.038789542695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433412705
  error estimate for blocks of size 2^( 2) =       0.000445736746
  error estimate for blocks of size 2^( 3) =       0.000458717930
  error estimate for blocks of size 2^( 4) =       0.000470942536
  error estimate for blocks of size 2^( 5) =       0.000481351428
  error estimate for blocks of size 2^( 6) =       0.000488790064
  error estimate for blocks of size 2^( 7) =       0.000494689049

      target function =                  N/A
              le_mean =     -16.906407447150
             les_mean =     286.202305726472
             stat err =       0.000483943269
             autocorr =       1.246767958934
              std dev =       0.612938125166
             le_variance =       0.375693145282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265742
                                         uncertainty =       0.038789542497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265742
                                         uncertainty =       0.038789542497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433412705
  error estimate for blocks of size 2^( 2) =       0.000445736747
  error estimate for blocks of size 2^( 3) =       0.000458717930
  error estimate for blocks of size 2^( 4) =       0.000470942536
  error estimate for blocks of size 2^( 5) =       0.000481351428
  error estimate for blocks of size 2^( 6) =       0.000488790064
  error estimate for blocks of size 2^( 7) =       0.000494689049

      target function =                  N/A
              le_mean =     -16.906407447137
             les_mean =     286.202305726726
             stat err =       0.000483943270
             autocorr =       1.246767957759
              std dev =       0.612938125710
             le_variance =       0.375693145948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265409
                                         uncertainty =       0.038789542596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265409
                                         uncertainty =       0.038789542596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433412705
  error estimate for blocks of size 2^( 2) =       0.000445736746
  error estimate for blocks of size 2^( 3) =       0.000458717930
  error estimate for blocks of size 2^( 4) =       0.000470942536
  error estimate for blocks of size 2^( 5) =       0.000481351428
  error estimate for blocks of size 2^( 6) =       0.000488790064
  error estimate for blocks of size 2^( 7) =       0.000494689049

      target function =                  N/A
              le_mean =     -16.906407447144
             les_mean =     286.202305726599
             stat err =       0.000483943269
             autocorr =       1.246767958353
              std dev =       0.612938125438
             le_variance =       0.375693145615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265118
                                         uncertainty =       0.038789542683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375836265118
                                         uncertainty =       0.038789542683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433412705
  error estimate for blocks of size 2^( 2) =       0.000445736746
  error estimate for blocks of size 2^( 3) =       0.000458717930
  error estimate for blocks of size 2^( 4) =       0.000470942536
  error estimate for blocks of size 2^( 5) =       0.000481351428
  error estimate for blocks of size 2^( 6) =       0.000488790064
  error estimate for blocks of size 2^( 7) =       0.000494689049

      target function =                  N/A
              le_mean =     -16.906407447149
             les_mean =     286.202305726488
             stat err =       0.000483943269
             autocorr =       1.246767958864
              std dev =       0.612938125200
             le_variance =       0.375693145323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906407447150        initial  <--
     5.6843e+04     5.6843e+05             5.2032e-09       -16.906407447137
     2.2737e+05     2.2737e+06             1.3008e-09       -16.906407447144
     9.0949e+05     9.0949e+06             3.2520e-10       -16.906407447149

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7733
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771999e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6073e+01 secs
  Total Execution time = 2.2521e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
