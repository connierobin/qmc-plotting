--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0268.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 79070 MB
Rank =    1  Free Memory = 79069 MB
Rank =    2  Free Memory = 79069 MB
Rank =    3  Free Memory = 79069 MB
Rank =    4  Free Memory = 79067 MB
Rank =    5  Free Memory = 79067 MB
Rank =    6  Free Memory = 79067 MB
Rank =    7  Free Memory = 79067 MB
Rank =    8  Free Memory = 79067 MB
Rank =    9  Free Memory = 79067 MB
Rank =   10  Free Memory = 79067 MB
Rank =   11  Free Memory = 79067 MB
Rank =   12  Free Memory = 79067 MB
Rank =   13  Free Memory = 79066 MB
Rank =   14  Free Memory = 79065 MB
Rank =   15  Free Memory = 79065 MB
Rank =   16  Free Memory = 79055 MB
Rank =   17  Free Memory = 79054 MB
Rank =   18  Free Memory = 79054 MB
Rank =   19  Free Memory = 79054 MB
Rank =   20  Free Memory = 79054 MB
Rank =   21  Free Memory = 79054 MB
Rank =   22  Free Memory = 79054 MB
Rank =   23  Free Memory = 79054 MB
Rank =   24  Free Memory = 79054 MB
Rank =   25  Free Memory = 79053 MB
Rank =   26  Free Memory = 79053 MB
Rank =   27  Free Memory = 79053 MB
Rank =   28  Free Memory = 79053 MB
Rank =   29  Free Memory = 79053 MB
Rank =   30  Free Memory = 79053 MB
Rank =   31  Free Memory = 79053 MB
Rank =   32  Free Memory = 64713 MB
Rank =   33  Free Memory = 64713 MB
Rank =   34  Free Memory = 64713 MB
Rank =   35  Free Memory = 64713 MB
Rank =   36  Free Memory = 64713 MB
Rank =   37  Free Memory = 64713 MB
Rank =   38  Free Memory = 64713 MB
Rank =   39  Free Memory = 64713 MB
Rank =   40  Free Memory = 64713 MB
Rank =   41  Free Memory = 64713 MB
Rank =   42  Free Memory = 64713 MB
Rank =   43  Free Memory = 64713 MB
Rank =   44  Free Memory = 64713 MB
Rank =   45  Free Memory = 64713 MB
Rank =   46  Free Memory = 64713 MB
Rank =   47  Free Memory = 64713 MB
Rank =   48  Free Memory = 64713 MB
Rank =   49  Free Memory = 64713 MB
Rank =   50  Free Memory = 64713 MB
Rank =   51  Free Memory = 64713 MB
Rank =   52  Free Memory = 64713 MB
Rank =   53  Free Memory = 64713 MB
Rank =   54  Free Memory = 64713 MB
Rank =   55  Free Memory = 64713 MB
Rank =   56  Free Memory = 64713 MB
Rank =   57  Free Memory = 64713 MB
Rank =   58  Free Memory = 64713 MB
Rank =   59  Free Memory = 64713 MB
Rank =   60  Free Memory = 64713 MB
Rank =   61  Free Memory = 64713 MB
Rank =   62  Free Memory = 64713 MB
Rank =   63  Free Memory = 64713 MB
Rank =   64  Free Memory = 64713 MB
Rank =   65  Free Memory = 64713 MB
Rank =   66  Free Memory = 64713 MB
Rank =   67  Free Memory = 64713 MB
Rank =   68  Free Memory = 64713 MB
Rank =   69  Free Memory = 64713 MB
Rank =   70  Free Memory = 64713 MB
Rank =   71  Free Memory = 64713 MB
Rank =   72  Free Memory = 64867 MB
Rank =   73  Free Memory = 64867 MB
Rank =   74  Free Memory = 64867 MB
Rank =   75  Free Memory = 64866 MB
Rank =   76  Free Memory = 64865 MB
Rank =   77  Free Memory = 64865 MB
Rank =   78  Free Memory = 64865 MB
Rank =   79  Free Memory = 64865 MB
Rank =   80  Free Memory = 64865 MB
Rank =   81  Free Memory = 64865 MB
Rank =   82  Free Memory = 64865 MB
Rank =   83  Free Memory = 64865 MB
Rank =   84  Free Memory = 64865 MB
Rank =   85  Free Memory = 64865 MB
Rank =   86  Free Memory = 64865 MB
Rank =   87  Free Memory = 64865 MB
Rank =   88  Free Memory = 64865 MB
Rank =   89  Free Memory = 64865 MB
Rank =   90  Free Memory = 64865 MB
Rank =   91  Free Memory = 64865 MB
Rank =   92  Free Memory = 64865 MB
Rank =   93  Free Memory = 64865 MB
Rank =   94  Free Memory = 64865 MB
Rank =   95  Free Memory = 64865 MB
Rank =   96  Free Memory = 64865 MB
Rank =   97  Free Memory = 64865 MB
Rank =   98  Free Memory = 64865 MB
Rank =   99  Free Memory = 64865 MB
Rank =  100  Free Memory = 64865 MB
Rank =  101  Free Memory = 64865 MB
Rank =  102  Free Memory = 64865 MB
Rank =  103  Free Memory = 64865 MB
Rank =  104  Free Memory = 64865 MB
Rank =  105  Free Memory = 64865 MB
Rank =  106  Free Memory = 64865 MB
Rank =  107  Free Memory = 64865 MB
Rank =  108  Free Memory = 64865 MB
Rank =  109  Free Memory = 64865 MB
Rank =  110  Free Memory = 64865 MB
Rank =  111  Free Memory = 64865 MB
Rank =  112  Free Memory = 68587 MB
Rank =  113  Free Memory = 68587 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001r.xml 
Rank =  114  Free Memory = 68587 MB
Rank =  115  Free Memory = 68587 MB
Rank =  116  Free Memory = 68587 MB
Rank =  117  Free Memory = 68587 MB
Rank =  118  Free Memory = 68587 MB
Rank =  119  Free Memory = 68587 MB
Rank =  120  Free Memory = 68587 MB
Rank =  121  Free Memory = 68587 MB
Rank =  122  Free Memory = 68587 MB
Rank =  123  Free Memory = 68587 MB
Rank =  124  Free Memory = 68587 MB
Rank =  127  Free Memory = 68587 MB
Rank =  125  Free Memory = 68587 MB
Rank =  126  Free Memory = 68587 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001r.xml

  Project = H2O
  date    = 2023-04-17 23:39:42 PDT
  host    = n0055.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 814

  Range of prime numbers to use as seeds over processors and threads = 6271-7457


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.103505e-01    1         1  ON     0
     uu_1                 1.432609e-01    1         1  ON     1
     uu_2                 4.137992e-02    1         1  ON     2
     uu_3                -2.102788e-02    1         1  ON     3
     uu_4                -6.676604e-02    1         1  ON     4
     uu_5                -1.019659e-01    1         1  ON     5
     uu_6                -1.295694e-01    1         1  ON     6
     uu_7                -1.431245e-01    1         1  ON     7
     uu_8                -1.351720e-01    1         1  ON     8
     uu_9                -1.060858e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.504063e-01    1         1  ON     0
     ud_1                 1.843537e-01    1         1  ON     1
     ud_2                 6.354533e-02    1         1  ON     2
     ud_3                -7.955052e-03    1         1  ON     3
     ud_4                -6.563399e-02    1         1  ON     4
     ud_5                -1.075375e-01    1         1  ON     5
     ud_6                -1.354407e-01    1         1  ON     6
     ud_7                -1.521925e-01    1         1  ON     7
     ud_8                -1.535926e-01    1         1  ON     8
     ud_9                -1.444189e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.598300e-01    1         1  ON     0
     eO_1                -4.379499e-01    1         1  ON     1
     eO_2                -2.110143e-02    1         1  ON     2
     eO_3                 2.980713e-01    1         1  ON     3
     eO_4                 5.258982e-01    1         1  ON     4
     eO_5                 4.888713e-01    1         1  ON     5
     eO_6                 2.613538e-01    1         1  ON     6
     eO_7                -4.046136e-02    1         1  ON     7
     eO_8                -2.236402e-01    1         1  ON     8
     eO_9                -8.931766e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.502085e-01    1         1  ON     0
     eH1_1                -1.472675e-01    1         1  ON     1
     eH1_2                -9.917042e-02    1         1  ON     2
     eH1_3                -4.464273e-02    1         1  ON     3
     eH1_4                 3.800025e-03    1         1  ON     4
     eH1_5                 3.765690e-02    1         1  ON     5
     eH1_6                 9.658255e-02    1         1  ON     6
     eH1_7                 1.544625e-01    1         1  ON     7
     eH1_8                 1.803104e-01    1         1  ON     8
     eH1_9                 7.208129e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.480641e-01    1         1  ON     0
     eH2_1                -1.453845e-01    1         1  ON     1
     eH2_2                -9.707090e-02    1         1  ON     2
     eH2_3                -4.256877e-02    1         1  ON     3
     eH2_4                 6.411296e-03    1         1  ON     4
     eH2_5                 4.075263e-02    1         1  ON     5
     eH2_6                 9.934589e-02    1         1  ON     6
     eH2_7                 1.556450e-01    1         1  ON     7
     eH2_8                 1.850802e-01    1         1  ON     8
     eH2_9                 6.204301e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.507785e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4754e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0055.savio3:70561] 95 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0055.savio3:70561] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 0.190647
====================================================
  Execution time = 3.7207e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3360e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333668941777
                                         uncertainty =       0.002615034658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333668941777
                                         uncertainty =       0.002615034658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408411033
  error estimate for blocks of size 2^( 2) =       0.000420997779
  error estimate for blocks of size 2^( 3) =       0.000434128420
  error estimate for blocks of size 2^( 4) =       0.000445401222
  error estimate for blocks of size 2^( 5) =       0.000454864235
  error estimate for blocks of size 2^( 6) =       0.000461936330
  error estimate for blocks of size 2^( 7) =       0.000468646698

      target function =                  N/A
              le_mean =     -16.906835679518
             les_mean =     286.174691671318
             stat err =       0.000457712121
             autocorr =       1.256000741910
              std dev =       0.577580422002
             le_variance =       0.333599143880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690683567952e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906835679518       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836171593       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906836358946       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906837474908       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906837638296       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906838171096       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906838508634       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906838510435       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906838704675       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906838547265       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.070951e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906835679518       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906835858006       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906836000349       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906836289482       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906836229027       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906836469273       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906836568447       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906836554179       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906836566343       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.654244e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906835679518       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906835729809       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906835782412       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906835850073       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906835819854       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906835893322       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906835921721       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906835920243       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.959254e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7525e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.103838e-01                 1 1 ON  0
uu_1  1.433407e-01                 1 1 ON  1
uu_2  4.147675e-02                 1 1 ON  2
uu_3  -2.107651e-02                1 1 ON  3
uu_4  -6.676221e-02                1 1 ON  4
uu_5  -1.019758e-01                1 1 ON  5
uu_6  -1.296041e-01                1 1 ON  6
uu_7  -1.431744e-01                1 1 ON  7
uu_8  -1.353550e-01                1 1 ON  8
uu_9  -1.061771e-01                1 1 ON  9
ud_0  4.503800e-01                 1 1 ON  10
ud_1  1.843322e-01                 1 1 ON  11
ud_2  6.363194e-02                 1 1 ON  12
ud_3  -7.944618e-03                1 1 ON  13
ud_4  -6.553991e-02                1 1 ON  14
ud_5  -1.075253e-01                1 1 ON  15
ud_6  -1.355130e-01                1 1 ON  16
ud_7  -1.521921e-01                1 1 ON  17
ud_8  -1.535466e-01                1 1 ON  18
ud_9  -1.444431e-01                1 1 ON  19
eO_0  -7.597516e-01                1 1 ON  20
eO_1  -4.378080e-01                1 1 ON  21
eO_2  -2.107968e-02                1 1 ON  22
eO_3  2.980185e-01                 1 1 ON  23
eO_4  5.258014e-01                 1 1 ON  24
eO_5  4.889691e-01                 1 1 ON  25
eO_6  2.614413e-01                 1 1 ON  26
eO_7  -4.046920e-02                1 1 ON  27
eO_8  -2.237529e-01                1 1 ON  28
eO_9  -8.945071e-02                1 1 ON  29
eH1_0 -2.504202e-01                1 1 ON  30
eH1_1 -1.474287e-01                1 1 ON  31
eH1_2 -9.917419e-02                1 1 ON  32
eH1_3 -4.466966e-02                1 1 ON  33
eH1_4 3.752363e-03                 1 1 ON  34
eH1_5 3.776611e-02                 1 1 ON  35
eH1_6 9.661224e-02                 1 1 ON  36
eH1_7 1.544622e-01                 1 1 ON  37
eH1_8 1.804217e-01                 1 1 ON  38
eH1_9 7.225752e-02                 1 1 ON  39
eH2_0 -2.483295e-01                1 1 ON  40
eH2_1 -1.454364e-01                1 1 ON  41
eH2_2 -9.709968e-02                1 1 ON  42
eH2_3 -4.256371e-02                1 1 ON  43
eH2_4 6.458982e-03                 1 1 ON  44
eH2_5 4.073639e-02                 1 1 ON  45
eH2_6 9.936887e-02                 1 1 ON  46
eH2_7 1.556381e-01                 1 1 ON  47
eH2_8 1.851680e-01                 1 1 ON  48
eH2_9 6.222753e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9352
    reference variance = 0.237627
====================================================
  Execution time = 3.5907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4139e-01
  Total weights = 2.0000e+06
  Execution time = 3.3725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396375351
                                         uncertainty =       0.005451247572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341396375351
                                         uncertainty =       0.005451247572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413208946
  error estimate for blocks of size 2^( 2) =       0.000426354488
  error estimate for blocks of size 2^( 3) =       0.000439657832
  error estimate for blocks of size 2^( 4) =       0.000452827133
  error estimate for blocks of size 2^( 5) =       0.000464448503
  error estimate for blocks of size 2^( 6) =       0.000475165163
  error estimate for blocks of size 2^( 7) =       0.000483046237

      target function =                  N/A
              le_mean =     -16.906100682650
             les_mean =     286.157723387982
             stat err =       0.000468871759
             autocorr =       1.287563681273
              std dev =       0.584365696140
             le_variance =       0.341483266825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341214736953
                                         uncertainty =       0.005449757345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341214736953
                                         uncertainty =       0.005449757345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413098947
  error estimate for blocks of size 2^( 2) =       0.000426244659
  error estimate for blocks of size 2^( 3) =       0.000439551243
  error estimate for blocks of size 2^( 4) =       0.000452724219
  error estimate for blocks of size 2^( 5) =       0.000464345909
  error estimate for blocks of size 2^( 6) =       0.000475070246
  error estimate for blocks of size 2^( 7) =       0.000482959333

      target function =                  N/A
              le_mean =     -16.906101849871
             les_mean =     286.157581067974
             stat err =       0.000468774927
             autocorr =       1.287717426509
              std dev =       0.584210133795
             le_variance =       0.341301480429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341216522481
                                         uncertainty =       0.005450755732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341216522481
                                         uncertainty =       0.005450755732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413099995
  error estimate for blocks of size 2^( 2) =       0.000426247714
  error estimate for blocks of size 2^( 3) =       0.000439555631
  error estimate for blocks of size 2^( 4) =       0.000452729206
  error estimate for blocks of size 2^( 5) =       0.000464351343
  error estimate for blocks of size 2^( 6) =       0.000475073605
  error estimate for blocks of size 2^( 7) =       0.000482958359

      target function =                  N/A
              le_mean =     -16.906100599340
             les_mean =     286.157540516593
             stat err =       0.000468778128
             autocorr =       1.287728481135
              std dev =       0.584211615976
             le_variance =       0.341303212242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341366733808
                                         uncertainty =       0.005451220306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341366733808
                                         uncertainty =       0.005451220306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413190989
  error estimate for blocks of size 2^( 2) =       0.000426336940
  error estimate for blocks of size 2^( 3) =       0.000439641055
  error estimate for blocks of size 2^( 4) =       0.000452811032
  error estimate for blocks of size 2^( 5) =       0.000464432515
  error estimate for blocks of size 2^( 6) =       0.000475150026
  error estimate for blocks of size 2^( 7) =       0.000483031358

      target function =                  N/A
              le_mean =     -16.906100528033
             les_mean =     286.157688480123
             stat err =       0.000468856233
             autocorr =       1.287590320942
              std dev =       0.584340300584
             le_variance =       0.341453586887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906100682650        initial
     2.5000e-01     2.5000e+00             9.0710e-04       -16.906101849871  <--
     1.0000e+00     1.0000e+01             2.6542e-04       -16.906100599340
     4.0000e+00     4.0000e+01             6.9593e-05       -16.906100528033

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.2877e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.105366e-01 1 1  ON 0
 uu_1                 1.435155e-01 1 1  ON 1
 uu_2                 4.164221e-02 1 1  ON 2
 uu_3                -2.107924e-02 1 1  ON 3
 uu_4                -6.677321e-02 1 1  ON 4
 uu_5                -1.020040e-01 1 1  ON 5
 uu_6                -1.297287e-01 1 1  ON 6
 uu_7                -1.433210e-01 1 1  ON 7
 uu_8                -1.358503e-01 1 1  ON 8
 uu_9                -1.064431e-01 1 1  ON 9
 ud_0                 4.503883e-01 1 1  ON 10
 ud_1                 1.843514e-01 1 1  ON 11
 ud_2                 6.374433e-02 1 1  ON 12
 ud_3                -7.844515e-03 1 1  ON 13
 ud_4                -6.537929e-02 1 1  ON 14
 ud_5                -1.074879e-01 1 1  ON 15
 ud_6                -1.356501e-01 1 1  ON 16
 ud_7                -1.522190e-01 1 1  ON 17
 ud_8                -1.534421e-01 1 1  ON 18
 ud_9                -1.445145e-01 1 1  ON 19
 eO_0                -7.594950e-01 1 1  ON 20
 eO_1                -4.374881e-01 1 1  ON 21
 eO_2                -2.094746e-02 1 1  ON 22
 eO_3                 2.978559e-01 1 1  ON 23
 eO_4                 5.255636e-01 1 1  ON 24
 eO_5                 4.892182e-01 1 1  ON 25
 eO_6                 2.616830e-01 1 1  ON 26
 eO_7                -4.048962e-02 1 1  ON 27
 eO_8                -2.240773e-01 1 1  ON 28
 eO_9                -8.983510e-02 1 1  ON 29
eH1_0                -2.509918e-01 1 1  ON 30
eH1_1                -1.477708e-01 1 1  ON 31
eH1_2                -9.930804e-02 1 1  ON 32
eH1_3                -4.476221e-02 1 1  ON 33
eH1_4                 3.629852e-03 1 1  ON 34
eH1_5                 3.802926e-02 1 1  ON 35
eH1_6                 9.670577e-02 1 1  ON 36
eH1_7                 1.544683e-01 1 1  ON 37
eH1_8                 1.807423e-01 1 1  ON 38
eH1_9                 7.276443e-02 1 1  ON 39
eH2_0                -2.489712e-01 1 1  ON 40
eH2_1                -1.455920e-01 1 1  ON 41
eH2_2                -9.721515e-02 1 1  ON 42
eH2_3                -4.258106e-02 1 1  ON 43
eH2_4                 6.528592e-03 1 1  ON 44
eH2_5                 4.072874e-02 1 1  ON 45
eH2_6                 9.942534e-02 1 1  ON 46
eH2_7                 1.556080e-01 1 1  ON 47
eH2_8                 1.854173e-01 1 1  ON 48
eH2_9                 6.275886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0041e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8293
    reference variance = 0.187953
====================================================
  Execution time = 3.8982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0037e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338548216161
                                         uncertainty =       0.003810853568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338548216161
                                         uncertainty =       0.003810853568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411368826
  error estimate for blocks of size 2^( 2) =       0.000423849139
  error estimate for blocks of size 2^( 3) =       0.000436877012
  error estimate for blocks of size 2^( 4) =       0.000449276136
  error estimate for blocks of size 2^( 5) =       0.000460185736
  error estimate for blocks of size 2^( 6) =       0.000468292337
  error estimate for blocks of size 2^( 7) =       0.000473369519

      target function =                  N/A
              le_mean =     -16.905938902388
             les_mean =     286.149218623674
             stat err =       0.000462780932
             autocorr =       1.265575790750
              std dev =       0.581763372539
             le_variance =       0.338448621628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593890239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905938902388       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941014545       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905944218265       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905944673404       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943407828       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905944665469       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905947364135       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905947519306       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905946453798       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905948178410       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905947605326       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905948170345       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905948076061       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.593115e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905938902388       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905940172438       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941741664       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942532021       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941328573       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941280017       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905942313440       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905942203474       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905941886480       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905942133814       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905942111026       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.733026e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905938902388       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905939391851       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905939984706       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940427267       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905939750924       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905939833473       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905939873539       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905939866399       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905939865211       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.748411e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9033e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.102133e-01 1 1  ON 0
 uu_1                 1.434733e-01 1 1  ON 1
 uu_2                 4.169199e-02 1 1  ON 2
 uu_3                -2.107285e-02 1 1  ON 3
 uu_4                -6.687480e-02 1 1  ON 4
 uu_5                -1.023347e-01 1 1  ON 5
 uu_6                -1.298046e-01 1 1  ON 6
 uu_7                -1.434872e-01 1 1  ON 7
 uu_8                -1.359192e-01 1 1  ON 8
 uu_9                -1.062601e-01 1 1  ON 9
 ud_0                 4.505628e-01 1 1  ON 10
 ud_1                 1.844347e-01 1 1  ON 11
 ud_2                 6.355888e-02 1 1  ON 12
 ud_3                -8.004728e-03 1 1  ON 13
 ud_4                -6.537152e-02 1 1  ON 14
 ud_5                -1.074946e-01 1 1  ON 15
 ud_6                -1.354677e-01 1 1  ON 16
 ud_7                -1.524101e-01 1 1  ON 17
 ud_8                -1.532308e-01 1 1  ON 18
 ud_9                -1.442958e-01 1 1  ON 19
 eO_0                -7.590080e-01 1 1  ON 20
 eO_1                -4.375511e-01 1 1  ON 21
 eO_2                -2.090877e-02 1 1  ON 22
 eO_3                 2.976613e-01 1 1  ON 23
 eO_4                 5.255215e-01 1 1  ON 24
 eO_5                 4.892381e-01 1 1  ON 25
 eO_6                 2.618350e-01 1 1  ON 26
 eO_7                -4.020215e-02 1 1  ON 27
 eO_8                -2.242872e-01 1 1  ON 28
 eO_9                -9.024558e-02 1 1  ON 29
eH1_0                -2.519651e-01 1 1  ON 30
eH1_1                -1.482185e-01 1 1  ON 31
eH1_2                -9.955644e-02 1 1  ON 32
eH1_3                -4.507431e-02 1 1  ON 33
eH1_4                 3.704314e-03 1 1  ON 34
eH1_5                 3.824484e-02 1 1  ON 35
eH1_6                 9.672894e-02 1 1  ON 36
eH1_7                 1.546419e-01 1 1  ON 37
eH1_8                 1.813008e-01 1 1  ON 38
eH1_9                 7.353323e-02 1 1  ON 39
eH2_0                -2.493900e-01 1 1  ON 40
eH2_1                -1.459995e-01 1 1  ON 41
eH2_2                -9.747361e-02 1 1  ON 42
eH2_3                -4.265007e-02 1 1  ON 43
eH2_4                 6.281460e-03 1 1  ON 44
eH2_5                 4.059888e-02 1 1  ON 45
eH2_6                 9.941343e-02 1 1  ON 46
eH2_7                 1.557921e-01 1 1  ON 47
eH2_8                 1.858591e-01 1 1  ON 48
eH2_9                 6.366362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.218684
====================================================
  Execution time = 3.6014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4407e-01
  Total weights = 2.0000e+06
  Execution time = 3.3770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344013339820
                                         uncertainty =       0.007702023276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344013339820
                                         uncertainty =       0.007702023276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414723661
  error estimate for blocks of size 2^( 2) =       0.000427654119
  error estimate for blocks of size 2^( 3) =       0.000440360876
  error estimate for blocks of size 2^( 4) =       0.000452296221
  error estimate for blocks of size 2^( 5) =       0.000462069427
  error estimate for blocks of size 2^( 6) =       0.000470526436
  error estimate for blocks of size 2^( 7) =       0.000473667076

      target function =                  N/A
              le_mean =     -16.906446682955
             les_mean =     286.171930701842
             stat err =       0.000464639790
             autocorr =       1.255206469953
              std dev =       0.586507826238
             le_variance =       0.343991430238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344054074212
                                         uncertainty =       0.007709343729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344054074212
                                         uncertainty =       0.007709343729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414748329
  error estimate for blocks of size 2^( 2) =       0.000427675690
  error estimate for blocks of size 2^( 3) =       0.000440377293
  error estimate for blocks of size 2^( 4) =       0.000452308552
  error estimate for blocks of size 2^( 5) =       0.000462085327
  error estimate for blocks of size 2^( 6) =       0.000470540016
  error estimate for blocks of size 2^( 7) =       0.000473684513

      target function =                  N/A
              le_mean =     -16.906445560762
             les_mean =     286.171933679172
             stat err =       0.000464654602
             autocorr =       1.255137185913
              std dev =       0.586542711286
             le_variance =       0.344032352162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344173628439
                                         uncertainty =       0.007714153380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344173628439
                                         uncertainty =       0.007714153380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414820435
  error estimate for blocks of size 2^( 2) =       0.000427741693
  error estimate for blocks of size 2^( 3) =       0.000440435822
  error estimate for blocks of size 2^( 4) =       0.000452360912
  error estimate for blocks of size 2^( 5) =       0.000462138005
  error estimate for blocks of size 2^( 6) =       0.000470589992
  error estimate for blocks of size 2^( 7) =       0.000473736835

      target function =                  N/A
              le_mean =     -16.906446671192
             les_mean =     286.172090860780
             stat err =       0.000464706436
             autocorr =       1.254980822780
              std dev =       0.586644685478
             le_variance =       0.344151986999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344049323455
                                         uncertainty =       0.007704821264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344049323455
                                         uncertainty =       0.007704821264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414745393
  error estimate for blocks of size 2^( 2) =       0.000427673292
  error estimate for blocks of size 2^( 3) =       0.000440376639
  error estimate for blocks of size 2^( 4) =       0.000452308970
  error estimate for blocks of size 2^( 5) =       0.000462083046
  error estimate for blocks of size 2^( 6) =       0.000470538186
  error estimate for blocks of size 2^( 7) =       0.000473680753

      target function =                  N/A
              le_mean =     -16.906446296886
             les_mean =     286.171953700055
             stat err =       0.000464652739
             autocorr =       1.255144886686
              std dev =       0.586538560192
             le_variance =       0.344027482592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906446682955        initial  <--
     6.2500e-02     6.2500e-01             3.5931e-03       -16.906445560762
     2.5000e-01     2.5000e+00             9.7330e-04       -16.906446671192
     1.0000e+00     1.0000e+01             2.7484e-04       -16.906446296886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9731
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.105366e-01 1 1  ON 0
 uu_1                 1.435155e-01 1 1  ON 1
 uu_2                 4.164221e-02 1 1  ON 2
 uu_3                -2.107924e-02 1 1  ON 3
 uu_4                -6.677321e-02 1 1  ON 4
 uu_5                -1.020040e-01 1 1  ON 5
 uu_6                -1.297287e-01 1 1  ON 6
 uu_7                -1.433210e-01 1 1  ON 7
 uu_8                -1.358503e-01 1 1  ON 8
 uu_9                -1.064431e-01 1 1  ON 9
 ud_0                 4.503883e-01 1 1  ON 10
 ud_1                 1.843514e-01 1 1  ON 11
 ud_2                 6.374433e-02 1 1  ON 12
 ud_3                -7.844515e-03 1 1  ON 13
 ud_4                -6.537929e-02 1 1  ON 14
 ud_5                -1.074879e-01 1 1  ON 15
 ud_6                -1.356501e-01 1 1  ON 16
 ud_7                -1.522190e-01 1 1  ON 17
 ud_8                -1.534421e-01 1 1  ON 18
 ud_9                -1.445145e-01 1 1  ON 19
 eO_0                -7.594950e-01 1 1  ON 20
 eO_1                -4.374881e-01 1 1  ON 21
 eO_2                -2.094746e-02 1 1  ON 22
 eO_3                 2.978559e-01 1 1  ON 23
 eO_4                 5.255636e-01 1 1  ON 24
 eO_5                 4.892182e-01 1 1  ON 25
 eO_6                 2.616830e-01 1 1  ON 26
 eO_7                -4.048962e-02 1 1  ON 27
 eO_8                -2.240773e-01 1 1  ON 28
 eO_9                -8.983510e-02 1 1  ON 29
eH1_0                -2.509918e-01 1 1  ON 30
eH1_1                -1.477708e-01 1 1  ON 31
eH1_2                -9.930804e-02 1 1  ON 32
eH1_3                -4.476221e-02 1 1  ON 33
eH1_4                 3.629852e-03 1 1  ON 34
eH1_5                 3.802926e-02 1 1  ON 35
eH1_6                 9.670577e-02 1 1  ON 36
eH1_7                 1.544683e-01 1 1  ON 37
eH1_8                 1.807423e-01 1 1  ON 38
eH1_9                 7.276443e-02 1 1  ON 39
eH2_0                -2.489712e-01 1 1  ON 40
eH2_1                -1.455920e-01 1 1  ON 41
eH2_2                -9.721515e-02 1 1  ON 42
eH2_3                -4.258106e-02 1 1  ON 43
eH2_4                 6.528592e-03 1 1  ON 44
eH2_5                 4.072874e-02 1 1  ON 45
eH2_6                 9.942534e-02 1 1  ON 46
eH2_7                 1.556080e-01 1 1  ON 47
eH2_8                 1.854173e-01 1 1  ON 48
eH2_9                 6.275886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0202e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9058
    reference variance = 0.188754
====================================================
  Execution time = 3.7228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4419e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0053e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344267161597
                                         uncertainty =       0.009284283325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344267161597
                                         uncertainty =       0.009284283325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414842836
  error estimate for blocks of size 2^( 2) =       0.000427588133
  error estimate for blocks of size 2^( 3) =       0.000440720950
  error estimate for blocks of size 2^( 4) =       0.000453226820
  error estimate for blocks of size 2^( 5) =       0.000464381107
  error estimate for blocks of size 2^( 6) =       0.000472442475
  error estimate for blocks of size 2^( 7) =       0.000478090034

      target function =                  N/A
              le_mean =     -16.905986434559
             les_mean =     286.156566310094
             stat err =       0.000467035109
             autocorr =       1.267453019809
              std dev =       0.586676364541
             le_variance =       0.344189156711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598643456e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905986434559       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986381402       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905986617671       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905986025782       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905985901246       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905986321545       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905986257507       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905986305899       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905986293905       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.570820e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905986434559       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986417923       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905986518674       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905986361886       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905986275368       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905986372841       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905986373921       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905986375808       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.204374e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905986434559       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986430120       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905986459253       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905986419982       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905986394897       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905986418319       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905986419865       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905986419741       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.051208e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7291e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.105675e-01 1 1  ON 0
 uu_1                 1.435012e-01 1 1  ON 1
 uu_2                 4.165072e-02 1 1  ON 2
 uu_3                -2.106616e-02 1 1  ON 3
 uu_4                -6.677726e-02 1 1  ON 4
 uu_5                -1.020022e-01 1 1  ON 5
 uu_6                -1.297318e-01 1 1  ON 6
 uu_7                -1.433614e-01 1 1  ON 7
 uu_8                -1.358844e-01 1 1  ON 8
 uu_9                -1.064634e-01 1 1  ON 9
 ud_0                 4.503879e-01 1 1  ON 10
 ud_1                 1.843969e-01 1 1  ON 11
 ud_2                 6.372959e-02 1 1  ON 12
 ud_3                -7.869054e-03 1 1  ON 13
 ud_4                -6.541027e-02 1 1  ON 14
 ud_5                -1.074720e-01 1 1  ON 15
 ud_6                -1.356442e-01 1 1  ON 16
 ud_7                -1.522382e-01 1 1  ON 17
 ud_8                -1.534479e-01 1 1  ON 18
 ud_9                -1.444696e-01 1 1  ON 19
 eO_0                -7.594475e-01 1 1  ON 20
 eO_1                -4.375132e-01 1 1  ON 21
 eO_2                -2.094026e-02 1 1  ON 22
 eO_3                 2.979032e-01 1 1  ON 23
 eO_4                 5.255708e-01 1 1  ON 24
 eO_5                 4.892070e-01 1 1  ON 25
 eO_6                 2.616915e-01 1 1  ON 26
 eO_7                -4.046927e-02 1 1  ON 27
 eO_8                -2.241262e-01 1 1  ON 28
 eO_9                -8.988028e-02 1 1  ON 29
eH1_0                -2.510750e-01 1 1  ON 30
eH1_1                -1.478032e-01 1 1  ON 31
eH1_2                -9.934827e-02 1 1  ON 32
eH1_3                -4.478041e-02 1 1  ON 33
eH1_4                 3.675034e-03 1 1  ON 34
eH1_5                 3.803827e-02 1 1  ON 35
eH1_6                 9.669862e-02 1 1  ON 36
eH1_7                 1.544738e-01 1 1  ON 37
eH1_8                 1.807984e-01 1 1  ON 38
eH1_9                 7.282556e-02 1 1  ON 39
eH2_0                -2.490916e-01 1 1  ON 40
eH2_1                -1.456522e-01 1 1  ON 41
eH2_2                -9.718456e-02 1 1  ON 42
eH2_3                -4.254015e-02 1 1  ON 43
eH2_4                 6.523458e-03 1 1  ON 44
eH2_5                 4.070288e-02 1 1  ON 45
eH2_6                 9.943497e-02 1 1  ON 46
eH2_7                 1.556318e-01 1 1  ON 47
eH2_8                 1.854498e-01 1 1  ON 48
eH2_9                 6.282599e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9445
    reference variance = 0.243126
====================================================
  Execution time = 3.6150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5664e-01
  Total weights = 2.0000e+06
  Execution time = 3.3780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356700555685
                                         uncertainty =       0.018934647418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356700555685
                                         uncertainty =       0.018934647418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422293464
  error estimate for blocks of size 2^( 2) =       0.000434787072
  error estimate for blocks of size 2^( 3) =       0.000447581379
  error estimate for blocks of size 2^( 4) =       0.000459627904
  error estimate for blocks of size 2^( 5) =       0.000471723739
  error estimate for blocks of size 2^( 6) =       0.000481178502
  error estimate for blocks of size 2^( 7) =       0.000490026990

      target function =                  N/A
              le_mean =     -16.905495211820
             les_mean =     286.152431717698
             stat err =       0.000475639284
             autocorr =       1.268605861732
              std dev =       0.597213143827
             le_variance =       0.356663539160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356667604868
                                         uncertainty =       0.018934937889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356667604868
                                         uncertainty =       0.018934937889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422273962
  error estimate for blocks of size 2^( 2) =       0.000434767845
  error estimate for blocks of size 2^( 3) =       0.000447563275
  error estimate for blocks of size 2^( 4) =       0.000459611280
  error estimate for blocks of size 2^( 5) =       0.000471708346
  error estimate for blocks of size 2^( 6) =       0.000481162662
  error estimate for blocks of size 2^( 7) =       0.000490015518

      target function =                  N/A
              le_mean =     -16.905494822458
             les_mean =     286.152385612305
             stat err =       0.000475624452
             autocorr =       1.268643912538
              std dev =       0.597185564529
             le_variance =       0.356630598482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356663268547
                                         uncertainty =       0.018934785378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356663268547
                                         uncertainty =       0.018934785378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422271401
  error estimate for blocks of size 2^( 2) =       0.000434765663
  error estimate for blocks of size 2^( 3) =       0.000447561021
  error estimate for blocks of size 2^( 4) =       0.000459608868
  error estimate for blocks of size 2^( 5) =       0.000471705748
  error estimate for blocks of size 2^( 6) =       0.000481160006
  error estimate for blocks of size 2^( 7) =       0.000490011749

      target function =                  N/A
              le_mean =     -16.905495064868
             les_mean =     286.152389481595
             stat err =       0.000475621593
             autocorr =       1.268644053701
              std dev =       0.597181941827
             le_variance =       0.356626271645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356694786843
                                         uncertainty =       0.018934663787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356694786843
                                         uncertainty =       0.018934663787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422290051
  error estimate for blocks of size 2^( 2) =       0.000434783752
  error estimate for blocks of size 2^( 3) =       0.000447578210
  error estimate for blocks of size 2^( 4) =       0.000459624928
  error estimate for blocks of size 2^( 5) =       0.000471720915
  error estimate for blocks of size 2^( 6) =       0.000481175598
  error estimate for blocks of size 2^( 7) =       0.000490024533

      target function =                  N/A
              le_mean =     -16.905495190356
             les_mean =     286.152425226578
             stat err =       0.000475636493
             autocorr =       1.268611483873
              std dev =       0.597208316893
             le_variance =       0.356657773766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905495211820        initial  <--
     6.2500e-01     6.2500e+00             4.5708e-04       -16.905494822458
     2.5000e+00     2.5000e+01             1.2044e-04       -16.905495064868
     1.0000e+01     1.0000e+02             3.0512e-05       -16.905495190356

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1187
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.105366e-01 1 1  ON 0
 uu_1                 1.435155e-01 1 1  ON 1
 uu_2                 4.164221e-02 1 1  ON 2
 uu_3                -2.107924e-02 1 1  ON 3
 uu_4                -6.677321e-02 1 1  ON 4
 uu_5                -1.020040e-01 1 1  ON 5
 uu_6                -1.297287e-01 1 1  ON 6
 uu_7                -1.433210e-01 1 1  ON 7
 uu_8                -1.358503e-01 1 1  ON 8
 uu_9                -1.064431e-01 1 1  ON 9
 ud_0                 4.503883e-01 1 1  ON 10
 ud_1                 1.843514e-01 1 1  ON 11
 ud_2                 6.374433e-02 1 1  ON 12
 ud_3                -7.844515e-03 1 1  ON 13
 ud_4                -6.537929e-02 1 1  ON 14
 ud_5                -1.074879e-01 1 1  ON 15
 ud_6                -1.356501e-01 1 1  ON 16
 ud_7                -1.522190e-01 1 1  ON 17
 ud_8                -1.534421e-01 1 1  ON 18
 ud_9                -1.445145e-01 1 1  ON 19
 eO_0                -7.594950e-01 1 1  ON 20
 eO_1                -4.374881e-01 1 1  ON 21
 eO_2                -2.094746e-02 1 1  ON 22
 eO_3                 2.978559e-01 1 1  ON 23
 eO_4                 5.255636e-01 1 1  ON 24
 eO_5                 4.892182e-01 1 1  ON 25
 eO_6                 2.616830e-01 1 1  ON 26
 eO_7                -4.048962e-02 1 1  ON 27
 eO_8                -2.240773e-01 1 1  ON 28
 eO_9                -8.983510e-02 1 1  ON 29
eH1_0                -2.509918e-01 1 1  ON 30
eH1_1                -1.477708e-01 1 1  ON 31
eH1_2                -9.930804e-02 1 1  ON 32
eH1_3                -4.476221e-02 1 1  ON 33
eH1_4                 3.629852e-03 1 1  ON 34
eH1_5                 3.802926e-02 1 1  ON 35
eH1_6                 9.670577e-02 1 1  ON 36
eH1_7                 1.544683e-01 1 1  ON 37
eH1_8                 1.807423e-01 1 1  ON 38
eH1_9                 7.276443e-02 1 1  ON 39
eH2_0                -2.489712e-01 1 1  ON 40
eH2_1                -1.455920e-01 1 1  ON 41
eH2_2                -9.721515e-02 1 1  ON 42
eH2_3                -4.258106e-02 1 1  ON 43
eH2_4                 6.528592e-03 1 1  ON 44
eH2_5                 4.072874e-02 1 1  ON 45
eH2_6                 9.942534e-02 1 1  ON 46
eH2_7                 1.556080e-01 1 1  ON 47
eH2_8                 1.854173e-01 1 1  ON 48
eH2_9                 6.275886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.205829
====================================================
  Execution time = 3.6851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4298e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0100e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343062611040
                                         uncertainty =       0.004362059932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343062611040
                                         uncertainty =       0.004362059932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414113287
  error estimate for blocks of size 2^( 2) =       0.000427020804
  error estimate for blocks of size 2^( 3) =       0.000441031736
  error estimate for blocks of size 2^( 4) =       0.000454754690
  error estimate for blocks of size 2^( 5) =       0.000466469501
  error estimate for blocks of size 2^( 6) =       0.000476240697
  error estimate for blocks of size 2^( 7) =       0.000482252378

      target function =                  N/A
              le_mean =     -16.905469786546
             les_mean =     286.137888161953
             stat err =       0.000469929317
             autocorr =       1.287735735706
              std dev =       0.585644627404
             le_variance =       0.342979629607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690546978655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905469786546       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905469858173       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469931885       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905470008134       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469965441       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469963875       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469967923       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469987841       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.624739e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905469786546       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905469804917       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469824070       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905469843739       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469832346       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469831384       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469832997       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469838094       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.065803e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905469786546       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905469791169       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469796006       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905469800963       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469798071       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469797790       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469798233       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469799515       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.266561e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6961e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.105400e-01 1 1  ON 0
 uu_1                 1.435160e-01 1 1  ON 1
 uu_2                 4.164098e-02 1 1  ON 2
 uu_3                -2.107891e-02 1 1  ON 3
 uu_4                -6.677767e-02 1 1  ON 4
 uu_5                -1.020072e-01 1 1  ON 5
 uu_6                -1.297278e-01 1 1  ON 6
 uu_7                -1.433276e-01 1 1  ON 7
 uu_8                -1.358482e-01 1 1  ON 8
 uu_9                -1.064422e-01 1 1  ON 9
 ud_0                 4.503908e-01 1 1  ON 10
 ud_1                 1.843529e-01 1 1  ON 11
 ud_2                 6.373963e-02 1 1  ON 12
 ud_3                -7.846190e-03 1 1  ON 13
 ud_4                -6.538038e-02 1 1  ON 14
 ud_5                -1.074915e-01 1 1  ON 15
 ud_6                -1.356499e-01 1 1  ON 16
 ud_7                -1.522215e-01 1 1  ON 17
 ud_8                -1.534376e-01 1 1  ON 18
 ud_9                -1.445089e-01 1 1  ON 19
 eO_0                -7.594872e-01 1 1  ON 20
 eO_1                -4.374916e-01 1 1  ON 21
 eO_2                -2.094946e-02 1 1  ON 22
 eO_3                 2.978541e-01 1 1  ON 23
 eO_4                 5.255664e-01 1 1  ON 24
 eO_5                 4.892187e-01 1 1  ON 25
 eO_6                 2.616845e-01 1 1  ON 26
 eO_7                -4.048783e-02 1 1  ON 27
 eO_8                -2.240796e-01 1 1  ON 28
 eO_9                -8.983885e-02 1 1  ON 29
eH1_0                -2.510009e-01 1 1  ON 30
eH1_1                -1.477779e-01 1 1  ON 31
eH1_2                -9.931117e-02 1 1  ON 32
eH1_3                -4.476110e-02 1 1  ON 33
eH1_4                 3.635017e-03 1 1  ON 34
eH1_5                 3.802578e-02 1 1  ON 35
eH1_6                 9.670675e-02 1 1  ON 36
eH1_7                 1.544700e-01 1 1  ON 37
eH1_8                 1.807475e-01 1 1  ON 38
eH1_9                 7.277247e-02 1 1  ON 39
eH2_0                -2.489793e-01 1 1  ON 40
eH2_1                -1.455884e-01 1 1  ON 41
eH2_2                -9.721965e-02 1 1  ON 42
eH2_3                -4.258270e-02 1 1  ON 43
eH2_4                 6.524715e-03 1 1  ON 44
eH2_5                 4.072596e-02 1 1  ON 45
eH2_6                 9.942379e-02 1 1  ON 46
eH2_7                 1.556110e-01 1 1  ON 47
eH2_8                 1.854227e-01 1 1  ON 48
eH2_9                 6.276760e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8458
    reference variance = 0.382716
====================================================
  Execution time = 3.5917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3747e-01
  Total weights = 2.0000e+06
  Execution time = 3.3702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337544677951
                                         uncertainty =       0.005295109682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337544677951
                                         uncertainty =       0.005295109682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410771603
  error estimate for blocks of size 2^( 2) =       0.000422849946
  error estimate for blocks of size 2^( 3) =       0.000436191604
  error estimate for blocks of size 2^( 4) =       0.000447884417
  error estimate for blocks of size 2^( 5) =       0.000458359579
  error estimate for blocks of size 2^( 6) =       0.000463654037
  error estimate for blocks of size 2^( 7) =       0.000470108362

      target function =                  N/A
              le_mean =     -16.906399374063
             les_mean =     286.163806245782
             stat err =       0.000460001599
             autocorr =       1.254058676043
              std dev =       0.580918771601
             le_variance =       0.337466619199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337563015153
                                         uncertainty =       0.005294930525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337563015153
                                         uncertainty =       0.005294930525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410782759
  error estimate for blocks of size 2^( 2) =       0.000422860407
  error estimate for blocks of size 2^( 3) =       0.000436201360
  error estimate for blocks of size 2^( 4) =       0.000447893816
  error estimate for blocks of size 2^( 5) =       0.000458367849
  error estimate for blocks of size 2^( 6) =       0.000463661828
  error estimate for blocks of size 2^( 7) =       0.000470115952

      target function =                  N/A
              le_mean =     -16.906399679730
             les_mean =     286.163834912698
             stat err =       0.000460009861
             autocorr =       1.254035606908
              std dev =       0.580934549374
             le_variance =       0.337484950656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554288000
                                         uncertainty =       0.005295023777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554288000
                                         uncertainty =       0.005295023777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410777450
  error estimate for blocks of size 2^( 2) =       0.000422855423
  error estimate for blocks of size 2^( 3) =       0.000436196706
  error estimate for blocks of size 2^( 4) =       0.000447889333
  error estimate for blocks of size 2^( 5) =       0.000458363902
  error estimate for blocks of size 2^( 6) =       0.000463658097
  error estimate for blocks of size 2^( 7) =       0.000470112319

      target function =                  N/A
              le_mean =     -16.906399530237
             les_mean =     286.163821133473
             stat err =       0.000460005913
             autocorr =       1.254046498627
              std dev =       0.580927040350
             le_variance =       0.337476226210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337545893037
                                         uncertainty =       0.005295099073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337545893037
                                         uncertainty =       0.005295099073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410772342
  error estimate for blocks of size 2^( 2) =       0.000422850638
  error estimate for blocks of size 2^( 3) =       0.000436192249
  error estimate for blocks of size 2^( 4) =       0.000447885038
  error estimate for blocks of size 2^( 5) =       0.000458360125
  error estimate for blocks of size 2^( 6) =       0.000463654549
  error estimate for blocks of size 2^( 7) =       0.000470108862

      target function =                  N/A
              le_mean =     -16.906399393560
             les_mean =     286.163808119743
             stat err =       0.000460002143
             autocorr =       1.254057131892
              std dev =       0.580919817100
             le_variance =       0.337467833899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906399374063        initial
     6.2500e+00     6.2500e+01             3.6247e-05       -16.906399679730  <--
     2.5000e+01     2.5000e+02             9.0658e-06       -16.906399530237
     1.0000e+02     1.0000e+03             2.2666e-06       -16.906399393560

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 5.2875e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9845e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8315
    reference variance = 0.185235
====================================================
  Execution time = 3.9222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3668e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336342013088
                                         uncertainty =       0.003970331087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336342013088
                                         uncertainty =       0.003970331087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410289893
  error estimate for blocks of size 2^( 2) =       0.000423149603
  error estimate for blocks of size 2^( 3) =       0.000435985437
  error estimate for blocks of size 2^( 4) =       0.000448349078
  error estimate for blocks of size 2^( 5) =       0.000459335240
  error estimate for blocks of size 2^( 6) =       0.000466995435
  error estimate for blocks of size 2^( 7) =       0.000471955565

      target function =                  N/A
              le_mean =     -16.906172240320
             les_mean =     286.155335244249
             stat err =       0.000461658829
             autocorr =       1.266078557588
              std dev =       0.580237531735
             le_variance =       0.336675593234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617224032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172240320       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172818678       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906173319499       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906173370202       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906173765018       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906173876971       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906173970976       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906173914815       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906173923828       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.566718e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172240320       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172400259       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172539176       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906172554956       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906172664812       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906172697754       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906172716492       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906172706649       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.980607e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172240320       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172281395       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172317146       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906172321354       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906172349674       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906172358517       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906172362822       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906172360666       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.000415e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9164e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.105581e-01 1 1  ON 0
 uu_1                 1.435206e-01 1 1  ON 1
 uu_2                 4.164437e-02 1 1  ON 2
 uu_3                -2.106741e-02 1 1  ON 3
 uu_4                -6.678671e-02 1 1  ON 4
 uu_5                -1.020181e-01 1 1  ON 5
 uu_6                -1.297179e-01 1 1  ON 6
 uu_7                -1.433567e-01 1 1  ON 7
 uu_8                -1.358734e-01 1 1  ON 8
 uu_9                -1.064571e-01 1 1  ON 9
 ud_0                 4.504048e-01 1 1  ON 10
 ud_1                 1.843814e-01 1 1  ON 11
 ud_2                 6.371970e-02 1 1  ON 12
 ud_3                -7.852115e-03 1 1  ON 13
 ud_4                -6.537385e-02 1 1  ON 14
 ud_5                -1.074981e-01 1 1  ON 15
 ud_6                -1.356223e-01 1 1  ON 16
 ud_7                -1.522584e-01 1 1  ON 17
 ud_8                -1.534523e-01 1 1  ON 18
 ud_9                -1.444912e-01 1 1  ON 19
 eO_0                -7.594364e-01 1 1  ON 20
 eO_1                -4.374905e-01 1 1  ON 21
 eO_2                -2.095000e-02 1 1  ON 22
 eO_3                 2.978361e-01 1 1  ON 23
 eO_4                 5.255695e-01 1 1  ON 24
 eO_5                 4.892142e-01 1 1  ON 25
 eO_6                 2.617114e-01 1 1  ON 26
 eO_7                -4.047710e-02 1 1  ON 27
 eO_8                -2.241095e-01 1 1  ON 28
 eO_9                -8.987183e-02 1 1  ON 29
eH1_0                -2.510679e-01 1 1  ON 30
eH1_1                -1.478172e-01 1 1  ON 31
eH1_2                -9.933456e-02 1 1  ON 32
eH1_3                -4.475480e-02 1 1  ON 33
eH1_4                 3.678818e-03 1 1  ON 34
eH1_5                 3.801015e-02 1 1  ON 35
eH1_6                 9.669855e-02 1 1  ON 36
eH1_7                 1.544727e-01 1 1  ON 37
eH1_8                 1.807876e-01 1 1  ON 38
eH1_9                 7.282672e-02 1 1  ON 39
eH2_0                -2.490279e-01 1 1  ON 40
eH2_1                -1.456031e-01 1 1  ON 41
eH2_2                -9.724057e-02 1 1  ON 42
eH2_3                -4.258342e-02 1 1  ON 43
eH2_4                 6.493566e-03 1 1  ON 44
eH2_5                 4.073982e-02 1 1  ON 45
eH2_6                 9.942710e-02 1 1  ON 46
eH2_7                 1.556193e-01 1 1  ON 47
eH2_8                 1.854535e-01 1 1  ON 48
eH2_9                 6.281956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0061
    reference variance = 0.294281
====================================================
  Execution time = 3.6156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4188e-01
  Total weights = 2.0000e+06
  Execution time = 3.3748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341882227804
                                         uncertainty =       0.004424407186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341882227804
                                         uncertainty =       0.004424407186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413451448
  error estimate for blocks of size 2^( 2) =       0.000426095353
  error estimate for blocks of size 2^( 3) =       0.000438577709
  error estimate for blocks of size 2^( 4) =       0.000449948814
  error estimate for blocks of size 2^( 5) =       0.000460756483
  error estimate for blocks of size 2^( 6) =       0.000468673801
  error estimate for blocks of size 2^( 7) =       0.000475524392

      target function =                  N/A
              le_mean =     -16.906527881127
             les_mean =     286.172569023908
             stat err =       0.000463725873
             autocorr =       1.257979662615
              std dev =       0.584708644977
             le_variance =       0.341884199511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341888844081
                                         uncertainty =       0.004425451865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341888844081
                                         uncertainty =       0.004425451865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413455432
  error estimate for blocks of size 2^( 2) =       0.000426097317
  error estimate for blocks of size 2^( 3) =       0.000438577500
  error estimate for blocks of size 2^( 4) =       0.000449947661
  error estimate for blocks of size 2^( 5) =       0.000460754061
  error estimate for blocks of size 2^( 6) =       0.000468670712
  error estimate for blocks of size 2^( 7) =       0.000475523726

      target function =                  N/A
              le_mean =     -16.906527222951
             les_mean =     286.172553357461
             stat err =       0.000463724040
             autocorr =       1.257945476986
              std dev =       0.584714278960
             le_variance =       0.341890788020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341881417239
                                         uncertainty =       0.004424987436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341881417239
                                         uncertainty =       0.004424987436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413450948
  error estimate for blocks of size 2^( 2) =       0.000426093894
  error estimate for blocks of size 2^( 3) =       0.000438575118
  error estimate for blocks of size 2^( 4) =       0.000449945827
  error estimate for blocks of size 2^( 5) =       0.000460752845
  error estimate for blocks of size 2^( 6) =       0.000468669763
  error estimate for blocks of size 2^( 7) =       0.000475521685

      target function =                  N/A
              le_mean =     -16.906527485157
             les_mean =     286.172554808885
             stat err =       0.000463722530
             autocorr =       1.257964565560
              std dev =       0.584707938584
             le_variance =       0.341883373443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341882035194
                                         uncertainty =       0.004424484844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341882035194
                                         uncertainty =       0.004424484844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413451330
  error estimate for blocks of size 2^( 2) =       0.000426095113
  error estimate for blocks of size 2^( 3) =       0.000438577323
  error estimate for blocks of size 2^( 4) =       0.000449948382
  error estimate for blocks of size 2^( 5) =       0.000460755966
  error estimate for blocks of size 2^( 6) =       0.000468673232
  error estimate for blocks of size 2^( 7) =       0.000475523986

      target function =                  N/A
              le_mean =     -16.906527825889
             les_mean =     286.172566961475
             stat err =       0.000463725391
             autocorr =       1.257977767623
              std dev =       0.584708478529
             le_variance =       0.341884004864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906527881127        initial  <--
     1.5625e+00     1.5625e+01             1.5667e-04       -16.906527222951
     6.2500e+00     6.2500e+01             3.9806e-05       -16.906527485157
     2.5000e+01     2.5000e+02             1.0004e-05       -16.906527825889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2585
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0243e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8776
    reference variance = 0.239859
====================================================
  Execution time = 3.7038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3997e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339926181462
                                         uncertainty =       0.003876648379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339926181462
                                         uncertainty =       0.003876648379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412289945
  error estimate for blocks of size 2^( 2) =       0.000425320065
  error estimate for blocks of size 2^( 3) =       0.000438032521
  error estimate for blocks of size 2^( 4) =       0.000450453219
  error estimate for blocks of size 2^( 5) =       0.000461166284
  error estimate for blocks of size 2^( 6) =       0.000469734375
  error estimate for blocks of size 2^( 7) =       0.000477423362

      target function =                  N/A
              le_mean =     -16.905391678526
             les_mean =     286.132233631348
             stat err =       0.000464694310
             autocorr =       1.270367059744
              std dev =       0.583066031385
             le_variance =       0.339965996955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539167853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905391678526       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905391672565       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905391677849       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905391695528       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905391716736       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905391716184       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905391720919       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905391718024       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.318291e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905391678526       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905391677023       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905391678391       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905391682928       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905391688358       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905391688299       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905391689340       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905391688634       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.298463e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905391678526       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905391678149       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905391678495       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905391679636       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905391681002       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905391680992       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905391681244       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905391681068       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.247895e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7016e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.105510e-01 1 1  ON 0
 uu_1                 1.435162e-01 1 1  ON 1
 uu_2                 4.163708e-02 1 1  ON 2
 uu_3                -2.107852e-02 1 1  ON 3
 uu_4                -6.679116e-02 1 1  ON 4
 uu_5                -1.020168e-01 1 1  ON 5
 uu_6                -1.297281e-01 1 1  ON 6
 uu_7                -1.433480e-01 1 1  ON 7
 uu_8                -1.358409e-01 1 1  ON 8
 uu_9                -1.064387e-01 1 1  ON 9
 ud_0                 4.503980e-01 1 1  ON 10
 ud_1                 1.843578e-01 1 1  ON 11
 ud_2                 6.372531e-02 1 1  ON 12
 ud_3                -7.851117e-03 1 1  ON 13
 ud_4                -6.538601e-02 1 1  ON 14
 ud_5                -1.075023e-01 1 1  ON 15
 ud_6                -1.356482e-01 1 1  ON 16
 ud_7                -1.522295e-01 1 1  ON 17
 ud_8                -1.534237e-01 1 1  ON 18
 ud_9                -1.444913e-01 1 1  ON 19
 eO_0                -7.594623e-01 1 1  ON 20
 eO_1                -4.375031e-01 1 1  ON 21
 eO_2                -2.095455e-02 1 1  ON 22
 eO_3                 2.978484e-01 1 1  ON 23
 eO_4                 5.255757e-01 1 1  ON 24
 eO_5                 4.892197e-01 1 1  ON 25
 eO_6                 2.616896e-01 1 1  ON 26
 eO_7                -4.048194e-02 1 1  ON 27
 eO_8                -2.240872e-01 1 1  ON 28
 eO_9                -8.985176e-02 1 1  ON 29
eH1_0                -2.510308e-01 1 1  ON 30
eH1_1                -1.477988e-01 1 1  ON 31
eH1_2                -9.932183e-02 1 1  ON 32
eH1_3                -4.475961e-02 1 1  ON 33
eH1_4                 3.651412e-03 1 1  ON 34
eH1_5                 3.801569e-02 1 1  ON 35
eH1_6                 9.670790e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807661e-01 1 1  ON 38
eH1_9                 7.279928e-02 1 1  ON 39
eH2_0                -2.490055e-01 1 1  ON 40
eH2_1                -1.455797e-01 1 1  ON 41
eH2_2                -9.723470e-02 1 1  ON 42
eH2_3                -4.258914e-02 1 1  ON 43
eH2_4                 6.511284e-03 1 1  ON 44
eH2_5                 4.071888e-02 1 1  ON 45
eH2_6                 9.942057e-02 1 1  ON 46
eH2_7                 1.556207e-01 1 1  ON 47
eH2_8                 1.854406e-01 1 1  ON 48
eH2_9                 6.279697e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.406029
====================================================
  Execution time = 3.6248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4277e-01
  Total weights = 2.0000e+06
  Execution time = 3.3760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342848598536
                                         uncertainty =       0.008621333166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342848598536
                                         uncertainty =       0.008621333166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413988193
  error estimate for blocks of size 2^( 2) =       0.000426369231
  error estimate for blocks of size 2^( 3) =       0.000439644762
  error estimate for blocks of size 2^( 4) =       0.000452138775
  error estimate for blocks of size 2^( 5) =       0.000463295545
  error estimate for blocks of size 2^( 6) =       0.000471613007
  error estimate for blocks of size 2^( 7) =       0.000478308568

      target function =                  N/A
              le_mean =     -16.906301891952
             les_mean =     286.165815938674
             stat err =       0.000466338974
             autocorr =       1.268900342975
              std dev =       0.585467717506
             le_variance =       0.342772448242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342852319552
                                         uncertainty =       0.008621487157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342852319552
                                         uncertainty =       0.008621487157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413990436
  error estimate for blocks of size 2^( 2) =       0.000426371299
  error estimate for blocks of size 2^( 3) =       0.000439646821
  error estimate for blocks of size 2^( 4) =       0.000452140804
  error estimate for blocks of size 2^( 5) =       0.000463297374
  error estimate for blocks of size 2^( 6) =       0.000471614878
  error estimate for blocks of size 2^( 7) =       0.000478310364

      target function =                  N/A
              le_mean =     -16.906301844803
             les_mean =     286.165818058057
             stat err =       0.000466340855
             autocorr =       1.268896832038
              std dev =       0.585470888990
             le_variance =       0.342776161854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342850479727
                                         uncertainty =       0.008621411717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342850479727
                                         uncertainty =       0.008621411717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413989327
  error estimate for blocks of size 2^( 2) =       0.000426370275
  error estimate for blocks of size 2^( 3) =       0.000439645802
  error estimate for blocks of size 2^( 4) =       0.000452139801
  error estimate for blocks of size 2^( 5) =       0.000463296469
  error estimate for blocks of size 2^( 6) =       0.000471613954
  error estimate for blocks of size 2^( 7) =       0.000478309478

      target function =                  N/A
              le_mean =     -16.906301867257
             les_mean =     286.165816981077
             stat err =       0.000466339926
             autocorr =       1.268898572059
              std dev =       0.585469320843
             le_variance =       0.342774325648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342848834233
                                         uncertainty =       0.008621343035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342848834233
                                         uncertainty =       0.008621343035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413988335
  error estimate for blocks of size 2^( 2) =       0.000426369362
  error estimate for blocks of size 2^( 3) =       0.000439644892
  error estimate for blocks of size 2^( 4) =       0.000452138904
  error estimate for blocks of size 2^( 5) =       0.000463295661
  error estimate for blocks of size 2^( 6) =       0.000471613126
  error estimate for blocks of size 2^( 7) =       0.000478308682

      target function =                  N/A
              le_mean =     -16.906301888816
             les_mean =     286.165816067852
             stat err =       0.000466339093
             autocorr =       1.268900121147
              std dev =       0.585467918390
             le_variance =       0.342772683464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906301891952        initial  <--
     1.5625e+01     1.5625e+02             1.3183e-05       -16.906301844803
     6.2500e+01     6.2500e+02             3.2985e-06       -16.906301867257
     2.5000e+02     2.5000e+03             8.2479e-07       -16.906301888816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1914
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0022e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.20481
====================================================
  Execution time = 3.6979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4370e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0028e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343761143169
                                         uncertainty =       0.005305748691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343761143169
                                         uncertainty =       0.005305748691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414545518
  error estimate for blocks of size 2^( 2) =       0.000427265065
  error estimate for blocks of size 2^( 3) =       0.000440590383
  error estimate for blocks of size 2^( 4) =       0.000452561802
  error estimate for blocks of size 2^( 5) =       0.000462257708
  error estimate for blocks of size 2^( 6) =       0.000470236112
  error estimate for blocks of size 2^( 7) =       0.000474793199

      target function =                  N/A
              le_mean =     -16.906133046534
             les_mean =     286.161030388776
             stat err =       0.000464962205
             autocorr =       1.258029589847
              std dev =       0.586255894234
             le_variance =       0.343695973524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613304653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906133046534       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906133053429       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906133053252       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906133052614       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133053555       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906133053598       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906133054313       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906133053579       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.417764e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906133046534       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906133048259       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906133048215       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906133048055       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133048290       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906133048300       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906133048480       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906133048296       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.547143e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906133046534       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906133046965       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906133046954       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906133046915       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133046972       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906133046975       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906133047018       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906133046974       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 8.869570e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7017e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.105497e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163810e-02 1 1  ON 2
 uu_3                -2.107838e-02 1 1  ON 3
 uu_4                -6.679024e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297254e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358423e-01 1 1  ON 8
 uu_9                -1.064397e-01 1 1  ON 9
 ud_0                 4.503976e-01 1 1  ON 10
 ud_1                 1.843566e-01 1 1  ON 11
 ud_2                 6.372661e-02 1 1  ON 12
 ud_3                -7.851445e-03 1 1  ON 13
 ud_4                -6.538374e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356493e-01 1 1  ON 16
 ud_7                -1.522289e-01 1 1  ON 17
 ud_8                -1.534244e-01 1 1  ON 18
 ud_9                -1.444925e-01 1 1  ON 19
 eO_0                -7.594642e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095587e-02 1 1  ON 22
 eO_3                 2.978488e-01 1 1  ON 23
 eO_4                 5.255750e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616894e-01 1 1  ON 26
 eO_7                -4.048234e-02 1 1  ON 27
 eO_8                -2.240868e-01 1 1  ON 28
 eO_9                -8.985028e-02 1 1  ON 29
eH1_0                -2.510284e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932081e-02 1 1  ON 32
eH1_3                -4.475813e-02 1 1  ON 33
eH1_4                 3.650269e-03 1 1  ON 34
eH1_5                 3.801550e-02 1 1  ON 35
eH1_6                 9.670973e-02 1 1  ON 36
eH1_7                 1.544750e-01 1 1  ON 37
eH1_8                 1.807632e-01 1 1  ON 38
eH1_9                 7.279672e-02 1 1  ON 39
eH2_0                -2.490036e-01 1 1  ON 40
eH2_1                -1.455786e-01 1 1  ON 41
eH2_2                -9.723321e-02 1 1  ON 42
eH2_3                -4.258758e-02 1 1  ON 43
eH2_4                 6.513341e-03 1 1  ON 44
eH2_5                 4.071769e-02 1 1  ON 45
eH2_6                 9.941923e-02 1 1  ON 46
eH2_7                 1.556201e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279396e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.285753
====================================================
  Execution time = 3.6230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3997e-01
  Total weights = 2.0000e+06
  Execution time = 3.3769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020331333
                                         uncertainty =       0.004128581869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020331333
                                         uncertainty =       0.004128581869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412289868
  error estimate for blocks of size 2^( 2) =       0.000424769660
  error estimate for blocks of size 2^( 3) =       0.000438053540
  error estimate for blocks of size 2^( 4) =       0.000450265271
  error estimate for blocks of size 2^( 5) =       0.000460281727
  error estimate for blocks of size 2^( 6) =       0.000467798907
  error estimate for blocks of size 2^( 7) =       0.000475429893

      target function =                  N/A
              le_mean =     -16.906332828057
             les_mean =     286.164055393153
             stat err =       0.000463443950
             autocorr =       1.263540333424
              std dev =       0.583065922592
             le_variance =       0.339965870088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340019342228
                                         uncertainty =       0.004128575300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340019342228
                                         uncertainty =       0.004128575300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412289268
  error estimate for blocks of size 2^( 2) =       0.000424769077
  error estimate for blocks of size 2^( 3) =       0.000438052956
  error estimate for blocks of size 2^( 4) =       0.000450264697
  error estimate for blocks of size 2^( 5) =       0.000460281153
  error estimate for blocks of size 2^( 6) =       0.000467798322
  error estimate for blocks of size 2^( 7) =       0.000475429348

      target function =                  N/A
              le_mean =     -16.906332809646
             les_mean =     286.164053782170
             stat err =       0.000463443380
             autocorr =       1.263540901839
              std dev =       0.583065074966
             le_variance =       0.339964881646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340019835438
                                         uncertainty =       0.004128578576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340019835438
                                         uncertainty =       0.004128578576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412289567
  error estimate for blocks of size 2^( 2) =       0.000424769368
  error estimate for blocks of size 2^( 3) =       0.000438053247
  error estimate for blocks of size 2^( 4) =       0.000450264983
  error estimate for blocks of size 2^( 5) =       0.000460281440
  error estimate for blocks of size 2^( 6) =       0.000467798614
  error estimate for blocks of size 2^( 7) =       0.000475429620

      target function =                  N/A
              le_mean =     -16.906332818833
             les_mean =     286.164054585683
             stat err =       0.000463443664
             autocorr =       1.263540618633
              std dev =       0.583065497629
             le_variance =       0.339965374525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020269303
                                         uncertainty =       0.004128581457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020269303
                                         uncertainty =       0.004128581457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412289830
  error estimate for blocks of size 2^( 2) =       0.000424769624
  error estimate for blocks of size 2^( 3) =       0.000438053503
  error estimate for blocks of size 2^( 4) =       0.000450265235
  error estimate for blocks of size 2^( 5) =       0.000460281691
  error estimate for blocks of size 2^( 6) =       0.000467798870
  error estimate for blocks of size 2^( 7) =       0.000475429859

      target function =                  N/A
              le_mean =     -16.906332826903
             les_mean =     286.164055292150
             stat err =       0.000463443914
             autocorr =       1.263540369110
              std dev =       0.583065869434
             le_variance =       0.339965808099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906332828057        initial  <--
     1.5625e+02     1.5625e+03             1.4178e-06       -16.906332809646
     6.2500e+02     6.2500e+03             3.5471e-07       -16.906332818833
     2.5000e+03     2.5000e+04             8.8696e-08       -16.906332826903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2605
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0029e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8856
    reference variance = 0.224589
====================================================
  Execution time = 3.8667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3861e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0105e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338586512329
                                         uncertainty =       0.004236127024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338586512329
                                         uncertainty =       0.004236127024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411468763
  error estimate for blocks of size 2^( 2) =       0.000424526704
  error estimate for blocks of size 2^( 3) =       0.000437448321
  error estimate for blocks of size 2^( 4) =       0.000449967557
  error estimate for blocks of size 2^( 5) =       0.000460677915
  error estimate for blocks of size 2^( 6) =       0.000467446419
  error estimate for blocks of size 2^( 7) =       0.000471949722

      target function =                  N/A
              le_mean =     -16.905804948085
             les_mean =     286.144853858892
             stat err =       0.000462510403
             autocorr =       1.263482614184
              std dev =       0.581904704838
             le_variance =       0.338613085513


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580494808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905804948085       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905804947975       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905804947974       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905804947813       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905804947926       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905804947989       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905804947991       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905804948052       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.969494e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905804948085       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905804948057       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905804948057       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905804948017       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905804948045       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905804948061       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905804948061       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905804948075       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 4.923893e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905804948085       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905804948078       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905804948078       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905804948068       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905804948079       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905804948073       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905804948057       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905804948073       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.230983e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8782e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163780e-02 1 1  ON 2
 uu_3                -2.107831e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851388e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985005e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475802e-02 1 1  ON 33
eH1_4                 3.650250e-03 1 1  ON 34
eH1_5                 3.801547e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279650e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258756e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941917e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279371e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.251961
====================================================
  Execution time = 3.5885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4065e-01
  Total weights = 2.0000e+06
  Execution time = 3.3706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723469604
                                         uncertainty =       0.004861454897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723469604
                                         uncertainty =       0.004861454897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412702025
  error estimate for blocks of size 2^( 2) =       0.000425771759
  error estimate for blocks of size 2^( 3) =       0.000439621848
  error estimate for blocks of size 2^( 4) =       0.000451874898
  error estimate for blocks of size 2^( 5) =       0.000463045218
  error estimate for blocks of size 2^( 6) =       0.000471915080
  error estimate for blocks of size 2^( 7) =       0.000477017045

      target function =                  N/A
              le_mean =     -16.905450089393
             les_mean =     286.134888477603
             stat err =       0.000465963060
             autocorr =       1.274763962733
              std dev =       0.583648801039
             le_variance =       0.340645922954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723457489
                                         uncertainty =       0.004861455096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723457489
                                         uncertainty =       0.004861455096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412702018
  error estimate for blocks of size 2^( 2) =       0.000425771750
  error estimate for blocks of size 2^( 3) =       0.000439621838
  error estimate for blocks of size 2^( 4) =       0.000451874889
  error estimate for blocks of size 2^( 5) =       0.000463045207
  error estimate for blocks of size 2^( 6) =       0.000471915071
  error estimate for blocks of size 2^( 7) =       0.000477017035

      target function =                  N/A
              le_mean =     -16.905450088502
             les_mean =     286.134888435364
             stat err =       0.000465963050
             autocorr =       1.274763955176
              std dev =       0.583648790680
             le_variance =       0.340645910862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723463545
                                         uncertainty =       0.004861454996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723463545
                                         uncertainty =       0.004861454996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412702021
  error estimate for blocks of size 2^( 2) =       0.000425771755
  error estimate for blocks of size 2^( 3) =       0.000439621843
  error estimate for blocks of size 2^( 4) =       0.000451874893
  error estimate for blocks of size 2^( 5) =       0.000463045212
  error estimate for blocks of size 2^( 6) =       0.000471915075
  error estimate for blocks of size 2^( 7) =       0.000477017040

      target function =                  N/A
              le_mean =     -16.905450088947
             les_mean =     286.134888456477
             stat err =       0.000465963055
             autocorr =       1.274763958948
              std dev =       0.583648795858
             le_variance =       0.340645916907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723468846
                                         uncertainty =       0.004861454909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340723468846
                                         uncertainty =       0.004861454909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412702025
  error estimate for blocks of size 2^( 2) =       0.000425771758
  error estimate for blocks of size 2^( 3) =       0.000439621847
  error estimate for blocks of size 2^( 4) =       0.000451874897
  error estimate for blocks of size 2^( 5) =       0.000463045217
  error estimate for blocks of size 2^( 6) =       0.000471915079
  error estimate for blocks of size 2^( 7) =       0.000477017044

      target function =                  N/A
              le_mean =     -16.905450089338
             les_mean =     286.134888474962
             stat err =       0.000465963059
             autocorr =       1.274763962257
              std dev =       0.583648800391
             le_variance =       0.340645922198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905450089393        initial  <--
     1.5625e+03     1.5625e+04             1.9695e-07       -16.905450088502
     6.2500e+03     6.2500e+04             4.9239e-08       -16.905450088947
     2.5000e+04     2.5000e+05             1.2310e-08       -16.905450089338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.7884
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0158e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8507
    reference variance = 0.463437
====================================================
  Execution time = 3.6949e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4145e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0005e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338839826209
                                         uncertainty =       0.004135939218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338839826209
                                         uncertainty =       0.004135939218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413190360
  error estimate for blocks of size 2^( 2) =       0.000426193090
  error estimate for blocks of size 2^( 3) =       0.000439397269
  error estimate for blocks of size 2^( 4) =       0.000451710562
  error estimate for blocks of size 2^( 5) =       0.000460980227
  error estimate for blocks of size 2^( 6) =       0.000468458332
  error estimate for blocks of size 2^( 7) =       0.000474508296

      target function =                  N/A
              le_mean =     -16.905788313669
             les_mean =     286.147130883609
             stat err =       0.000463914354
             autocorr =       1.260594067226
              std dev =       0.584339411420
             le_variance =       0.341452547739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578831367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788313669       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788313725       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788313790       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788313873       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788313824       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788313799       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788313805       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788313795       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.707788e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788313669       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788313683       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788313700       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788313719       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788313721       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788313714       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788313686       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788313689       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 4.269480e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788313669       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788313673       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788313677       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788313772       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788313679       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788313729       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788313745       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788313591       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.067371e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.419369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6963e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851396e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650224e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513240e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.496836
====================================================
  Execution time = 3.5889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5495e-01
  Total weights = 2.0000e+06
  Execution time = 3.3655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035333438
                                         uncertainty =       0.014213443489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035333438
                                         uncertainty =       0.014213443489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421278993
  error estimate for blocks of size 2^( 2) =       0.000433494498
  error estimate for blocks of size 2^( 3) =       0.000446291332
  error estimate for blocks of size 2^( 4) =       0.000457853125
  error estimate for blocks of size 2^( 5) =       0.000468240832
  error estimate for blocks of size 2^( 6) =       0.000475078663
  error estimate for blocks of size 2^( 7) =       0.000479497274

      target function =                  N/A
              le_mean =     -16.905524951223
             les_mean =     286.151725679036
             stat err =       0.000470167474
             autocorr =       1.245562587934
              std dev =       0.595778465613
             le_variance =       0.354951980089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035323903
                                         uncertainty =       0.014213443407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035323903
                                         uncertainty =       0.014213443407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421278987
  error estimate for blocks of size 2^( 2) =       0.000433494492
  error estimate for blocks of size 2^( 3) =       0.000446291327
  error estimate for blocks of size 2^( 4) =       0.000457853120
  error estimate for blocks of size 2^( 5) =       0.000468240828
  error estimate for blocks of size 2^( 6) =       0.000475078659
  error estimate for blocks of size 2^( 7) =       0.000479497270

      target function =                  N/A
              le_mean =     -16.905524951157
             les_mean =     286.151725667279
             stat err =       0.000470167469
             autocorr =       1.245562595882
              std dev =       0.595778457613
             le_variance =       0.354951970556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035328671
                                         uncertainty =       0.014213443448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035328671
                                         uncertainty =       0.014213443448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421278990
  error estimate for blocks of size 2^( 2) =       0.000433494495
  error estimate for blocks of size 2^( 3) =       0.000446291329
  error estimate for blocks of size 2^( 4) =       0.000457853123
  error estimate for blocks of size 2^( 5) =       0.000468240830
  error estimate for blocks of size 2^( 6) =       0.000475078661
  error estimate for blocks of size 2^( 7) =       0.000479497272

      target function =                  N/A
              le_mean =     -16.905524951190
             les_mean =     286.151725673157
             stat err =       0.000470167471
             autocorr =       1.245562591900
              std dev =       0.595778461613
             le_variance =       0.354951975322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035332842
                                         uncertainty =       0.014213443484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355035332842
                                         uncertainty =       0.014213443484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421278993
  error estimate for blocks of size 2^( 2) =       0.000433494498
  error estimate for blocks of size 2^( 3) =       0.000446291332
  error estimate for blocks of size 2^( 4) =       0.000457853125
  error estimate for blocks of size 2^( 5) =       0.000468240832
  error estimate for blocks of size 2^( 6) =       0.000475078663
  error estimate for blocks of size 2^( 7) =       0.000479497274

      target function =                  N/A
              le_mean =     -16.905524951219
             les_mean =     286.151725678301
             stat err =       0.000470167474
             autocorr =       1.245562588429
              std dev =       0.595778465113
             le_variance =       0.354951979493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905524951223        initial  <--
     1.5625e+04     1.5625e+05             1.7078e-08       -16.905524951157
     6.2500e+04     6.2500e+05             4.2695e-09       -16.905524951190
     2.5000e+05     2.5000e+06             1.0674e-09       -16.905524951219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.7702
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9622
    reference variance = 0.200088
====================================================
  Execution time = 3.7014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.1413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.414256545501
                                         uncertainty =       0.075537418025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.414256545501
                                         uncertainty =       0.075537418025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000455041763
  error estimate for blocks of size 2^( 2) =       0.000466746190
  error estimate for blocks of size 2^( 3) =       0.000477727546
  error estimate for blocks of size 2^( 4) =       0.000488728610
  error estimate for blocks of size 2^( 5) =       0.000498590179
  error estimate for blocks of size 2^( 6) =       0.000507291931
  error estimate for blocks of size 2^( 7) =       0.000511621560

      target function =                  N/A
              le_mean =     -16.905788360072
             les_mean =     286.219805879998
             stat err =       0.000501558070
             autocorr =       1.214898317977
              std dev =       0.643526232192
             le_variance =       0.414126011519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578836007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788360072       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788360073       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788360077       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788360132       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788360075       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788360030       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788360053       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788360043       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.874825e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788360072       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788360072       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788360073       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788360074       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788360106       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788360068       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788360033       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788360073       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 4.687064e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788360072       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788360072       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905788360072       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788360072       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788360072       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905788362117       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905788360285       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788359358       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 1.171766e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7005e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679028e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8807
    reference variance = 0.466153
====================================================
  Execution time = 3.5915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3926e-01
  Total weights = 2.0000e+06
  Execution time = 3.3660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822699
                                         uncertainty =       0.006349862981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822699
                                         uncertainty =       0.006349862981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863928
  error estimate for blocks of size 2^( 2) =       0.000424216599
  error estimate for blocks of size 2^( 3) =       0.000437206014
  error estimate for blocks of size 2^( 4) =       0.000449385463
  error estimate for blocks of size 2^( 5) =       0.000460999820
  error estimate for blocks of size 2^( 6) =       0.000471385859
  error estimate for blocks of size 2^( 7) =       0.000476355941

      target function =                  N/A
              le_mean =     -16.906104378808
             les_mean =     286.155628888634
             stat err =       0.000464531771
             autocorr =       1.272106082155
              std dev =       0.582463553478
             le_variance =       0.339263791131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822971
                                         uncertainty =       0.006349862968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822971
                                         uncertainty =       0.006349862968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863929
  error estimate for blocks of size 2^( 2) =       0.000424216599
  error estimate for blocks of size 2^( 3) =       0.000437206014
  error estimate for blocks of size 2^( 4) =       0.000449385463
  error estimate for blocks of size 2^( 5) =       0.000460999820
  error estimate for blocks of size 2^( 6) =       0.000471385860
  error estimate for blocks of size 2^( 7) =       0.000476355941

      target function =                  N/A
              le_mean =     -16.906104378812
             les_mean =     286.155628889050
             stat err =       0.000464531771
             autocorr =       1.272106081769
              std dev =       0.582463553712
             le_variance =       0.339263791402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822835
                                         uncertainty =       0.006349862975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822835
                                         uncertainty =       0.006349862975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863929
  error estimate for blocks of size 2^( 2) =       0.000424216599
  error estimate for blocks of size 2^( 3) =       0.000437206014
  error estimate for blocks of size 2^( 4) =       0.000449385463
  error estimate for blocks of size 2^( 5) =       0.000460999820
  error estimate for blocks of size 2^( 6) =       0.000471385859
  error estimate for blocks of size 2^( 7) =       0.000476355941

      target function =                  N/A
              le_mean =     -16.906104378810
             les_mean =     286.155628888842
             stat err =       0.000464531771
             autocorr =       1.272106081960
              std dev =       0.582463553595
             le_variance =       0.339263791267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822716
                                         uncertainty =       0.006349862980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257822716
                                         uncertainty =       0.006349862980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411863928
  error estimate for blocks of size 2^( 2) =       0.000424216599
  error estimate for blocks of size 2^( 3) =       0.000437206014
  error estimate for blocks of size 2^( 4) =       0.000449385463
  error estimate for blocks of size 2^( 5) =       0.000460999820
  error estimate for blocks of size 2^( 6) =       0.000471385859
  error estimate for blocks of size 2^( 7) =       0.000476355941

      target function =                  N/A
              le_mean =     -16.906104378808
             les_mean =     286.155628888660
             stat err =       0.000464531771
             autocorr =       1.272106082135
              std dev =       0.582463553493
             le_variance =       0.339263791148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906104378808        initial
     1.5625e+05     1.5625e+06             1.8748e-09       -16.906104378812  <--
     6.2500e+05     6.2500e+06             4.6871e-10       -16.906104378810
     2.5000e+06     2.5000e+07             1.1718e-10       -16.906104378808

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 5.2819e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851397e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8458
    reference variance = 0.179678
====================================================
  Execution time = 3.8975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5004e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0042e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350152839956
                                         uncertainty =       0.010458210102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350152839956
                                         uncertainty =       0.010458210102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418356347
  error estimate for blocks of size 2^( 2) =       0.000431470136
  error estimate for blocks of size 2^( 3) =       0.000444037669
  error estimate for blocks of size 2^( 4) =       0.000456602300
  error estimate for blocks of size 2^( 5) =       0.000466728475
  error estimate for blocks of size 2^( 6) =       0.000474964762
  error estimate for blocks of size 2^( 7) =       0.000481247719

      target function =                  N/A
              le_mean =     -16.906938147014
             les_mean =     286.194601398338
             stat err =       0.000469885814
             autocorr =       1.261513617283
              std dev =       0.591645220032
             le_variance =       0.350044066386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690693814701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906938147014       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906938147009       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906938147024       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906938147035       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906938147032       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906938147068       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906938147077       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906938147041       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.358887e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906938147014       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906938147013       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906938147017       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906938147019       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906938147023       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906938147077       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906938147032       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906938146991       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.589722e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906938147014       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906938147014       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906938147015       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906938147016       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906938147012       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906938146727       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906938147484       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906938147488       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.974306e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.426905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9026e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8343
    reference variance = 0.246853
====================================================
  Execution time = 3.6547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3985e-01
  Total weights = 2.0000e+06
  Execution time = 3.3759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861447960
                                         uncertainty =       0.003630184172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861447960
                                         uncertainty =       0.003630184172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412222699
  error estimate for blocks of size 2^( 2) =       0.000424973852
  error estimate for blocks of size 2^( 3) =       0.000438022490
  error estimate for blocks of size 2^( 4) =       0.000449339625
  error estimate for blocks of size 2^( 5) =       0.000459589012
  error estimate for blocks of size 2^( 6) =       0.000467646988
  error estimate for blocks of size 2^( 7) =       0.000470510417

      target function =                  N/A
              le_mean =     -16.906030117429
             les_mean =     286.153709268632
             stat err =       0.000461771511
             autocorr =       1.254846100267
              std dev =       0.582970931643
             le_variance =       0.339855107141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861446367
                                         uncertainty =       0.003630184127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861446367
                                         uncertainty =       0.003630184127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412222698
  error estimate for blocks of size 2^( 2) =       0.000424973851
  error estimate for blocks of size 2^( 3) =       0.000438022489
  error estimate for blocks of size 2^( 4) =       0.000449339624
  error estimate for blocks of size 2^( 5) =       0.000459589011
  error estimate for blocks of size 2^( 6) =       0.000467646987
  error estimate for blocks of size 2^( 7) =       0.000470510416

      target function =                  N/A
              le_mean =     -16.906030117424
             les_mean =     286.153709266884
             stat err =       0.000461771510
             autocorr =       1.254846100915
              std dev =       0.582970930278
             le_variance =       0.339855105549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861447164
                                         uncertainty =       0.003630184150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861447164
                                         uncertainty =       0.003630184150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412222699
  error estimate for blocks of size 2^( 2) =       0.000424973852
  error estimate for blocks of size 2^( 3) =       0.000438022489
  error estimate for blocks of size 2^( 4) =       0.000449339625
  error estimate for blocks of size 2^( 5) =       0.000459589011
  error estimate for blocks of size 2^( 6) =       0.000467646988
  error estimate for blocks of size 2^( 7) =       0.000470510416

      target function =                  N/A
              le_mean =     -16.906030117427
             les_mean =     286.153709267758
             stat err =       0.000461771510
             autocorr =       1.254846100590
              std dev =       0.582970930960
             le_variance =       0.339855106345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861447860
                                         uncertainty =       0.003630184169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339861447860
                                         uncertainty =       0.003630184169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412222699
  error estimate for blocks of size 2^( 2) =       0.000424973852
  error estimate for blocks of size 2^( 3) =       0.000438022490
  error estimate for blocks of size 2^( 4) =       0.000449339625
  error estimate for blocks of size 2^( 5) =       0.000459589012
  error estimate for blocks of size 2^( 6) =       0.000467646988
  error estimate for blocks of size 2^( 7) =       0.000470510417

      target function =                  N/A
              le_mean =     -16.906030117429
             les_mean =     286.153709268523
             stat err =       0.000461771510
             autocorr =       1.254846100308
              std dev =       0.582970931558
             le_variance =       0.339855107041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906030117429        initial  <--
     3.9062e+04     3.9062e+05             6.3589e-09       -16.906030117424
     1.5625e+05     1.5625e+06             1.5897e-09       -16.906030117427
     6.2500e+05     6.2500e+06             3.9743e-10       -16.906030117429

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5101
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851397e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0254e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9154
    reference variance = 0.276187
====================================================
  Execution time = 3.6630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0120e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338650145259
                                         uncertainty =       0.004243882451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338650145259
                                         uncertainty =       0.004243882451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411437101
  error estimate for blocks of size 2^( 2) =       0.000424193987
  error estimate for blocks of size 2^( 3) =       0.000436538357
  error estimate for blocks of size 2^( 4) =       0.000447847361
  error estimate for blocks of size 2^( 5) =       0.000458362418
  error estimate for blocks of size 2^( 6) =       0.000466705093
  error estimate for blocks of size 2^( 7) =       0.000471020935

      target function =                  N/A
              le_mean =     -16.906039318953
             les_mean =     286.152726261386
             stat err =       0.000460983952
             autocorr =       1.255349662472
              std dev =       0.581859928755
             le_variance =       0.338560976690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603931895e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039318953       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039318954       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906039318954       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906039318954       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039319122       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039318472       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906039318897       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906039319267       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 6.524338e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039318953       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039318953       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906039318953       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906039318813       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039318923       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039320345       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906039319031       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906039320052       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.631086e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906039318953       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906039318953       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906039318953       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906039318953       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039318953       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906039318953       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906039318058       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906039314221       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 4.077705e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6758e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8695
    reference variance = 0.221791
====================================================
  Execution time = 3.6310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3698e-01
  Total weights = 2.0000e+06
  Execution time = 3.3626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565666
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565666
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410476876
  error estimate for blocks of size 2^( 2) =       0.000423371021
  error estimate for blocks of size 2^( 3) =       0.000436475923
  error estimate for blocks of size 2^( 4) =       0.000448378308
  error estimate for blocks of size 2^( 5) =       0.000460344878
  error estimate for blocks of size 2^( 6) =       0.000467963404
  error estimate for blocks of size 2^( 7) =       0.000475572839

      target function =                  N/A
              le_mean =     -16.906356535786
             les_mean =     286.161873677567
             stat err =       0.000463064857
             autocorr =       1.272642005516
              std dev =       0.580501964644
             le_variance =       0.336982530955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565715
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565715
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410476876
  error estimate for blocks of size 2^( 2) =       0.000423371021
  error estimate for blocks of size 2^( 3) =       0.000436475923
  error estimate for blocks of size 2^( 4) =       0.000448378308
  error estimate for blocks of size 2^( 5) =       0.000460344878
  error estimate for blocks of size 2^( 6) =       0.000467963404
  error estimate for blocks of size 2^( 7) =       0.000475572839

      target function =                  N/A
              le_mean =     -16.906356535788
             les_mean =     286.161873677701
             stat err =       0.000463064857
             autocorr =       1.272642005450
              std dev =       0.580501964685
             le_variance =       0.336982531004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565691
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565691
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410476876
  error estimate for blocks of size 2^( 2) =       0.000423371021
  error estimate for blocks of size 2^( 3) =       0.000436475923
  error estimate for blocks of size 2^( 4) =       0.000448378308
  error estimate for blocks of size 2^( 5) =       0.000460344878
  error estimate for blocks of size 2^( 6) =       0.000467963404
  error estimate for blocks of size 2^( 7) =       0.000475572839

      target function =                  N/A
              le_mean =     -16.906356535787
             les_mean =     286.161873677635
             stat err =       0.000463064857
             autocorr =       1.272642005486
              std dev =       0.580501964665
             le_variance =       0.336982530979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565669
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337063565669
                                         uncertainty =       0.003302859398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410476876
  error estimate for blocks of size 2^( 2) =       0.000423371021
  error estimate for blocks of size 2^( 3) =       0.000436475923
  error estimate for blocks of size 2^( 4) =       0.000448378308
  error estimate for blocks of size 2^( 5) =       0.000460344878
  error estimate for blocks of size 2^( 6) =       0.000467963404
  error estimate for blocks of size 2^( 7) =       0.000475572839

      target function =                  N/A
              le_mean =     -16.906356535786
             les_mean =     286.161873677576
             stat err =       0.000463064857
             autocorr =       1.272642005516
              std dev =       0.580501964646
             le_variance =       0.336982530958


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906356535786        initial
     3.9062e+05     3.9062e+06             6.5243e-10       -16.906356535788  <--
     1.5625e+06     1.5625e+07             1.6311e-10       -16.906356535787
     6.2500e+06     6.2500e+07             4.0777e-11       -16.906356535786

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 5.3205e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985003e-02 1 1  ON 29
eH1_0                -2.510280e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8514
    reference variance = 0.23779
====================================================
  Execution time = 3.6715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4425e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343935596248
                                         uncertainty =       0.008976797798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343935596248
                                         uncertainty =       0.008976797798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414876718
  error estimate for blocks of size 2^( 2) =       0.000427683291
  error estimate for blocks of size 2^( 3) =       0.000441014180
  error estimate for blocks of size 2^( 4) =       0.000453577373
  error estimate for blocks of size 2^( 5) =       0.000463673474
  error estimate for blocks of size 2^( 6) =       0.000474205712
  error estimate for blocks of size 2^( 7) =       0.000479287581

      target function =                  N/A
              le_mean =     -16.906194353586
             les_mean =     286.163652732126
             stat err =       0.000467686035
             autocorr =       1.270780891746
              std dev =       0.586724281936
             le_variance =       0.344245383013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619435359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194353586       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194353580       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906194353574       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906194353455       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906194353579       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194353579       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906194353594       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194353552       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.217202e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194353586       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194353585       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906194353583       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906194353507       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906194353604       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194353501       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906194353543       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194353435       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.543012e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194353586       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194353586       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906194353586       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906194353128       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906194353586       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906194353584       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906194353528       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906194353219       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.385753e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6724e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650225e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279647e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9318
    reference variance = 0.231496
====================================================
  Execution time = 3.6139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5511e-01
  Total weights = 2.0000e+06
  Execution time = 3.3544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234258674
                                         uncertainty =       0.009062503952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234258674
                                         uncertainty =       0.009062503952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421375397
  error estimate for blocks of size 2^( 2) =       0.000433485608
  error estimate for blocks of size 2^( 3) =       0.000445872679
  error estimate for blocks of size 2^( 4) =       0.000456495257
  error estimate for blocks of size 2^( 5) =       0.000466720559
  error estimate for blocks of size 2^( 6) =       0.000473878684
  error estimate for blocks of size 2^( 7) =       0.000480280434

      target function =                  N/A
              le_mean =     -16.906698680171
             les_mean =     286.191574534686
             stat err =       0.000469343734
             autocorr =       1.240634055370
              std dev =       0.595914801091
             le_variance =       0.355114450160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234257519
                                         uncertainty =       0.009062503586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234257519
                                         uncertainty =       0.009062503586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421375396
  error estimate for blocks of size 2^( 2) =       0.000433485608
  error estimate for blocks of size 2^( 3) =       0.000445872678
  error estimate for blocks of size 2^( 4) =       0.000456495257
  error estimate for blocks of size 2^( 5) =       0.000466720558
  error estimate for blocks of size 2^( 6) =       0.000473878684
  error estimate for blocks of size 2^( 7) =       0.000480280433

      target function =                  N/A
              le_mean =     -16.906698680182
             les_mean =     286.191574533899
             stat err =       0.000469343733
             autocorr =       1.240634055798
              std dev =       0.595914800122
             le_variance =       0.355114449005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234258096
                                         uncertainty =       0.009062503769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234258096
                                         uncertainty =       0.009062503769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421375397
  error estimate for blocks of size 2^( 2) =       0.000433485608
  error estimate for blocks of size 2^( 3) =       0.000445872678
  error estimate for blocks of size 2^( 4) =       0.000456495257
  error estimate for blocks of size 2^( 5) =       0.000466720558
  error estimate for blocks of size 2^( 6) =       0.000473878684
  error estimate for blocks of size 2^( 7) =       0.000480280434

      target function =                  N/A
              le_mean =     -16.906698680176
             les_mean =     286.191574534292
             stat err =       0.000469343733
             autocorr =       1.240634055587
              std dev =       0.595914800607
             le_variance =       0.355114449582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234258602
                                         uncertainty =       0.009062503929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355234258602
                                         uncertainty =       0.009062503929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421375397
  error estimate for blocks of size 2^( 2) =       0.000433485608
  error estimate for blocks of size 2^( 3) =       0.000445872678
  error estimate for blocks of size 2^( 4) =       0.000456495257
  error estimate for blocks of size 2^( 5) =       0.000466720559
  error estimate for blocks of size 2^( 6) =       0.000473878684
  error estimate for blocks of size 2^( 7) =       0.000480280434

      target function =                  N/A
              le_mean =     -16.906698680171
             les_mean =     286.191574534637
             stat err =       0.000469343733
             autocorr =       1.240634055397
              std dev =       0.595914801031
             le_variance =       0.355114450087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906698680171        initial
     9.7656e+04     9.7656e+05             2.2172e-09       -16.906698680182  <--
     3.9062e+05     3.9062e+06             5.5430e-10       -16.906698680176
     1.5625e+06     1.5625e+07             1.3858e-10       -16.906698680171

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 5.2996e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9084
    reference variance = 1.04427
====================================================
  Execution time = 3.8869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3166e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0086e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608070966
                                         uncertainty =       0.002750590415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331608070966
                                         uncertainty =       0.002750590415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407223000
  error estimate for blocks of size 2^( 2) =       0.000420114528
  error estimate for blocks of size 2^( 3) =       0.000433186377
  error estimate for blocks of size 2^( 4) =       0.000445877661
  error estimate for blocks of size 2^( 5) =       0.000456561002
  error estimate for blocks of size 2^( 6) =       0.000464894113
  error estimate for blocks of size 2^( 7) =       0.000473589936

      target function =                  N/A
              le_mean =     -16.906137122589
             les_mean =     286.149133384609
             stat err =       0.000460230678
             autocorr =       1.277281235896
              std dev =       0.575900288817
             le_variance =       0.331661142659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613712259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137122589       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906137122641       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906137122695       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137122696       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906137122703       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906137122711       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137122700       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137122692       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.030918e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137122589       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906137122602       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906137122615       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137122596       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906137122598       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906137122618       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137122592       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137122659       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.577299e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137122589       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906137122592       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906137122596       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137122595       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906137122875       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906137122702       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137122718       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137122470       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 6.443248e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8965e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513242e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9949
    reference variance = 0.305246
====================================================
  Execution time = 3.6122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5419e-01
  Total weights = 2.0000e+06
  Execution time = 3.3709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264710057
                                         uncertainty =       0.017208992304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264710057
                                         uncertainty =       0.017208992304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420827940
  error estimate for blocks of size 2^( 2) =       0.000433046863
  error estimate for blocks of size 2^( 3) =       0.000445532914
  error estimate for blocks of size 2^( 4) =       0.000456103964
  error estimate for blocks of size 2^( 5) =       0.000465278010
  error estimate for blocks of size 2^( 6) =       0.000471753811
  error estimate for blocks of size 2^( 7) =       0.000474536522

      target function =                  N/A
              le_mean =     -16.906511832674
             les_mean =     286.184334481017
             stat err =       0.000466918077
             autocorr =       1.231040224514
              std dev =       0.595140579832
             le_variance =       0.354192309762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264711957
                                         uncertainty =       0.017208992132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264711957
                                         uncertainty =       0.017208992132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420827941
  error estimate for blocks of size 2^( 2) =       0.000433046864
  error estimate for blocks of size 2^( 3) =       0.000445532915
  error estimate for blocks of size 2^( 4) =       0.000456103965
  error estimate for blocks of size 2^( 5) =       0.000465278011
  error estimate for blocks of size 2^( 6) =       0.000471753812
  error estimate for blocks of size 2^( 7) =       0.000474536523

      target function =                  N/A
              le_mean =     -16.906511832627
             les_mean =     286.184334481323
             stat err =       0.000466918077
             autocorr =       1.231040222321
              std dev =       0.595140581430
             le_variance =       0.354192311665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264711007
                                         uncertainty =       0.017208992218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264711007
                                         uncertainty =       0.017208992218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420827940
  error estimate for blocks of size 2^( 2) =       0.000433046863
  error estimate for blocks of size 2^( 3) =       0.000445532914
  error estimate for blocks of size 2^( 4) =       0.000456103964
  error estimate for blocks of size 2^( 5) =       0.000465278010
  error estimate for blocks of size 2^( 6) =       0.000471753811
  error estimate for blocks of size 2^( 7) =       0.000474536522

      target function =                  N/A
              le_mean =     -16.906511832651
             les_mean =     286.184334481170
             stat err =       0.000466918077
             autocorr =       1.231040223414
              std dev =       0.595140580631
             le_variance =       0.354192310714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264710176
                                         uncertainty =       0.017208992293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354264710176
                                         uncertainty =       0.017208992293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420827940
  error estimate for blocks of size 2^( 2) =       0.000433046863
  error estimate for blocks of size 2^( 3) =       0.000445532914
  error estimate for blocks of size 2^( 4) =       0.000456103964
  error estimate for blocks of size 2^( 5) =       0.000465278010
  error estimate for blocks of size 2^( 6) =       0.000471753811
  error estimate for blocks of size 2^( 7) =       0.000474536522

      target function =                  N/A
              le_mean =     -16.906511832671
             les_mean =     286.184334481037
             stat err =       0.000466918077
             autocorr =       1.231040224375
              std dev =       0.595140579931
             le_variance =       0.354192309881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906511832674        initial  <--
     2.4414e+04     2.4414e+05             1.0309e-08       -16.906511832627
     9.7656e+04     9.7656e+05             2.5773e-09       -16.906511832651
     3.9062e+05     3.9062e+06             6.4432e-10       -16.906511832671

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0468
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048247e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0202e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9241
    reference variance = 0.243118
====================================================
  Execution time = 3.6760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0061e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146657150
                                         uncertainty =       0.004947401546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146657150
                                         uncertainty =       0.004947401546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411232997
  error estimate for blocks of size 2^( 2) =       0.000423216983
  error estimate for blocks of size 2^( 3) =       0.000435621816
  error estimate for blocks of size 2^( 4) =       0.000447623926
  error estimate for blocks of size 2^( 5) =       0.000457896352
  error estimate for blocks of size 2^( 6) =       0.000464594089
  error estimate for blocks of size 2^( 7) =       0.000472121382

      target function =                  N/A
              le_mean =     -16.906027869740
             les_mean =     286.152003319570
             stat err =       0.000460558937
             autocorr =       1.254280060669
              std dev =       0.581571282190
             le_variance =       0.338225156269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602786974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027869740       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027869741       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027869741       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027869743       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027869745       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027869766       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027869692       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906027869754       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.013021e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027869740       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027869740       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027869740       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027869888       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027869894       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027869791       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027869688       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906027870676       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.532552e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027869740       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027869740       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027869740       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027869594       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027869602       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027869982       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027869768       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906027869423       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 6.331381e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6830e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9493
    reference variance = 0.419876
====================================================
  Execution time = 3.6152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3739e-01
  Total weights = 2.0000e+06
  Execution time = 3.3813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469512669
                                         uncertainty =       0.004769157157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469512669
                                         uncertainty =       0.004769157157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410722503
  error estimate for blocks of size 2^( 2) =       0.000423509961
  error estimate for blocks of size 2^( 3) =       0.000436153724
  error estimate for blocks of size 2^( 4) =       0.000447823055
  error estimate for blocks of size 2^( 5) =       0.000457948977
  error estimate for blocks of size 2^( 6) =       0.000465625411
  error estimate for blocks of size 2^( 7) =       0.000469278602

      target function =                  N/A
              le_mean =     -16.905631864291
             les_mean =     286.137774511870
             stat err =       0.000460169012
             autocorr =       1.255271711331
              std dev =       0.580849334706
             le_variance =       0.337385949628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469513222
                                         uncertainty =       0.004769157154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469513222
                                         uncertainty =       0.004769157154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410722504
  error estimate for blocks of size 2^( 2) =       0.000423509962
  error estimate for blocks of size 2^( 3) =       0.000436153724
  error estimate for blocks of size 2^( 4) =       0.000447823056
  error estimate for blocks of size 2^( 5) =       0.000457948977
  error estimate for blocks of size 2^( 6) =       0.000465625412
  error estimate for blocks of size 2^( 7) =       0.000469278603

      target function =                  N/A
              le_mean =     -16.905631864299
             les_mean =     286.137774512689
             stat err =       0.000460169012
             autocorr =       1.255271710541
              std dev =       0.580849335181
             le_variance =       0.337385950181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469512946
                                         uncertainty =       0.004769157156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469512946
                                         uncertainty =       0.004769157156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410722504
  error estimate for blocks of size 2^( 2) =       0.000423509961
  error estimate for blocks of size 2^( 3) =       0.000436153724
  error estimate for blocks of size 2^( 4) =       0.000447823055
  error estimate for blocks of size 2^( 5) =       0.000457948977
  error estimate for blocks of size 2^( 6) =       0.000465625412
  error estimate for blocks of size 2^( 7) =       0.000469278602

      target function =                  N/A
              le_mean =     -16.905631864295
             les_mean =     286.137774512280
             stat err =       0.000460169012
             autocorr =       1.255271710930
              std dev =       0.580849334943
             le_variance =       0.337385949904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469512704
                                         uncertainty =       0.004769157157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337469512704
                                         uncertainty =       0.004769157157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410722503
  error estimate for blocks of size 2^( 2) =       0.000423509961
  error estimate for blocks of size 2^( 3) =       0.000436153724
  error estimate for blocks of size 2^( 4) =       0.000447823055
  error estimate for blocks of size 2^( 5) =       0.000457948977
  error estimate for blocks of size 2^( 6) =       0.000465625412
  error estimate for blocks of size 2^( 7) =       0.000469278602

      target function =                  N/A
              le_mean =     -16.905631864292
             les_mean =     286.137774511922
             stat err =       0.000460169012
             autocorr =       1.255271711286
              std dev =       0.580849334736
             le_variance =       0.337385949663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905631864291        initial
     2.4414e+05     2.4414e+06             1.0130e-09       -16.905631864299  <--
     9.7656e+05     9.7656e+06             2.5326e-10       -16.905631864295
     3.9062e+06     3.9062e+07             6.3314e-11       -16.905631864292

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 5.3137e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8865
    reference variance = 0.253423
====================================================
  Execution time = 3.7040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0072e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343363459548
                                         uncertainty =       0.008223027140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343363459548
                                         uncertainty =       0.008223027140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414314711
  error estimate for blocks of size 2^( 2) =       0.000426981217
  error estimate for blocks of size 2^( 3) =       0.000440032534
  error estimate for blocks of size 2^( 4) =       0.000451791434
  error estimate for blocks of size 2^( 5) =       0.000461733126
  error estimate for blocks of size 2^( 6) =       0.000470136699
  error estimate for blocks of size 2^( 7) =       0.000474978692

      target function =                  N/A
              le_mean =     -16.905733099017
             les_mean =     286.147124802382
             stat err =       0.000464659988
             autocorr =       1.257794948262
              std dev =       0.585929482822
             le_variance =       0.343313358840


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573309902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733099017       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733099018       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905733099023       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905733099027       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905733099009       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905733099050       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905733099005       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905733099006       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.080000e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733099017       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733099017       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905733099018       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905733099020       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905733098947       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905733098892       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905733098809       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905733098968       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 7.700001e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733099017       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733099017       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905733099017       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905733098959       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905733099019       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905733099534       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905733098538       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905733098905       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 1.925000e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.445918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7122e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650227e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8547
    reference variance = 0.209212
====================================================
  Execution time = 3.6188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4585e-01
  Total weights = 2.0000e+06
  Execution time = 3.3757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028928445
                                         uncertainty =       0.010095614350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028928445
                                         uncertainty =       0.010095614350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415843280
  error estimate for blocks of size 2^( 2) =       0.000427945805
  error estimate for blocks of size 2^( 3) =       0.000440563071
  error estimate for blocks of size 2^( 4) =       0.000452358616
  error estimate for blocks of size 2^( 5) =       0.000462550459
  error estimate for blocks of size 2^( 6) =       0.000471493139
  error estimate for blocks of size 2^( 7) =       0.000473984816

      target function =                  N/A
              le_mean =     -16.906704550167
             les_mean =     286.182509841474
             stat err =       0.000465096758
             autocorr =       1.250913407409
              std dev =       0.588091207010
             le_variance =       0.345851267763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028931533
                                         uncertainty =       0.010095614325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028931533
                                         uncertainty =       0.010095614325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415843282
  error estimate for blocks of size 2^( 2) =       0.000427945806
  error estimate for blocks of size 2^( 3) =       0.000440563073
  error estimate for blocks of size 2^( 4) =       0.000452358617
  error estimate for blocks of size 2^( 5) =       0.000462550460
  error estimate for blocks of size 2^( 6) =       0.000471493141
  error estimate for blocks of size 2^( 7) =       0.000473984818

      target function =                  N/A
              le_mean =     -16.906704550155
             les_mean =     286.182509844163
             stat err =       0.000465096759
             autocorr =       1.250913403919
              std dev =       0.588091209634
             le_variance =       0.345851270848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028929989
                                         uncertainty =       0.010095614337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028929989
                                         uncertainty =       0.010095614337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415843281
  error estimate for blocks of size 2^( 2) =       0.000427945806
  error estimate for blocks of size 2^( 3) =       0.000440563072
  error estimate for blocks of size 2^( 4) =       0.000452358617
  error estimate for blocks of size 2^( 5) =       0.000462550459
  error estimate for blocks of size 2^( 6) =       0.000471493140
  error estimate for blocks of size 2^( 7) =       0.000473984817

      target function =                  N/A
              le_mean =     -16.906704550161
             les_mean =     286.182509842818
             stat err =       0.000465096758
             autocorr =       1.250913405672
              std dev =       0.588091208322
             le_variance =       0.345851269306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028928638
                                         uncertainty =       0.010095614348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346028928638
                                         uncertainty =       0.010095614348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415843281
  error estimate for blocks of size 2^( 2) =       0.000427945805
  error estimate for blocks of size 2^( 3) =       0.000440563071
  error estimate for blocks of size 2^( 4) =       0.000452358616
  error estimate for blocks of size 2^( 5) =       0.000462550459
  error estimate for blocks of size 2^( 6) =       0.000471493139
  error estimate for blocks of size 2^( 7) =       0.000473984816

      target function =                  N/A
              le_mean =     -16.906704550166
             les_mean =     286.182509841643
             stat err =       0.000465096758
             autocorr =       1.250913407199
              std dev =       0.588091207175
             le_variance =       0.345851267956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906704550167        initial  <--
     6.1035e+04     6.1035e+05             3.0800e-09       -16.906704550155
     2.4414e+05     2.4414e+06             7.7000e-10       -16.906704550161
     9.7656e+05     9.7656e+06             1.9250e-10       -16.906704550166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.1555
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0029e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.175711
====================================================
  Execution time = 3.9066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3495e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334852149727
                                         uncertainty =       0.002722191591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334852149727
                                         uncertainty =       0.002722191591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409238518
  error estimate for blocks of size 2^( 2) =       0.000421980099
  error estimate for blocks of size 2^( 3) =       0.000435238044
  error estimate for blocks of size 2^( 4) =       0.000447433962
  error estimate for blocks of size 2^( 5) =       0.000458498490
  error estimate for blocks of size 2^( 6) =       0.000467042644
  error estimate for blocks of size 2^( 7) =       0.000471813352

      target function =                  N/A
              le_mean =     -16.906712133285
             les_mean =     286.171867320232
             stat err =       0.000461197112
             autocorr =       1.270048047527
              std dev =       0.578750663020
             le_variance =       0.334952329946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671213328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906712133285       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906712133285       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906712133286       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906712133281       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906712133293       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906712132435       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906712133236       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906712133761       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.789771e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906712133285       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906712133285       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906712133285       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906712133282       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906712133740       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906712133171       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906712134069       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906712130291       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.474454e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906712133285       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906712133285       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906712133285       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906712133285       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906712133115       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906712133078       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906712134331       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906712152726       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.368629e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.449610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8969e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9337
    reference variance = 0.192119
====================================================
  Execution time = 3.5868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3806e-01
  Total weights = 2.0000e+06
  Execution time = 3.3642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977763
                                         uncertainty =       0.003265298221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977763
                                         uncertainty =       0.003265298221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134428
  error estimate for blocks of size 2^( 2) =       0.000424279431
  error estimate for blocks of size 2^( 3) =       0.000438721464
  error estimate for blocks of size 2^( 4) =       0.000452679914
  error estimate for blocks of size 2^( 5) =       0.000466386280
  error estimate for blocks of size 2^( 6) =       0.000479356327
  error estimate for blocks of size 2^( 7) =       0.000487693229

      target function =                  N/A
              le_mean =     -16.905885907893
             les_mean =     286.147041197508
             stat err =       0.000471528937
             autocorr =       1.315373259891
              std dev =       0.581431884099
             le_variance =       0.338063035847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977764
                                         uncertainty =       0.003265298224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977764
                                         uncertainty =       0.003265298224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134428
  error estimate for blocks of size 2^( 2) =       0.000424279431
  error estimate for blocks of size 2^( 3) =       0.000438721464
  error estimate for blocks of size 2^( 4) =       0.000452679914
  error estimate for blocks of size 2^( 5) =       0.000466386280
  error estimate for blocks of size 2^( 6) =       0.000479356327
  error estimate for blocks of size 2^( 7) =       0.000487693229

      target function =                  N/A
              le_mean =     -16.905885907894
             les_mean =     286.147041197550
             stat err =       0.000471528937
             autocorr =       1.315373259848
              std dev =       0.581431884100
             le_variance =       0.338063035848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977763
                                         uncertainty =       0.003265298222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977763
                                         uncertainty =       0.003265298222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134428
  error estimate for blocks of size 2^( 2) =       0.000424279431
  error estimate for blocks of size 2^( 3) =       0.000438721464
  error estimate for blocks of size 2^( 4) =       0.000452679914
  error estimate for blocks of size 2^( 5) =       0.000466386280
  error estimate for blocks of size 2^( 6) =       0.000479356327
  error estimate for blocks of size 2^( 7) =       0.000487693229

      target function =                  N/A
              le_mean =     -16.905885907894
             les_mean =     286.147041197529
             stat err =       0.000471528937
             autocorr =       1.315373259858
              std dev =       0.581431884100
             le_variance =       0.338063035848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977763
                                         uncertainty =       0.003265298221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338099977763
                                         uncertainty =       0.003265298221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134428
  error estimate for blocks of size 2^( 2) =       0.000424279431
  error estimate for blocks of size 2^( 3) =       0.000438721464
  error estimate for blocks of size 2^( 4) =       0.000452679914
  error estimate for blocks of size 2^( 5) =       0.000466386280
  error estimate for blocks of size 2^( 6) =       0.000479356327
  error estimate for blocks of size 2^( 7) =       0.000487693229

      target function =                  N/A
              le_mean =     -16.905885907893
             les_mean =     286.147041197511
             stat err =       0.000471528937
             autocorr =       1.315373259881
              std dev =       0.581431884099
             le_variance =       0.338063035847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905885907893        initial
     6.1035e+05     6.1035e+06             3.7898e-10       -16.905885907894  <--
     2.4414e+06     2.4414e+07             9.4745e-11       -16.905885907894
     9.7656e+06     9.7656e+07             2.3686e-11       -16.905885907893

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 5.2750e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0173e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8218
    reference variance = 0.254793
====================================================
  Execution time = 3.6708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000455272
                                         uncertainty =       0.009493219905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000455272
                                         uncertainty =       0.009493219905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414729345
  error estimate for blocks of size 2^( 2) =       0.000427279256
  error estimate for blocks of size 2^( 3) =       0.000439985222
  error estimate for blocks of size 2^( 4) =       0.000452579535
  error estimate for blocks of size 2^( 5) =       0.000462399756
  error estimate for blocks of size 2^( 6) =       0.000470919152
  error estimate for blocks of size 2^( 7) =       0.000473924114

      target function =                  N/A
              le_mean =     -16.906808257983
             les_mean =     286.184166159315
             stat err =       0.000464955639
             autocorr =       1.256879108025
              std dev =       0.586515864330
             le_variance =       0.344000859111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680825798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906808257983       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906808257988       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906808257989       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906808257988       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906808257910       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906808258014       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906808258004       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906808258048       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.589767e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906808257983       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906808257984       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906808257985       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906808258072       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906808257998       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906808258212       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906808258307       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906808258461       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.974421e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906808257983       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906808257983       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906808257983       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906808257983       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906808259939       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906808259618       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906808257200       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906808258010       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.936037e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.453478 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6613e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513240e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8558
    reference variance = 0.203507
====================================================
  Execution time = 3.6089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3947e-01
  Total weights = 2.0000e+06
  Execution time = 3.3626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218271
                                         uncertainty =       0.004928099227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218271
                                         uncertainty =       0.004928099227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989629
  error estimate for blocks of size 2^( 2) =       0.000424506160
  error estimate for blocks of size 2^( 3) =       0.000437214160
  error estimate for blocks of size 2^( 4) =       0.000449309805
  error estimate for blocks of size 2^( 5) =       0.000458962248
  error estimate for blocks of size 2^( 6) =       0.000465532495
  error estimate for blocks of size 2^( 7) =       0.000469517891

      target function =                  N/A
              le_mean =     -16.906771733443
             les_mean =     286.178401186622
             stat err =       0.000460830610
             autocorr =       1.251151982601
              std dev =       0.582641321564
             le_variance =       0.339470909594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218217
                                         uncertainty =       0.004928099233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218217
                                         uncertainty =       0.004928099233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989629
  error estimate for blocks of size 2^( 2) =       0.000424506160
  error estimate for blocks of size 2^( 3) =       0.000437214160
  error estimate for blocks of size 2^( 4) =       0.000449309805
  error estimate for blocks of size 2^( 5) =       0.000458962248
  error estimate for blocks of size 2^( 6) =       0.000465532495
  error estimate for blocks of size 2^( 7) =       0.000469517891

      target function =                  N/A
              le_mean =     -16.906771733443
             les_mean =     286.178401186565
             stat err =       0.000460830610
             autocorr =       1.251151982629
              std dev =       0.582641321518
             le_variance =       0.339470909540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218244
                                         uncertainty =       0.004928099230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218244
                                         uncertainty =       0.004928099230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989629
  error estimate for blocks of size 2^( 2) =       0.000424506160
  error estimate for blocks of size 2^( 3) =       0.000437214160
  error estimate for blocks of size 2^( 4) =       0.000449309805
  error estimate for blocks of size 2^( 5) =       0.000458962248
  error estimate for blocks of size 2^( 6) =       0.000465532495
  error estimate for blocks of size 2^( 7) =       0.000469517891

      target function =                  N/A
              le_mean =     -16.906771733443
             les_mean =     286.178401186594
             stat err =       0.000460830610
             autocorr =       1.251151982613
              std dev =       0.582641321541
             le_variance =       0.339470909567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218267
                                         uncertainty =       0.004928099228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339550218267
                                         uncertainty =       0.004928099228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989629
  error estimate for blocks of size 2^( 2) =       0.000424506160
  error estimate for blocks of size 2^( 3) =       0.000437214160
  error estimate for blocks of size 2^( 4) =       0.000449309805
  error estimate for blocks of size 2^( 5) =       0.000458962248
  error estimate for blocks of size 2^( 6) =       0.000465532495
  error estimate for blocks of size 2^( 7) =       0.000469517891

      target function =                  N/A
              le_mean =     -16.906771733443
             les_mean =     286.178401186618
             stat err =       0.000460830610
             autocorr =       1.251151982601
              std dev =       0.582641321561
             le_variance =       0.339470909591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906771733443        initial  <--
     1.5259e+05     1.5259e+06             1.5898e-09       -16.906771733443
     6.1035e+05     6.1035e+06             3.9744e-10       -16.906771733443
     2.4414e+06     2.4414e+07             9.9360e-11       -16.906771733443

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9761
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9596e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8412
    reference variance = 0.392261
====================================================
  Execution time = 3.6648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3498e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0118e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335124346535
                                         uncertainty =       0.003616369747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335124346535
                                         uncertainty =       0.003616369747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409253188
  error estimate for blocks of size 2^( 2) =       0.000421983411
  error estimate for blocks of size 2^( 3) =       0.000434611237
  error estimate for blocks of size 2^( 4) =       0.000446472369
  error estimate for blocks of size 2^( 5) =       0.000456023027
  error estimate for blocks of size 2^( 6) =       0.000463018721
  error estimate for blocks of size 2^( 7) =       0.000466950627

      target function =                  N/A
              le_mean =     -16.906111778162
             les_mean =     286.151591632715
             stat err =       0.000458116186
             autocorr =       1.253046332876
              std dev =       0.578771409527
             le_variance =       0.334976344485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611177816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111778162       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906111778162       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111778162       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906111778162       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906111778500       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906111779455       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906111778941       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906111780113       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.293096e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111778162       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906111778162       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111778162       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906111777621       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906111780892       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906111783861       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906111779713       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906111778907       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.232738e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111778162       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906111778162       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111778162       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906111778162       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906111774139       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906111778876       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906111833366       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906111765620       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 8.082095e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.457125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6776e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8785
    reference variance = 0.221502
====================================================
  Execution time = 3.5902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3951e-01
  Total weights = 2.0000e+06
  Execution time = 3.3559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872158
                                         uncertainty =       0.007313187133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872158
                                         uncertainty =       0.007313187133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412014219
  error estimate for blocks of size 2^( 2) =       0.000424907983
  error estimate for blocks of size 2^( 3) =       0.000438213568
  error estimate for blocks of size 2^( 4) =       0.000451366267
  error estimate for blocks of size 2^( 5) =       0.000463250001
  error estimate for blocks of size 2^( 6) =       0.000471922583
  error estimate for blocks of size 2^( 7) =       0.000479911383

      target function =                  N/A
              le_mean =     -16.906401807842
             les_mean =     286.165933351486
             stat err =       0.000466612558
             autocorr =       1.282591738151
              std dev =       0.582676096174
             le_variance =       0.339511433053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872176
                                         uncertainty =       0.007313187131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872176
                                         uncertainty =       0.007313187131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412014219
  error estimate for blocks of size 2^( 2) =       0.000424907983
  error estimate for blocks of size 2^( 3) =       0.000438213568
  error estimate for blocks of size 2^( 4) =       0.000451366267
  error estimate for blocks of size 2^( 5) =       0.000463250001
  error estimate for blocks of size 2^( 6) =       0.000471922583
  error estimate for blocks of size 2^( 7) =       0.000479911383

      target function =                  N/A
              le_mean =     -16.906401807842
             les_mean =     286.165933351504
             stat err =       0.000466612558
             autocorr =       1.282591738109
              std dev =       0.582676096189
             le_variance =       0.339511433071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872167
                                         uncertainty =       0.007313187132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872167
                                         uncertainty =       0.007313187132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412014219
  error estimate for blocks of size 2^( 2) =       0.000424907983
  error estimate for blocks of size 2^( 3) =       0.000438213568
  error estimate for blocks of size 2^( 4) =       0.000451366267
  error estimate for blocks of size 2^( 5) =       0.000463250001
  error estimate for blocks of size 2^( 6) =       0.000471922583
  error estimate for blocks of size 2^( 7) =       0.000479911383

      target function =                  N/A
              le_mean =     -16.906401807842
             les_mean =     286.165933351495
             stat err =       0.000466612558
             autocorr =       1.282591738136
              std dev =       0.582676096182
             le_variance =       0.339511433062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872159
                                         uncertainty =       0.007313187133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339632872159
                                         uncertainty =       0.007313187133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412014219
  error estimate for blocks of size 2^( 2) =       0.000424907983
  error estimate for blocks of size 2^( 3) =       0.000438213568
  error estimate for blocks of size 2^( 4) =       0.000451366267
  error estimate for blocks of size 2^( 5) =       0.000463250001
  error estimate for blocks of size 2^( 6) =       0.000471922583
  error estimate for blocks of size 2^( 7) =       0.000479911383

      target function =                  N/A
              le_mean =     -16.906401807842
             les_mean =     286.165933351487
             stat err =       0.000466612558
             autocorr =       1.282591738152
              std dev =       0.582676096175
             le_variance =       0.339511433054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906401807842        initial
     1.5259e+06     1.5259e+07             1.2931e-10       -16.906401807842  <--
     6.1035e+06     6.1035e+07             3.2327e-11       -16.906401807842
     2.4414e+07     2.4414e+08             8.0821e-12       -16.906401807842

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 5.2775e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9554
    reference variance = 0.313218
====================================================
  Execution time = 3.8041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347635195386
                                         uncertainty =       0.007511888033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347635195386
                                         uncertainty =       0.007511888033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416871712
  error estimate for blocks of size 2^( 2) =       0.000429581698
  error estimate for blocks of size 2^( 3) =       0.000442272598
  error estimate for blocks of size 2^( 4) =       0.000455567164
  error estimate for blocks of size 2^( 5) =       0.000465804474
  error estimate for blocks of size 2^( 6) =       0.000475128557
  error estimate for blocks of size 2^( 7) =       0.000482206174

      target function =                  N/A
              le_mean =     -16.906361231345
             les_mean =     286.172613959281
             stat err =       0.000469676592
             autocorr =       1.269383886872
              std dev =       0.589545628721
             le_variance =       0.347564048344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636123134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361231345       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361231346       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361231345       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361231346       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361231348       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361231346       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361231328       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361231826       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.369053e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361231345       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361231345       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361231345       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361231505       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361231375       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361231395       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361232435       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361230652       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.842263e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361231345       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361231345       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361231345       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361230592       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361231345       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361231987       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361230180       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361230041       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 4.605659e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.460834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7924e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297252e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.260073
====================================================
  Execution time = 3.5765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4191e-01
  Total weights = 2.0000e+06
  Execution time = 3.3597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914461194
                                         uncertainty =       0.003024529050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914461194
                                         uncertainty =       0.003024529050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413465910
  error estimate for blocks of size 2^( 2) =       0.000425761819
  error estimate for blocks of size 2^( 3) =       0.000438527888
  error estimate for blocks of size 2^( 4) =       0.000450990913
  error estimate for blocks of size 2^( 5) =       0.000460557897
  error estimate for blocks of size 2^( 6) =       0.000467747749
  error estimate for blocks of size 2^( 7) =       0.000472548368

      target function =                  N/A
              le_mean =     -16.906328121533
             les_mean =     286.165838500190
             stat err =       0.000462961232
             autocorr =       1.253746786112
              std dev =       0.584729098136
             le_variance =       0.341908118207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914460888
                                         uncertainty =       0.003024529049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914460888
                                         uncertainty =       0.003024529049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413465910
  error estimate for blocks of size 2^( 2) =       0.000425761819
  error estimate for blocks of size 2^( 3) =       0.000438527888
  error estimate for blocks of size 2^( 4) =       0.000450990913
  error estimate for blocks of size 2^( 5) =       0.000460557897
  error estimate for blocks of size 2^( 6) =       0.000467747749
  error estimate for blocks of size 2^( 7) =       0.000472548368

      target function =                  N/A
              le_mean =     -16.906328121534
             les_mean =     286.165838499911
             stat err =       0.000462961232
             autocorr =       1.253746786398
              std dev =       0.584729097874
             le_variance =       0.341908117901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914461041
                                         uncertainty =       0.003024529050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914461041
                                         uncertainty =       0.003024529050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413465910
  error estimate for blocks of size 2^( 2) =       0.000425761819
  error estimate for blocks of size 2^( 3) =       0.000438527888
  error estimate for blocks of size 2^( 4) =       0.000450990913
  error estimate for blocks of size 2^( 5) =       0.000460557897
  error estimate for blocks of size 2^( 6) =       0.000467747749
  error estimate for blocks of size 2^( 7) =       0.000472548368

      target function =                  N/A
              le_mean =     -16.906328121533
             les_mean =     286.165838500051
             stat err =       0.000462961232
             autocorr =       1.253746786251
              std dev =       0.584729098005
             le_variance =       0.341908118054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914461175
                                         uncertainty =       0.003024529050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914461175
                                         uncertainty =       0.003024529050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413465910
  error estimate for blocks of size 2^( 2) =       0.000425761819
  error estimate for blocks of size 2^( 3) =       0.000438527888
  error estimate for blocks of size 2^( 4) =       0.000450990913
  error estimate for blocks of size 2^( 5) =       0.000460557897
  error estimate for blocks of size 2^( 6) =       0.000467747749
  error estimate for blocks of size 2^( 7) =       0.000472548368

      target function =                  N/A
              le_mean =     -16.906328121533
             les_mean =     286.165838500173
             stat err =       0.000462961232
             autocorr =       1.253746786127
              std dev =       0.584729098120
             le_variance =       0.341908118188


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906328121533        initial
     3.8147e+05     3.8147e+06             7.3691e-10       -16.906328121534  <--
     1.5259e+06     1.5259e+07             1.8423e-10       -16.906328121533
     6.1035e+06     6.1035e+07             4.6057e-11       -16.906328121533

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 5.2658e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650226e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0059e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.238756
====================================================
  Execution time = 3.6755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4712e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0042e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347182598332
                                         uncertainty =       0.009066889814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347182598332
                                         uncertainty =       0.009066889814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416603561
  error estimate for blocks of size 2^( 2) =       0.000428691491
  error estimate for blocks of size 2^( 3) =       0.000441377833
  error estimate for blocks of size 2^( 4) =       0.000452915337
  error estimate for blocks of size 2^( 5) =       0.000461912560
  error estimate for blocks of size 2^( 6) =       0.000469538831
  error estimate for blocks of size 2^( 7) =       0.000471048585

      target function =                  N/A
              le_mean =     -16.906471726253
             les_mean =     286.175903111788
             stat err =       0.000463853828
             autocorr =       1.239699237319
              std dev =       0.589166406662
             le_variance =       0.347117054739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647172625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471726253       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471726257       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906471726252       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471726236       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471726260       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906471726372       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906471726247       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906471726274       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 3.245829e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471726253       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471726254       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906471726253       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471726257       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471725977       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906471726251       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906471726135       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906471726461       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 8.114577e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471726253       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471726254       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906471726253       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471726105       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471726254       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906471726219       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906471726074       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906471725675       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.028644e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.464889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6807e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851397e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650227e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513241e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.57703
====================================================
  Execution time = 3.6209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3432e-01
  Total weights = 2.0000e+06
  Execution time = 3.3647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354923072
                                         uncertainty =       0.002781389693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354923072
                                         uncertainty =       0.002781389693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408854572
  error estimate for blocks of size 2^( 2) =       0.000422012828
  error estimate for blocks of size 2^( 3) =       0.000435278626
  error estimate for blocks of size 2^( 4) =       0.000448272931
  error estimate for blocks of size 2^( 5) =       0.000461848956
  error estimate for blocks of size 2^( 6) =       0.000471051701
  error estimate for blocks of size 2^( 7) =       0.000478422458

      target function =                  N/A
              le_mean =     -16.905610719661
             les_mean =     286.133997759124
             stat err =       0.000464899012
             autocorr =       1.292943445991
              std dev =       0.578207680308
             le_variance =       0.334324121568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354922313
                                         uncertainty =       0.002781389683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354922313
                                         uncertainty =       0.002781389683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408854571
  error estimate for blocks of size 2^( 2) =       0.000422012828
  error estimate for blocks of size 2^( 3) =       0.000435278626
  error estimate for blocks of size 2^( 4) =       0.000448272931
  error estimate for blocks of size 2^( 5) =       0.000461848956
  error estimate for blocks of size 2^( 6) =       0.000471051701
  error estimate for blocks of size 2^( 7) =       0.000478422457

      target function =                  N/A
              le_mean =     -16.905610719685
             les_mean =     286.133997759158
             stat err =       0.000464899011
             autocorr =       1.292943446231
              std dev =       0.578207679652
             le_variance =       0.334324120808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354922692
                                         uncertainty =       0.002781389688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354922692
                                         uncertainty =       0.002781389688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408854571
  error estimate for blocks of size 2^( 2) =       0.000422012828
  error estimate for blocks of size 2^( 3) =       0.000435278626
  error estimate for blocks of size 2^( 4) =       0.000448272931
  error estimate for blocks of size 2^( 5) =       0.000461848956
  error estimate for blocks of size 2^( 6) =       0.000471051701
  error estimate for blocks of size 2^( 7) =       0.000478422457

      target function =                  N/A
              le_mean =     -16.905610719673
             les_mean =     286.133997759141
             stat err =       0.000464899011
             autocorr =       1.292943446114
              std dev =       0.578207679980
             le_variance =       0.334324121188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354923025
                                         uncertainty =       0.002781389692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334354923025
                                         uncertainty =       0.002781389692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408854572
  error estimate for blocks of size 2^( 2) =       0.000422012828
  error estimate for blocks of size 2^( 3) =       0.000435278626
  error estimate for blocks of size 2^( 4) =       0.000448272931
  error estimate for blocks of size 2^( 5) =       0.000461848956
  error estimate for blocks of size 2^( 6) =       0.000471051701
  error estimate for blocks of size 2^( 7) =       0.000478422458

      target function =                  N/A
              le_mean =     -16.905610719663
             les_mean =     286.133997759126
             stat err =       0.000464899011
             autocorr =       1.292943446011
              std dev =       0.578207680267
             le_variance =       0.334324121520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905610719661        initial
     9.5367e+04     9.5367e+05             3.2458e-09       -16.905610719685  <--
     3.8147e+05     3.8147e+06             8.1146e-10       -16.905610719673
     1.5259e+06     1.5259e+07             2.0286e-10       -16.905610719663

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 5.3110e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851397e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650228e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513240e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9924e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8982
    reference variance = 0.337719
====================================================
  Execution time = 3.6907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5908e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359205916922
                                         uncertainty =       0.014609024514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359205916922
                                         uncertainty =       0.014609024514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423721544
  error estimate for blocks of size 2^( 2) =       0.000436199715
  error estimate for blocks of size 2^( 3) =       0.000448881041
  error estimate for blocks of size 2^( 4) =       0.000460956439
  error estimate for blocks of size 2^( 5) =       0.000471656092
  error estimate for blocks of size 2^( 6) =       0.000479601625
  error estimate for blocks of size 2^( 7) =       0.000483502537

      target function =                  N/A
              le_mean =     -16.906829738282
             les_mean =     286.199971513597
             stat err =       0.000473929173
             autocorr =       1.251024437935
              std dev =       0.599232754336
             le_variance =       0.359079893869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682973828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906829738282       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906829738257       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906829738252       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829738247       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906829738264       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906829738250       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906829738247       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906829738256       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.420532e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906829738282       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906829738276       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906829738275       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829738274       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906829738251       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906829738256       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906829738319       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906829738278       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.105135e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906829738282       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906829738281       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906829738280       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829738280       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906829738241       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906829738082       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906829738181       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906829738096       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.262839e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6862e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851397e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650229e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513240e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8829
    reference variance = 0.290666
====================================================
  Execution time = 3.6268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3909e-01
  Total weights = 2.0000e+06
  Execution time = 3.3561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334079
                                         uncertainty =       0.004752864209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334079
                                         uncertainty =       0.004752864209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758766
  error estimate for blocks of size 2^( 2) =       0.000424057065
  error estimate for blocks of size 2^( 3) =       0.000437492151
  error estimate for blocks of size 2^( 4) =       0.000450853501
  error estimate for blocks of size 2^( 5) =       0.000461140367
  error estimate for blocks of size 2^( 6) =       0.000470576778
  error estimate for blocks of size 2^( 7) =       0.000476289655

      target function =                  N/A
              le_mean =     -16.905807253448
             les_mean =     286.145409283679
             stat err =       0.000464715075
             autocorr =       1.273760611547
              std dev =       0.582314831066
             le_variance =       0.339090562479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334075
                                         uncertainty =       0.004752864151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334075
                                         uncertainty =       0.004752864151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758766
  error estimate for blocks of size 2^( 2) =       0.000424057065
  error estimate for blocks of size 2^( 3) =       0.000437492151
  error estimate for blocks of size 2^( 4) =       0.000450853501
  error estimate for blocks of size 2^( 5) =       0.000461140367
  error estimate for blocks of size 2^( 6) =       0.000470576778
  error estimate for blocks of size 2^( 7) =       0.000476289655

      target function =                  N/A
              le_mean =     -16.905807253487
             les_mean =     286.145409284985
             stat err =       0.000464715075
             autocorr =       1.273760610666
              std dev =       0.582314831062
             le_variance =       0.339090562475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334077
                                         uncertainty =       0.004752864180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334077
                                         uncertainty =       0.004752864180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758766
  error estimate for blocks of size 2^( 2) =       0.000424057065
  error estimate for blocks of size 2^( 3) =       0.000437492151
  error estimate for blocks of size 2^( 4) =       0.000450853501
  error estimate for blocks of size 2^( 5) =       0.000461140367
  error estimate for blocks of size 2^( 6) =       0.000470576778
  error estimate for blocks of size 2^( 7) =       0.000476289655

      target function =                  N/A
              le_mean =     -16.905807253468
             les_mean =     286.145409284332
             stat err =       0.000464715075
             autocorr =       1.273760611102
              std dev =       0.582314831064
             le_variance =       0.339090562477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334079
                                         uncertainty =       0.004752864206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339062334079
                                         uncertainty =       0.004752864206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758766
  error estimate for blocks of size 2^( 2) =       0.000424057065
  error estimate for blocks of size 2^( 3) =       0.000437492151
  error estimate for blocks of size 2^( 4) =       0.000450853501
  error estimate for blocks of size 2^( 5) =       0.000461140367
  error estimate for blocks of size 2^( 6) =       0.000470576778
  error estimate for blocks of size 2^( 7) =       0.000476289655

      target function =                  N/A
              le_mean =     -16.905807253451
             les_mean =     286.145409283760
             stat err =       0.000464715075
             autocorr =       1.273760611499
              std dev =       0.582314831065
             le_variance =       0.339090562479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905807253448        initial
     2.3842e+04     2.3842e+05             8.4205e-09       -16.905807253487  <--
     9.5367e+04     9.5367e+05             2.1051e-09       -16.905807253468
     3.8147e+05     3.8147e+06             5.2628e-10       -16.905807253451

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 5.3146e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851398e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095567e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985004e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650231e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670963e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279648e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723303e-02 1 1  ON 42
eH2_3                -4.258758e-02 1 1  ON 43
eH2_4                 6.513238e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941917e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.252896
====================================================
  Execution time = 3.8788e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3639e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0292e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336428745387
                                         uncertainty =       0.002863300037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336428745387
                                         uncertainty =       0.002863300037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410118456
  error estimate for blocks of size 2^( 2) =       0.000423097168
  error estimate for blocks of size 2^( 3) =       0.000436283251
  error estimate for blocks of size 2^( 4) =       0.000448671633
  error estimate for blocks of size 2^( 5) =       0.000460070178
  error estimate for blocks of size 2^( 6) =       0.000468973394
  error estimate for blocks of size 2^( 7) =       0.000476495776

      target function =                  N/A
              le_mean =     -16.905592105336
             les_mean =     286.135438559876
             stat err =       0.000463552745
             autocorr =       1.277555238067
              std dev =       0.579995082792
             le_variance =       0.336394296063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559210534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905592105336       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905592105425       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592105528       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905592105601       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905592105572       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905592105570       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905592105565       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905592105570       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.766272e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905592105336       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905592105358       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592105384       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905592105402       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905592105397       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905592105391       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905592105392       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905592105401       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.415861e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905592105336       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905592105342       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592105348       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905592105353       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905592105368       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905592105349       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905592105267       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905592105337       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.353977e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.472622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9090e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679029e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372657e-02 1 1  ON 12
 ud_3                -7.851399e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375014e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240865e-01 1 1  ON 28
 eO_9                -8.985005e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650241e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279649e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723304e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513234e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279370e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9591
    reference variance = 0.28128
====================================================
  Execution time = 3.5938e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3873e-01
  Total weights = 2.0000e+06
  Execution time = 3.3620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608905164
                                         uncertainty =       0.003674343829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608905164
                                         uncertainty =       0.003674343829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411537490
  error estimate for blocks of size 2^( 2) =       0.000423919584
  error estimate for blocks of size 2^( 3) =       0.000437201787
  error estimate for blocks of size 2^( 4) =       0.000449837345
  error estimate for blocks of size 2^( 5) =       0.000460308461
  error estimate for blocks of size 2^( 6) =       0.000466836509
  error estimate for blocks of size 2^( 7) =       0.000470545672

      target function =                  N/A
              le_mean =     -16.906429267253
             les_mean =     286.166076610469
             stat err =       0.000461881997
             autocorr =       1.259630769531
              std dev =       0.582001899655
             le_variance =       0.338726211202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608902619
                                         uncertainty =       0.003674343821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608902619
                                         uncertainty =       0.003674343821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411537488
  error estimate for blocks of size 2^( 2) =       0.000423919583
  error estimate for blocks of size 2^( 3) =       0.000437201785
  error estimate for blocks of size 2^( 4) =       0.000449837342
  error estimate for blocks of size 2^( 5) =       0.000460308458
  error estimate for blocks of size 2^( 6) =       0.000466836507
  error estimate for blocks of size 2^( 7) =       0.000470545669

      target function =                  N/A
              le_mean =     -16.906429267488
             les_mean =     286.166076615932
             stat err =       0.000461881994
             autocorr =       1.259630763559
              std dev =       0.582001897521
             le_variance =       0.338726208718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608903891
                                         uncertainty =       0.003674343825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608903891
                                         uncertainty =       0.003674343825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411537489
  error estimate for blocks of size 2^( 2) =       0.000423919583
  error estimate for blocks of size 2^( 3) =       0.000437201786
  error estimate for blocks of size 2^( 4) =       0.000449837343
  error estimate for blocks of size 2^( 5) =       0.000460308460
  error estimate for blocks of size 2^( 6) =       0.000466836508
  error estimate for blocks of size 2^( 7) =       0.000470545671

      target function =                  N/A
              le_mean =     -16.906429267371
             les_mean =     286.166076613200
             stat err =       0.000461881995
             autocorr =       1.259630766548
              std dev =       0.582001898588
             le_variance =       0.338726209960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608905005
                                         uncertainty =       0.003674343829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338608905005
                                         uncertainty =       0.003674343829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411537490
  error estimate for blocks of size 2^( 2) =       0.000423919584
  error estimate for blocks of size 2^( 3) =       0.000437201787
  error estimate for blocks of size 2^( 4) =       0.000449837344
  error estimate for blocks of size 2^( 5) =       0.000460308461
  error estimate for blocks of size 2^( 6) =       0.000466836509
  error estimate for blocks of size 2^( 7) =       0.000470545672

      target function =                  N/A
              le_mean =     -16.906429267268
             les_mean =     286.166076610810
             stat err =       0.000461881997
             autocorr =       1.259630769160
              std dev =       0.582001899522
             le_variance =       0.338726211047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906429267253        initial
     5.9605e+03     5.9605e+04             3.7663e-08       -16.906429267488  <--
     2.3842e+04     2.3842e+05             9.4159e-09       -16.906429267371
     9.5367e+04     9.5367e+05             2.3540e-09       -16.906429267268

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 5.2839e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679030e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372656e-02 1 1  ON 12
 ud_3                -7.851403e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985006e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475802e-02 1 1  ON 33
eH1_4                 3.650269e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279651e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723305e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513221e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0194e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.333684
====================================================
  Execution time = 3.6440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353395161656
                                         uncertainty =       0.014702427536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353395161656
                                         uncertainty =       0.014702427536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420388469
  error estimate for blocks of size 2^( 2) =       0.000432543249
  error estimate for blocks of size 2^( 3) =       0.000445414126
  error estimate for blocks of size 2^( 4) =       0.000458552348
  error estimate for blocks of size 2^( 5) =       0.000469606038
  error estimate for blocks of size 2^( 6) =       0.000479988465
  error estimate for blocks of size 2^( 7) =       0.000487933922

      target function =                  N/A
              le_mean =     -16.906025089583
             les_mean =     286.167137082373
             stat err =       0.000474020194
             autocorr =       1.271428952380
              std dev =       0.594519074126
             le_variance =       0.353452929499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602508958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025089583       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025089694       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025089951       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025090019       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025090321       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025090480       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025090504       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025090540       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.720219e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025089583       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025089610       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025089675       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025089692       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025089767       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025089807       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025089815       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025089825       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.300555e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025089583       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025089590       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025089606       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025089610       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025089636       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025089633       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025089635       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025089670       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.075139e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.476287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6429e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163780e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372655e-02 1 1  ON 12
 ud_3                -7.851406e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095563e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616893e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985008e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932057e-02 1 1  ON 32
eH1_3                -4.475803e-02 1 1  ON 33
eH1_4                 3.650282e-03 1 1  ON 34
eH1_5                 3.801549e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279654e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723306e-02 1 1  ON 42
eH2_3                -4.258756e-02 1 1  ON 43
eH2_4                 6.513202e-03 1 1  ON 44
eH2_5                 4.071766e-02 1 1  ON 45
eH2_6                 9.941917e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279376e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9816
    reference variance = 0.184626
====================================================
  Execution time = 3.6087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3768e-01
  Total weights = 2.0000e+06
  Execution time = 3.3706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667496563
                                         uncertainty =       0.003746565635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667496563
                                         uncertainty =       0.003746565635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410903840
  error estimate for blocks of size 2^( 2) =       0.000423219028
  error estimate for blocks of size 2^( 3) =       0.000436161770
  error estimate for blocks of size 2^( 4) =       0.000447489385
  error estimate for blocks of size 2^( 5) =       0.000456864275
  error estimate for blocks of size 2^( 6) =       0.000464052486
  error estimate for blocks of size 2^( 7) =       0.000467588683

      target function =                  N/A
              le_mean =     -16.907002334982
             les_mean =     286.184411717345
             stat err =       0.000458998707
             autocorr =       1.247792944616
              std dev =       0.581105783055
             le_variance =       0.337683931100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667484290
                                         uncertainty =       0.003746564919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667484290
                                         uncertainty =       0.003746564919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410903832
  error estimate for blocks of size 2^( 2) =       0.000423219020
  error estimate for blocks of size 2^( 3) =       0.000436161761
  error estimate for blocks of size 2^( 4) =       0.000447489378
  error estimate for blocks of size 2^( 5) =       0.000456864269
  error estimate for blocks of size 2^( 6) =       0.000464052482
  error estimate for blocks of size 2^( 7) =       0.000467588676

      target function =                  N/A
              le_mean =     -16.907002333957
             les_mean =     286.184411670453
             stat err =       0.000458998701
             autocorr =       1.247792956935
              std dev =       0.581105772518
             le_variance =       0.337683918854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667490422
                                         uncertainty =       0.003746565277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667490422
                                         uncertainty =       0.003746565277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410903836
  error estimate for blocks of size 2^( 2) =       0.000423219024
  error estimate for blocks of size 2^( 3) =       0.000436161765
  error estimate for blocks of size 2^( 4) =       0.000447489382
  error estimate for blocks of size 2^( 5) =       0.000456864272
  error estimate for blocks of size 2^( 6) =       0.000464052484
  error estimate for blocks of size 2^( 7) =       0.000467588680

      target function =                  N/A
              le_mean =     -16.907002334470
             les_mean =     286.184411693889
             stat err =       0.000458998704
             autocorr =       1.247792950773
              std dev =       0.581105777782
             le_variance =       0.337683924972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667495795
                                         uncertainty =       0.003746565590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337667495795
                                         uncertainty =       0.003746565590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410903839
  error estimate for blocks of size 2^( 2) =       0.000423219028
  error estimate for blocks of size 2^( 3) =       0.000436161769
  error estimate for blocks of size 2^( 4) =       0.000447489385
  error estimate for blocks of size 2^( 5) =       0.000456864274
  error estimate for blocks of size 2^( 6) =       0.000464052486
  error estimate for blocks of size 2^( 7) =       0.000467588683

      target function =                  N/A
              le_mean =     -16.907002334918
             les_mean =     286.184411714413
             stat err =       0.000458998707
             autocorr =       1.247792945389
              std dev =       0.581105782396
             le_variance =       0.337683930334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907002334982        initial  <--
     1.4901e+03     1.4901e+04             1.7202e-07       -16.907002333957
     5.9605e+03     5.9605e+04             4.3006e-08       -16.907002334470
     2.3842e+04     2.3842e+05             1.0751e-08       -16.907002334918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0409
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679030e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372656e-02 1 1  ON 12
 ud_3                -7.851403e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985006e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475802e-02 1 1  ON 33
eH1_4                 3.650269e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279651e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723305e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513221e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.354148
====================================================
  Execution time = 3.6836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4006e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340085827956
                                         uncertainty =       0.004535743526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340085827956
                                         uncertainty =       0.004535743526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412349765
  error estimate for blocks of size 2^( 2) =       0.000424873841
  error estimate for blocks of size 2^( 3) =       0.000437834921
  error estimate for blocks of size 2^( 4) =       0.000449460817
  error estimate for blocks of size 2^( 5) =       0.000460397883
  error estimate for blocks of size 2^( 6) =       0.000466605288
  error estimate for blocks of size 2^( 7) =       0.000470719589

      target function =                  N/A
              le_mean =     -16.905842687426
             les_mean =     286.147581458868
             stat err =       0.000461795894
             autocorr =       1.254205301248
              std dev =       0.583150629686
             le_variance =       0.340064656903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584268743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905842687426       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905842687437       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905842687487       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905842687537       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905842687581       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905842687575       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905842687587       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905842687582       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.237330e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905842687426       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905842687429       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905842687441       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905842687454       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905842687464       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905842687365       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905842687495       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905842687465       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.093371e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905842687426       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905842687427       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905842687430       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905842687433       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905842687439       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905842687426       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905842687646       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905842687538       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.733462e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.479940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6745e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163779e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679030e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372656e-02 1 1  ON 12
 ud_3                -7.851403e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095565e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048246e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985007e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475802e-02 1 1  ON 33
eH1_4                 3.650269e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279652e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723305e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513221e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.7934
    reference variance = 0.313751
====================================================
  Execution time = 3.5843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3366e-01
  Total weights = 2.0000e+06
  Execution time = 3.3754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360844
                                         uncertainty =       0.002948340377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360844
                                         uncertainty =       0.002948340377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408447478
  error estimate for blocks of size 2^( 2) =       0.000421142800
  error estimate for blocks of size 2^( 3) =       0.000433941381
  error estimate for blocks of size 2^( 4) =       0.000445192409
  error estimate for blocks of size 2^( 5) =       0.000455295899
  error estimate for blocks of size 2^( 6) =       0.000463403376
  error estimate for blocks of size 2^( 7) =       0.000466990131

      target function =                  N/A
              le_mean =     -16.906350181698
             les_mean =     286.158334983600
             stat err =       0.000457720454
             autocorr =       1.255822334226
              std dev =       0.577631962611
             le_variance =       0.333658684230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360245
                                         uncertainty =       0.002948340402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360245
                                         uncertainty =       0.002948340402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408447477
  error estimate for blocks of size 2^( 2) =       0.000421142800
  error estimate for blocks of size 2^( 3) =       0.000433941380
  error estimate for blocks of size 2^( 4) =       0.000445192408
  error estimate for blocks of size 2^( 5) =       0.000455295899
  error estimate for blocks of size 2^( 6) =       0.000463403375
  error estimate for blocks of size 2^( 7) =       0.000466990130

      target function =                  N/A
              le_mean =     -16.906350181766
             les_mean =     286.158334985289
             stat err =       0.000457720453
             autocorr =       1.255822332100
              std dev =       0.577631962090
             le_variance =       0.333658683628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360544
                                         uncertainty =       0.002948340389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360544
                                         uncertainty =       0.002948340389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408447478
  error estimate for blocks of size 2^( 2) =       0.000421142800
  error estimate for blocks of size 2^( 3) =       0.000433941380
  error estimate for blocks of size 2^( 4) =       0.000445192409
  error estimate for blocks of size 2^( 5) =       0.000455295899
  error estimate for blocks of size 2^( 6) =       0.000463403375
  error estimate for blocks of size 2^( 7) =       0.000466990131

      target function =                  N/A
              le_mean =     -16.906350181732
             les_mean =     286.158334984444
             stat err =       0.000457720453
             autocorr =       1.255822333158
              std dev =       0.577631962351
             le_variance =       0.333658683929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360807
                                         uncertainty =       0.002948340379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692360807
                                         uncertainty =       0.002948340379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408447478
  error estimate for blocks of size 2^( 2) =       0.000421142800
  error estimate for blocks of size 2^( 3) =       0.000433941381
  error estimate for blocks of size 2^( 4) =       0.000445192409
  error estimate for blocks of size 2^( 5) =       0.000455295899
  error estimate for blocks of size 2^( 6) =       0.000463403376
  error estimate for blocks of size 2^( 7) =       0.000466990131

      target function =                  N/A
              le_mean =     -16.906350181702
             les_mean =     286.158334983705
             stat err =       0.000457720454
             autocorr =       1.255822334085
              std dev =       0.577631962579
             le_variance =       0.333658684193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906350181698        initial
     1.4901e+04     1.4901e+05             1.2373e-08       -16.906350181766  <--
     5.9605e+04     5.9605e+05             3.0934e-09       -16.906350181732
     2.3842e+05     2.3842e+06             7.7335e-10       -16.906350181702

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 5.2858e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163780e-02 1 1  ON 2
 uu_3                -2.107833e-02 1 1  ON 3
 uu_4                -6.679030e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372656e-02 1 1  ON 12
 ud_3                -7.851400e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075021e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095565e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048245e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985008e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477986e-01 1 1  ON 31
eH1_2                -9.932058e-02 1 1  ON 32
eH1_3                -4.475802e-02 1 1  ON 33
eH1_4                 3.650270e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670961e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279652e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723305e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513222e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941918e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279374e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8569
    reference variance = 0.141916
====================================================
  Execution time = 3.8495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2855e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0059e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328599111846
                                         uncertainty =       0.002352187156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328599111846
                                         uncertainty =       0.002352187156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405305585
  error estimate for blocks of size 2^( 2) =       0.000418304784
  error estimate for blocks of size 2^( 3) =       0.000432017066
  error estimate for blocks of size 2^( 4) =       0.000445211223
  error estimate for blocks of size 2^( 5) =       0.000457854500
  error estimate for blocks of size 2^( 6) =       0.000469845294
  error estimate for blocks of size 2^( 7) =       0.000476950246

      target function =                  N/A
              le_mean =     -16.906094967809
             les_mean =     286.144592130537
             stat err =       0.000462465316
             autocorr =       1.301946556198
              std dev =       0.573188654996
             le_variance =       0.328545234216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609496781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094967809       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094967965       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094968026       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094967934       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094967949       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094968006       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094968055       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094968078       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 7.827686e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094967809       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094967848       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094967864       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094967839       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094967844       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094967870       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094967874       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094967884       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.956928e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094967809       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094967819       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094967823       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094967844       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094967814       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094967822       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094967848       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094967818       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.892324e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.483637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8564e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163780e-02 1 1  ON 2
 uu_3                -2.107833e-02 1 1  ON 3
 uu_4                -6.679030e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372656e-02 1 1  ON 12
 ud_3                -7.851403e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095565e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048245e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985008e-02 1 1  ON 29
eH1_0                -2.510281e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932059e-02 1 1  ON 32
eH1_3                -4.475802e-02 1 1  ON 33
eH1_4                 3.650274e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670961e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279653e-02 1 1  ON 39
eH2_0                -2.490033e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723306e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513220e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941917e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854389e-01 1 1  ON 48
eH2_9                 6.279376e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9087
    reference variance = 0.168122
====================================================
  Execution time = 3.5756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4059e-01
  Total weights = 2.0000e+06
  Execution time = 3.3658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552488456
                                         uncertainty =       0.004102559472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552488456
                                         uncertainty =       0.004102559472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412665568
  error estimate for blocks of size 2^( 2) =       0.000425328174
  error estimate for blocks of size 2^( 3) =       0.000437895102
  error estimate for blocks of size 2^( 4) =       0.000449975921
  error estimate for blocks of size 2^( 5) =       0.000457912164
  error estimate for blocks of size 2^( 6) =       0.000464224803
  error estimate for blocks of size 2^( 7) =       0.000468226667

      target function =                  N/A
              le_mean =     -16.907086582449
             les_mean =     286.190162277653
             stat err =       0.000460084889
             autocorr =       1.243023878805
              std dev =       0.583597242570
             le_variance =       0.340585741535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552535695
                                         uncertainty =       0.004102559710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552535695
                                         uncertainty =       0.004102559710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412665596
  error estimate for blocks of size 2^( 2) =       0.000425328201
  error estimate for blocks of size 2^( 3) =       0.000437895127
  error estimate for blocks of size 2^( 4) =       0.000449975945
  error estimate for blocks of size 2^( 5) =       0.000457912187
  error estimate for blocks of size 2^( 6) =       0.000464224826
  error estimate for blocks of size 2^( 7) =       0.000468226689

      target function =                  N/A
              le_mean =     -16.907086582625
             les_mean =     286.190162330847
             stat err =       0.000460084912
             autocorr =       1.243023830655
              std dev =       0.583597283040
             le_variance =       0.340585788771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552512077
                                         uncertainty =       0.004102559591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552512077
                                         uncertainty =       0.004102559591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412665582
  error estimate for blocks of size 2^( 2) =       0.000425328187
  error estimate for blocks of size 2^( 3) =       0.000437895115
  error estimate for blocks of size 2^( 4) =       0.000449975933
  error estimate for blocks of size 2^( 5) =       0.000457912175
  error estimate for blocks of size 2^( 6) =       0.000464224814
  error estimate for blocks of size 2^( 7) =       0.000468226678

      target function =                  N/A
              le_mean =     -16.907086582537
             les_mean =     286.190162304252
             stat err =       0.000460084900
             autocorr =       1.243023854722
              std dev =       0.583597262806
             le_variance =       0.340585765155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552491408
                                         uncertainty =       0.004102559486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340552491408
                                         uncertainty =       0.004102559486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412665569
  error estimate for blocks of size 2^( 2) =       0.000425328176
  error estimate for blocks of size 2^( 3) =       0.000437895104
  error estimate for blocks of size 2^( 4) =       0.000449975922
  error estimate for blocks of size 2^( 5) =       0.000457912165
  error estimate for blocks of size 2^( 6) =       0.000464224804
  error estimate for blocks of size 2^( 7) =       0.000468226669

      target function =                  N/A
              le_mean =     -16.907086582460
             les_mean =     286.190162280978
             stat err =       0.000460084890
             autocorr =       1.243023875789
              std dev =       0.583597245099
             le_variance =       0.340585744488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907086582449        initial
     3.7253e+03     3.7253e+04             7.8277e-08       -16.907086582625  <--
     1.4901e+04     1.4901e+05             1.9569e-08       -16.907086582537
     5.9605e+04     5.9605e+05             4.8923e-09       -16.907086582460

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 5.2801e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851413e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650285e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279656e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513213e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941916e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0137e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.199487
====================================================
  Execution time = 3.6486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4293e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342914207851
                                         uncertainty =       0.004178381746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342914207851
                                         uncertainty =       0.004178381746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414082153
  error estimate for blocks of size 2^( 2) =       0.000426466012
  error estimate for blocks of size 2^( 3) =       0.000439523505
  error estimate for blocks of size 2^( 4) =       0.000452258777
  error estimate for blocks of size 2^( 5) =       0.000462419893
  error estimate for blocks of size 2^( 6) =       0.000470869571
  error estimate for blocks of size 2^( 7) =       0.000476236499

      target function =                  N/A
              le_mean =     -16.906313836361
             les_mean =     286.166375420505
             stat err =       0.000465446185
             autocorr =       1.263472882531
              std dev =       0.585600596344
             le_variance =       0.342928058438


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631383636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313836361       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313836653       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313838551       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313838745       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313838532       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313838517       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313838478       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313838508       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.284965e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313836361       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313836434       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313836909       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313836957       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313836903       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313836899       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313836891       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313836897       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.712506e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313836361       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313836379       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313836498       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313836509       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313836497       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313836485       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313836493       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313836499       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.428132e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.487314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6478e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.105498e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163783e-02 1 1  ON 2
 uu_3                -2.107830e-02 1 1  ON 3
 uu_4                -6.679034e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358421e-01 1 1  ON 8
 uu_9                -1.064396e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843566e-01 1 1  ON 11
 ud_2                 6.372653e-02 1 1  ON 12
 ud_3                -7.851402e-03 1 1  ON 13
 ud_4                -6.538380e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616893e-01 1 1  ON 26
 eO_7                -4.048242e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985015e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932061e-02 1 1  ON 32
eH1_3                -4.475801e-02 1 1  ON 33
eH1_4                 3.650298e-03 1 1  ON 34
eH1_5                 3.801548e-02 1 1  ON 35
eH1_6                 9.670963e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807631e-01 1 1  ON 38
eH1_9                 7.279661e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455785e-01 1 1  ON 41
eH2_2                -9.723309e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513167e-03 1 1  ON 44
eH2_5                 4.071768e-02 1 1  ON 45
eH2_6                 9.941917e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279387e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8968
    reference variance = 0.204433
====================================================
  Execution time = 3.5981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3419e-01
  Total weights = 2.0000e+06
  Execution time = 3.3596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224796538
                                         uncertainty =       0.002921059038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224796538
                                         uncertainty =       0.002921059038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408774456
  error estimate for blocks of size 2^( 2) =       0.000421884231
  error estimate for blocks of size 2^( 3) =       0.000435249059
  error estimate for blocks of size 2^( 4) =       0.000446745117
  error estimate for blocks of size 2^( 5) =       0.000456830012
  error estimate for blocks of size 2^( 6) =       0.000462562205
  error estimate for blocks of size 2^( 7) =       0.000465219214

      target function =                  N/A
              le_mean =     -16.906526368655
             les_mean =     286.164826799255
             stat err =       0.000457839137
             autocorr =       1.254464364656
              std dev =       0.578094380126
             le_variance =       0.334193112333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224759530
                                         uncertainty =       0.002921058227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224759530
                                         uncertainty =       0.002921058227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408774434
  error estimate for blocks of size 2^( 2) =       0.000421884206
  error estimate for blocks of size 2^( 3) =       0.000435249033
  error estimate for blocks of size 2^( 4) =       0.000446745091
  error estimate for blocks of size 2^( 5) =       0.000456829986
  error estimate for blocks of size 2^( 6) =       0.000462562177
  error estimate for blocks of size 2^( 7) =       0.000465219187

      target function =                  N/A
              le_mean =     -16.906526367103
             les_mean =     286.164826709726
             stat err =       0.000457839110
             autocorr =       1.254464357476
              std dev =       0.578094348077
             le_variance =       0.334193075279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224778026
                                         uncertainty =       0.002921058632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224778026
                                         uncertainty =       0.002921058632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408774445
  error estimate for blocks of size 2^( 2) =       0.000421884218
  error estimate for blocks of size 2^( 3) =       0.000435249046
  error estimate for blocks of size 2^( 4) =       0.000446745104
  error estimate for blocks of size 2^( 5) =       0.000456829999
  error estimate for blocks of size 2^( 6) =       0.000462562191
  error estimate for blocks of size 2^( 7) =       0.000465219200

      target function =                  N/A
              le_mean =     -16.906526367878
             les_mean =     286.164826754466
             stat err =       0.000457839123
             autocorr =       1.254464361063
              std dev =       0.578094364094
             le_variance =       0.334193093798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224794224
                                         uncertainty =       0.002921058987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224794224
                                         uncertainty =       0.002921058987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408774455
  error estimate for blocks of size 2^( 2) =       0.000421884229
  error estimate for blocks of size 2^( 3) =       0.000435249057
  error estimate for blocks of size 2^( 4) =       0.000446745115
  error estimate for blocks of size 2^( 5) =       0.000456830010
  error estimate for blocks of size 2^( 6) =       0.000462562203
  error estimate for blocks of size 2^( 7) =       0.000465219212

      target function =                  N/A
              le_mean =     -16.906526368558
             les_mean =     286.164826793656
             stat err =       0.000457839135
             autocorr =       1.254464364207
              std dev =       0.578094378122
             le_variance =       0.334193110016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906526368655        initial  <--
     9.3132e+02     9.3132e+03             2.2850e-07       -16.906526367103
     3.7253e+03     3.7253e+04             5.7125e-08       -16.906526367878
     1.4901e+04     1.4901e+05             1.4281e-08       -16.906526368558

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8576
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851413e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650285e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279656e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513213e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941916e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9235
    reference variance = 0.256881
====================================================
  Execution time = 3.7185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3546e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335292610547
                                         uncertainty =       0.002969769481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335292610547
                                         uncertainty =       0.002969769481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409550926
  error estimate for blocks of size 2^( 2) =       0.000422142008
  error estimate for blocks of size 2^( 3) =       0.000434633241
  error estimate for blocks of size 2^( 4) =       0.000447253759
  error estimate for blocks of size 2^( 5) =       0.000456890027
  error estimate for blocks of size 2^( 6) =       0.000463588391
  error estimate for blocks of size 2^( 7) =       0.000468689221

      target function =                  N/A
              le_mean =     -16.905887239880
             les_mean =     286.144487121896
             stat err =       0.000459105350
             autocorr =       1.256634220450
              std dev =       0.579192474130
             le_variance =       0.335463922089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588723988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887239880       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887239872       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887239921       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905887239896       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905887239907       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905887239888       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905887239887       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905887239885       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.689654e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887239880       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887239878       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887239890       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905887239875       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905887239887       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905887239887       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905887239873       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905887239885       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.724257e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887239880       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905887239880       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887239883       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905887239956       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905887239842       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905887239864       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905887239879       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905887240052       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.681072e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491111 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7176e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851413e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650287e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513210e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941916e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.98
    reference variance = 0.223149
====================================================
  Execution time = 3.6116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4354e-01
  Total weights = 2.0000e+06
  Execution time = 3.3690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561820647
                                         uncertainty =       0.007050858592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561820647
                                         uncertainty =       0.007050858592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414453486
  error estimate for blocks of size 2^( 2) =       0.000427242556
  error estimate for blocks of size 2^( 3) =       0.000440569188
  error estimate for blocks of size 2^( 4) =       0.000453440299
  error estimate for blocks of size 2^( 5) =       0.000464536099
  error estimate for blocks of size 2^( 6) =       0.000473869503
  error estimate for blocks of size 2^( 7) =       0.000479671482

      target function =                  N/A
              le_mean =     -16.905180400376
             les_mean =     286.128667581661
             stat err =       0.000467879346
             autocorr =       1.274430492422
              std dev =       0.586125740931
             le_variance =       0.343543384182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561818815
                                         uncertainty =       0.007050858214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561818815
                                         uncertainty =       0.007050858214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414453485
  error estimate for blocks of size 2^( 2) =       0.000427242554
  error estimate for blocks of size 2^( 3) =       0.000440569187
  error estimate for blocks of size 2^( 4) =       0.000453440297
  error estimate for blocks of size 2^( 5) =       0.000464536098
  error estimate for blocks of size 2^( 6) =       0.000473869502
  error estimate for blocks of size 2^( 7) =       0.000479671480

      target function =                  N/A
              le_mean =     -16.905180400311
             les_mean =     286.128667577627
             stat err =       0.000467879344
             autocorr =       1.274430491885
              std dev =       0.586125739373
             le_variance =       0.343543382356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561819731
                                         uncertainty =       0.007050858403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561819731
                                         uncertainty =       0.007050858403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414453485
  error estimate for blocks of size 2^( 2) =       0.000427242555
  error estimate for blocks of size 2^( 3) =       0.000440569187
  error estimate for blocks of size 2^( 4) =       0.000453440298
  error estimate for blocks of size 2^( 5) =       0.000464536098
  error estimate for blocks of size 2^( 6) =       0.000473869503
  error estimate for blocks of size 2^( 7) =       0.000479671481

      target function =                  N/A
              le_mean =     -16.905180400343
             les_mean =     286.128667579644
             stat err =       0.000467879345
             autocorr =       1.274430492149
              std dev =       0.586125740152
             le_variance =       0.343543383269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561820532
                                         uncertainty =       0.007050858568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343561820532
                                         uncertainty =       0.007050858568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414453486
  error estimate for blocks of size 2^( 2) =       0.000427242556
  error estimate for blocks of size 2^( 3) =       0.000440569188
  error estimate for blocks of size 2^( 4) =       0.000453440298
  error estimate for blocks of size 2^( 5) =       0.000464536099
  error estimate for blocks of size 2^( 6) =       0.000473869503
  error estimate for blocks of size 2^( 7) =       0.000479671482

      target function =                  N/A
              le_mean =     -16.905180400372
             les_mean =     286.128667581409
             stat err =       0.000467879346
             autocorr =       1.274430492386
              std dev =       0.586125740834
             le_variance =       0.343543384068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905180400376        initial  <--
     9.3132e+03     9.3132e+04             2.6897e-08       -16.905180400311
     3.7253e+04     3.7253e+05             6.7243e-09       -16.905180400343
     1.4901e+05     1.4901e+06             1.6811e-09       -16.905180400372

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.0516
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851413e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650285e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279656e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513213e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941916e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0023e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8014
    reference variance = 0.167964
====================================================
  Execution time = 3.8889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3192e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331962931285
                                         uncertainty =       0.002114464251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331962931285
                                         uncertainty =       0.002114464251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407382915
  error estimate for blocks of size 2^( 2) =       0.000420571219
  error estimate for blocks of size 2^( 3) =       0.000434511851
  error estimate for blocks of size 2^( 4) =       0.000447753134
  error estimate for blocks of size 2^( 5) =       0.000459354878
  error estimate for blocks of size 2^( 6) =       0.000469149134
  error estimate for blocks of size 2^( 7) =       0.000474874111

      target function =                  N/A
              le_mean =     -16.905890968116
             les_mean =     286.141070939253
             stat err =       0.000462782814
             autocorr =       1.290472701724
              std dev =       0.576126443909
             le_variance =       0.331921679372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589096812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890968116       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890968118       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890968119       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890968144       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890968147       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890968119       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890968125       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890968086       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.613742e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890968116       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890968117       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890968117       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890968142       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890968297       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890968194       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890967903       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890967837       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.534353e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890968116       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890968117       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890968117       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890968117       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890968538       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890967487       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890969445       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890968112       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.633589e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.495068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8786e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851413e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650285e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513213e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.317725
====================================================
  Execution time = 3.6207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5372e-01
  Total weights = 2.0000e+06
  Execution time = 3.3648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794597900
                                         uncertainty =       0.010851155681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794597900
                                         uncertainty =       0.010851155681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420547112
  error estimate for blocks of size 2^( 2) =       0.000432908824
  error estimate for blocks of size 2^( 3) =       0.000445988302
  error estimate for blocks of size 2^( 4) =       0.000458349913
  error estimate for blocks of size 2^( 5) =       0.000469084500
  error estimate for blocks of size 2^( 6) =       0.000478504633
  error estimate for blocks of size 2^( 7) =       0.000484992275

      target function =                  N/A
              le_mean =     -16.906286849856
             les_mean =     286.176254619356
             stat err =       0.000472732830
             autocorr =       1.263578473604
              std dev =       0.594743429227
             le_variance =       0.353719746608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794598520
                                         uncertainty =       0.010851155712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794598520
                                         uncertainty =       0.010851155712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420547112
  error estimate for blocks of size 2^( 2) =       0.000432908824
  error estimate for blocks of size 2^( 3) =       0.000445988302
  error estimate for blocks of size 2^( 4) =       0.000458349913
  error estimate for blocks of size 2^( 5) =       0.000469084501
  error estimate for blocks of size 2^( 6) =       0.000478504633
  error estimate for blocks of size 2^( 7) =       0.000484992275

      target function =                  N/A
              le_mean =     -16.906286849870
             les_mean =     286.176254620451
             stat err =       0.000472732831
             autocorr =       1.263578473149
              std dev =       0.594743429748
             le_variance =       0.353719747228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794598210
                                         uncertainty =       0.010851155696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794598210
                                         uncertainty =       0.010851155696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420547112
  error estimate for blocks of size 2^( 2) =       0.000432908824
  error estimate for blocks of size 2^( 3) =       0.000445988302
  error estimate for blocks of size 2^( 4) =       0.000458349913
  error estimate for blocks of size 2^( 5) =       0.000469084501
  error estimate for blocks of size 2^( 6) =       0.000478504633
  error estimate for blocks of size 2^( 7) =       0.000484992275

      target function =                  N/A
              le_mean =     -16.906286849863
             les_mean =     286.176254619904
             stat err =       0.000472732830
             autocorr =       1.263578473379
              std dev =       0.594743429487
             le_variance =       0.353719746918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794597939
                                         uncertainty =       0.010851155683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353794597939
                                         uncertainty =       0.010851155683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420547112
  error estimate for blocks of size 2^( 2) =       0.000432908824
  error estimate for blocks of size 2^( 3) =       0.000445988302
  error estimate for blocks of size 2^( 4) =       0.000458349913
  error estimate for blocks of size 2^( 5) =       0.000469084500
  error estimate for blocks of size 2^( 6) =       0.000478504633
  error estimate for blocks of size 2^( 7) =       0.000484992275

      target function =                  N/A
              le_mean =     -16.906286849857
             les_mean =     286.176254619425
             stat err =       0.000472732830
             autocorr =       1.263578473565
              std dev =       0.594743429259
             le_variance =       0.353719746647


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906286849856        initial
     9.3132e+04     9.3132e+05             2.6137e-09       -16.906286849870  <--
     3.7253e+05     3.7253e+06             6.5344e-10       -16.906286849863
     1.4901e+06     1.4901e+07             1.6336e-10       -16.906286849857

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 5.3111e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851414e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0190e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.894
    reference variance = 0.177154
====================================================
  Execution time = 3.6988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3302e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333094521983
                                         uncertainty =       0.002434092116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333094521983
                                         uncertainty =       0.002434092116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408054476
  error estimate for blocks of size 2^( 2) =       0.000421136962
  error estimate for blocks of size 2^( 3) =       0.000434344542
  error estimate for blocks of size 2^( 4) =       0.000446060737
  error estimate for blocks of size 2^( 5) =       0.000456413022
  error estimate for blocks of size 2^( 6) =       0.000465360469
  error estimate for blocks of size 2^( 7) =       0.000471574503

      target function =                  N/A
              le_mean =     -16.906819822227
             les_mean =     286.173573245440
             stat err =       0.000459852183
             autocorr =       1.269989739685
              std dev =       0.577076174099
             le_variance =       0.333016910713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681982223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906819822227       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906819822267       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906819822277       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906819822286       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906819822287       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906819822297       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906819822294       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906819822301       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.222160e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906819822227       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906819822237       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906819822239       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906819822242       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906819822242       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906819822255       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906819822219       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906819822183       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.055403e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906819822227       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906819822229       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906819822230       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906819822325       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906819822303       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906819822440       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906819822334       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906819822300       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.638509e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.499128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6827e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163782e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851414e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.857
    reference variance = 0.164262
====================================================
  Execution time = 3.5758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4436e-01
  Total weights = 2.0000e+06
  Execution time = 3.3652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404230878
                                         uncertainty =       0.008237647277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404230878
                                         uncertainty =       0.008237647277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414948201
  error estimate for blocks of size 2^( 2) =       0.000427747468
  error estimate for blocks of size 2^( 3) =       0.000440841755
  error estimate for blocks of size 2^( 4) =       0.000452790634
  error estimate for blocks of size 2^( 5) =       0.000463460361
  error estimate for blocks of size 2^( 6) =       0.000471103960
  error estimate for blocks of size 2^( 7) =       0.000476252576

      target function =                  N/A
              le_mean =     -16.905715221092
             les_mean =     286.147570982855
             stat err =       0.000465901883
             autocorr =       1.260669249997
              std dev =       0.586825372978
             le_variance =       0.344364018371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404235714
                                         uncertainty =       0.008237647467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404235714
                                         uncertainty =       0.008237647467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414948204
  error estimate for blocks of size 2^( 2) =       0.000427747470
  error estimate for blocks of size 2^( 3) =       0.000440841757
  error estimate for blocks of size 2^( 4) =       0.000452790636
  error estimate for blocks of size 2^( 5) =       0.000463460363
  error estimate for blocks of size 2^( 6) =       0.000471103962
  error estimate for blocks of size 2^( 7) =       0.000476252578

      target function =                  N/A
              le_mean =     -16.905715221044
             les_mean =     286.147570986062
             stat err =       0.000465901885
             autocorr =       1.260669243539
              std dev =       0.586825377098
             le_variance =       0.344364023207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404233296
                                         uncertainty =       0.008237647372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404233296
                                         uncertainty =       0.008237647372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414948202
  error estimate for blocks of size 2^( 2) =       0.000427747469
  error estimate for blocks of size 2^( 3) =       0.000440841756
  error estimate for blocks of size 2^( 4) =       0.000452790635
  error estimate for blocks of size 2^( 5) =       0.000463460362
  error estimate for blocks of size 2^( 6) =       0.000471103961
  error estimate for blocks of size 2^( 7) =       0.000476252577

      target function =                  N/A
              le_mean =     -16.905715221068
             les_mean =     286.147570984458
             stat err =       0.000465901884
             autocorr =       1.260669246771
              std dev =       0.586825375038
             le_variance =       0.344364020789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404231181
                                         uncertainty =       0.008237647289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344404231181
                                         uncertainty =       0.008237647289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414948201
  error estimate for blocks of size 2^( 2) =       0.000427747468
  error estimate for blocks of size 2^( 3) =       0.000440841755
  error estimate for blocks of size 2^( 4) =       0.000452790634
  error estimate for blocks of size 2^( 5) =       0.000463460361
  error estimate for blocks of size 2^( 6) =       0.000471103960
  error estimate for blocks of size 2^( 7) =       0.000476252576

      target function =                  N/A
              le_mean =     -16.905715221089
             les_mean =     286.147570983055
             stat err =       0.000465901883
             autocorr =       1.260669249597
              std dev =       0.586825373236
             le_variance =       0.344364018673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905715221092        initial  <--
     2.3283e+04     2.3283e+05             1.2222e-08       -16.905715221044
     9.3132e+04     9.3132e+05             3.0554e-09       -16.905715221068
     3.7253e+05     3.7253e+06             7.6385e-10       -16.905715221089

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.6583
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851414e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.958362
====================================================
  Execution time = 3.6305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336994767906
                                         uncertainty =       0.002970010055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336994767906
                                         uncertainty =       0.002970010055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410522060
  error estimate for blocks of size 2^( 2) =       0.000423546544
  error estimate for blocks of size 2^( 3) =       0.000437417330
  error estimate for blocks of size 2^( 4) =       0.000450288660
  error estimate for blocks of size 2^( 5) =       0.000461746203
  error estimate for blocks of size 2^( 6) =       0.000471075073
  error estimate for blocks of size 2^( 7) =       0.000477344724

      target function =                  N/A
              le_mean =     -16.906780864297
             les_mean =     286.176295747591
             stat err =       0.000465113665
             autocorr =       1.283645787718
              std dev =       0.580565864281
             le_variance =       0.337056722769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690678086430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906780864297       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906780864300       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906780864300       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906780864325       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906780864382       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906780864186       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906780864225       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906780864303       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.002767e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906780864297       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906780864297       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906780864298       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906780864297       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906780864437       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906780865041       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906780866116       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906780870064       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.506912e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906780864297       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906780864297       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906780864297       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906780864297       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906780864495       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906780865974       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906780862742       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906780865125       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 6.267269e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6174e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163782e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851414e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.618563
====================================================
  Execution time = 3.5910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4690e-01
  Total weights = 2.0000e+06
  Execution time = 3.3707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962260
                                         uncertainty =       0.009330096884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962260
                                         uncertainty =       0.009330096884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416473728
  error estimate for blocks of size 2^( 2) =       0.000428967234
  error estimate for blocks of size 2^( 3) =       0.000442014785
  error estimate for blocks of size 2^( 4) =       0.000454371274
  error estimate for blocks of size 2^( 5) =       0.000466281206
  error estimate for blocks of size 2^( 6) =       0.000473552371
  error estimate for blocks of size 2^( 7) =       0.000479639380

      target function =                  N/A
              le_mean =     -16.907366429229
             les_mean =     286.205940131530
             stat err =       0.000468461058
             autocorr =       1.265236662561
              std dev =       0.588982794963
             le_variance =       0.346900732763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962048
                                         uncertainty =       0.009330096876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962048
                                         uncertainty =       0.009330096876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416473728
  error estimate for blocks of size 2^( 2) =       0.000428967234
  error estimate for blocks of size 2^( 3) =       0.000442014785
  error estimate for blocks of size 2^( 4) =       0.000454371274
  error estimate for blocks of size 2^( 5) =       0.000466281206
  error estimate for blocks of size 2^( 6) =       0.000473552371
  error estimate for blocks of size 2^( 7) =       0.000479639380

      target function =                  N/A
              le_mean =     -16.907366429232
             les_mean =     286.205940131432
             stat err =       0.000468461058
             autocorr =       1.265236662651
              std dev =       0.588982794783
             le_variance =       0.346900732550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962154
                                         uncertainty =       0.009330096880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962154
                                         uncertainty =       0.009330096880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416473728
  error estimate for blocks of size 2^( 2) =       0.000428967234
  error estimate for blocks of size 2^( 3) =       0.000442014785
  error estimate for blocks of size 2^( 4) =       0.000454371274
  error estimate for blocks of size 2^( 5) =       0.000466281206
  error estimate for blocks of size 2^( 6) =       0.000473552371
  error estimate for blocks of size 2^( 7) =       0.000479639380

      target function =                  N/A
              le_mean =     -16.907366429231
             les_mean =     286.205940131481
             stat err =       0.000468461058
             autocorr =       1.265236662604
              std dev =       0.588982794873
             le_variance =       0.346900732656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962247
                                         uncertainty =       0.009330096884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937962247
                                         uncertainty =       0.009330096884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416473728
  error estimate for blocks of size 2^( 2) =       0.000428967234
  error estimate for blocks of size 2^( 3) =       0.000442014785
  error estimate for blocks of size 2^( 4) =       0.000454371274
  error estimate for blocks of size 2^( 5) =       0.000466281206
  error estimate for blocks of size 2^( 6) =       0.000473552371
  error estimate for blocks of size 2^( 7) =       0.000479639380

      target function =                  N/A
              le_mean =     -16.907366429229
             les_mean =     286.205940131524
             stat err =       0.000468461058
             autocorr =       1.265236662578
              std dev =       0.588982794952
             le_variance =       0.346900732750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907366429229        initial
     2.3283e+05     2.3283e+06             1.0028e-09       -16.907366429232  <--
     9.3132e+05     9.3132e+06             2.5069e-10       -16.907366429231
     3.7253e+06     3.7253e+07             6.2673e-11       -16.907366429229

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 5.2819e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163782e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851414e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594645e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9067
    reference variance = 0.202297
====================================================
  Execution time = 3.8514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3941e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410718342
                                         uncertainty =       0.004791768913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339410718342
                                         uncertainty =       0.004791768913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411953934
  error estimate for blocks of size 2^( 2) =       0.000425174592
  error estimate for blocks of size 2^( 3) =       0.000438598254
  error estimate for blocks of size 2^( 4) =       0.000451798715
  error estimate for blocks of size 2^( 5) =       0.000462241748
  error estimate for blocks of size 2^( 6) =       0.000468478474
  error estimate for blocks of size 2^( 7) =       0.000473102798

      target function =                  N/A
              le_mean =     -16.905945947038
             les_mean =     286.150420282655
             stat err =       0.000463905434
             autocorr =       1.268123669758
              std dev =       0.582590841157
             le_variance =       0.339412088200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594594704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905945947038       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905945947060       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905945947056       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905945947057       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905945947084       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905945947044       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905945947060       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905945947051       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.297808e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905945947038       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905945947043       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905945947042       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905945947043       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905945947061       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905945946975       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905945947009       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905945946911       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.074452e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905945947038       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905945947039       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905945947039       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905945946957       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905945947039       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905945947032       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905945946604       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905945946244       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.686130e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.506680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8430e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163782e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851414e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9575
    reference variance = 0.359963
====================================================
  Execution time = 3.5822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4407e-01
  Total weights = 2.0000e+06
  Execution time = 3.3689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668993773
                                         uncertainty =       0.006567380278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668993773
                                         uncertainty =       0.006567380278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414769590
  error estimate for blocks of size 2^( 2) =       0.000427169822
  error estimate for blocks of size 2^( 3) =       0.000439924733
  error estimate for blocks of size 2^( 4) =       0.000451679193
  error estimate for blocks of size 2^( 5) =       0.000461680084
  error estimate for blocks of size 2^( 6) =       0.000469994375
  error estimate for blocks of size 2^( 7) =       0.000474095935

      target function =                  N/A
              le_mean =     -16.905553764783
             les_mean =     286.141815547218
             stat err =       0.000464362397
             autocorr =       1.253430545829
              std dev =       0.586572779192
             le_variance =       0.344067625289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668995926
                                         uncertainty =       0.006567380314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668995926
                                         uncertainty =       0.006567380314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414769591
  error estimate for blocks of size 2^( 2) =       0.000427169823
  error estimate for blocks of size 2^( 3) =       0.000439924734
  error estimate for blocks of size 2^( 4) =       0.000451679195
  error estimate for blocks of size 2^( 5) =       0.000461680085
  error estimate for blocks of size 2^( 6) =       0.000469994376
  error estimate for blocks of size 2^( 7) =       0.000474095937

      target function =                  N/A
              le_mean =     -16.905553764795
             les_mean =     286.141815549784
             stat err =       0.000464362398
             autocorr =       1.253430544094
              std dev =       0.586572781032
             le_variance =       0.344067627448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668994849
                                         uncertainty =       0.006567380296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668994849
                                         uncertainty =       0.006567380296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414769590
  error estimate for blocks of size 2^( 2) =       0.000427169823
  error estimate for blocks of size 2^( 3) =       0.000439924734
  error estimate for blocks of size 2^( 4) =       0.000451679194
  error estimate for blocks of size 2^( 5) =       0.000461680085
  error estimate for blocks of size 2^( 6) =       0.000469994375
  error estimate for blocks of size 2^( 7) =       0.000474095936

      target function =                  N/A
              le_mean =     -16.905553764789
             les_mean =     286.141815548501
             stat err =       0.000464362397
             autocorr =       1.253430544951
              std dev =       0.586572780112
             le_variance =       0.344067626368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668993908
                                         uncertainty =       0.006567380280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343668993908
                                         uncertainty =       0.006567380280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414769590
  error estimate for blocks of size 2^( 2) =       0.000427169822
  error estimate for blocks of size 2^( 3) =       0.000439924733
  error estimate for blocks of size 2^( 4) =       0.000451679193
  error estimate for blocks of size 2^( 5) =       0.000461680084
  error estimate for blocks of size 2^( 6) =       0.000469994375
  error estimate for blocks of size 2^( 7) =       0.000474095936

      target function =                  N/A
              le_mean =     -16.905553764784
             les_mean =     286.141815547379
             stat err =       0.000464362397
             autocorr =       1.253430545728
              std dev =       0.586572779307
             le_variance =       0.344067625424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905553764783        initial
     5.8208e+04     5.8208e+05             4.2978e-09       -16.905553764795  <--
     2.3283e+05     2.3283e+06             1.0745e-09       -16.905553764789
     9.3132e+05     9.3132e+06             2.6861e-10       -16.905553764784

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 5.2691e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0113e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.195301
====================================================
  Execution time = 3.6271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333088636676
                                         uncertainty =       0.003572792382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333088636676
                                         uncertainty =       0.003572792382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408153472
  error estimate for blocks of size 2^( 2) =       0.000421420795
  error estimate for blocks of size 2^( 3) =       0.000434347491
  error estimate for blocks of size 2^( 4) =       0.000446185101
  error estimate for blocks of size 2^( 5) =       0.000457607331
  error estimate for blocks of size 2^( 6) =       0.000465309555
  error estimate for blocks of size 2^( 7) =       0.000469595793

      target function =                  N/A
              le_mean =     -16.905196737770
             les_mean =     286.118855089924
             stat err =       0.000459674445
             autocorr =       1.268392689735
              std dev =       0.577216175973
             le_variance =       0.333178513805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519673777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905196737770       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905196737769       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905196737935       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196737945       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196737917       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196737918       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905196737920       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905196737912       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.825720e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905196737770       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905196737770       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905196737811       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196737814       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196737805       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196738004       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905196737826       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905196737833       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.564315e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905196737770       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905196737770       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905196737780       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905196737804       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905196737779       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905196737867       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905196737665       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905196737736       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.141080e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.510344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6247e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163782e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679032e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985012e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650287e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513211e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.275231
====================================================
  Execution time = 3.6260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3289e-01
  Total weights = 2.0000e+06
  Execution time = 3.3763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935418741
                                         uncertainty =       0.002592360036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935418741
                                         uncertainty =       0.002592360036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407979790
  error estimate for blocks of size 2^( 2) =       0.000421102568
  error estimate for blocks of size 2^( 3) =       0.000434203091
  error estimate for blocks of size 2^( 4) =       0.000447182175
  error estimate for blocks of size 2^( 5) =       0.000458748048
  error estimate for blocks of size 2^( 6) =       0.000468608829
  error estimate for blocks of size 2^( 7) =       0.000472682043

      target function =                  N/A
              le_mean =     -16.906030448201
             les_mean =     286.146760366898
             stat err =       0.000461805274
             autocorr =       1.281269465495
              std dev =       0.576970551983
             le_variance =       0.332895017855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935420013
                                         uncertainty =       0.002592360044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935420013
                                         uncertainty =       0.002592360044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407979791
  error estimate for blocks of size 2^( 2) =       0.000421102569
  error estimate for blocks of size 2^( 3) =       0.000434203092
  error estimate for blocks of size 2^( 4) =       0.000447182175
  error estimate for blocks of size 2^( 5) =       0.000458748048
  error estimate for blocks of size 2^( 6) =       0.000468608830
  error estimate for blocks of size 2^( 7) =       0.000472682043

      target function =                  N/A
              le_mean =     -16.906030448177
             les_mean =     286.146760367367
             stat err =       0.000461805274
             autocorr =       1.281269462824
              std dev =       0.576970553086
             le_variance =       0.332895019128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935419377
                                         uncertainty =       0.002592360040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935419377
                                         uncertainty =       0.002592360040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407979790
  error estimate for blocks of size 2^( 2) =       0.000421102569
  error estimate for blocks of size 2^( 3) =       0.000434203092
  error estimate for blocks of size 2^( 4) =       0.000447182175
  error estimate for blocks of size 2^( 5) =       0.000458748048
  error estimate for blocks of size 2^( 6) =       0.000468608829
  error estimate for blocks of size 2^( 7) =       0.000472682043

      target function =                  N/A
              le_mean =     -16.906030448189
             les_mean =     286.146760367132
             stat err =       0.000461805274
             autocorr =       1.281269464162
              std dev =       0.576970552534
             le_variance =       0.332895018491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935418821
                                         uncertainty =       0.002592360037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332935418821
                                         uncertainty =       0.002592360037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407979790
  error estimate for blocks of size 2^( 2) =       0.000421102569
  error estimate for blocks of size 2^( 3) =       0.000434203091
  error estimate for blocks of size 2^( 4) =       0.000447182175
  error estimate for blocks of size 2^( 5) =       0.000458748048
  error estimate for blocks of size 2^( 6) =       0.000468608829
  error estimate for blocks of size 2^( 7) =       0.000472682043

      target function =                  N/A
              le_mean =     -16.906030448199
             les_mean =     286.146760366928
             stat err =       0.000461805274
             autocorr =       1.281269465313
              std dev =       0.576970552051
             le_variance =       0.332895017934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906030448201        initial  <--
     1.4552e+04     1.4552e+05             1.8257e-08       -16.906030448177
     5.8208e+04     5.8208e+05             4.5643e-09       -16.906030448189
     2.3283e+05     2.3283e+06             1.1411e-09       -16.906030448199

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2342
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9526
    reference variance = 0.454407
====================================================
  Execution time = 3.6761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4640e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0056e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346407614186
                                         uncertainty =       0.007330494318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346407614186
                                         uncertainty =       0.007330494318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416175305
  error estimate for blocks of size 2^( 2) =       0.000428784550
  error estimate for blocks of size 2^( 3) =       0.000442173916
  error estimate for blocks of size 2^( 4) =       0.000455569621
  error estimate for blocks of size 2^( 5) =       0.000466348791
  error estimate for blocks of size 2^( 6) =       0.000474494251
  error estimate for blocks of size 2^( 7) =       0.000480044691

      target function =                  N/A
              le_mean =     -16.905889856795
             les_mean =     286.155515445362
             stat err =       0.000469114338
             autocorr =       1.270588155158
              std dev =       0.588560760241
             le_variance =       0.346403768495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588985679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905889856795       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905889856797       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905889856797       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905889856745       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905889856790       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905889856820       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905889856807       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905889856797       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.323711e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905889856795       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905889856795       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905889856795       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905889857353       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905889856795       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905889857045       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905889856520       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905889856743       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.309279e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905889856795       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905889856795       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905889856795       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905889856864       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905889856795       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905889857020       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905889857240       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905889855070       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 8.273203e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.514408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6827e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.377722
====================================================
  Execution time = 3.5838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3522e-01
  Total weights = 2.0000e+06
  Execution time = 3.3731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602790
                                         uncertainty =       0.003138265776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602790
                                         uncertainty =       0.003138265776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409399599
  error estimate for blocks of size 2^( 2) =       0.000422543208
  error estimate for blocks of size 2^( 3) =       0.000435884579
  error estimate for blocks of size 2^( 4) =       0.000447937224
  error estimate for blocks of size 2^( 5) =       0.000458730614
  error estimate for blocks of size 2^( 6) =       0.000467329280
  error estimate for blocks of size 2^( 7) =       0.000472422371

      target function =                  N/A
              le_mean =     -16.906209731017
             les_mean =     286.155143364362
             stat err =       0.000461604872
             autocorr =       1.271293840241
              std dev =       0.578978464913
             le_variance =       0.335216062832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602490
                                         uncertainty =       0.003138265778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602490
                                         uncertainty =       0.003138265778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409399599
  error estimate for blocks of size 2^( 2) =       0.000422543208
  error estimate for blocks of size 2^( 3) =       0.000435884578
  error estimate for blocks of size 2^( 4) =       0.000447937223
  error estimate for blocks of size 2^( 5) =       0.000458730613
  error estimate for blocks of size 2^( 6) =       0.000467329280
  error estimate for blocks of size 2^( 7) =       0.000472422371

      target function =                  N/A
              le_mean =     -16.906209731014
             les_mean =     286.155143363947
             stat err =       0.000461604872
             autocorr =       1.271293840335
              std dev =       0.578978464655
             le_variance =       0.335216062534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602640
                                         uncertainty =       0.003138265777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602640
                                         uncertainty =       0.003138265777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409399599
  error estimate for blocks of size 2^( 2) =       0.000422543208
  error estimate for blocks of size 2^( 3) =       0.000435884578
  error estimate for blocks of size 2^( 4) =       0.000447937224
  error estimate for blocks of size 2^( 5) =       0.000458730614
  error estimate for blocks of size 2^( 6) =       0.000467329280
  error estimate for blocks of size 2^( 7) =       0.000472422371

      target function =                  N/A
              le_mean =     -16.906209731015
             les_mean =     286.155143364154
             stat err =       0.000461604872
             autocorr =       1.271293840280
              std dev =       0.578978464784
             le_variance =       0.335216062683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602771
                                         uncertainty =       0.003138265776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335138602771
                                         uncertainty =       0.003138265776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409399599
  error estimate for blocks of size 2^( 2) =       0.000422543208
  error estimate for blocks of size 2^( 3) =       0.000435884579
  error estimate for blocks of size 2^( 4) =       0.000447937224
  error estimate for blocks of size 2^( 5) =       0.000458730614
  error estimate for blocks of size 2^( 6) =       0.000467329280
  error estimate for blocks of size 2^( 7) =       0.000472422371

      target function =                  N/A
              le_mean =     -16.906209731017
             les_mean =     286.155143364336
             stat err =       0.000461604872
             autocorr =       1.271293840245
              std dev =       0.578978464897
             le_variance =       0.335216062814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906209731017        initial  <--
     1.4552e+05     1.4552e+06             1.3237e-09       -16.906209731014
     5.8208e+05     5.8208e+06             3.3093e-10       -16.906209731015
     2.3283e+06     2.3283e+07             8.2732e-11       -16.906209731017

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.7896
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9374
    reference variance = 0.249995
====================================================
  Execution time = 3.8538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3859e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338675717050
                                         uncertainty =       0.004211993997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338675717050
                                         uncertainty =       0.004211993997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411457279
  error estimate for blocks of size 2^( 2) =       0.000423636162
  error estimate for blocks of size 2^( 3) =       0.000436407693
  error estimate for blocks of size 2^( 4) =       0.000447469841
  error estimate for blocks of size 2^( 5) =       0.000456955998
  error estimate for blocks of size 2^( 6) =       0.000465543597
  error estimate for blocks of size 2^( 7) =       0.000469939534

      target function =                  N/A
              le_mean =     -16.907312597107
             les_mean =     286.195813271399
             stat err =       0.000459977243
             autocorr =       1.249750134023
              std dev =       0.581888463884
             le_variance =       0.338594184401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690731259711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907312597107       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907312597108       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907312597108       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907312596281       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907312597141       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907312596841       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907312597108       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907312597279       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.930571e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907312597107       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907312597107       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907312597107       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907312597107       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907312601960       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907312600198       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907312592753       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907312595403       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.826411e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907312597107       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907312597107       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907312597107       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907312597107       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907312589409       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907312596152       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907312613452       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907312611543       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.206602e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8462e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.539464
====================================================
  Execution time = 3.5738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4972e-01
  Total weights = 2.0000e+06
  Execution time = 3.3654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646784
                                         uncertainty =       0.010756684709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646784
                                         uncertainty =       0.010756684709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418164796
  error estimate for blocks of size 2^( 2) =       0.000430320615
  error estimate for blocks of size 2^( 3) =       0.000442822391
  error estimate for blocks of size 2^( 4) =       0.000454270827
  error estimate for blocks of size 2^( 5) =       0.000464362271
  error estimate for blocks of size 2^( 6) =       0.000470699051
  error estimate for blocks of size 2^( 7) =       0.000473739281

      target function =                  N/A
              le_mean =     -16.906192736394
             les_mean =     286.169076257758
             stat err =       0.000465767857
             autocorr =       1.240635185285
              std dev =       0.591374325221
             le_variance =       0.349723592531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646745
                                         uncertainty =       0.010756684710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646745
                                         uncertainty =       0.010756684710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418164796
  error estimate for blocks of size 2^( 2) =       0.000430320615
  error estimate for blocks of size 2^( 3) =       0.000442822391
  error estimate for blocks of size 2^( 4) =       0.000454270827
  error estimate for blocks of size 2^( 5) =       0.000464362271
  error estimate for blocks of size 2^( 6) =       0.000470699051
  error estimate for blocks of size 2^( 7) =       0.000473739281

      target function =                  N/A
              le_mean =     -16.906192736392
             les_mean =     286.169076257681
             stat err =       0.000465767857
             autocorr =       1.240635185312
              std dev =       0.591374325189
             le_variance =       0.349723592493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646765
                                         uncertainty =       0.010756684709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646765
                                         uncertainty =       0.010756684709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418164796
  error estimate for blocks of size 2^( 2) =       0.000430320615
  error estimate for blocks of size 2^( 3) =       0.000442822391
  error estimate for blocks of size 2^( 4) =       0.000454270827
  error estimate for blocks of size 2^( 5) =       0.000464362271
  error estimate for blocks of size 2^( 6) =       0.000470699051
  error estimate for blocks of size 2^( 7) =       0.000473739281

      target function =                  N/A
              le_mean =     -16.906192736393
             les_mean =     286.169076257720
             stat err =       0.000465767857
             autocorr =       1.240635185294
              std dev =       0.591374325205
             le_variance =       0.349723592512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646781
                                         uncertainty =       0.010756684709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349688646781
                                         uncertainty =       0.010756684709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418164796
  error estimate for blocks of size 2^( 2) =       0.000430320615
  error estimate for blocks of size 2^( 3) =       0.000442822391
  error estimate for blocks of size 2^( 4) =       0.000454270827
  error estimate for blocks of size 2^( 5) =       0.000464362271
  error estimate for blocks of size 2^( 6) =       0.000470699051
  error estimate for blocks of size 2^( 7) =       0.000473739281

      target function =                  N/A
              le_mean =     -16.906192736394
             les_mean =     286.169076257754
             stat err =       0.000465767857
             autocorr =       1.240635185291
              std dev =       0.591374325219
             le_variance =       0.349723592528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906192736394        initial  <--
     1.4552e+06     1.4552e+07             1.9306e-10       -16.906192736392
     5.8208e+06     5.8208e+07             4.8264e-11       -16.906192736393
     2.3283e+07     2.3283e+08             1.2066e-11       -16.906192736394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.6304
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0110e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.210613
====================================================
  Execution time = 3.6458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4495e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0046e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344761545404
                                         uncertainty =       0.007003366069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344761545404
                                         uncertainty =       0.007003366069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415303060
  error estimate for blocks of size 2^( 2) =       0.000427737451
  error estimate for blocks of size 2^( 3) =       0.000440640805
  error estimate for blocks of size 2^( 4) =       0.000452251148
  error estimate for blocks of size 2^( 5) =       0.000462448484
  error estimate for blocks of size 2^( 6) =       0.000470286175
  error estimate for blocks of size 2^( 7) =       0.000478047879

      target function =                  N/A
              le_mean =     -16.905801406128
             les_mean =     286.151074273962
             stat err =       0.000465758421
             autocorr =       1.257740860928
              std dev =       0.587327219693
             le_variance =       0.344953262992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580140613e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801406128       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801406128       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801406128       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801404487       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801401727       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801405674       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801407029       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801405406       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.809331e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801406128       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801406128       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801406128       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801406902       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801420808       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801391831       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801410141       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801351981       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.523328e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801406128       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801406128       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801406128       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801389739       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801365508       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801305579       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801333178       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801249087       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.130794e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.522109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6514e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.262251
====================================================
  Execution time = 3.6265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3657e-01
  Total weights = 2.0000e+06
  Execution time = 3.3734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093593
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093593
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410227234
  error estimate for blocks of size 2^( 2) =       0.000423401888
  error estimate for blocks of size 2^( 3) =       0.000436949939
  error estimate for blocks of size 2^( 4) =       0.000449227615
  error estimate for blocks of size 2^( 5) =       0.000459349489
  error estimate for blocks of size 2^( 6) =       0.000467910731
  error estimate for blocks of size 2^( 7) =       0.000470024517

      target function =                  N/A
              le_mean =     -16.905812302114
             les_mean =     286.143062192817
             stat err =       0.000461628088
             autocorr =       1.266296698716
              std dev =       0.580148917781
             le_variance =       0.336572766803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093587
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093587
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410227234
  error estimate for blocks of size 2^( 2) =       0.000423401888
  error estimate for blocks of size 2^( 3) =       0.000436949939
  error estimate for blocks of size 2^( 4) =       0.000449227615
  error estimate for blocks of size 2^( 5) =       0.000459349489
  error estimate for blocks of size 2^( 6) =       0.000467910731
  error estimate for blocks of size 2^( 7) =       0.000470024517

      target function =                  N/A
              le_mean =     -16.905812302114
             les_mean =     286.143062192810
             stat err =       0.000461628088
             autocorr =       1.266296698717
              std dev =       0.580148917777
             le_variance =       0.336572766797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093590
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093590
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410227234
  error estimate for blocks of size 2^( 2) =       0.000423401888
  error estimate for blocks of size 2^( 3) =       0.000436949939
  error estimate for blocks of size 2^( 4) =       0.000449227615
  error estimate for blocks of size 2^( 5) =       0.000459349489
  error estimate for blocks of size 2^( 6) =       0.000467910731
  error estimate for blocks of size 2^( 7) =       0.000470024517

      target function =                  N/A
              le_mean =     -16.905812302114
             les_mean =     286.143062192813
             stat err =       0.000461628088
             autocorr =       1.266296698717
              std dev =       0.580148917779
             le_variance =       0.336572766800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093593
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336605093593
                                         uncertainty =       0.003970890148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410227234
  error estimate for blocks of size 2^( 2) =       0.000423401888
  error estimate for blocks of size 2^( 3) =       0.000436949939
  error estimate for blocks of size 2^( 4) =       0.000449227615
  error estimate for blocks of size 2^( 5) =       0.000459349489
  error estimate for blocks of size 2^( 6) =       0.000467910731
  error estimate for blocks of size 2^( 7) =       0.000470024517

      target function =                  N/A
              le_mean =     -16.905812302114
             les_mean =     286.143062192816
             stat err =       0.000461628088
             autocorr =       1.266296698716
              std dev =       0.580148917781
             le_variance =       0.336572766802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905812302114        initial  <--
     1.4552e+07     1.4552e+08             1.8093e-11       -16.905812302114
     5.8208e+07     5.8208e+08             4.5233e-12       -16.905812302114
     2.3283e+08     2.3283e+09             1.1308e-12       -16.905812302114

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.3603
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9881e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9428
    reference variance = 0.195006
====================================================
  Execution time = 4.2011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335545294991
                                         uncertainty =       0.003171882052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335545294991
                                         uncertainty =       0.003171882052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409557976
  error estimate for blocks of size 2^( 2) =       0.000422632924
  error estimate for blocks of size 2^( 3) =       0.000435014727
  error estimate for blocks of size 2^( 4) =       0.000446554872
  error estimate for blocks of size 2^( 5) =       0.000457200270
  error estimate for blocks of size 2^( 6) =       0.000464938100
  error estimate for blocks of size 2^( 7) =       0.000470325148

      target function =                  N/A
              le_mean =     -16.906214814091
             les_mean =     286.155574643190
             stat err =       0.000459754597
             autocorr =       1.260147511550
              std dev =       0.579202443666
             le_variance =       0.335475470749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621481409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214814091       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906214814091       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214814091       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906214801376       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214813289       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214765669       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906214852481       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906214608052       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.353365e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214814091       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906214814091       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214814091       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906214814091       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214385136       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214576693       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906215241318       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906215049299       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 3.381469e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214814091       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906214814091       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214814091       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906214814091       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214814091       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214190646       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906214816675       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906215878149       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 8.446865e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.525750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2017e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8614
    reference variance = 0.190484
====================================================
  Execution time = 3.5896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4355e-01
  Total weights = 2.0000e+06
  Execution time = 3.3789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414459656
  error estimate for blocks of size 2^( 2) =       0.000427374172
  error estimate for blocks of size 2^( 3) =       0.000439171932
  error estimate for blocks of size 2^( 4) =       0.000451191257
  error estimate for blocks of size 2^( 5) =       0.000461579091
  error estimate for blocks of size 2^( 6) =       0.000468206557
  error estimate for blocks of size 2^( 7) =       0.000473914894

      target function =                  N/A
              le_mean =     -16.905830244496
             les_mean =     286.150649696357
             stat err =       0.000463722950
             autocorr =       1.251851043849
              std dev =       0.586134466169
             le_variance =       0.343553612431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414459656
  error estimate for blocks of size 2^( 2) =       0.000427374172
  error estimate for blocks of size 2^( 3) =       0.000439171932
  error estimate for blocks of size 2^( 4) =       0.000451191257
  error estimate for blocks of size 2^( 5) =       0.000461579091
  error estimate for blocks of size 2^( 6) =       0.000468206557
  error estimate for blocks of size 2^( 7) =       0.000473914894

      target function =                  N/A
              le_mean =     -16.905830244496
             les_mean =     286.150649696357
             stat err =       0.000463722950
             autocorr =       1.251851043850
              std dev =       0.586134466169
             le_variance =       0.343553612431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414459656
  error estimate for blocks of size 2^( 2) =       0.000427374172
  error estimate for blocks of size 2^( 3) =       0.000439171932
  error estimate for blocks of size 2^( 4) =       0.000451191257
  error estimate for blocks of size 2^( 5) =       0.000461579091
  error estimate for blocks of size 2^( 6) =       0.000468206557
  error estimate for blocks of size 2^( 7) =       0.000473914894

      target function =                  N/A
              le_mean =     -16.905830244496
             les_mean =     286.150649696357
             stat err =       0.000463722950
             autocorr =       1.251851043853
              std dev =       0.586134466169
             le_variance =       0.343553612431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343621085714
                                         uncertainty =       0.007167263660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414459656
  error estimate for blocks of size 2^( 2) =       0.000427374172
  error estimate for blocks of size 2^( 3) =       0.000439171932
  error estimate for blocks of size 2^( 4) =       0.000451191257
  error estimate for blocks of size 2^( 5) =       0.000461579091
  error estimate for blocks of size 2^( 6) =       0.000468206557
  error estimate for blocks of size 2^( 7) =       0.000473914894

      target function =                  N/A
              le_mean =     -16.905830244496
             les_mean =     286.150649696357
             stat err =       0.000463722950
             autocorr =       1.251851043856
              std dev =       0.586134466169
             le_variance =       0.343553612431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905830244496        initial  <--
     1.4552e+08     1.4552e+09             1.3534e-12       -16.905830244496
     5.8208e+08     5.8208e+09             3.3815e-13       -16.905830244496
     2.3283e+09     2.3283e+10             8.4469e-14       -16.905830244496

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.8792
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0490e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0598
    reference variance = 0.495595
====================================================
  Execution time = 3.8521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0069e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385325928272
                                         uncertainty =       0.043245058921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385325928272
                                         uncertainty =       0.043245058921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438866006
  error estimate for blocks of size 2^( 2) =       0.000450750944
  error estimate for blocks of size 2^( 3) =       0.000462597642
  error estimate for blocks of size 2^( 4) =       0.000474907123
  error estimate for blocks of size 2^( 5) =       0.000485031961
  error estimate for blocks of size 2^( 6) =       0.000491486949
  error estimate for blocks of size 2^( 7) =       0.000495830951

      target function =                  N/A
              le_mean =     -16.906005537371
             les_mean =     286.198229779087
             stat err =       0.000486814246
             autocorr =       1.230446325138
              std dev =       0.620650257454
             le_variance =       0.385206742078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600553737e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005537371       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005537371       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005537371       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906004651813       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005396013       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906004692880       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005588134       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906004912028       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.659879e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005537371       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005537371       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005537371       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005537371       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005537371       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906005537371       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906000626492       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906013516683       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906008871536       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 4.125340e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005537371       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005537371       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005537371       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906004303806       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906008525972       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006785790       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905978736085       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005843694       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906015433502       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905995692741       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906127944896       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905941220891       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906337240573       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906706499517       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906209098193       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906033642384       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906536685523       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905934157512       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907380826638       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908190274270       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908449698067       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904307687750       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.903719313533       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905217812666       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908150546670       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906568023741       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905175300457       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908964997538       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905857570137       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907174634681       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906925738837       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.905829211527       residual = 4.33e-06           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.907799627913       residual = 4.09e-04           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.029323e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.552973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8623e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.243771
====================================================
  Execution time = 3.6260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4073e-01
  Total weights = 2.0000e+06
  Execution time = 3.3702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412750594
  error estimate for blocks of size 2^( 2) =       0.000425450422
  error estimate for blocks of size 2^( 3) =       0.000437642868
  error estimate for blocks of size 2^( 4) =       0.000449640041
  error estimate for blocks of size 2^( 5) =       0.000459884134
  error estimate for blocks of size 2^( 6) =       0.000469012798
  error estimate for blocks of size 2^( 7) =       0.000474779903

      target function =                  N/A
              le_mean =     -16.905889052054
             les_mean =     286.149810575256
             stat err =       0.000463329219
             autocorr =       1.260096962199
              std dev =       0.583717487545
             le_variance =       0.340726105266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412750594
  error estimate for blocks of size 2^( 2) =       0.000425450422
  error estimate for blocks of size 2^( 3) =       0.000437642868
  error estimate for blocks of size 2^( 4) =       0.000449640041
  error estimate for blocks of size 2^( 5) =       0.000459884134
  error estimate for blocks of size 2^( 6) =       0.000469012798
  error estimate for blocks of size 2^( 7) =       0.000474779903

      target function =                  N/A
              le_mean =     -16.905889052054
             les_mean =     286.149810575256
             stat err =       0.000463329219
             autocorr =       1.260096962194
              std dev =       0.583717487545
             le_variance =       0.340726105266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412750594
  error estimate for blocks of size 2^( 2) =       0.000425450422
  error estimate for blocks of size 2^( 3) =       0.000437642868
  error estimate for blocks of size 2^( 4) =       0.000449640041
  error estimate for blocks of size 2^( 5) =       0.000459884134
  error estimate for blocks of size 2^( 6) =       0.000469012798
  error estimate for blocks of size 2^( 7) =       0.000474779903

      target function =                  N/A
              le_mean =     -16.905889052054
             les_mean =     286.149810575256
             stat err =       0.000463329219
             autocorr =       1.260096962198
              std dev =       0.583717487545
             le_variance =       0.340726105266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340792167663
                                         uncertainty =       0.004077650374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412750594
  error estimate for blocks of size 2^( 2) =       0.000425450422
  error estimate for blocks of size 2^( 3) =       0.000437642868
  error estimate for blocks of size 2^( 4) =       0.000449640041
  error estimate for blocks of size 2^( 5) =       0.000459884134
  error estimate for blocks of size 2^( 6) =       0.000469012798
  error estimate for blocks of size 2^( 7) =       0.000474779903

      target function =                  N/A
              le_mean =     -16.905889052054
             les_mean =     286.149810575256
             stat err =       0.000463329219
             autocorr =       1.260096962198
              std dev =       0.583717487545
             le_variance =       0.340726105266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905889052054        initial  <--
     1.4552e+09     1.4552e+10             1.6599e-13       -16.905889052054
     5.8208e+09     5.8208e+10             4.1253e-14       -16.905889052054
     2.3283e+10     2.3283e+11             1.0293e-14       -16.905889052054

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.2142
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0184e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8344
    reference variance = 0.318807
====================================================
  Execution time = 3.6490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343448285094
                                         uncertainty =       0.011121007393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343448285094
                                         uncertainty =       0.011121007393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414323393
  error estimate for blocks of size 2^( 2) =       0.000426611342
  error estimate for blocks of size 2^( 3) =       0.000439179367
  error estimate for blocks of size 2^( 4) =       0.000450887283
  error estimate for blocks of size 2^( 5) =       0.000460600337
  error estimate for blocks of size 2^( 6) =       0.000468576839
  error estimate for blocks of size 2^( 7) =       0.000473011020

      target function =                  N/A
              le_mean =     -16.906094020233
             les_mean =     286.159342596937
             stat err =       0.000463268870
             autocorr =       1.250222547759
              std dev =       0.585941761311
             le_variance =       0.343327747648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609402023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094020233       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094020233       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094020233       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094336823       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094020233       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906086678615       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906102670858       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906090836939       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+10 is 1.574767e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094020233       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094020233       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094020233       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094020233       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906106574475       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906103067238       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906052497803       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906107382708       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906107567366       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905760824109       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905766895764       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905941252831       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906249002839       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907475807347       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906247782119       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909362936907       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907316671476       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907407597669       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904222383511       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909010114237       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903646564942       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906984729297       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904400488508       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906877481564       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904461325357       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.900924565695       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903879770060       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.903702120278       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.914177256754       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.896321479802       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906040663206       residual = 8.14e-05           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.901078009295       residual = 3.57e-03           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.25e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+10 is 4.005679e-15

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094020233       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094020233       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094020233       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906080489257       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906039066183       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906013992195       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996233805       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906653104540       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905657409268       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906694194847       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.900785985718       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894622114271       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906648171702       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903119021733       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896915587870       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906986854945       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893630903680       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.897768810689       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.928108108701       residual = 6.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.930544656669       residual = 7.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.844572070325       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.907470559614       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.925731992490       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.926774119536       residual = 5.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.895507818087       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.929370404747       residual = 7.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.876418452619       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.925388442883       residual = 4.87e-02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.866849633949       residual = 2.06e-01           smallest_sin_value = 9.97e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 6.343800e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.590687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6480e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.286494
====================================================
  Execution time = 3.6475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4487e-01
  Total weights = 2.0000e+06
  Execution time = 3.3740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415252665
  error estimate for blocks of size 2^( 2) =       0.000428160256
  error estimate for blocks of size 2^( 3) =       0.000440758680
  error estimate for blocks of size 2^( 4) =       0.000452881824
  error estimate for blocks of size 2^( 5) =       0.000464346484
  error estimate for blocks of size 2^( 6) =       0.000471756408
  error estimate for blocks of size 2^( 7) =       0.000476613094

      target function =                  N/A
              le_mean =     -16.906454783648
             les_mean =     286.173082730398
             stat err =       0.000466399452
             autocorr =       1.261511481441
              std dev =       0.587255950429
             le_variance =       0.344869551314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415252665
  error estimate for blocks of size 2^( 2) =       0.000428160256
  error estimate for blocks of size 2^( 3) =       0.000440758680
  error estimate for blocks of size 2^( 4) =       0.000452881824
  error estimate for blocks of size 2^( 5) =       0.000464346484
  error estimate for blocks of size 2^( 6) =       0.000471756408
  error estimate for blocks of size 2^( 7) =       0.000476613094

      target function =                  N/A
              le_mean =     -16.906454783648
             les_mean =     286.173082730398
             stat err =       0.000466399452
             autocorr =       1.261511481440
              std dev =       0.587255950429
             le_variance =       0.344869551315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415252665
  error estimate for blocks of size 2^( 2) =       0.000428160256
  error estimate for blocks of size 2^( 3) =       0.000440758680
  error estimate for blocks of size 2^( 4) =       0.000452881824
  error estimate for blocks of size 2^( 5) =       0.000464346484
  error estimate for blocks of size 2^( 6) =       0.000471756408
  error estimate for blocks of size 2^( 7) =       0.000476613094

      target function =                  N/A
              le_mean =     -16.906454783648
             les_mean =     286.173082730398
             stat err =       0.000466399452
             autocorr =       1.261511481439
              std dev =       0.587255950429
             le_variance =       0.344869551314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344975557062
                                         uncertainty =       0.007157044428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415252665
  error estimate for blocks of size 2^( 2) =       0.000428160256
  error estimate for blocks of size 2^( 3) =       0.000440758680
  error estimate for blocks of size 2^( 4) =       0.000452881824
  error estimate for blocks of size 2^( 5) =       0.000464346484
  error estimate for blocks of size 2^( 6) =       0.000471756408
  error estimate for blocks of size 2^( 7) =       0.000476613094

      target function =                  N/A
              le_mean =     -16.906454783648
             les_mean =     286.173082730398
             stat err =       0.000466399452
             autocorr =       1.261511481441
              std dev =       0.587255950429
             le_variance =       0.344869551314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906454783648        initial  <--
     1.4552e+10     1.4552e+11             1.5748e-14       -16.906454783648
     5.8208e+10     5.8208e+11             4.0057e-15       -16.906454783648
     2.3283e+11     2.3283e+12             6.3438e-16       -16.906454783648

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4275
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8529
    reference variance = 0.358458
====================================================
  Execution time = 3.6368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4062e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340665567842
                                         uncertainty =       0.003818798862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340665567842
                                         uncertainty =       0.003818798862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688832
  error estimate for blocks of size 2^( 2) =       0.000425216281
  error estimate for blocks of size 2^( 3) =       0.000438226984
  error estimate for blocks of size 2^( 4) =       0.000450072843
  error estimate for blocks of size 2^( 5) =       0.000463069593
  error estimate for blocks of size 2^( 6) =       0.000471102198
  error estimate for blocks of size 2^( 7) =       0.000475509313

      target function =                  N/A
              le_mean =     -16.906410816393
             les_mean =     286.167350665842
             stat err =       0.000464938487
             autocorr =       1.269245298830
              std dev =       0.583630142738
             le_variance =       0.340624143512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641081639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410816393       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410816393       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410816393       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410816393       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906293962269       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906504061651       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906328656112       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906037569732       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906948501004       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904454516853       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907098644094       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906299533743       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905520061646       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905559399217       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.913459476583       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.887540127346       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.917910561394       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905208147199       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912082296291       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.886748589210       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.896229648236       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902288414245       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.919713474545       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.915672673756       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.901840841156       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.921423897642       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.883447285669       residual = 7.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.918897934266       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.920612068777       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907915303495       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.901173859276       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.925595318007       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.888144485433       residual = 4.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.925606815760       residual = 5.03e-02           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.933162848142       residual = 9.65e-02           smallest_sin_value = 9.94e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.13e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+11 is 1.790948e-15

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410816393       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410816393       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410816393       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906536631196       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204495480       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906483189936       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777580264       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904155047164       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906352802234       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904278851938       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911204867743       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904964969437       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910715220422       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903787151285       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904302481402       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.896778124677       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.881911915988       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.965458047914       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.920921309195       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.982746152525       residual = 7.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904978394457       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.882111990011       residual = 7.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.919751781706       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.855017487898       residual = 3.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.922458781299       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.866336326240       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.912910486433       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.829199688126       residual = 7.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.888829545118       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.898018891215       residual = 8.07e-03           smallest_sin_value = 9.98e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+11 is 2.458787e-16

solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410816393       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410816393       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.635905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6297e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.608848
====================================================
  Execution time = 3.6045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3783e-01
  Total weights = 2.0000e+06
  Execution time = 3.3613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410991669
  error estimate for blocks of size 2^( 2) =       0.000423818988
  error estimate for blocks of size 2^( 3) =       0.000436443437
  error estimate for blocks of size 2^( 4) =       0.000449262771
  error estimate for blocks of size 2^( 5) =       0.000461032750
  error estimate for blocks of size 2^( 6) =       0.000468857947
  error estimate for blocks of size 2^( 7) =       0.000473559440

      target function =                  N/A
              le_mean =     -16.906470272476
             les_mean =     286.166565208709
             stat err =       0.000463178227
             autocorr =       1.270077537893
              std dev =       0.581229991919
             le_variance =       0.337828303507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410991669
  error estimate for blocks of size 2^( 2) =       0.000423818988
  error estimate for blocks of size 2^( 3) =       0.000436443437
  error estimate for blocks of size 2^( 4) =       0.000449262771
  error estimate for blocks of size 2^( 5) =       0.000461032750
  error estimate for blocks of size 2^( 6) =       0.000468857947
  error estimate for blocks of size 2^( 7) =       0.000473559440

      target function =                  N/A
              le_mean =     -16.906470272476
             les_mean =     286.166565208709
             stat err =       0.000463178227
             autocorr =       1.270077537891
              std dev =       0.581229991919
             le_variance =       0.337828303507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410991669
  error estimate for blocks of size 2^( 2) =       0.000423818988
  error estimate for blocks of size 2^( 3) =       0.000436443437
  error estimate for blocks of size 2^( 4) =       0.000449262771
  error estimate for blocks of size 2^( 5) =       0.000461032750
  error estimate for blocks of size 2^( 6) =       0.000468857947
  error estimate for blocks of size 2^( 7) =       0.000473559440

      target function =                  N/A
              le_mean =     -16.906470272476
             les_mean =     286.166565208709
             stat err =       0.000463178227
             autocorr =       1.270077537891
              std dev =       0.581229991919
             le_variance =       0.337828303507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337933647909
                                         uncertainty =       0.005824704639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410991669
  error estimate for blocks of size 2^( 2) =       0.000423818988
  error estimate for blocks of size 2^( 3) =       0.000436443437
  error estimate for blocks of size 2^( 4) =       0.000449262771
  error estimate for blocks of size 2^( 5) =       0.000461032750
  error estimate for blocks of size 2^( 6) =       0.000468857947
  error estimate for blocks of size 2^( 7) =       0.000473559440

      target function =                  N/A
              le_mean =     -16.906470272476
             les_mean =     286.166565208709
             stat err =       0.000463178227
             autocorr =       1.270077537893
              std dev =       0.581229991919
             le_variance =       0.337828303507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906470272476        initial  <--
     1.4552e+11     1.4552e+12             1.7909e-15       -16.906470272476
     5.8208e+11     5.8208e+12             2.4588e-16       -16.906470272476
     2.3283e+12     2.3283e+13             0.0000e+00       -16.906470272476

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.9282
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.105499e-01 1 1  ON 0
 uu_1                 1.435169e-01 1 1  ON 1
 uu_2                 4.163781e-02 1 1  ON 2
 uu_3                -2.107832e-02 1 1  ON 3
 uu_4                -6.679031e-02 1 1  ON 4
 uu_5                -1.020169e-01 1 1  ON 5
 uu_6                -1.297253e-01 1 1  ON 6
 uu_7                -1.433469e-01 1 1  ON 7
 uu_8                -1.358422e-01 1 1  ON 8
 uu_9                -1.064395e-01 1 1  ON 9
 ud_0                 4.503978e-01 1 1  ON 10
 ud_1                 1.843565e-01 1 1  ON 11
 ud_2                 6.372654e-02 1 1  ON 12
 ud_3                -7.851415e-03 1 1  ON 13
 ud_4                -6.538381e-02 1 1  ON 14
 ud_5                -1.075022e-01 1 1  ON 15
 ud_6                -1.356495e-01 1 1  ON 16
 ud_7                -1.522290e-01 1 1  ON 17
 ud_8                -1.534242e-01 1 1  ON 18
 ud_9                -1.444923e-01 1 1  ON 19
 eO_0                -7.594644e-01 1 1  ON 20
 eO_1                -4.375015e-01 1 1  ON 21
 eO_2                -2.095566e-02 1 1  ON 22
 eO_3                 2.978489e-01 1 1  ON 23
 eO_4                 5.255749e-01 1 1  ON 24
 eO_5                 4.892200e-01 1 1  ON 25
 eO_6                 2.616892e-01 1 1  ON 26
 eO_7                -4.048244e-02 1 1  ON 27
 eO_8                -2.240866e-01 1 1  ON 28
 eO_9                -8.985011e-02 1 1  ON 29
eH1_0                -2.510282e-01 1 1  ON 30
eH1_1                -1.477987e-01 1 1  ON 31
eH1_2                -9.932062e-02 1 1  ON 32
eH1_3                -4.475800e-02 1 1  ON 33
eH1_4                 3.650286e-03 1 1  ON 34
eH1_5                 3.801546e-02 1 1  ON 35
eH1_6                 9.670962e-02 1 1  ON 36
eH1_7                 1.544749e-01 1 1  ON 37
eH1_8                 1.807630e-01 1 1  ON 38
eH1_9                 7.279657e-02 1 1  ON 39
eH2_0                -2.490034e-01 1 1  ON 40
eH2_1                -1.455784e-01 1 1  ON 41
eH2_2                -9.723307e-02 1 1  ON 42
eH2_3                -4.258757e-02 1 1  ON 43
eH2_4                 6.513212e-03 1 1  ON 44
eH2_5                 4.071767e-02 1 1  ON 45
eH2_6                 9.941915e-02 1 1  ON 46
eH2_7                 1.556200e-01 1 1  ON 47
eH2_8                 1.854390e-01 1 1  ON 48
eH2_9                 6.279383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9232e+01 secs
  Total Execution time = 4.0227e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
